import{r as d,ad as re,ae as oe,af as le,b4 as ce,ag as ie,dQ as u,j as n,c8 as ue,o as m,ax as de,dR as me,T as f,J as Y,a8 as D,L as pe,b2 as he}from"./index-e8217573.js";import{A as _}from"./AutoComplete-0bca608a.js";import{B as w}from"./ButtonBox-9e46519a.js";import{D as xe}from"./Dialog-adadaf64.js";import{D as Ne,a as fe}from"./DocumentUploader-e2ec1a13.js";import{I as N}from"./InputBox-b9e88f52.js";import{S as De}from"./SimpleDropDown-061a3470.js";import{S as Ee}from"./Skeleton-7e12d019.js";import{S as ve}from"./SystemDatePicker-abe08a29.js";import{T as Ce}from"./TextData-06df331b.js";import{D as Te}from"./DepositAccountService-fb3e0018.js";import{L as ye}from"./LoanService-d10912e0.js";import{s as ge}from"./Helper-54d1e873.js";const M={DDE:"DDE",FEES:"FEES"},E={uid:"",instrumentType:"",instrumentDate:"",utrOrChequeNo:"",amount:"",remark:"",sahayyaBankAccount:{name:"",uid:"",branch:"",accountNo:""},savedDocuments:[],lanId:"",applicantName:"",loanUid:"",status:""},we=d.forwardRef((k,q)=>{var L;const{onHide:H,visible:A,instrumentTypeOptions:G,onSubmit:Q,data:o,module:R,isLoading:O}=k,[I,U]=d.useState([]),[t,i]=d.useState({...E}),[,v]=d.useState(void 0),r=d.useRef(new re({validators:{...oe()},...le(),autoForceUpdate:{forceUpdate:()=>v(e=>!e)}})),S=d.useRef(null);d.useImperativeHandle(q,()=>({onCloseAndClearData:T})),d.useEffect(()=>{var e;(e=o==null?void 0:o.updateReceiptDetails)!=null&&e.uid?i(s=>({...s,...o.updateReceiptDetails})):R===M.DDE&&i(s=>{var a,l,x;return{...s,loanUid:((a=o==null?void 0:o.loanInfo)==null?void 0:a.loanUid)??"",applicantName:((l=o==null?void 0:o.loanInfo)==null?void 0:l.applicantName)??"",lanId:((x=o==null?void 0:o.loanInfo)==null?void 0:x.lanId)??""}})},[o]),d.useEffect(()=>{r.current.visibleFields=[],r.current.hideMessages(),i(e=>({...e,instrumentDate:ce(ie(pe.SYSTEM_DATE))}))},[A]),d.useEffect(()=>{var e;h===u.CASH&&i(s=>({...s,utrOrChequeNo:"",sahayyaBankAccount:{...E.sahayyaBankAccount}})),h===u.CHEQUE&&i(s=>({...s,sahayyaBankAccount:{...E.sahayyaBankAccount}})),r.current.visibleFields=[],(e=r==null?void 0:r.current)==null||e.purgeFields()},[t==null?void 0:t.instrumentType]),d.useEffect(()=>{console.log("updated PageObj",t)},[t]);const $=e=>{const{name:s,value:a}=e.target;i(typeof a=="object"?l=>({...l,[s]:{name:a==null?void 0:a.name,uid:a==null?void 0:a.uid,branch:a==null?void 0:a.branch,accountNo:a==null?void 0:a.accountNo}}):l=>({...l,[s]:{name:a,uid:"",branch:"",accountNo:""}}))},J=e=>{const{name:s,value:a}=e.target;i(typeof a=="object"?l=>({...l,lanId:a==null?void 0:a.lanId,loanUid:a==null?void 0:a.uid,applicantName:a==null?void 0:a.applicantName}):l=>({...l,lanId:a,loanUid:"",applicantName:""}))},C=e=>{i(s=>({...s,[e.target.name]:e.target.value}))},W=e=>{const s=e.target.value;i(a=>({...a,[e.target.name]:ge(s)}))},z=e=>{const{value:s}=e.target;i(a=>({...a,instrumentDate:s}))},K=()=>{var s;const e=(s=S.current)==null?void 0:s.getUploadedData();if(!(!X()||(t.instrumentType===u.CHEQUE||t.instrumentType===u.UPI)&&!(e!=null&&e.documentUid)))return Q({...t,unsavedDocuments:e})},p=e=>{var s,a;(a=r==null?void 0:r.current)==null||a.showMessageFor((s=e==null?void 0:e.target)==null?void 0:s.name)},X=()=>{var s,a;let e=!1;return e=((s=r==null?void 0:r.current)==null?void 0:s.allValid())??!1,e||(v(l=>!l),(a=r==null?void 0:r.current)==null||a.showMessages(),v(l=>!l),!1)},T=()=>{i(e=>({...e,...E})),H()},Z=async e=>{let s=[];try{await Te.getBankAccount(0,50,e.query).then(a=>{var x;const l=(x=a.data.results)==null?void 0:x.map(c=>({name:c.bank.name,accountNo:c.accountNumber,branch:c.ifsc.branch,uid:c.uid}));a.status===200&&(s=[...l??[]])})}catch(a){console.log(a)}s.length===0&&s.push({name:"",uid:""}),U(s)},V=async e=>{let s=[];try{await ye.getAll(0,50,`&lanId:lk=${e.query}&loanStatus:nq=DRAFT`).then(a=>{a.status===200&&(s=a.data.results)})}catch(a){console.log(a)}s.length===0&&s.push({name:"",uid:""}),U(s)},ee=()=>{var e;return R===M.DDE?n.jsxs("div",{className:"group grid",children:[n.jsx(D,{label:"label.dde.loanApplicationNo"}),n.jsx("div",{className:"mt-1",children:n.jsx(D,{label:t==null?void 0:t.lanId})})]}):n.jsx(_,{label:"label.dde.loanApplicationNo",name:"loanApplicationNo",value:t==null?void 0:t.lanId,variant:m.PRIMARY,suggestions:I,completeMethod:V,onChange:J,itemTemplate:te,onBlur:p,validation:(e=r==null?void 0:r.current)==null?void 0:e.message("loanApplicationNo",t==null?void 0:t.loanUid,"mandatory")})},y=()=>{var s;const{instrumentDate:e}=t;return n.jsx("div",{children:n.jsx(ve,{label:"label.dde.instrumentDate",name:"instrumentDate",value:e,variant:m.SECONDARY,onChange:z,onBlur:p,placeholder:"DD-MM-YYYY ",validation:(s=r==null?void 0:r.current)==null?void 0:s.message("instrumentDate",e,"mandatory")})})},j=()=>{var s;const{utrOrChequeNo:e}=t;return n.jsx("div",{children:n.jsx(N,{label:(t==null?void 0:t.instrumentType)===u.CHEQUE?"label.dde.ChqNo*":"label.dde.UTR*",name:"utrOrChequeNo",variant:m.SECONDARY,onChange:C,onBlur:p,value:e,className:"text-right",validation:(s=r==null?void 0:r.current)==null?void 0:s.message("utrOrChequeNo",e,(t==null?void 0:t.instrumentType)===u.CHEQUE?"mandatory|chequeNo":"mandatory")})})},g=()=>{var e;return n.jsx("div",{children:n.jsx(N,{label:"label.dde.amount",name:"amount",variant:m.SECONDARY,onChange:W,onBlur:p,value:F,className:"text-right",validation:(e=r==null?void 0:r.current)==null?void 0:e.message("amount",he(F),"mandatory|receiptAmount")})})},b=()=>{const{remark:e}=t;return n.jsx("div",{children:n.jsx(N,{label:"label.dde.remark",name:"remark",variant:m.SECONDARY,onChange:C,onBlur:p,value:e})})},ae=()=>{var B;const{instrumentType:e,instrumentDate:s,utrOrChequeNo:a,amount:l,remark:x,sahayyaBankAccount:c}=t;if(e===u.UPI)return n.jsxs(n.Fragment,{children:[y(),j(),g(),b(),n.jsx("div",{children:n.jsx(_,{label:"label.dde.sahayyaBankAccount",name:"sahayyaBankAccount",value:c==null?void 0:c.name,variant:m.PRIMARY,suggestions:I,completeMethod:Z,onChange:$,itemTemplate:ne,onBlur:p,validation:(B=r==null?void 0:r.current)==null?void 0:B.message("sahayyaBankAccount",c==null?void 0:c.uid,"mandatory")})}),n.jsx("div",{children:n.jsx(N,{label:"label.loanListing.branch",name:"branch",variant:m.SECONDARY,onBlur:p,value:c==null?void 0:c.branch,disabled:!0})}),n.jsx("div",{children:n.jsx(N,{label:"label.dde.accountNo",name:"accountNo",variant:m.SECONDARY,onBlur:p,value:c==null?void 0:c.accountNo,className:"text-right",disabled:!0})})]});if(e===u.CHEQUE)return n.jsxs(n.Fragment,{children:[y(),j(),g(),b()]});if(e===u.CASH)return n.jsxs(n.Fragment,{children:[y(),g(),b()]})},ne=e=>P(e,`${e==null?void 0:e.name}`),te=e=>P(e,`${e==null?void 0:e.lanId}`),P=(e,s,a)=>(e==null?void 0:e.uid)===void 0||(e==null?void 0:e.uid)===""?n.jsx("div",{className:"flex flex-col items-center justify-center h-39 pointer-events-none cursor-default",children:n.jsx(f,{className:"text-primary-labelColor mt-2",label:"label.noDataFound"})}):n.jsxs("div",{className:"flex flex-col",children:[n.jsx(f,{className:"text-primary-labelColor",label:s}),a?n.jsx(f,{className:"text-secondary-gray-500 text-xxs",label:a}):null]}),se=d.useMemo(()=>{var e,s,a;return n.jsxs("div",{className:"flex flex-col space-y-4 pl-6 pb-11",children:[n.jsx(Ce,{label:"label.dde.receiptsProof*",value:"Attach Documents (PDF, JPG, JPEG or PNG)",titleClass:"text-primary-gray-700 text-sm font-bold mb-1"}),n.jsx("div",{className:"flex gap-5",children:n.jsx(Ne,{ref:S,mandatoryDocUpload:!0,savedDocument:(e=t==null?void 0:t.savedDocuments)!=null&&e[0]?(a=(s=o==null?void 0:o.updateReceiptDetails)==null?void 0:s.savedDocuments)==null?void 0:a[0]:{},mode:fe.EDIT,queryParamForDocList:ue.DOCUMENT_CATEGORY_FEE_RECEIPT})})]})},[t==null?void 0:t.savedDocuments]),{amount:F,instrumentType:h}=t;return n.jsx(xe,{onHide:T,visible:A,modal:!0,closable:!1,variant:m.SECONDARY,className:" w-[842px] !p-0",children:O?n.jsx(Ee,{height:"19.375rem",width:"100%",borderRadius:"8px",animation:"wave"}):n.jsxs(de,{override:{read:(t==null?void 0:t.status)!==""&&(t==null?void 0:t.status)!==me.PENDING_DEPOSIT},children:[n.jsxs("div",{className:"flex justify-between items-center px-6 pt-3 pb-3 border-b border-primary-gray-600",children:[n.jsx(f,{className:"text-primary-primaryTextColor text-base font-bold ",label:t!=null&&t.uid?"label.dde.editReceipts":"label.dde.newReceipts"}),n.jsxs("div",{className:"flex",children:[n.jsx("div",{className:"mr-6",children:n.jsx(w,{buttonType:Y.CANCEL_OUTLINE,onClick:T,className:"w-8 h-8"})}),n.jsx("div",{className:"",children:n.jsx(w,{buttonType:Y.COLLECT,onClickWithLoader:K,className:"w-8 h-8"})})]})]}),n.jsxs("div",{className:`${h===u.CHEQUE||h===u.UPI?"h-[420px]":""}  overflow-y-auto `,children:[n.jsxs("div",{className:`mt-7 grid grid-cols-3 gap-3 px-6   ${t!=null&&t.instrumentType?"":"pb-6"} mb-6`,children:[n.jsx("div",{children:ee()}),n.jsx("div",{className:"",children:n.jsxs("div",{className:"group grid",children:[n.jsx(D,{label:"label.loanListing.applicationName"}),n.jsx("div",{className:"mt-1",children:n.jsx(D,{label:t==null?void 0:t.applicantName})})]})}),n.jsx("div",{children:n.jsx(De,{label:"label.dde.instrumentType",name:"instrumentType",placeholder:"placeholder.dde.instrumentType",value:h,variant:m.PRIMARY,options:G,optionLabel:"name",optionValue:"value",onChange:C,onBlur:p,disabled:!!(t!=null&&t.uid),validation:(L=r==null?void 0:r.current)==null?void 0:L.message("instrumentType",h,"mandatory")})}),ae()]}),h===u.CHEQUE||h===u.UPI?se:null]})]})})});export{we as A,M,E as i};
//# sourceMappingURL=AddNewReceiptDialog-69862c63.js.map
