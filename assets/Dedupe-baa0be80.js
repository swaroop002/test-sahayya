import{q as O,x as R,r as a,aG as N,g as $,ag as k,dl as p,ao as T,j as s,T as B,N as V,l as A,i as D,a2 as G,J as K,K as Y,M as F,ek as H,Q as J,V as W,el as q,em as z,en as Q,eo as Z,L as X,d7 as ee,cZ as S,b as se}from"./index-e8217573.js";import{u as te}from"./LoanDetailActions-c6533c8e.js";import{B as ae}from"./ButtonBox-9e46519a.js";import{E as oe}from"./ErrorDialog-d5eef4d7.js";import{T as ie}from"./Toast-ae99ea5b.js";import{D as le}from"./DedupeService-b4b7e998.js";import{L as ne}from"./LoanService-d10912e0.js";import{c as re,M as ce,C as de}from"./MainMessageBody-e15b4437.js";import{D as ue}from"./Dialog-adadaf64.js";import{A as me}from"./ACLService-e19daf7c.js";import"./kebab-menu-8835ad2e.js";import"./TransitionGroup-c8afe0ce.js";import"./Skeleton-7e12d019.js";import"./InputBox-b9e88f52.js";import"./withAuth-6de36ebf.js";import"./StageService-c1c03c89.js";const ge=[{id:1,name:"Customer Dedupe",path:q},{id:2,name:"Address Dedupe",path:z},{id:3,name:"Property Loan Linking",path:Q},{id:4,name:"Customer Loan Linking",path:Z}],pe={stageComplete:!1},Pe=()=>{const t=O(),L=R(),[_,c]=a.useState(!1),[d,u]=a.useState(""),[b]=a.useState("bottom-right"),[j,m]=a.useState({...pe}),[r,E]=a.useState(!1),[v,I]=a.useState(!1),[g,C]=a.useState(""),[f,P]=a.useState(N.PRIMARY),[h,M]=a.useState(!1),i=a.useRef(null);a.useEffect(()=>{U()},[]),a.useEffect(()=>{console.log(r,"message ");const e=$("VITE_MESSAGE_CONVERSATION_TIMING"),o=async()=>{try{const l=await de.checkNewMessageAvailability((t==null?void 0:t.stageUid)??"");I(l==null?void 0:l.data)}catch(l){console.log(l)}};o();const n=setInterval(o,e);return()=>{clearInterval(n)}},[]),a.useEffect(()=>{if(t!=null&&t.stageUid){const e=JSON.parse(k(X.STAGE_DETAIL));(e==null?void 0:e.status)===p.COMPLETED||(e==null?void 0:e.status)===p.CANCELLED?m(o=>({...o,stageComplete:!0})):(e==null?void 0:e.status)===p.IN_REVIEW?m(o=>({...o,stageComplete:!1})):m(o=>({...o,stageComplete:!1}))}},[t==null?void 0:t.stageUid]),a.useEffect(()=>{var e;i!=null&&i.current&&g!==""&&((e=i==null?void 0:i.current)==null||e.showFunction())},[g,f,h]),a.useEffect(()=>{d&&c(!0)},[d]);const U=()=>{const o=`&uid=${t.loanUid}`;ne.getAll(0,1,o).then(n=>{const l=n.data.results[0];L(te(l))}).catch(n=>{console.log(n),u(T(n))})},x=e=>{E(!r)},w=async()=>{try{const e=await le.stageComplete((t==null?void 0:t.stageUid)??"",{});if(ee(e)&&(C("Stage completed successfully"),P(N.PRIMARY),M(!h),me.isRouteHasAccess(S))){const o=`${se}${A}${D}${S}/${t.loanUid}/`;window.location.href=o}}catch(e){console.log(e),c(!0),u(T(e))}},y=({isActive:e})=>`tab text-sm px-2.5 py-1 min-w-fit ${e?"bg-secondary-steelBlue-900 rounded-sm text-white font-medium shadow-activeBtn ":"text-primary-500"}`;return s.jsx("div",{children:s.jsxs("div",{className:"flex flex-col gap-5 ",children:[s.jsxs("div",{className:"flex items-center justify-between gap-5 w-full",children:[s.jsxs("div",{className:"flex items-center gap-5 w-11/12",children:[s.jsxs("div",{className:"border-r flex items-center border-secondary-stext-600 px-5 py-2 gap-2  ",children:[s.jsx(B,{className:"text-primary-ptext-1000 font-bold",label:"heading.dedupe"}),s.jsxs("button",{onClick:x,className:" relative",children:[s.jsx("img",{src:re,alt:"ChatIcon",className:""})," ",v?s.jsx("div",{className:"absolute top-0 right-0 w-2 h-2 bg-red-500 rounded-full"}):s.jsx(s.Fragment,{})]})]}),s.jsx("div",{className:"w-3/4",children:ge.map(e=>s.jsx(V,{className:y,to:`${A}${D}${G}/${t==null?void 0:t.loanUid}/${t==null?void 0:t.stageUid}${e.path}`,children:e.name},e.path))})]}),s.jsx("div",{className:"w-1/4 flex justify-end",children:s.jsx(ae,{buttonType:K.STAGE_COMPLETE,onClickWithLoader:w,size:"LOAN_DATA",disabled:j.stageComplete})})]}),s.jsxs("div",{className:"dedupe-layout-body-content",children:[s.jsx(a.Suspense,{fallback:s.jsx(Y,{}),children:s.jsx(F,{children:H.map((e,o)=>s.jsx(J,{path:e.path,element:s.jsx(e.component,{})},o))})}),s.jsx(W,{})]}),s.jsx(oe,{onHide:()=>{c(!1),u("")},visible:_,errorMessage:d}),r?s.jsx(ue,{visible:r,closable:!1,model:"false",onHide:()=>E(!1),className:"rounded-lg shadow-lg !w-240 bg-blend-darken !p-0 !h-162 ",children:s.jsx(ce,{params:t,handleCloseOverLay:x})}):null,s.jsx(ie,{position:b,ref:i,toastText:g,variant:f})]})})};export{Pe as default};
//# sourceMappingURL=Dedupe-baa0be80.js.map
