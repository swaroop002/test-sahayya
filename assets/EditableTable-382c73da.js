import{r as i,aF as u,j as d,T as j,R as G,ck as g}from"./index-e8217573.js";import{n as H}from"./No_data-1720c54e.js";import{S as J}from"./SimpleDropDown-061a3470.js";import{D as Q}from"./datatable.esm-f474a654.js";const X=i.forwardRef((e,A)=>{var D,S,E,y,T,P;const[t,c]=i.useState({limit:((D=e.tableObj)==null?void 0:D.limit)??10,loading:((S=e.tableObj)==null?void 0:S.loading)??!1,totalRecords:((E=e.tableObj)==null?void 0:E.totalRecords)??0,start:((y=e.tableObj)==null?void 0:y.start)??0,records:[],search:((T=e.tableObj)==null?void 0:T.search)??"",page:((P=e.tableObj)==null?void 0:P.page)??0}),[v]=i.useState(0),[x,C]=i.useState([...(e==null?void 0:e.updatedRecords)||[]]),[h,R]=i.useState([...(e==null?void 0:e.addedRecords)||[]]),[I,L]=i.useState([]),b=a=>{const s=n=>{let f=[];if(e.pageMode==u.EDIT||e.pageMode==u.REVIEW||e.pageMode===u.VIEW?f=[...N([...n.results])]:f=[...n.results],c({...t,loading:!1,records:[...h,...f],totalRecords:n.totalRecords,start:o.start,search:o.search}),e.onUpdateCallback&&e.onUpdateCallback(),e.scrollToTopOnUpdate){const m=document.querySelector(".p-datatable-scrollable-body tr");m==null||m.scrollIntoView({behavior:"smooth"})}},l=()=>{c({...t,loading:!1,records:[],start:0,totalRecords:0})};if(c({...t,loading:!0}),!e.standardDataFormatPromise)return;function r(){return e.avoidStartOffset?t.start:t.start===0?v:t.start}const o={start:r(),limit:e.rows?e.rows:t.limit,search:""};if(a){const n=a.page?a.page:0,f=a.rows?a.rows:0;let m=n*f;m=e.avoidStartOffset?m:m+v,o.start=m}return e.search&&(o.search=e.search),(e.search&&e.standardDataFormatSearchPromise?e.standardDataFormatSearchPromise:e.standardDataFormatPromise)(o.start,o.limit,o.search).then(n=>{n.data&&s(n.data)}).catch(l)},M=a=>{const s=t.records.filter(r=>r.isAdded===!0),l=t.records.filter(r=>r.isAdded!==!0);c({...t,records:e.pageMode===u.EDIT?[...s,{...a},...l]:[...t.records,{...a}]})},O=a=>{const s=t.records.filter(r=>r.isAdded===!0),l=t.records.filter(r=>r.isAdded!==!0);c({...t,records:e.pageMode===u.EDIT?[...s,...a,...l]:[...t.records,...a]})},F=(a,s,l)=>{const r=[...a.props.value];r[a.rowIndex-t.start][l]=s,r[a.rowIndex-t.start].isAdded!==!0&&(r[a.rowIndex-t.start][g.IS_UPDATED]=!0);const o=r.filter(w=>{const n=x.some(f=>f.uid===w.uid);return w.isUpdated&&!n});C([...x,...o]),c({...t,records:r})},k=a=>{const s=[...a.props.value];if(s[a.rowIndex-t.start][g.IS_ADDED]===!0){s.splice(a.rowIndex-t.start,1);const l=s.filter(r=>r.isAdded);R(l),c({...t,records:s})}else{s[a.rowIndex-t.start][g.IS_INACTIVE]===!0?s[a.rowIndex-t.start][g.IS_INACTIVE]=!1:s[a.rowIndex-t.start][g.IS_INACTIVE]=!0;const l=s.filter(o=>o.isInactive),r=s.filter(o=>o.isAdded);R(r),L(l),c({...t,records:s})}},U=a=>{c({...t,records:[]}),R([])},V=()=>h,_=()=>I,B=()=>x,N=a=>[...a.map(l=>{const r=x.find(o=>o.uid===l.uid);return r||l})],W=(a,s)=>{const l=[...t.records.map(o=>a[s]==o[s]?a:o)],r=l?[...l]:[...t.records];c({...t,records:r})};i.useImperativeHandle(A,()=>({search:()=>{b(void 0)},addRecords:M,updateRecords:F,deleteRow:k,getAddedRecords:V,getDeletedRecords:_,addRecordsArray:O,emptyRow:U,getUpdatedRecords:B,updateRecordsOnTabChange:N,updateAddedRecords:W}));const $=a=>a!=null&&a.uid?{"row-highlight":a.uid%2}:"",z=()=>d.jsx("div",{className:"flex flex-col w-full h-16 justify-center items-center",children:d.jsx("div",{className:"text-sm text-inputBorderColour pt-3 font-medium",children:e.showLoader?d.jsx("div",{children:"Loading..."}):e.emptymessage??d.jsxs(d.Fragment,{children:[d.jsx("img",{src:H,alt:"search-icon",className:" w-full mt-84"}),d.jsx("div",{className:"flex justify-center mt-7 ml-4",children:d.jsx(j,{label:"No Data Found",className:"text-primary-primaryTextColor text-h1 font-Roboto font-bold"})})]})})}),K=a=>{c({...t,limit:a.value})},q={layout:"FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink RowsPerPageDropdown ",RowsPerPageDropdown:a=>{const s=[{label:10,value:10},{label:20,value:20},{label:50,value:50}];return d.jsxs("div",{className:"flex ml-auto",children:[d.jsx("div",{className:"flex",children:d.jsx(j,{label:"Rows Per Page",className:"text-secondary-gray-500 text-xs ml-4 flex items-center"})}),d.jsx(J,{value:a.value,options:s,onChange:K,className:"border-none !w-20 !text-primary-gray-700 !text-xss !font-Roboto"})]})}};return i.useEffect(()=>{console.log(e.pageMode),e.pageMode===u.EDIT||e.pageMode===u.REVIEW||e.pageMode===u.VIEW?b({}):c({...t,loading:!1,records:[...h]})},[]),i.useEffect(()=>{const a=t.records.filter(s=>s.isAdded);R(a)},[t.records]),d.jsxs("div",{children:[e.showStatusBar?d.jsx("div",{className:"mt-4 w-full flex items-center justify-center text-primary-ptext-1000 text-left text-xs font-bold",children:d.jsxs("div",{className:"flex items-center",children:[d.jsxs("div",{className:"flex items-center mx-2",children:[d.jsx("div",{className:"w-4 h-4 rounded-full bg-semantic-deepSkyBlue-100 border-none"}),d.jsxs("div",{className:"ml-2 ",children:["Added : ",h.length]})]}),d.jsxs("div",{className:"flex items-center mx-2",children:[d.jsx("div",{className:"w-4 h-4 rounded-full bg-semantic-yellow-100 border-none"}),d.jsxs("div",{className:"ml-2",children:["Updated : ",x.length]})]}),d.jsxs("div",{className:"flex items-center mx-2",children:[d.jsx("div",{className:"w-4 h-4 rounded-full bg-semantic-crimson-100 border-none"}),d.jsxs("div",{className:"ml-2",children:["Deleted : ",I.length]})]})]})}):"",d.jsx(Q,{className:"text-primaryColour text-left align-text-top",headerClassName:e.headerClassName,emptyMessage:z,search:"",style:{width:"100%"},dataLoaderFunction:b,value:t.records,first:t.start,rows:t.limit,totalRecords:100,onPage:b,loading:t.loading,selection:e.selection,onRowSelect:a=>e.onRowSelect?e.selectThisRow(a):"",selectionMode:e.selectionMode,dataKey:e.dataKey,resizableColumns:!1,paginator:t.totalRecords>0&&!e.hidePaginator,paginatorTemplate:q,onsort:e.sortFunction,paginatorLeft:d.jsx(j,{label:`${t.start+1}-${t.start+t.limit} of ${t.totalRecords}`,className:"text-secondary-gray-500 text-xs ml-4"}),lazy:!0,rowClassName:$+e.rowClassName,responsiveLayout:"scroll",breakpoint:"768px",...e,children:e.children})]})}),ae=G.memo(X);export{ae as E};
//# sourceMappingURL=EditableTable-382c73da.js.map
