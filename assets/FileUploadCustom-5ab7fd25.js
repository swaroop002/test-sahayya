import{r as m,R as S,j as n,T as P,aG as $t,v as st,ao as Z,aw as le,c8 as Bt}from"./index-e8217573.js";import{l as Ot}from"./Loading-783a01c7.js";import{R as zt,Z as Wt,a as Gt,M as Zt,i as Qt,P as qt}from"./MediaGallery-5884b284.js";import{D as ct}from"./Dialog-adadaf64.js";import{E as Jt}from"./ErrorDialog-d5eef4d7.js";import{M as ea}from"./FileUploadMenuBox-f47dc693.js";import{S as He}from"./SimpleDropDown-061a3470.js";import{T as ta}from"./Toast-ae99ea5b.js";import{F as Q}from"./FileUploadService-1aaf11f7.js";const ht="/assets/Cancel_ImageEdit-f9563072.svg",ut="/assets/Save_Image-8e728893.svg",ge={x:0,y:0,width:0,height:0,unit:"px"},J=(u,t,e)=>Math.min(Math.max(u,t),e),aa=(...u)=>u.filter(t=>t&&typeof t=="string").join(" "),lt=(u,t)=>u===t||u.width===t.width&&u.height===t.height&&u.x===t.x&&u.y===t.y&&u.unit===t.unit;function Sa(u,t,e,o){const a=X(u,e,o);return u.width&&(a.height=a.width/t),u.height&&(a.width=a.height*t),a.y+a.height>o&&(a.height=o-a.y,a.width=a.height*t),a.x+a.width>e&&(a.width=e-a.x,a.height=a.width/t),u.unit==="%"?O(a,e,o):a}function ja(u,t,e){const o=X(u,t,e);return o.x=(t-o.width)/2,o.y=(e-o.height)/2,u.unit==="%"?O(o,t,e):o}function O(u,t,e){return u.unit==="%"?{...ge,...u,unit:"%"}:{unit:"%",x:u.x?u.x/t*100:0,y:u.y?u.y/e*100:0,width:u.width?u.width/t*100:0,height:u.height?u.height/e*100:0}}function X(u,t,e){return u.unit?u.unit==="px"?{...ge,...u,unit:"px"}:{unit:"px",x:u.x?u.x*t/100:0,y:u.y?u.y*e/100:0,width:u.width?u.width*t/100:0,height:u.height?u.height*e/100:0}:{...ge,...u,unit:"px"}}function dt(u,t,e,o,a,i=0,p=0,v=o,l=a){const r={...u};let x=Math.min(i,o),g=Math.min(p,a),f=Math.min(v,o),h=Math.min(l,a);t&&(t>1?(x=p?p*t:x,g=x/t,f=v*t):(g=i?i/t:g,x=g*t,h=l/t)),r.y<0&&(r.height=Math.max(r.height+r.y,g),r.y=0),r.x<0&&(r.width=Math.max(r.width+r.x,x),r.x=0);const b=o-(r.x+r.width);b<0&&(r.x=Math.min(r.x,o-x),r.width+=b);const I=a-(r.y+r.height);if(I<0&&(r.y=Math.min(r.y,a-g),r.height+=I),r.width<x&&((e==="sw"||e=="nw")&&(r.x-=x-r.width),r.width=x),r.height<g&&((e==="nw"||e=="ne")&&(r.y-=g-r.height),r.height=g),r.width>f&&((e==="sw"||e=="nw")&&(r.x-=f-r.width),r.width=f),r.height>h&&((e==="nw"||e=="ne")&&(r.y-=h-r.height),r.height=h),t){const F=r.width/r.height;if(F<t){const A=Math.max(r.width/t,g);(e==="nw"||e=="ne")&&(r.y-=A-r.height),r.height=A}else if(F>t){const A=Math.max(r.height*t,x);(e==="sw"||e=="nw")&&(r.x-=A-r.width),r.width=A}}return r}function na(u,t,e,o){const a={...u};return t==="ArrowLeft"?o==="nw"?(a.x-=e,a.y-=e,a.width+=e,a.height+=e):o==="w"?(a.x-=e,a.width+=e):o==="sw"?(a.x-=e,a.width+=e,a.height+=e):o==="ne"?(a.y+=e,a.width-=e,a.height-=e):o==="e"?a.width-=e:o==="se"&&(a.width-=e,a.height-=e):t==="ArrowRight"&&(o==="nw"?(a.x+=e,a.y+=e,a.width-=e,a.height-=e):o==="w"?(a.x+=e,a.width-=e):o==="sw"?(a.x+=e,a.width-=e,a.height-=e):o==="ne"?(a.y-=e,a.width+=e,a.height+=e):o==="e"?a.width+=e:o==="se"&&(a.width+=e,a.height+=e)),t==="ArrowUp"?o==="nw"?(a.x-=e,a.y-=e,a.width+=e,a.height+=e):o==="n"?(a.y-=e,a.height+=e):o==="ne"?(a.y-=e,a.width+=e,a.height+=e):o==="sw"?(a.x+=e,a.width-=e,a.height-=e):o==="s"?a.height-=e:o==="se"&&(a.width-=e,a.height-=e):t==="ArrowDown"&&(o==="nw"?(a.x+=e,a.y+=e,a.width-=e,a.height-=e):o==="n"?(a.y+=e,a.height-=e):o==="ne"?(a.y+=e,a.width-=e,a.height-=e):o==="sw"?(a.x-=e,a.width+=e,a.height+=e):o==="s"?a.height+=e:o==="se"&&(a.width+=e,a.height+=e)),a}const ee={capture:!0,passive:!1},z=class Y extends m.PureComponent{constructor(){super(...arguments),this.docMoveBound=!1,this.mouseDownOnCrop=!1,this.dragStarted=!1,this.evData={startClientX:0,startClientY:0,startCropX:0,startCropY:0,clientX:0,clientY:0,isResize:!0},this.componentRef=m.createRef(),this.mediaRef=m.createRef(),this.initChangeCalled=!1,this.state={cropIsActive:!1,newCropIsBeingDrawn:!1},this.onCropPointerDown=t=>{const{crop:e,disabled:o}=this.props,a=this.getBox();if(!e)return;const i=X(e,a.width,a.height);if(o)return;t.cancelable&&t.preventDefault(),this.bindDocMove(),this.componentRef.current.focus({preventScroll:!0});const p=t.target.dataset.ord,v=!!p;let l=t.clientX,r=t.clientY,x=i.x,g=i.y;if(p){const f=t.clientX-a.x,h=t.clientY-a.y;let b=0,I=0;p==="ne"||p=="e"?(b=f-(i.x+i.width),I=h-i.y,x=i.x,g=i.y+i.height):p==="se"||p==="s"?(b=f-(i.x+i.width),I=h-(i.y+i.height),x=i.x,g=i.y):p==="sw"||p=="w"?(b=f-i.x,I=h-(i.y+i.height),x=i.x+i.width,g=i.y):(p==="nw"||p=="n")&&(b=f-i.x,I=h-i.y,x=i.x+i.width,g=i.y+i.height),l=x+a.x+b,r=g+a.y+I}this.evData={startClientX:l,startClientY:r,startCropX:x,startCropY:g,clientX:t.clientX,clientY:t.clientY,isResize:v,ord:p},this.mouseDownOnCrop=!0,this.setState({cropIsActive:!0})},this.onComponentPointerDown=t=>{const{crop:e,disabled:o,locked:a,keepSelection:i,onChange:p}=this.props,v=this.getBox();if(o||a||i&&e)return;t.cancelable&&t.preventDefault(),this.bindDocMove(),this.componentRef.current.focus({preventScroll:!0});const l=t.clientX-v.x,r=t.clientY-v.y,x={unit:"px",x:l,y:r,width:0,height:0};this.evData={startClientX:t.clientX,startClientY:t.clientY,startCropX:l,startCropY:r,clientX:t.clientX,clientY:t.clientY,isResize:!0},this.mouseDownOnCrop=!0,p(X(x,v.width,v.height),O(x,v.width,v.height)),this.setState({cropIsActive:!0,newCropIsBeingDrawn:!0})},this.onDocPointerMove=t=>{const{crop:e,disabled:o,onChange:a,onDragStart:i}=this.props,p=this.getBox();if(o||!e||!this.mouseDownOnCrop)return;t.cancelable&&t.preventDefault(),this.dragStarted||(this.dragStarted=!0,i&&i(t));const{evData:v}=this;v.clientX=t.clientX,v.clientY=t.clientY;let l;v.isResize?l=this.resizeCrop():l=this.dragCrop(),lt(e,l)||a(X(l,p.width,p.height),O(l,p.width,p.height))},this.onComponentKeyDown=t=>{const{crop:e,disabled:o,onChange:a,onComplete:i}=this.props;if(o)return;const p=t.key;let v=!1;if(!e)return;const l=this.getBox(),r=this.makePixelCrop(l),x=(navigator.platform.match("Mac")?t.metaKey:t.ctrlKey)?Y.nudgeStepLarge:t.shiftKey?Y.nudgeStepMedium:Y.nudgeStep;if(p==="ArrowLeft"?(r.x-=x,v=!0):p==="ArrowRight"?(r.x+=x,v=!0):p==="ArrowUp"?(r.y-=x,v=!0):p==="ArrowDown"&&(r.y+=x,v=!0),v){t.cancelable&&t.preventDefault(),r.x=J(r.x,0,l.width-r.width),r.y=J(r.y,0,l.height-r.height);const g=X(r,l.width,l.height),f=O(r,l.width,l.height);a(g,f),i&&i(g,f)}},this.onHandlerKeyDown=(t,e)=>{const{aspect:o=0,crop:a,disabled:i,minWidth:p=0,minHeight:v=0,maxWidth:l,maxHeight:r,onChange:x,onComplete:g}=this.props,f=this.getBox();if(i||!a)return;if(t.key==="ArrowUp"||t.key==="ArrowDown"||t.key==="ArrowLeft"||t.key==="ArrowRight")t.stopPropagation(),t.preventDefault();else return;const h=(navigator.platform.match("Mac")?t.metaKey:t.ctrlKey)?Y.nudgeStepLarge:t.shiftKey?Y.nudgeStepMedium:Y.nudgeStep,b=X(a,f.width,f.height),I=na(b,t.key,h,e),F=dt(I,o,e,f.width,f.height,p,v,l,r);if(!lt(a,F)){const A=O(F,f.width,f.height);x(F,A),g&&g(F,A)}},this.onDocPointerDone=t=>{const{crop:e,disabled:o,onComplete:a,onDragEnd:i}=this.props,p=this.getBox();this.unbindDocMove(),!(o||!e)&&this.mouseDownOnCrop&&(this.mouseDownOnCrop=!1,this.dragStarted=!1,i&&i(t),a&&a(X(e,p.width,p.height),O(e,p.width,p.height)),this.setState({cropIsActive:!1,newCropIsBeingDrawn:!1}))},this.onDragFocus=t=>{var e;(e=this.componentRef.current)==null||e.scrollTo(0,0)}}get document(){return document}getBox(){const t=this.mediaRef.current;if(!t)return{x:0,y:0,width:0,height:0};const{x:e,y:o,width:a,height:i}=t.getBoundingClientRect();return{x:e,y:o,width:a,height:i}}componentDidUpdate(t){const{crop:e,onComplete:o}=this.props;if(o&&!t.crop&&e){const{width:a,height:i}=this.getBox();a&&i&&o(X(e,a,i),O(e,a,i))}}componentWillUnmount(){this.resizeObserver&&this.resizeObserver.disconnect()}bindDocMove(){this.docMoveBound||(this.document.addEventListener("pointermove",this.onDocPointerMove,ee),this.document.addEventListener("pointerup",this.onDocPointerDone,ee),this.document.addEventListener("pointercancel",this.onDocPointerDone,ee),this.docMoveBound=!0)}unbindDocMove(){this.docMoveBound&&(this.document.removeEventListener("pointermove",this.onDocPointerMove,ee),this.document.removeEventListener("pointerup",this.onDocPointerDone,ee),this.document.removeEventListener("pointercancel",this.onDocPointerDone,ee),this.docMoveBound=!1)}getCropStyle(){const{crop:t}=this.props;if(t)return{top:`${t.y}${t.unit}`,left:`${t.x}${t.unit}`,width:`${t.width}${t.unit}`,height:`${t.height}${t.unit}`}}dragCrop(){const{evData:t}=this,e=this.getBox(),o=this.makePixelCrop(e),a=t.clientX-t.startClientX,i=t.clientY-t.startClientY;return o.x=J(t.startCropX+a,0,e.width-o.width),o.y=J(t.startCropY+i,0,e.height-o.height),o}getPointRegion(t,e,o,a){const{evData:i}=this,p=i.clientX-t.x,v=i.clientY-t.y;let l;a&&e?l=e==="nw"||e==="n"||e==="ne":l=v<i.startCropY;let r;return o&&e?r=e==="nw"||e==="w"||e==="sw":r=p<i.startCropX,r?l?"nw":"sw":l?"ne":"se"}resolveMinDimensions(t,e,o=0,a=0){let i=Math.min(o,t.width),p=Math.min(a,t.height);return!e||!i&&!p?[i,p]:e>1?i?[i,i/e]:[p*e,p]:p?[p*e,p]:[i,i/e]}resizeCrop(){const{evData:t}=this,{aspect:e=0,maxWidth:o,maxHeight:a}=this.props,i=this.getBox(),[p,v]=this.resolveMinDimensions(i,e,this.props.minWidth,this.props.minHeight);let l=this.makePixelCrop(i),r=this.getPointRegion(i,t.ord,p,v);const x=t.ord||r;let g=t.clientX-t.startClientX,f=t.clientY-t.startClientY;(p&&x==="nw"||x==="w"||x==="sw")&&(g=Math.min(g,-p)),(v&&x==="nw"||x==="n"||x==="ne")&&(f=Math.min(f,-v));const h={unit:"px",x:0,y:0,width:0,height:0};r==="ne"?(h.x=t.startCropX,h.width=g,e?(h.height=h.width/e,h.y=t.startCropY-h.height):(h.height=Math.abs(f),h.y=t.startCropY-h.height)):r==="se"?(h.x=t.startCropX,h.y=t.startCropY,h.width=g,e?h.height=h.width/e:h.height=f):r==="sw"?(h.x=t.startCropX+g,h.y=t.startCropY,h.width=Math.abs(g),e?h.height=h.width/e:h.height=f):r==="nw"&&(h.x=t.startCropX+g,h.width=Math.abs(g),e?(h.height=h.width/e,h.y=t.startCropY-h.height):(h.height=Math.abs(f),h.y=t.startCropY+f));const b=dt(h,e,r,i.width,i.height,p,v,o,a);return e||Y.xyOrds.indexOf(x)>-1?l=b:Y.xOrds.indexOf(x)>-1?(l.x=b.x,l.width=b.width):Y.yOrds.indexOf(x)>-1&&(l.y=b.y,l.height=b.height),l.x=J(l.x,0,i.width-l.width),l.y=J(l.y,0,i.height-l.height),l}createCropSelection(){const{ariaLabels:t=Y.defaultProps.ariaLabels,disabled:e,locked:o,renderSelectionAddon:a,ruleOfThirds:i,crop:p}=this.props,v=this.getCropStyle();if(p)return S.createElement("div",{style:v,className:"ReactCrop__crop-selection",onPointerDown:this.onCropPointerDown,"aria-label":t.cropArea,tabIndex:0,onKeyDown:this.onComponentKeyDown,role:"group"},!e&&!o&&S.createElement("div",{className:"ReactCrop__drag-elements",onFocus:this.onDragFocus},S.createElement("div",{className:"ReactCrop__drag-bar ord-n","data-ord":"n"}),S.createElement("div",{className:"ReactCrop__drag-bar ord-e","data-ord":"e"}),S.createElement("div",{className:"ReactCrop__drag-bar ord-s","data-ord":"s"}),S.createElement("div",{className:"ReactCrop__drag-bar ord-w","data-ord":"w"}),S.createElement("div",{className:"ReactCrop__drag-handle ord-nw","data-ord":"nw",tabIndex:0,"aria-label":t.nwDragHandle,onKeyDown:l=>this.onHandlerKeyDown(l,"nw"),role:"button"}),S.createElement("div",{className:"ReactCrop__drag-handle ord-n","data-ord":"n",tabIndex:0,"aria-label":t.nDragHandle,onKeyDown:l=>this.onHandlerKeyDown(l,"n"),role:"button"}),S.createElement("div",{className:"ReactCrop__drag-handle ord-ne","data-ord":"ne",tabIndex:0,"aria-label":t.neDragHandle,onKeyDown:l=>this.onHandlerKeyDown(l,"ne"),role:"button"}),S.createElement("div",{className:"ReactCrop__drag-handle ord-e","data-ord":"e",tabIndex:0,"aria-label":t.eDragHandle,onKeyDown:l=>this.onHandlerKeyDown(l,"e"),role:"button"}),S.createElement("div",{className:"ReactCrop__drag-handle ord-se","data-ord":"se",tabIndex:0,"aria-label":t.seDragHandle,onKeyDown:l=>this.onHandlerKeyDown(l,"se"),role:"button"}),S.createElement("div",{className:"ReactCrop__drag-handle ord-s","data-ord":"s",tabIndex:0,"aria-label":t.sDragHandle,onKeyDown:l=>this.onHandlerKeyDown(l,"s"),role:"button"}),S.createElement("div",{className:"ReactCrop__drag-handle ord-sw","data-ord":"sw",tabIndex:0,"aria-label":t.swDragHandle,onKeyDown:l=>this.onHandlerKeyDown(l,"sw"),role:"button"}),S.createElement("div",{className:"ReactCrop__drag-handle ord-w","data-ord":"w",tabIndex:0,"aria-label":t.wDragHandle,onKeyDown:l=>this.onHandlerKeyDown(l,"w"),role:"button"})),a&&S.createElement("div",{className:"ReactCrop__selection-addon",onMouseDown:l=>l.stopPropagation()},a(this.state)),i&&S.createElement(S.Fragment,null,S.createElement("div",{className:"ReactCrop__rule-of-thirds-hz"}),S.createElement("div",{className:"ReactCrop__rule-of-thirds-vt"})))}makePixelCrop(t){const e={...ge,...this.props.crop||{}};return X(e,t.width,t.height)}render(){const{aspect:t,children:e,circularCrop:o,className:a,crop:i,disabled:p,locked:v,style:l,ruleOfThirds:r}=this.props,{cropIsActive:x,newCropIsBeingDrawn:g}=this.state,f=i?this.createCropSelection():null,h=aa("ReactCrop",a,x&&"ReactCrop--active",p&&"ReactCrop--disabled",v&&"ReactCrop--locked",g&&"ReactCrop--new-crop",i&&t&&"ReactCrop--fixed-aspect",i&&o&&"ReactCrop--circular-crop",i&&r&&"ReactCrop--rule-of-thirds",!this.dragStarted&&i&&!i.width&&!i.height&&"ReactCrop--invisible-crop",o&&"ReactCrop--no-animate");return S.createElement("div",{ref:this.componentRef,className:h,style:l},S.createElement("div",{ref:this.mediaRef,className:"ReactCrop__child-wrapper",onPointerDown:this.onComponentPointerDown},e),f)}};z.xOrds=["e","w"];z.yOrds=["n","s"];z.xyOrds=["nw","ne","se","sw"];z.nudgeStep=1;z.nudgeStepMedium=10;z.nudgeStepLarge=100;z.defaultProps={ariaLabels:{cropArea:"Use the arrow keys to move the crop selection area",nwDragHandle:"Use the arrow keys to move the north west drag handle to change the crop selection area",nDragHandle:"Use the up and down arrow keys to move the north drag handle to change the crop selection area",neDragHandle:"Use the arrow keys to move the north east drag handle to change the crop selection area",eDragHandle:"Use the up and down arrow keys to move the east drag handle to change the crop selection area",seDragHandle:"Use the arrow keys to move the south east drag handle to change the crop selection area",sDragHandle:"Use the up and down arrow keys to move the south drag handle to change the crop selection area",swDragHandle:"Use the arrow keys to move the south west drag handle to change the crop selection area",wDragHandle:"Use the up and down arrow keys to move the west drag handle to change the crop selection area"}};let ia=z;const ra=Math.PI/180;async function oa(u,t,e=1,o=0){const a=document.createElement("canvas"),i=a.getContext("2d");if(!i)throw new Error("No 2d context");const p=u.naturalWidth/u.width,v=u.naturalHeight/u.height,l=window.devicePixelRatio;a.width=Math.floor(t.width*p*l),a.height=Math.floor(t.height*v*l),i.scale(l,l),i.imageSmoothingQuality="high";const r=t.x*p,x=t.y*v,g=o*ra,f=u.naturalWidth/2,h=u.naturalHeight/2;return i.save(),i.translate(-r,-x),i.translate(f,h),i.rotate(g),i.scale(e,e),i.translate(-f,-h),i.drawImage(u,0,0,u.naturalWidth,u.naturalHeight,0,0,u.naturalWidth,u.naturalHeight),i.restore(),a.toDataURL("image/jpeg")}const sa=(u,t)=>{const{imageSource:e,getDataUrl:o,onCancelImageCroppingDialog:a}=u,[i,p]=m.useState(""),[v,l]=m.useState(!1),[r,x]=m.useState({unit:"%",x:0,y:0,width:100,height:100}),[g,f]=m.useState(),h=m.useRef(null),[b,I]=m.useState(1),[F,A]=m.useState(0);m.useImperativeHandle(t,()=>({toggler:te})),m.useEffect(()=>{(async()=>{if(g!=null&&g.width&&(g!=null&&g.height)&&h.current){const _=await oa(h.current,g,b,F);_&&p(_)}})()},[g,b,F]);const te=()=>{l(j=>!j)},ae=async()=>{o(i||e),te()},de=()=>{te(),a()},xe=()=>{A(j=>j<=-270?0:j-90)};return n.jsx("div",{className:"container",children:n.jsx(ct,{className:"image-cropper-dialog !w-auto !max-h-11/12 !px-0 !py-0 overflow-y-auto",visible:v,closable:!1,children:n.jsxs("div",{className:"flex flex-col ",children:[n.jsx("div",{className:"pl-6 py-2 font-bold text-base text-primary-primaryTextColor",children:n.jsx(P,{label:"Edit Image"})}),n.jsx("div",{className:"bg-white px-6 pt-4 pb-2 flex justify-center border-2 border-l-0 border-r-0 border-b-0",children:!!e&&n.jsx(ia,{className:"w-full",crop:r,onChange:(j,_)=>{x(_)},onComplete:j=>{f(j)},ruleOfThirds:!0,aspect:void 0,children:n.jsx("img",{ref:h,alt:"image",src:e,style:{transform:`scale(${b}) rotate(${F}deg)`}})})}),n.jsx("div",{className:"flex justify-center border-2 border-l-0 border-r-0 border-t-0",children:n.jsxs("div",{className:"w-full px-6 pb-2 flex justify-between items-center",children:[n.jsx("button",{className:"cursor-pointer",onClick:xe,children:n.jsx("img",{src:zt,alt:"rotate"})}),n.jsxs("div",{className:"h-6 right-control rounded-lg flex gap-1 px-2 bg-secondary-steelBlue-1000",children:[n.jsx("button",{className:"w-3 self-center zoom-out-control cursor-pointer",onClick:()=>{I(j=>j>=1.1?Math.round((j-.1)*10)/10:1)},children:n.jsx("img",{src:Wt,alt:"zoomOut"})}),n.jsx("input",{className:"cropper-zoom-range",type:"range",value:b,min:1,max:3,step:.1,"aria-labelledby":"Zoom",onChange:j=>I(Number(j.target.value))}),n.jsx("button",{className:"w-3 self-center zoom-in-control cursor-pointer",onClick:()=>{I(j=>j<=2.9?Math.round((j+.1)*10)/10:3)},children:n.jsx("img",{src:Gt,alt:"zoomIn"})})]})]})}),n.jsxs("div",{className:"self-center py-3 flex gap-5",children:[n.jsxs("div",{className:"flex flex-col text-xs items-center justify-center",children:[n.jsx("button",{className:"w-12 h-12 cursor-pointer",onClick:de,children:n.jsx("img",{src:ht,alt:"cancel"})}),n.jsx("span",{className:"-mt-1 pr-1",children:n.jsx(P,{label:"Cancel"})})]}),n.jsxs("div",{className:"flex flex-col text-xs items-center justify-center",children:[n.jsx("button",{className:"w-12 h-12 cursor-pointer",onClick:ae,children:n.jsx("img",{src:ut,alt:"save"})}),n.jsx("span",{className:"-mt-1 pr-1",children:n.jsx(P,{label:"Save"})})]})]})]})})})},la=S.forwardRef(sa),da="/assets/Add-09ceabbe.svg",ca="/assets/Disabled_Add-ee1697a2.svg",Le="/assets/Uploaded_Doc-7cb2d2eb.svg",q={IMAGE:"image",VIDEO:"video",PDF:"pdf",AUDIO:"audio",WORD_EXCEL:"application/vnd.openxmlformats-officedocument"},V={uploadStarted:!1,uploadInProgress:!1,uploaded:!1,previewFileSignedUrl:"",url:"",thumbUrl:"",fileName:"",uploadType:""},Xe="Select Meta";let Ke={};const ha=m.forwardRef((u,t)=>{const{getUrl:e,getSavedFileSignedUrl:o,disabled:a,footerTitle:i,mode:p,uploaderIndex:v,savedFileInfoFromApi:l,clearCardUploadSectionData:r,docInfoForMediaGallery:x,docInfoListForMediaGallery:g,metaCategoryDropdownOptions:f,metaTypeDropdownOptions:h,metaSectionDropdownOptions:b,disableMetaCategory:I,disableMetaSection:F,disableMetaType:A,disableKebab:te,getSelectedMetaOptions:ae,mediaValidationRequired:de,isExistDocUploader:xe,onClickUploader:j,isDummy:_}=u,fe=m.useRef(null),we=m.useRef(null),[pt,ce]=m.useState(!1),[Ve,$]=m.useState(!1),[mt,K]=m.useState(n.jsx(n.Fragment,{})),[$e,W]=m.useState(!1),[ne,ve]=m.useState(""),[be,ye]=m.useState(null),[Ce,Se]=m.useState(V),[je,Ue]=m.useState(V),[De,Ne]=m.useState(V),[Ee,Be]=m.useState(V),[Re,Ie]=m.useState(V),[Oe,ze]=m.useState(!1),[gt,Me]=m.useState(!1),[ie,Te]=m.useState(""),[We,Ge]=m.useState(""),[Ze,Qe]=m.useState(""),[he,qe]=m.useState(Xe),[xt,Fe]=m.useState(!1),[ft,ue]=m.useState(!1),[wt,ua]=m.useState("bottom-right"),[Je,vt]=m.useState(""),[bt,pa]=m.useState($t.QUATERNARY);m.useState(!1);const[Pe,B]=m.useState(""),[yt,et]=m.useState(!1),G=m.useRef(null),Ct=[{label:"Edit Meta",command:()=>{Me(!0)}},{label:"Delete",command:()=>{Pt()}}],re=m.useCallback(()=>{K(n.jsx("div",{className:"w-full h-full flex items-center justify-center bg-primary-ptext-200 border border-primary-ptext-600 rounded-xl",children:n.jsx("div",{className:"w-6 h-6 pointer-events-none cursor-pointer",children:n.jsx("img",{className:"animate-spin",src:Ot,alt:"loader"})})})),_||W(!0),ce(!0)},[]),k=m.useCallback(c=>{K(n.jsx("div",{className:"w-full h-full bg-primary-ptext-200 flex border border-primary-ptext-600 rounded-xl items-center justify-center text-xxs",children:n.jsx("div",{className:"text-center text-semantic-crimson-600",children:n.jsx(P,{label:c})})})),W(!1),setTimeout(Ae,3e3)},[]);m.useEffect(()=>{var c;G!=null&&G.current&&Je!==""&&((c=G==null?void 0:G.current)==null||c.showFunction(),vt(""))}),m.useEffect(()=>{Pe&&et(!0)},[Pe]),m.useEffect(()=>{_&&Ae()}),m.useEffect(()=>{St()},[p,l==null?void 0:l.url]),m.useEffect(()=>{var c,d,w;(I||A||F)&&(f!=null&&f.length&&Qe(f==null?void 0:f[0].value),h!=null&&h.length&&Ge((c=h==null?void 0:h[0])==null?void 0:c.value),b&&v!==void 0&&b.length>1?Te((d=b==null?void 0:b[v])==null?void 0:d.value):Te(((w=b==null?void 0:b[0])==null?void 0:w.value)??"NA"))},[f,h,b]),m.useEffect(()=>{ie&&b&&(b==null?void 0:b.length)===1&&at()},[ie]),m.useEffect(()=>{be&&Et(be)},[be]),m.useEffect(()=>{we.current&&ne&&we.current.toggler()},[ne]),m.useEffect(()=>{const{uploaded:c,previewFileSignedUrl:d}=Ce;c&&(nt(d),W(!1),$(!0))},[Ce]),m.useEffect(()=>{const{uploaded:c,previewFileSignedUrl:d}=je;c&&(it(d),W(!1),$(!0))},[je]),m.useEffect(()=>{const{uploaded:c,previewFileSignedUrl:d}=De;c&&(rt(d),W(!1),$(!0))},[De]),m.useEffect(()=>{const{uploaded:c,previewFileSignedUrl:d}=Re;c&&(Ye(d),W(!1),$(!0))},[Re]),m.useEffect(()=>{const{uploaded:c,previewFileSignedUrl:d}=Ee;c&&(Kt(d),W(!1),$(!0))},[Ee]),m.useImperativeHandle(t,()=>({isUrlAvailable:_t,isSectionNameAvailable:kt,resetErrorStates:Yt}));const St=async()=>{if(p&&l!==void 0){const{fileType:c,contentType:d,url:w}=l;if(w){const y=await jt(w),s=c||d;ce(!0),$(!0),s.includes(q.IMAGE)?(nt(y),Se(C=>({...C,previewFileSignedUrl:y,uploaded:!0}))):s.includes(q.PDF)?(it(y),Ue(C=>({...C,previewFileSignedUrl:y,uploaded:!0}))):s.includes(q.WORD_EXCEL)?(rt(y),Ne(C=>({...C,previewFileSignedUrl:y,uploaded:!0}))):s.includes(q.VIDEO)?(Ye(y),Ie(C=>({...C,previewFileSignedUrl:y,uploaded:!0}))):s.includes(q.AUDIO)&&(Ye(y),Be(C=>({...C,previewFileSignedUrl:y,uploaded:!0}))),o&&o(y)}}},jt=async c=>{var w;const d=await Q.getSignedURL(c);try{return st(d)?(w=d.data)==null?void 0:w.SignedUrl:""}catch(y){console.log(y),B(Z(y))}return""},H=(c,d,w,y)=>{Q.getSignedURL(c).then(s=>{var C,R,U,D,M;if(st(s)){const N=T=>{const{url:E,thumbUrl:L,fileName:se,contentType:pe,signedUrl:me}=T;e&&e({url:E,thumbUrl:L,fileName:se,contentType:pe,signedUrl:me,meta:Ke})};w==="image"?(_||Se(T=>{var E;return{...T,...d,previewFileSignedUrl:(E=s.data)==null?void 0:E.SignedUrl,uploaded:!0}}),N({url:d.url,thumbUrl:d.thumbUrl,fileName:d.fileName,contentType:d.contentType,signedUrl:(C=s.data)==null?void 0:C.SignedUrl})):w==="pdf"?(_||Ue(T=>{var E;return{...T,previewFileSignedUrl:(E=s.data)==null?void 0:E.SignedUrl,uploaded:!0}}),N({url:d.url,thumbUrl:d.thumbUrl,fileName:d.fileName,contentType:d.contentType,signedUrl:(R=s.data)==null?void 0:R.SignedUrl})):w==="document"?(_||Ne(T=>{var E;return{...T,previewFileSignedUrl:(E=s.data)==null?void 0:E.SignedUrl,uploaded:!0}}),N({url:d.url,thumbUrl:d.thumbUrl,fileName:d.fileName,contentType:d.contentType,signedUrl:(U=s.data)==null?void 0:U.SignedUrl})):w==="video"?(_||Ie(T=>{var E;return{...T,previewFileSignedUrl:(E=s.data)==null?void 0:E.SignedUrl,uploaded:!0}}),N({url:d.url,thumbUrl:d.thumbUrl,fileName:d.fileName,contentType:d.contentType,signedUrl:(D=s.data)==null?void 0:D.SignedUrl})):w==="audio"&&(_||Be(T=>{var E;return{...T,previewFileSignedUrl:(E=s.data)==null?void 0:E.SignedUrl,uploaded:!0}}),N({url:d.url,thumbUrl:d.thumbUrl,fileName:d.fileName,contentType:d.contentType,signedUrl:(M=s.data)==null?void 0:M.SignedUrl}))}else k(y)}).catch(s=>{console.log(s),k(y),B(Z(s))})},Ut=()=>{if(xe)return j==null?void 0:j();fe.current&&fe.current.click()},Dt=c=>{const d=new FileReader;d.onload=()=>{var w;ve(((w=d.result)==null?void 0:w.toString())||"")},d.readAsDataURL(c)},Nt=async(c,d="sample.jpeg")=>{const w=await(await fetch(c)).blob();ye(new File([w],d,{type:w.type})),ve(null)},oe=()=>{ze(!0)},Et=c=>{ye(null),re();const d=new Date().getTime(),w=Math.random().toString(36).substring(2,8),y=`${d}_${w}`;Q.saveFile(c,y).then(s=>{var C,R,U,D,M;if(le(s)){const N={url:((C=s.data)==null?void 0:C.url)??"",thumbUrl:((R=s.data)==null?void 0:R.thumbUrl)??"",fileName:((U=s.data)==null?void 0:U.fileName)??"",contentType:((D=s.data)==null?void 0:D.contentType)??""};H((M=s.data)==null?void 0:M.url,N,"image","Image upload failed"),setInterval(()=>{var T;H((T=s.data)==null?void 0:T.url,N,"image","Image upload failed")},1800*1e3)}else k("Image upload failed")}).catch(s=>{console.log(s),k("Image upload failed"),B(Z(s))})},Rt=c=>{re();const d=new Date().getTime(),w=Math.random().toString(36).substring(2,8),y=`${d}_${w}`;Q.saveFile(c,y).then(s=>{var C,R,U,D;if(le(s)){const M={url:((C=s.data)==null?void 0:C.url)??"",fileName:((R=s.data)==null?void 0:R.fileName)??"",thumbUrl:"",contentType:((U=s.data)==null?void 0:U.contentType)??""};H((D=s.data)==null?void 0:D.url,M,"pdf","Pdf upload failed"),setInterval(()=>{var N;H((N=s.data)==null?void 0:N.url,M,"pdf","Pdf upload failed")},1800*1e3)}else k("Pdf upload failed")}).catch(s=>{console.log(s),k("Pdf upload failed"),B(Z(s))})},tt=c=>{re();const d=new Date().getTime(),w=Math.random().toString(36).substring(2,8),y=`${d}_${w}`;Q.saveFile(c,y).then(s=>{var C,R,U,D;if(le(s)){const M={url:((C=s.data)==null?void 0:C.url)??"",fileName:((R=s.data)==null?void 0:R.fileName)??"",thumbUrl:"",contentType:((U=s.data)==null?void 0:U.contentType)??""};H((D=s.data)==null?void 0:D.url,M,"document","Document upload failed"),setInterval(()=>{var N;H((N=s.data)==null?void 0:N.url,M,"document","Document upload failed")},1800*1e3)}else k("Document upload failed")}).catch(s=>{console.log(s),k("Document upload failed"),B(Z(s))})},It=c=>{re();const d=new Date().getTime(),w=Math.random().toString(36).substring(2,8),y=`${d}_${w}`;Q.saveFile(c,y).then(s=>{var C,R,U,D;if(le(s)){const M={url:((C=s.data)==null?void 0:C.url)??"",fileName:((R=s.data)==null?void 0:R.fileName)??"",thumbUrl:"",contentType:((U=s.data)==null?void 0:U.contentType)??""};H((D=s.data)==null?void 0:D.url,M,"audio","Audio upload failed"),setInterval(()=>{var N;H((N=s.data)==null?void 0:N.url,M,"audio","Audio upload failed")},1800*1e3)}else k("Audio upload failed")}).catch(s=>{console.log(s),k("Audio upload failed"),B(Z(s))})},Mt=c=>{re(),Q.saveVideo(c).then(d=>{var w,y,s,C,R,U,D,M,N,T,E;if(le(d)){let L=(y=(w=d.data)==null?void 0:w.videoUrl)!=null&&y.objectUrl?(C=(s=d.data)==null?void 0:s.videoUrl)==null?void 0:C.objectUrl:"";L=L.split("video/");const se=(R=L==null?void 0:L[1])==null?void 0:R.split("."),pe={url:((D=(U=d.data)==null?void 0:U.videoUrl)==null?void 0:D.objectUrl)??"",fileName:(L==null?void 0:L[1])??"",thumbUrl:((N=(M=d.data)==null?void 0:M.videoUrl)==null?void 0:N.objectUrl)??"",contentType:`video/${(se==null?void 0:se[1])??""}`};H((E=(T=d.data)==null?void 0:T.videoUrl)==null?void 0:E.objectUrl,pe,"video","Video upload failed"),setInterval(()=>{var me,ot;H((ot=(me=d.data)==null?void 0:me.videoUrl)==null?void 0:ot.objectUrl,pe,"video","Video upload failed")},1800*1e3)}else k("Video upload failed")}).catch(d=>{console.log(d),k("Video upload failed"),B(Z(d))})},Tt=c=>{const w=c.target.files[0];switch(w.type){case"application/pdf":Rt(w);break;case"image/jpeg":case"image/png":Dt(w);break;case"application/msword":case"application/vnd.openxmlformats-officedocument.wordprocessingml.document":case"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":tt(w);break}if(w.type.includes(q.VIDEO)){if(de){const y=URL.createObjectURL(w),s=document.createElement("video");s.src=y,s.addEventListener("loadedmetadata",C=>{var U,D;Ke={durationInSec:isNaN((U=C==null?void 0:C.target)==null?void 0:U.duration)?0:Number((D=C==null?void 0:C.target)==null?void 0:D.duration)}})}Mt(w)}else if(w.type.includes(q.AUDIO)){if(de){const y=URL.createObjectURL(w),s=document.createElement("audio");s.src=y,s.addEventListener("loadedmetadata",()=>{Ke={durationInSec:isNaN(s==null?void 0:s.duration)?0:Number(s==null?void 0:s.duration)}})}It(w)}else w.type||tt(w)},Ft=()=>{const c=b==null?void 0:b.find(y=>y.value===ie),d=h==null?void 0:h.find(y=>y.value===We),w=f==null?void 0:f[0];v!==void 0&&(ae==null||ae({section:c??{label:"",uid:"",value:""},type:d??{label:"",uid:"",value:""},category:w??{label:"",uid:"",value:""}},v))},Ae=()=>{ye(null),Se(V),Ue(V),Ne(V),Ie(V),ce(!1),$(!1),Fe(!1),ue(!1)},Pt=()=>{Ae(),K(ke),r&&i!==void 0&&r(i)},At=()=>{ve(null),$(!1),ce(!1),K(ke)},_e=c=>{c.target.name==="category"?Qe(c.value):c.target.name==="type"?Ge(c.value):c.target.name==="section"&&Te(c.value)},at=()=>{Ze!==Bt.DOCUMENT_CATEGORY_KYC&&Ft();const c=b==null?void 0:b.find(d=>d.value===ie);c?(qe(c.label),ue(!1)):qe("Invalid"),Me(!1)},_t=()=>Ce.previewFileSignedUrl||je.previewFileSignedUrl||De.previewFileSignedUrl||Re.previewFileSignedUrl||Ee.previewFileSignedUrl?!0:(Fe(!0),!1),kt=()=>he===Xe&&!i?(ue(!0),!1):!0,Yt=()=>{ue(!1),Fe(!1)},Ht=()=>{if(x&&!g)return{...x||Qt};if(g&&g.length)return{...g[v??0]}},ke=()=>n.jsxs("button",{className:`w-25 h-25 flex items-center justify-center bg-primary-ptext-200 border border-primary-ptext-600 rounded-xl cursor-pointer ${a?"pointer-events-none":""}`,onClick:Ut,children:[n.jsx("input",{title:"upload",ref:fe,className:"hidden",type:"file",accept:"application/pdf, application/msword, image/png, image/jpeg, application/vnd.openxmlformats-officedocument.wordprocessingml.document, application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, video/*, audio/*",onChange:Tt}),n.jsx("span",{className:"select-none",children:n.jsx("img",{src:a?ca:da,alt:"add-file"})})]}),Lt=()=>n.jsx("div",{className:"w-25 h-25 flex cursor-pointer select-none",children:mt}),nt=c=>{K(n.jsx("div",{className:"w-full flex justify-center",children:c?n.jsx("button",{className:"w-full border border-primary-ptext-600 rounded-xl",onClick:oe,children:n.jsx("img",{className:"w-full h-full rounded-xl object-fill",src:c,alt:"image-preview"})}):n.jsx("div",{className:"w-full bg-primary-ptext-300 text-center py-2 text-xxs text-semantic-crimson-600",children:n.jsx(P,{label:"Can't load preview"})})}))},Xt=()=>{if(ne)return n.jsx(la,{ref:we,imageSource:ne.toString(),getDataUrl:Nt,onCancelImageCroppingDialog:At})},it=c=>{K(n.jsx("div",{className:"w-full flex justify-center",children:c?n.jsx("button",{title:"upload",type:"button",className:"w-full",onClick:oe,children:n.jsx(qt,{source:c})}):n.jsx("div",{className:"w-full bg-primary-ptext-300 text-center py-2 text-xxs text-semantic-crimson-600",children:n.jsx(P,{label:"Can't load preview"})})}))},rt=c=>{K(n.jsx("div",{className:"w-full border border-primary-ptext-600 rounded-xl",children:c?n.jsx("button",{onClick:oe,children:n.jsx("img",{src:Le,alt:"document"})}):n.jsx("div",{className:"w-full bg-primary-ptext-300 text-center py-2 text-xxs text-semantic-crimson-600",children:n.jsx(P,{label:"Can't load preview"})})}))},Ye=c=>{K(n.jsx("div",{className:"w-full border border-primary-ptext-600 rounded-xl",children:c?n.jsx("button",{onClick:oe,children:n.jsx("img",{src:Le,alt:"video-thumbnail"})}):n.jsx("div",{className:"w-full bg-primary-ptext-300 text-center py-2 text-xxs text-semantic-crimson-600",children:n.jsx(P,{label:"Can't load preview"})})}))},Kt=c=>{K(n.jsx("div",{className:"w-full border border-primary-ptext-600 rounded-xl",children:c?n.jsx("button",{onClick:oe,children:n.jsx("img",{src:Le,alt:"audio-thumbnail"})}):n.jsx("div",{className:"w-full bg-primary-ptext-300 text-center py-2 text-xxs text-semantic-crimson-600",children:n.jsx(P,{label:"Can't load preview"})})}))},Vt=()=>n.jsx(ct,{className:"w-77 !px-0 !py-0",visible:gt,closable:!1,children:n.jsxs("div",{className:"p-6 flex flex-col gap-4",children:[n.jsx("div",{className:"mb-3 font-bold text-primary-primaryTextColor",children:n.jsx(P,{label:"Edit Meta"})}),n.jsx("div",{className:"w-64",children:n.jsx(He,{name:"category",label:"Category",labelClassNames:"text-xs",optionLabel:"label",optionValue:"value",options:f,onChange:_e,value:Ze,hideErrorRow:!0,disabled:I})}),n.jsx("div",{className:"w-64",children:n.jsx(He,{name:"type",label:"Type",labelClassNames:"text-xs",optionLabel:"label",optionValue:"value",options:h,onChange:_e,value:We,hideErrorRow:!0,disabled:A})}),n.jsx("div",{className:"w-64",children:n.jsx(He,{name:"section",label:"Section",labelClassNames:"text-xs",optionLabel:"label",optionValue:"value",options:b,onChange:_e,value:ie,hideErrorRow:!0,disabled:F})}),n.jsxs("div",{className:"mt-3 flex gap-6 items-center justify-center",children:[n.jsxs("div",{className:"flex flex-col text-xs items-center justify-center",children:[n.jsx("button",{className:"w-12 h-12 cursor-pointer",onClick:()=>Me(!1),children:n.jsx("img",{src:ht,alt:"cancel"})}),n.jsx(P,{label:"Cancel"})]}),n.jsxs("div",{className:"flex flex-col text-xs items-center justify-center",children:[n.jsx("button",{className:"w-12 h-12 cursor-pointer",onClick:at,children:n.jsx("img",{src:ut,alt:"save"})}),n.jsx(P,{label:"Save"})]})]})]})});return n.jsxs(S.Fragment,{children:[ne&&Xt(),n.jsxs("div",{className:"flex flex-col relative max-w-fit",children:[n.jsxs("div",{className:"flex flex-col items-center gap-1 ",children:[pt?Lt():ke(),$e&&!i&&n.jsx("div",{className:"w-full text-center text-xs text-primary-ptext-1000",children:n.jsx(P,{label:"Uploading"})})]}),i&&n.jsx("div",{className:"w-25 mt-3 text-center text-primary-ptext-1000 select-none",children:n.jsx("p",{className:"text-xs truncate",title:i,children:i})}),Ve&&!$e&&!i&&n.jsx("div",{className:"w-25 mt-3 flex flex-col items-center justify-center truncate select-none",children:n.jsx("div",{className:`text-center text-xs ${he!==Xe?he!=="Invalid"?"text-primary-ptext-1000":"text-semantic-crimson-600":"text-primary-ptext-700"} ${ft?"text-semantic-crimson-600":""}`,children:he})}),Ve?n.jsxs(m.Fragment,{children:[n.jsx("div",{className:"absolute top-2 right-2.5",children:n.jsx(ea,{model:Ct,disabled:te})}),Vt(),n.jsx("div",{className:"h-4.75"})]}):n.jsx(m.Fragment,{children:xt&&n.jsx("div",{className:"text-xs text-semantic-crimson-600",children:n.jsx(P,{label:"Please upload doc"})})}),Oe?n.jsx(Zt,{visible:Oe,onToggleVisibility:()=>ze(c=>!c),list:g&&g.length?g:[],currentSection:Ht()}):n.jsx(n.Fragment,{}),n.jsx(ta,{position:wt,ref:G,toastText:Je,variant:bt}),n.jsx(Jt,{onHide:()=>{et(!1),B("")},visible:yt,errorMessage:Pe})]})]})}),Ua=S.memo(ha);export{la as C,Ua as F,Sa as H,ia as I,ja as N,X as y};
//# sourceMappingURL=FileUploadCustom-5ab7fd25.js.map
