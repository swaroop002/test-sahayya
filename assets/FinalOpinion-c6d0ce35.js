import{r as s,aF as l,ad as M,ae as R,af as U,aH as z,ao as J,j as t,ax as K,o as C,aG as Q}from"./index-e8217573.js";import{S as Z}from"./SaveComponent-160c5b32.js";import{S as $}from"./SimpleDropDown-061a3470.js";import{I as Y}from"./InputTextArea-b90aad1d.js";import{E as ee}from"./ErrorDialog-d5eef4d7.js";import{T as ae}from"./Toast-ae99ea5b.js";import{L as se}from"./LegalService-c6087928.js";import{S as te}from"./Skeleton-7e12d019.js";const re={legalUid:"",status:"",remark:"",certificateOrOpinion:""},D={POSITIVE:"POSITIVE",NEGATIVE:"NEGATIVE"},ne=[{code:D.POSITIVE,label:"Positive"},{code:D.NEGATIVE,label:"Negative"}],me=s.forwardRef((b,y)=>{var w,j,L;const{data:c,getDetailsCallback:i,isLoadingInitial:G,isLoading:k}=b,[r,T]=s.useState({...re}),[f,g]=s.useState(l.VIEW),[m,v]=s.useState(""),[I,V]=s.useState(!1),[E,O]=s.useState(""),[W,x]=s.useState(!1),o=s.useRef(null),[,u]=s.useState(!1),e=s.useRef(new M({validators:{...R()},...U(),autoForceUpdate:{forceUpdate:()=>u(a=>!a)}}));s.useImperativeHandle(y,()=>({save:A,onCancel:N})),s.useEffect(()=>{c!=null&&c.legalUid&&T(a=>({...a,...c}))},[c]),s.useEffect(()=>{var a;o!=null&&o.current&&m!==""&&((a=o==null?void 0:o.current)==null||a.showFunction(),v(""))},[m,I]),s.useEffect(()=>{E&&x(!0)},[E]);const p=a=>{T(n=>({...n,[a.target.name]:a.target.value}))},S=a=>{var n,d;(d=e==null?void 0:e.current)==null||d.showMessageFor((n=a==null?void 0:a.target)==null?void 0:n.name)},B=()=>{var n,d;let a=!1;return a=((n=e==null?void 0:e.current)==null?void 0:n.allValid())??!1,a||(u(h=>!h),(d=e==null?void 0:e.current)==null||d.showMessages(),u(h=>!h),!1)},A=async()=>{if(console.log("save"),!B())return;const a=X();try{const n=await se.updateFinalOpinion(a);v(z.SAVED),V(!I),g(l.VIEW),i==null||i()}catch(n){O(J(n))}},H=()=>g(l.EDIT),N=()=>{g(l.VIEW),q(),i==null||i()},X=()=>({uid:r==null?void 0:r.legalUid,finalOpinionStatus:r==null?void 0:r.status,finalOpinionRemarks:r==null?void 0:r.remark,finalOpinionCertificate:r==null?void 0:r.certificateOrOpinion}),q=()=>{var a;e.current=new M({validators:{...R()},...U(),autoForceUpdate:{forceUpdate:()=>u(n=>!n)}}),(a=e==null?void 0:e.current)==null||a.hideMessages()},{status:P,remark:F,certificateOrOpinion:_}=r;return t.jsxs("div",{children:[t.jsx(Z,{title:"heading.legal.finalOpinion*",pageMode:f,disabled:k,onSave:A,onCancel:N,onEdit:H,children:G?t.jsx(te,{height:"19.375rem",width:"100%",borderRadius:"8px",animation:"wave"}):t.jsx(K,{override:{read:f===l.VIEW},children:t.jsxs("div",{className:" grid grid-cols-4 gap-3 ",children:[t.jsx("div",{className:"col-span-1",children:t.jsx($,{label:"label.legal.status*",placeholder:"placeholder.legal.status*",name:"status",value:P,onChange:p,validation:(w=e==null?void 0:e.current)==null?void 0:w.message("status",P,"mandatory"),onBlur:S,disabled:f===l.VIEW,options:ne,optionLabel:"label",optionValue:"code"})}),t.jsx("div",{className:"col-span-3"}),t.jsx("div",{className:"col-span-2 h-32",children:t.jsx(Y,{name:"remark",className:"!h-full",label:"label.legal.remarks*",placeholder:"placeholder.legal.description",variant:C.SECONDARY,onChange:p,value:F,onBlur:S,validation:(j=e==null?void 0:e.current)==null?void 0:j.message("remark",F,"mandatory")})}),t.jsx("div",{className:"col-span-2 h-32",children:t.jsx(Y,{name:"certificateOrOpinion",className:"!h-full",label:"label.legal.certificate/Opinion*",placeholder:"placeholder.legal.description",variant:C.SECONDARY,onChange:p,value:_,onBlur:S,validation:(L=e==null?void 0:e.current)==null?void 0:L.message("certificateOrOpinion",_,"mandatory")})})]})})}),t.jsx(ae,{position:"bottom-right",ref:o,toastText:m,variant:Q.PRIMARY}),t.jsx(ee,{onHide:()=>{x(!1),O("")},visible:W,errorMessage:E})]})});export{D as F,me as a,re as i};
//# sourceMappingURL=FinalOpinion-c6d0ce35.js.map
