{"version":3,"file":"InPrincipalApproval-9cea69bd.js","sources":["../../src/services/transaction/InPrincipalApprovalService.ts","../../src/views/transaction/approval/InPrincipalApproval/InPrincipalApproval.tsx"],"sourcesContent":["import BaseApiService from \"../BaseApiService\";\n\nconst DEFAULT_PATH = \"/custom/api/manage/approval/stage/inprincipal\";\n\n\nclass InPrincipalApprovalService extends BaseApiService {\n  getAll = (start = 0, limit = 10, search: string) => {\n    const url = `${DEFAULT_PATH}/${search}`;\n    return this.makeGetRequestWithAuth(url);\n  };\n\n  createReceipt = ( payload: any) => {\n    const endPoint = DEFAULT_PATH ;\n    return this.makePostRequestWithAuth(endPoint,payload);\n  };\n\n\n\n\n  getRemarks = ( start = 0, limit = 10, search: string) => {\n    const url = `${DEFAULT_PATH}/remark/${search}`;\n    return this.makeGetRequestWithAuth(url);\n  };\n  addRemarks = ( payload: any) => {\n    const endPoint = DEFAULT_PATH + `/remark`;\n    return this.makePutRequestWithAuth(endPoint,payload);\n  };\n  onApprove = ( payload: any) => {\n    const endPoint = DEFAULT_PATH + `/approve`;\n    return this.makePutRequestWithAuth(endPoint,payload);\n  };\n  onReject = ( payload: any) => {\n    const endPoint = DEFAULT_PATH + `/reject`;\n    return this.makePutRequestWithAuth(endPoint,payload);\n  };\n \n}\n\nexport default new InPrincipalApprovalService();\n","import chatIcon from \"assets/chatSvg/chatIcon.svg\";\nimport eyeIcon from \"assets/img/common/eye_icon.svg\";\nimport ButtonBox from \"components/ButtonBox/ButtonBox\";\nimport MainMessageBody from \"components/ChatComponents/MainMessageBody\";\nimport DialogBox from \"components/Dialog/Dialog\";\nimport ErrorDialog from \"components/ErrorDialog/ErrorDialog\";\nimport InputTextArea from \"components/InputTextArea/InputTextArea\";\nimport ReadOnlyTable, { IReadonlyTableRef } from \"components/ReadOnlyTable/ReadOnlyTable\";\nimport RichTextEditor from \"components/RichTextEditor/RichTextEditor\";\nimport SaveComponent from \"components/Save/SaveComponent\";\nimport SimpleDropDown from \"components/SimpleDropDown/SimpleDropDown\";\nimport SimpleOverlayPanel from \"components/SimpleOverlayPanel/SimpleOverlayPanel\";\nimport Text from \"components/Text/Text\";\nimport TextButton from \"components/TextButton/TextButton\";\nimport ToastCustom from \"components/Toast\";\nimport { withRouter } from \"hoc/withRouter\";\nimport i18n from \"i18n\";\nimport { Column } from \"primereact/column\";\nimport { DropdownChangeParams } from \"primereact/dropdown\";\nimport React, { ReactNode, useEffect, useRef, useState } from \"react\";\nimport { useParams } from \"react-router-dom\";\nimport ChatServices from \"services/ChatServices\";\nimport CreditQueryService from \"services/transaction/CreditQueryService\";\nimport InPrincipalApprovalService from \"services/transaction/InPrincipalApprovalService\";\nimport SimpleReactValidator from \"simple-react-validator\";\nimport { LINK_DDE_STAGE_AND_STATUS, LINK_LOAN_DETAIL } from \"transactionRoutes\";\nimport {\n  formatDate,\n  getEnvVariableValue,\n  getStandardValidator,\n  messageReplace,\n  parseStandardAPIErrorMessage,\n  removeHtmlTags,\n} from \"utils/CommonUtil\";\nimport {\n  APPROVAL_STATUS,\n  BUTTON_TYPE,\n  INPUT_STYLE_TYPE,\n  PAGE_MODE,\n  SESSION_STORAGE,\n  STATIC_MASTER_TYPE_TOAST_TEXT,\n  TOAST_STYLE_TYPE,\n} from \"utils/Constant\";\ninterface IFinancialApprovalProps {\n  navigate: any;\n  prop1?: string;\n}\n\ninterface ITableRowData {\n  uid: string;\n  sNo: number;\n  query: string;\n  raisedOn: string;\n  raisedBy: string;\n  respondedOn: string;\n  respondedBy: string;\n  status: string;\n  action: string;\n}\n\nconst LOAN_QUERY_STATUS: { [key: string]: string } = {\n  IN_PROGRESS: \"In Progress\",\n  CLOSED: \"Closed\",\n};\nconst InPrincipalApproval = (props: IFinancialApprovalProps) => {\n  const [notesSectionMode, setNotesSectionMode] = useState(PAGE_MODE.VIEW);\n  const [showQuery, setShowQuery] = useState(false);\n  const [showConfirmApproval, setShowConfirmApproval] = useState(false);\n  const [showRejectApplication, setShowRejectApplication] = useState(false);\n  const [showTableQueryDialog, setShowTableQueryDialog] = useState(false);\n  const [dataForViewQuery, setDataForViewQuery] = useState<any>({\n    respondedBy: \"\",\n    respondedAt: \"\",\n    queryMessage: \"\",\n    queryResponse: \"\",\n  });\n  const [rejectReason, setRejectReason] = useState(\"\"); // Assuming rejectReason is a string\n  const [rejectRemarks, setRejectRemarks] = useState(\"\"); // Assuming rejectRemarks is a string\n  const [toastMessage, setToastMessage] = useState(\"\");\n  const [toastMessageVariant, setToastMessageVariant] = useState(TOAST_STYLE_TYPE.PRIMARY);\n  const [triggerToast, setTriggerToast] = useState(false);\n  const [errorMessage, setErrorMessage] = useState(\"\");\n  const [showDialogAPIError, setShowDialogAPIError] = useState(false);\n  const [navigateBack, setNavigateBack] = useState(false);\n  //ref\n  const overlayPanelRef = useRef(null);\n  const dataTableRef = useRef<IReadonlyTableRef>(null);\n  const toastMessageRef = useRef(null);\n\n  const [position, setPosition] = useState<any>(\"bottom-right\"); //NOSONAR\n  const [remarkFromGetApi, setRemarkFromGetApi] = useState<any>(false);\n  const [notes, setNotes] = useState<any>(\"\");\n  const [approvalRemarks, setApprovalRemarks] = useState<any>(\"\");\n  const [uidForNotes, setUIDForNotes] = useState<any>(\"\");\n  const params: { loanUid?: string; stageUid?: string } = useParams();\n  const [isMessageDialogVisible, setIsMessageDialogVisible] = useState(false);\n  const [isNewMessageAvailable, setIsNewMessageAvailable] = useState(false);\n  const approvalRef = useRef<any>(null);\n\n  const [, forceUpdate] = useState<undefined | boolean>(undefined);\n  const validator = useRef(\n    new SimpleReactValidator({\n      validators: { ...getStandardValidator() },\n      ...messageReplace(),\n      autoForceUpdate: { forceUpdate: () => forceUpdate((prev) => !prev) },\n    })\n  );\n\n  useEffect(() => {\n    getInitialRemarks();\n  }, []);\n  useEffect(() => {\n    console.log(isMessageDialogVisible, \"message \");\n    const pollingTimingForConversation = getEnvVariableValue(\"VITE_MESSAGE_CONVERSATION_TIMING\");\n    const callAPI = async () => {\n      try {\n        const res = await ChatServices.checkNewMessageAvailability(params?.stageUid ?? \"\");\n        setIsNewMessageAvailable(res?.data);\n      } catch (error) {\n        console.log(error);\n      }\n    };\n    callAPI();\n    const intervalId = setInterval(callAPI, pollingTimingForConversation);\n    return () => {\n      clearInterval(intervalId);\n    };\n  }, []);\n  const getInitialRemarks = () => {\n    InPrincipalApprovalService.getRemarks(0, 100, `${params.stageUid}`)\n      .then((res: any) => {\n        console.log(res.data, \"response\");\n\n        if (res.data.uid === null) {\n          setRemarkFromGetApi(false);\n        } else {\n          setRemarkFromGetApi(true);\n          setUIDForNotes(res.data.uid);\n          setNotes(res.data.remarks);\n        }\n      })\n      .catch((err) => {\n        console.log(err);\n      });\n  };\n  useEffect(() => {\n    if (errorMessage) {\n      setShowDialogAPIError(true);\n    }\n  }, [errorMessage]);\n  useEffect(() => {\n    if (toastMessageRef?.current && toastMessage !== \"\") {\n      // @ts-ignore: will be fixed in future\n      toastMessageRef?.current?.showFunction();\n    }\n  }, [toastMessage, toastMessageVariant, triggerToast]);\n\n  /*-----------------------------Validators-------------------------------------- */\n\n  const validate = (e: React.BaseSyntheticEvent) => {\n    validator?.current?.showMessageFor(e?.target?.name);\n  };\n\n  const validateForm = () => {\n    let isValid = false;\n    isValid = validator?.current?.allValid() ?? false;\n\n    if (isValid) {\n      return isValid;\n    } else {\n      forceUpdate((prev) => !prev);\n      validator?.current?.showMessages();\n      forceUpdate((prev) => !prev);\n      return false;\n    }\n  };\n\n  const resetValidator = () => {\n    validator.current = new SimpleReactValidator({\n      validators: { ...getStandardValidator() },\n      ...messageReplace(),\n      autoForceUpdate: { forceUpdate: () => forceUpdate((prev) => !prev) },\n    });\n  };\n\n  /*--------------------------------Event Handlers------------------------- */\n\n  /*---------------------------Click-------------------------------- */\n\n  const onAddQuery = () => {\n    setShowQuery(true);\n  };\n  const onToggleMessage = (e: any) => {\n    setIsMessageDialogVisible(!isMessageDialogVisible);\n  };\n  const prepareForAddQuery = () => {\n    const { loanUid, stageUid } = params;\n    return {\n      loan: {\n        uid: loanUid,\n      },\n      stage: {\n        uid: stageUid,\n      },\n      status: APPROVAL_STATUS.IN_PROGRESS,\n      queryMessage: approvalRef.current?.editor?.getContent(),\n    };\n  };\n\n  const onSubmitQueryInPopUp = async () => {\n    if (!validateForm()) {\n      return;\n    }\n    const enrichObj = prepareForAddQuery();\n    try {\n      console.log(\"object\");\n      const res = await InPrincipalApprovalService.createReceipt(enrichObj);\n      setToastMessage(STATIC_MASTER_TYPE_TOAST_TEXT.SAVED);\n      setToastMessageVariant(TOAST_STYLE_TYPE.PRIMARY);\n      setTriggerToast(!triggerToast);\n    } catch (error) {\n      setErrorMessage(parseStandardAPIErrorMessage(error));\n    }\n    setShowQuery(false);\n    dataTableRef?.current?.search();\n  };\n\n  const onCancelQueryInPopUp = () => {\n    setShowQuery(false);\n    resetValidator();\n  };\n\n  const onCancelApprovalInPopUp = () => {\n    setShowConfirmApproval(false);\n    setApprovalRemarks(\"\");\n    resetValidator();\n  };\n  const preparePayloadForApprove = () => {\n    const enrichForApprove = {\n      uid: params.stageUid, //stage uid\n      stageName: \"IN_PRINCIPAL_APPROVAL\",\n      remarks: approvalRemarks,\n    };\n    return enrichForApprove;\n  };\n\n  const onSubmitApprovalInPopUp = async () => {\n    if (!validateForm()) {\n      return;\n    }\n\n    const enrichForApprove = preparePayloadForApprove();\n    return InPrincipalApprovalService.onApprove(enrichForApprove)\n      .then((res) => {\n        setToastMessageVariant(TOAST_STYLE_TYPE.PRIMARY);\n        setToastMessage(\"Saved Successfully\");\n        setTriggerToast(!triggerToast);\n        if (!sessionStorage.getItem(SESSION_STORAGE.IS_WEB_VIEW)) {\n          setNavigateBack(true);\n        }\n      })\n      .catch((err) => {\n        setErrorMessage(parseStandardAPIErrorMessage(err));\n        setNavigateBack(false);\n      });\n  };\n\n  const preparePayloadForReject = () => {\n    const enrichForReject = {\n      uid: params.stageUid,\n      stageName: \"IN_PRINCIPAL_APPROVAL\",\n      remarks: rejectRemarks,\n      reasonToReject: rejectReason,\n    };\n    return enrichForReject;\n  };\n\n  const onRejectApplicationInPopUp = async () => {\n    if (!validateForm()) {\n      return;\n    }\n    const enrichForApprove = preparePayloadForReject();\n    return InPrincipalApprovalService.onReject(enrichForApprove)\n      .then((res) => {\n        setToastMessageVariant(TOAST_STYLE_TYPE.PRIMARY);\n        setToastMessage(\"Saved Successfully\");\n        setTriggerToast(!triggerToast);\n        setNavigateBack(true);\n      })\n      .catch((err) => {\n        setErrorMessage(parseStandardAPIErrorMessage(err));\n        setNavigateBack(false);\n      });\n  };\n\n  const onCancelRejAppInPopUp = () => {\n    setShowRejectApplication(false);\n    setRejectReason(\"\");\n    setRejectRemarks(\"\");\n    resetValidator();\n  };\n\n  const onCancelQueryTablePopUp = () => {\n    setShowTableQueryDialog(false);\n    resetValidator();\n  };\n\n  const onRejectFinancialApproval = () => {\n    setShowRejectApplication(true);\n  };\n\n  const onApproveFinancialApproval = () => {\n    setShowConfirmApproval(true);\n  };\n\n  const prepareForSaveNotes = () => {\n    const objectForSave: any = {\n      loan: {\n        uid: params.loanUid,\n      },\n      stage: {\n        uid: params.stageUid,\n      },\n      remarks: notes,\n    };\n\n    if (remarkFromGetApi) {\n      objectForSave.uid = uidForNotes;\n    }\n    return objectForSave;\n  };\n\n  const onSaveNotes = async () => {\n    if (!validateForm()) {\n      return;\n    }\n    const enrichObj = prepareForSaveNotes();\n    if (remarkFromGetApi) {\n      return InPrincipalApprovalService.addRemarks(enrichObj)\n        .then((res) => {\n          setToastMessageVariant(TOAST_STYLE_TYPE.PRIMARY);\n          setToastMessage(\"Saved Successfully\");\n          setTriggerToast(!triggerToast);\n          setNotesSectionMode(PAGE_MODE.VIEW);\n        })\n        .catch((err) => {\n          setErrorMessage(parseStandardAPIErrorMessage(err));\n          setNavigateBack(false);\n          setNotesSectionMode(PAGE_MODE.VIEW);\n        });\n    }\n  };\n\n  const onEditNotes = () => {\n    setNotesSectionMode(PAGE_MODE.EDIT);\n  };\n\n  const onCancelNotes = () => {\n    setNotesSectionMode(PAGE_MODE.VIEW);\n    setNotes(\"\");\n    resetValidator();\n  };\n\n  /*---------------------------change,blur,focus-------------------------- */\n\n  /*---------------------------Sectional Renders----------------------- */\n  const renderTableQueryPopUp = (): ReactNode => {\n    return (\n      <DialogBox className={`w-full md:!w-1/2`} visible={showTableQueryDialog} closable={false}>\n        <div className=\"flex flex-col gap-6\">\n          <div className=\"flex flex-wrap items-center justify-between\">\n            <div className=\"flex flex-col\">\n              <Text\n                className=\"text-xl font-bold text-primary-ptext-1000\"\n                label={\"label.approval.query\"}\n              />\n\n              <div className=\"flex items-center gap-10\">\n                <div>\n                  <Text\n                    className=\"mr-3 text-xs font-bold text-primary-ptext-1000\"\n                    label={\"table.approval.query.raisedOn\"}\n                  />\n                  <Text\n                    className=\"text-xs text-primary-ptext-1000\"\n                    label={formatDate(dataForViewQuery?.respondedAt)}\n                  />\n                </div>\n\n                <div>\n                  <Text\n                    className=\"mr-3 text-xs font-bold text-primary-ptext-1000\"\n                    label={\"table.approval.query.raisedBy\"}\n                  />\n                  <Text\n                    className=\"text-xs text-primary-ptext-1000\"\n                    label={dataForViewQuery?.respondedBy}\n                  />\n                </div>\n              </div>\n            </div>\n\n            <ButtonBox\n              buttonType={BUTTON_TYPE.CANCEL_OUTLINE}\n              size={\"LOAN_DATA\"}\n              onClick={onCancelQueryTablePopUp}\n            />\n          </div>\n\n          <div className=\"flex flex-col \">\n            <Text label={\"Query*\"} className=\"text-xs text-primary-labelColor \" />\n\n            <div\n              className=\"h-40 bg-secondary-disabledBGColor border rounded-md\"\n              dangerouslySetInnerHTML={{ __html: dataForViewQuery?.queryMessage }}\n            ></div>\n\n            <div className=\"h-48 mt-3\">\n              <InputTextArea\n                name=\"notes\"\n                label={\"table.approval.query.reply*\"}\n                className=\"!h-full\"\n                labelClassNames=\"text-xs !text-primary-gray-700\"\n                value={dataForViewQuery?.queryResponse}\n                variant={INPUT_STYLE_TYPE.SECONDARY}\n                disabled\n                hideMaxCount\n              />\n            </div>\n          </div>\n        </div>\n      </DialogBox>\n    );\n  };\n  const renderConfirmApprovalPopUp = (): ReactNode => {\n    return (\n      <DialogBox className={`w-full md:!w-1/2`} visible={showConfirmApproval} closable={false}>\n        <div className=\"flex flex-col\">\n          <div className=\"flex flex-wrap items-center justify-between\">\n            <div>\n              <Text\n                className=\"text-xl font-bold text-primary-ptext-1000\"\n                label={\"label.approval.confirmApprove\"}\n              />\n            </div>\n\n            <div className=\"flex gap-3\">\n              <ButtonBox\n                className=\"\"\n                size={\"LOAN_DATA\"}\n                buttonType={BUTTON_TYPE.CANCEL_OUTLINE}\n                onClick={onCancelApprovalInPopUp}\n              />\n              <ButtonBox\n                className=\"\"\n                size={\"LOAN_DATA\"}\n                buttonType={BUTTON_TYPE.SUBMIT_OUTLINE}\n                onClickWithLoader={onSubmitApprovalInPopUp}\n              />\n            </div>\n          </div>\n\n          <div className=\"w-full h-60\">\n            <InputTextArea\n              name=\"approvalRemarks\"\n              className={`!h-full`}\n              label={`label.approval.remarks*`}\n              disabled={false}\n              value={approvalRemarks}\n              onChange={(e) => setApprovalRemarks(e.target.value)}\n              onBlur={validate}\n              validation={validator?.current?.message(\n                \"approvalRemarks\",\n                approvalRemarks,\n                \"mandatory\"\n              )}\n            />\n          </div>\n        </div>\n      </DialogBox>\n    );\n  };\n\n  const renderRejectApplicationPopUp = (): ReactNode => {\n    return (\n      <DialogBox className={`w-full md:!w-1/2`} visible={showRejectApplication} closable={false}>\n        <div className=\"flex flex-col gap-3 sm:gap-0\">\n          <div className=\"flex flex-wrap items-center justify-between gap-3 sm:gap-0\">\n            <div className=\"w-fit\">\n              <Text\n                className=\"text-xl font-bold text-primary-ptext-1000\"\n                label={\"label.approval.rejectApp\"}\n              />\n            </div>\n\n            <div className=\"flex gap-3\">\n              <ButtonBox\n                className=\"\"\n                size={\"LOAN_DATA\"}\n                buttonType={BUTTON_TYPE.CANCEL_OUTLINE}\n                onClick={onCancelRejAppInPopUp}\n              />\n              <ButtonBox\n                className=\"\"\n                size={\"LOAN_DATA\"}\n                buttonType={BUTTON_TYPE.REJECT_APPLICATION}\n                onClickWithLoader={onRejectApplicationInPopUp}\n              />\n            </div>\n          </div>\n\n          <div className=\"w-full sm:w-61\">\n            <SimpleDropDown\n              name={\"rejectReason\"}\n              options={[\n                { name: \"insufficientInformation\", value: \"Insufficient Information\" },\n                { name: \"lowCreditScore\", value: \"Low Credit Score\" },\n                { name: \"inappropriateDocumentation\", value: \"Inappropriate Documentation\" },\n                { name: \"other\", value: \"Other\" },\n              ]}\n              optionLabel={\"name\"}\n              optionValue={\"value\"}\n              onChange={handleRejectReasonChange}\n              label={\"label.approval.rejectionReason*\"}\n              placeholder={\"label.approval.select\"}\n              onBlur={validate}\n              validation={validator?.current?.message(\"rejectReason\", rejectReason, \"mandatory\")}\n              value={rejectReason}\n              disabled={false}\n            />\n          </div>\n\n          <div className=\"w-full h-60\">\n            <InputTextArea\n              name=\"rejectRemarks\"\n              className={`!h-full`}\n              label={`label.approval.remarks*`}\n              disabled={false}\n              onChange={handleRejectRemarksChange}\n              value={rejectRemarks}\n              placeholder={\"label.approval.enterMessage*\"}\n              onBlur={validate}\n              validation={validator?.current?.message(\"rejectRemarks\", rejectRemarks, \"mandatory\")}\n            />\n          </div>\n        </div>\n      </DialogBox>\n    );\n  };\n  const renderQueryPopUp = (): ReactNode => {\n    return (\n      <DialogBox className={`w-full md:!w-1/2`} visible={showQuery} closable={false}>\n        <div className=\"flex flex-col gap-3\">\n          <div className=\"flex flex-wrap items-center justify-between\">\n            <div>\n              <Text\n                className=\"text-xl font-bold text-primary-ptext-1000\"\n                label={\"label.approval.query\"}\n              />\n            </div>\n\n            <div className=\"flex gap-3\">\n              <ButtonBox\n                className=\"\"\n                size={\"LOAN_DATA\"}\n                buttonType={BUTTON_TYPE.CANCEL_OUTLINE}\n                onClick={onCancelQueryInPopUp}\n              />\n              <ButtonBox\n                className=\"\"\n                size={\"LOAN_DATA\"}\n                buttonType={BUTTON_TYPE.SUBMIT_OUTLINE}\n                onClickWithLoader={onSubmitQueryInPopUp}\n              />\n            </div>\n          </div>\n\n          <div className={`text-editor-scroll `}>\n            <RichTextEditor\n              hideErrorRow\n              ref={approvalRef}\n              validation={{ errorMessage: \"pageObj.errorMessage\" }}\n              // onChange={(e)=>alert(e.target.value)}\n              height={200}\n              disabled={false}\n            />\n          </div>\n        </div>\n      </DialogBox>\n    );\n  };\n  /*--------------------------Table Row Renders---------------------------------- */\n\n  const renderLoanDetail = () => {\n    return (\n      <div className=\"flex flex-col gap-4 p-5 \">\n        <div className=\"flex flex-row justify-between items-center\">\n          <div className=\"text-sm text-secondary-stext-900\">Status :</div>\n          <div className=\"text-sm text-secondary-stext-900  font-bold ml-2\">\n            {dataForViewDetails.status}\n          </div>\n        </div>\n        <div className=\"flex flex-row justify-between items-center\">\n          <div className=\"text-sm text-secondary-stext-900\">Assigned to :</div>\n          <div className=\"text-sm text-secondary-stext-900  font-bold ml-2\">\n            {dataForViewDetails.assignedTo}\n          </div>\n        </div>\n        <div className=\"flex flex-row justify-between items-center\">\n          <div className=\"text-sm text-secondary-stext-900\">Delegated to :</div>\n          <div className=\"text-sm text-secondary-stext-900  font-bold ml-2\">\n            {dataForViewDetails.delegateTo}\n          </div>\n        </div>\n        <div className=\"flex flex-row justify-between items-center\">\n          <div className=\"text-sm text-secondary-stext-900\">Date of Initiation :</div>\n          <div className=\"text-sm text-secondary-stext-900  font-bold ml-2\">\n            {formatDate(dataForViewDetails.initiation)}\n          </div>\n        </div>\n      </div>\n    );\n  };\n  const renderActions = (rowData: any) => {\n    return (\n      <div className=\"flex items-center \">\n        <div className=\"w-4 h-4 flex items-center\" onClick={() => viewTableQuery(rowData)}>\n          <img src={eyeIcon} alt=\"Sahayya Logo\" className=\"cursor-pointer\" />\n        </div>\n      </div>\n    );\n  };\n  const renderRespondedBy = (rowData: any) => {\n    return (\n      <div className=\"text-primary-ptext-900 font-BrownLight text-left truncate\">\n        {rowData.status !== \"IN_PROGRESS\" ? rowData?.updatedByUserName : \"-\"}\n      </div>\n    );\n  };\n  const renderRespondedOn = (rowData: any) => {\n    return (\n      <div className=\"text-primary-ptext-900 font-BrownLight text-left truncate\">\n        {rowData.status !== \"IN_PROGRESS\" ? formatDate(rowData?.updatedAtSystemDate) : \"-\"}\n      </div>\n    );\n  };\n  const renderStatus = (rowData: any) => {\n    return (\n      <div className=\"text-primary-ptext-900 font-BrownLight text-left truncate\">\n        {LOAN_QUERY_STATUS[`${rowData?.status}`] ?? \"\"}\n      </div>\n    );\n  };\n  const renderSNo = (rowData: any) => {\n    return (\n      <div className=\"text-primary-ptext-900 font-BrownLight text-left truncate\">{rowData?.id}</div>\n    );\n  };\n  const renderQuery = (rowData: any) => {\n    return (\n      <div\n        className=\"text-primary-ptext-900 font-BrownLight text-left truncate w-48\"\n        title={removeHtmlTags(rowData.queryMessage)}\n        // dangerouslySetInnerHTML={{ __html: rowData?.queryMessage }}\n      >{removeHtmlTags(rowData.queryMessage)}</div>\n    );\n  };\n  const renderRaisedBy = (rowData: any) => {\n    return (\n      <div className=\"text-primary-ptext-900 font-BrownLight text-left truncate\">\n        {rowData?.createdByUserName}\n      </div>\n    );\n  };\n  const renderRaisedOn = (rowData: any) => {\n    return (\n      <div className=\"text-primary-ptext-900 font-BrownLight text-left truncate\">\n        {formatDate(rowData?.createdAtSystemDate)}\n      </div>\n    );\n  };\n\n  //helpers\n  const [dataForViewDetails, setDataForViewDetails] = useState({\n    assignedTo: \"\",\n    delegateTo: \"\",\n    initiation: \"\",\n    status: \"\",\n  });\n\n  const onViewDetails = (e: any) => {\n    const viewDetailData: any = localStorage.getItem(\"stageDetail\");\n    setDataForViewDetails({\n      assignedTo: JSON.parse(viewDetailData)?.assignee?.name ?? \"NA\",\n      delegateTo: JSON.parse(viewDetailData)?.delegate?.name ?? \"NA\",\n      initiation: JSON.parse(viewDetailData)?.createdAtSystemDate ?? \"NA\",\n      status: JSON.parse(viewDetailData)?.status ?? \"NA\",\n    });\n    if (overlayPanelRef.current) {\n      // @ts-ignore: Will fix later\n      overlayPanelRef.current?.toggle(e);\n    }\n  };\n  const viewTableQuery = (rowData: any) => {\n    setDataForViewQuery({\n      respondedBy: rowData.createdByUserName,\n      respondedAt: rowData.createdAtSystemDate,\n      queryMessage: rowData.queryMessage,\n      queryResponse: rowData.queryResponse,\n    });\n    setShowTableQueryDialog(true);\n  };\n  //handlers\n  const handleChangeNotes = (e: any) => {\n    setNotes(e.target.value);\n  };\n  const handleRejectRemarksChange = (event: React.ChangeEvent<HTMLTextAreaElement>) => {\n    setRejectRemarks(event.target.value);\n  };\n  const handleRejectReasonChange = (e: DropdownChangeParams) => {\n    // Assuming e.value contains the selected rejectReason value\n    setRejectReason(e.value);\n  };\n\n  /*-----------------------------Main Render----------------------------*/\n  return (\n    <div className=\"flex flex-col gap-2\">\n      <div className=\"flex justify-between items-center flex-wrap\">\n        <div className=\"w-full flex gap-3 py-2 px-5 items-center justify-between sm:justify-normal sm:w-fit\">\n          <Text\n            className=\"text-primary-ptext-1000 font-bold\"\n            label={\"heading.approval.inPrincipal\"}\n          />\n          <TextButton\n            className=\"underline text-xs  !text-black  \"\n            label={\"View Details\"}\n            onClick={onViewDetails}\n          />\n          <button onClick={onToggleMessage} className=\" relative\">\n            <img src={chatIcon} alt=\"ChatIcon\" className=\"\" />{\" \"}\n            {isNewMessageAvailable ? (\n              <div className=\"absolute top-0 right-0 w-2 h-2 bg-red-500 rounded-full\"></div>\n            ) : (\n              <></>\n            )}\n          </button>\n        </div>\n\n        <div className=\"w-full my-2 px-5 flex items-center justify-end gap-5 text-xs text-primary-ptext-1000 sm:w-fit sm:justify-normal sm:my-0\">\n          <ButtonBox\n            className=\"\"\n            size={\"LOAN_DATA\"}\n            buttonType={BUTTON_TYPE.REJECT_APPLICATION}\n            onClick={onRejectFinancialApproval}\n          />\n\n          <ButtonBox\n            className=\"\"\n            size={\"LOAN_DATA\"}\n            buttonType={BUTTON_TYPE.APPROVE}\n            onClick={onApproveFinancialApproval}\n          />\n        </div>\n      </div>\n\n      <div className=\"flex flex-col gap-5 dde-layout-body-content\">\n        <div className=\"bg-white p-5 flex flex-col rounded-xl gap-2\">\n          <div className=\"flex items-center justify-between \">\n            <div>\n              <Text\n                className=\"text-xl font-bold text-primary-ptext-1000\"\n                label={\"label.approval.query\"}\n              />\n            </div>\n            <div>\n              <ButtonBox\n                buttonType={BUTTON_TYPE.ICON_TEXT_ROW}\n                customLabel={\"Add Query\"}\n                onClick={onAddQuery}\n              />\n            </div>\n          </div>\n\n          <div>\n            <ReadOnlyTable\n              ref={dataTableRef}\n              standardDataFormatPromise={CreditQueryService.getAll}\n              search={`&stage.uid=${params.stageUid}&isActive=${true}`}\n              dataKey=\"uid\"\n              // value={pageObj.tableData}\n\n              style={{ width: \"100%\" }}\n            >\n              {/* <Column\n                  className=\"text-primary-ptext-1000 text-left text-xs p-1 h-12 pl-6\"\n                  header={`${i18n.t(\"table.approval.query.sNo\")}`}\n                  body={renderSNo}\n                /> */}\n              <Column\n                className=\"text-primary-ptext-1000 text-left text-xs p-1 h-12 pl-6\"\n                header={`${i18n.t(\"table.approval.query.query\")}`}\n                body={renderQuery}\n              />\n              <Column\n                className=\"text-primary-ptext-1000 text-left text-xs p-1 h-12 pl-6\"\n                header={`${i18n.t(\"table.approval.query.raisedOn\")}`}\n                body={renderRaisedOn}\n              />\n              <Column\n                className=\"text-primary-ptext-1000 text-left text-xs p-1 h-12 pl-6\"\n                header={`${i18n.t(\"table.approval.query.raisedBy\")}`}\n                body={renderRaisedBy}\n              />\n              <Column\n                className=\"text-primary-ptext-1000 text-left text-xs p-1 h-12 pl-6\"\n                header={`${i18n.t(\"table.approval.query.respondedOn\")}`}\n                body={renderRespondedOn}\n              />\n              <Column\n                className=\"text-primary-ptext-1000 text-left text-xs p-1 h-12 pl-6\"\n                header={`${i18n.t(\"table.approval.query.respondedBy\")}`}\n                body={renderRespondedBy}\n              />\n              <Column\n                className=\"text-primary-ptext-1000 text-left text-xs p-1 h-12 pl-6\"\n                header={`${i18n.t(\"table.approval.query.status\")}`}\n                body={renderStatus}\n              />\n              <Column\n                className=\"text-primary-ptext-1000 text-left text-xs p-1 h-12 pl-6\"\n                header=\"Actions\"\n                body={renderActions}\n              />\n            </ReadOnlyTable>\n          </div>\n        </div>\n\n        <div className=\"bg-white flex flex-col gap-3 p-5 rounded-xl\">\n          <SaveComponent\n            title={\"label.approval.notes\"}\n            pageMode={notesSectionMode}\n            onSave={onSaveNotes}\n            onEdit={onEditNotes}\n            onCancel={onCancelNotes}\n          >\n            <div className=\"h-40\">\n              <InputTextArea\n                name=\"notes\"\n                className=\"!h-full\"\n                labelClassNames=\"text-xs !text-primary-gray-700\"\n                value={notes}\n                onChange={handleChangeNotes}\n                variant={INPUT_STYLE_TYPE.SECONDARY}\n                hideLabel\n                disabled={notesSectionMode === PAGE_MODE.VIEW}\n              />\n            </div>\n          </SaveComponent>\n        </div>\n\n        <ToastCustom\n          position={position}\n          ref={toastMessageRef}\n          toastText={toastMessage}\n          variant={toastMessageVariant}\n          onRemove={() => {\n            if (navigateBack) {\n              props.navigate(`${LINK_LOAN_DETAIL}${LINK_DDE_STAGE_AND_STATUS}/${params.loanUid}`);\n            }\n          }}\n        />\n        {isMessageDialogVisible ? (\n          <DialogBox\n            visible={isMessageDialogVisible}\n            closable={false}\n            model={\"false\"}\n            onHide={() => setIsMessageDialogVisible(false)}\n            className=\"rounded-lg shadow-lg !w-240 bg-blend-darken !p-0 !h-162 \"\n          >\n            <MainMessageBody params={params} handleCloseOverLay={onToggleMessage} />\n          </DialogBox>\n        ) : null}\n        <ErrorDialog\n          onHide={() => {\n            setShowDialogAPIError(false);\n            setErrorMessage(\"\");\n          }}\n          visible={showDialogAPIError}\n          errorMessage={errorMessage}\n        />\n        <SimpleOverlayPanel\n          className=\"rounded-lg shadow-lg !w-80 p-1.5 \"\n          ref={overlayPanelRef}\n          content={renderLoanDetail()}\n        />\n        {showQuery && renderQueryPopUp()}\n        {showRejectApplication && renderRejectApplicationPopUp()}\n        {showConfirmApproval && renderConfirmApprovalPopUp()}\n        {showTableQueryDialog && renderTableQueryPopUp()}\n      </div>\n    </div>\n  );\n};\n\nexport default withRouter(InPrincipalApproval);\n"],"names":["DEFAULT_PATH","InPrincipalApprovalService","BaseApiService","__publicField","start","limit","search","url","payload","endPoint","InPrincipalApprovalService$1","LOAN_QUERY_STATUS","InPrincipalApproval","props","notesSectionMode","setNotesSectionMode","useState","PAGE_MODE","showQuery","setShowQuery","showConfirmApproval","setShowConfirmApproval","showRejectApplication","setShowRejectApplication","showTableQueryDialog","setShowTableQueryDialog","dataForViewQuery","setDataForViewQuery","rejectReason","setRejectReason","rejectRemarks","setRejectRemarks","toastMessage","setToastMessage","toastMessageVariant","setToastMessageVariant","TOAST_STYLE_TYPE","triggerToast","setTriggerToast","errorMessage","setErrorMessage","showDialogAPIError","setShowDialogAPIError","navigateBack","setNavigateBack","overlayPanelRef","useRef","dataTableRef","toastMessageRef","position","setPosition","remarkFromGetApi","setRemarkFromGetApi","notes","setNotes","approvalRemarks","setApprovalRemarks","uidForNotes","setUIDForNotes","params","useParams","isMessageDialogVisible","setIsMessageDialogVisible","isNewMessageAvailable","setIsNewMessageAvailable","approvalRef","forceUpdate","validator","SimpleReactValidator","getStandardValidator","messageReplace","prev","useEffect","getInitialRemarks","pollingTimingForConversation","getEnvVariableValue","callAPI","res","ChatServices","error","intervalId","err","_a","validate","e","_b","validateForm","isValid","resetValidator","onAddQuery","onToggleMessage","prepareForAddQuery","loanUid","stageUid","APPROVAL_STATUS","onSubmitQueryInPopUp","enrichObj","STATIC_MASTER_TYPE_TOAST_TEXT","parseStandardAPIErrorMessage","onCancelQueryInPopUp","onCancelApprovalInPopUp","preparePayloadForApprove","onSubmitApprovalInPopUp","enrichForApprove","SESSION_STORAGE","preparePayloadForReject","onRejectApplicationInPopUp","onCancelRejAppInPopUp","onCancelQueryTablePopUp","onRejectFinancialApproval","onApproveFinancialApproval","prepareForSaveNotes","objectForSave","onSaveNotes","onEditNotes","onCancelNotes","renderTableQueryPopUp","jsx","DialogBox","jsxs","Text","formatDate","ButtonBox","BUTTON_TYPE","InputTextArea","INPUT_STYLE_TYPE","renderConfirmApprovalPopUp","renderRejectApplicationPopUp","SimpleDropDown","handleRejectReasonChange","handleRejectRemarksChange","renderQueryPopUp","RichTextEditor","renderLoanDetail","dataForViewDetails","renderActions","rowData","viewTableQuery","eyeIcon","renderRespondedBy","renderRespondedOn","renderStatus","renderQuery","removeHtmlTags","renderRaisedBy","renderRaisedOn","setDataForViewDetails","onViewDetails","viewDetailData","_d","_c","_e","_f","_g","handleChangeNotes","event","TextButton","chatIcon","Fragment","ReadOnlyTable","CreditQueryService","Column","i18n","SaveComponent","ToastCustom","LINK_LOAN_DETAIL","LINK_DDE_STAGE_AND_STATUS","MainMessageBody","ErrorDialog","SimpleOverlayPanel","InPrincipalApproval$1","withRouter"],"mappings":"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"}