var an=Object.defineProperty;var on=(G,a,I)=>a in G?an(G,a,{enumerable:!0,configurable:!0,writable:!0,value:I}):G[a]=I;var Lt=(G,a,I)=>(on(G,typeof a!="symbol"?a+"":a,I),I),he=(G,a,I)=>{if(!a.has(G))throw TypeError("Cannot "+I)};var y=(G,a,I)=>(he(G,a,"read from private field"),I?I.call(G):a.get(G)),tt=(G,a,I)=>{if(a.has(G))throw TypeError("Cannot add the same private member more than once");a instanceof WeakSet?a.add(G):a.set(G,I)},gt=(G,a,I,d)=>(he(G,a,"write to private field"),d?d.call(G,I):a.set(G,I),I),re=(G,a,I,d)=>({set _(_){gt(G,a,_,I)},get _(){return y(G,a,d)}}),at=(G,a,I)=>(he(G,a,"access private method"),I);import{r as reactExports,j as jsxRuntimeExports,aC as getDefaultExportFromCjs,c5 as commonjsRequire,c6 as require$$5,R as React,bW as axios}from"./index-e8217573.js";import{D as DownloadRowIcon}from"./Download_Icon-51fc7f46.js";import{D as DialogBox}from"./Dialog-adadaf64.js";import{P as PropTypes}from"./index-8739acfd.js";import{S as SkeletonCustom}from"./Skeleton-7e12d019.js";import{F as FileUploadService}from"./FileUploadService-1aaf11f7.js";function _mergeNamespaces(G,a){for(var I=0;I<a.length;I++){const d=a[I];if(typeof d!="string"&&!Array.isArray(d)){for(const _ in d)if(_!=="default"&&!(_ in G)){const M=Object.getOwnPropertyDescriptor(d,_);M&&Object.defineProperty(G,_,M.get?M:{enumerable:!0,get:()=>d[_]})}}}return Object.freeze(Object.defineProperty(G,Symbol.toStringTag,{value:"Module"}))}const RotateIcon="/assets/Rotate_Image-897e5d8b.svg",ZoomInIcon="/assets/Zoom_In-01b8581d.svg",ZoomOutIcon="/assets/Zoom_Out-45b3bfcb.svg",CloseIcon="/assets/closeIcon-b9083511.svg",DocIcon="/assets/doc_icon-8d05fffc.svg",LeftIcon="/assets/left_icon-87b3df83.svg",RightIcon="/assets/right_icon-094b2e65.svg",skipBackIcon="/assets/ap_backward_skip-4bd1503a.svg",micIcon="/assets/ap_center_mic-2e97f96f.svg",skipForwardIcon="/assets/ap_forward_skip-5cf28044.svg",loopEnabledIcon="/assets/ap_loop-46eb7712.svg",loopDisabledIcon="/assets/ap_loop_disabled-80bed2e8.svg",volumeMuteIcon="/assets/ap_mute-7aeb405a.svg",pauseIcon="/assets/ap_pause-09e81621.svg",playIcon="/assets/ap_play-8ea0af3f.svg",volumeHighIcon="/assets/ap_vol_high-84324b25.svg",volumeMidIcon="/assets/ap_vol_mid-ebdd0edd.svg",AudioPlayer=G=>{const{className:a,mediaSource:I}=G,[d,_]=reactExports.useState(I),[M,H]=reactExports.useState(!1),[Z,O]=reactExports.useState(0),[F,v]=reactExports.useState(0),[j,w]=reactExports.useState(100),[T,p]=reactExports.useState(!1),u=reactExports.useRef(null),o=reactExports.useRef(null),A=reactExports.useRef(),x=reactExports.useCallback(()=>{let D=0;u.current&&o.current&&(D=u.current.currentTime,O(D),o.current.value=""+D,F&&o.current.style.setProperty("--range-progress",`${parseInt(o.current.value)/Math.round(F)*100}%`)),A.current&&D<F&&(A.current=requestAnimationFrame(x))},[u,F,o,O]);reactExports.useEffect(()=>{u.current&&(M?u.current.play():u.current.pause(),A.current=requestAnimationFrame(x))},[M,u,x]),reactExports.useEffect(()=>{u.current&&(u.current.volume=j/100)},[j,u]),reactExports.useEffect(()=>{u.current&&(u.current.loop=T)},[T]);const C=()=>{p(D=>!D)},m=()=>{H(D=>!D)},t=()=>{if(u.current&&o.current){const D=u.current.duration;v(D),o.current.max=""+Math.round(D)}},c=()=>{u.current&&(u.current.currentTime+=3)},i=()=>{u.current&&(u.current.currentTime-=3)},n=()=>{u.current&&o.current&&(u.current.currentTime=Number(o.current.value))},h=D=>w(D.target.value),R=D=>{if(D&&!isNaN(D)){const q=Math.floor(D/60),Y=q<10?`0${q}`:`${q}`,Q=Math.floor(D%60),et=Q<10?`0${Q}`:`${Q}`;return`${Y}:${et}`}return"00:00"},s=()=>j>50?volumeHighIcon:j>0?volumeMidIcon:volumeMuteIcon;return jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:jsxRuntimeExports.jsx("div",{className:`audio-player-wrapper w-full h-full bg-secondary-steelBlue-300 rounded-lg ${a??""}`,children:jsxRuntimeExports.jsxs("div",{className:"w-full h-full flex flex-col justify-end",children:[jsxRuntimeExports.jsx("div",{className:"mt-20 mb-16 flex items-center justify-center",children:jsxRuntimeExports.jsx("img",{src:micIcon})}),jsxRuntimeExports.jsx("div",{children:jsxRuntimeExports.jsx("audio",{ref:u,src:d,onLoadedMetadata:t})}),jsxRuntimeExports.jsxs("div",{className:"w-full h-32 p-6 rounded-xl flex flex-col bg-secondary-gray-1000 justify-center",children:[jsxRuntimeExports.jsxs("div",{className:"ap-progress-bar-wrapper flex gap-6 items-center",children:[jsxRuntimeExports.jsx("span",{className:"text-white",children:R(Z)}),jsxRuntimeExports.jsx("input",{ref:o,className:"w-full",type:"range",defaultValue:0,onChange:n}),jsxRuntimeExports.jsx("span",{className:"text-white",children:R(F)})]}),jsxRuntimeExports.jsxs("div",{className:"ap-controls-wrapper flex items-center justify-center gap-6 relative",children:[jsxRuntimeExports.jsx("button",{onClick:i,children:jsxRuntimeExports.jsx("img",{src:skipBackIcon,alt:"skip-back"})}),jsxRuntimeExports.jsx("button",{className:"w-16 h-16 bg-white rounded-full flex items-center justify-center cursor-pointer",onClick:m,children:jsxRuntimeExports.jsx("img",{id:"ap-play-icon",src:M?pauseIcon:playIcon,alt:"play/pause"})}),jsxRuntimeExports.jsx("button",{onClick:c,children:jsxRuntimeExports.jsx("img",{src:skipForwardIcon,alt:"skip-forward"})}),jsxRuntimeExports.jsx("div",{className:"absolute left-0 bottom-0 top-0 flex items-center justify-center",children:jsxRuntimeExports.jsx("button",{onClick:C,children:jsxRuntimeExports.jsx("img",{src:T?loopEnabledIcon:loopDisabledIcon,alt:"loop"})})}),jsxRuntimeExports.jsxs("div",{className:"absolute right-0 bottom-0 top-0 flex items-center justify-center",children:[jsxRuntimeExports.jsx("button",{children:jsxRuntimeExports.jsx("img",{src:s(),alt:"volume"})}),jsxRuntimeExports.jsx("input",{className:"w-22",type:"range",min:0,max:100,value:j,onChange:h,style:{background:`linear-gradient(to right, #f50 ${j}%, #ccc ${j}%)`}})]})]})]})]})})})};var pdf$1={exports:{}};(function(module,exports){(function(a,I){module.exports=I()})(globalThis,()=>(()=>{var __webpack_modules__=[,(G,a)=>{var Ft;Object.defineProperty(a,"__esModule",{value:!0}),a.VerbosityLevel=a.Util=a.UnknownErrorException=a.UnexpectedResponseException=a.TextRenderingMode=a.RenderingIntentFlag=a.PromiseCapability=a.PermissionFlag=a.PasswordResponses=a.PasswordException=a.PageActionEventType=a.OPS=a.MissingPDFException=a.MAX_IMAGE_SIZE_TO_CACHE=a.LINE_FACTOR=a.LINE_DESCENT_FACTOR=a.InvalidPDFException=a.ImageKind=a.IDENTITY_MATRIX=a.FormatError=a.FeatureTest=a.FONT_IDENTITY_MATRIX=a.DocumentActionEventType=a.CMapCompressionType=a.BaseException=a.BASELINE_FACTOR=a.AnnotationType=a.AnnotationStateModelType=a.AnnotationReviewState=a.AnnotationReplyType=a.AnnotationMode=a.AnnotationMarkedState=a.AnnotationFlag=a.AnnotationFieldFlag=a.AnnotationEditorType=a.AnnotationEditorPrefix=a.AnnotationEditorParamsType=a.AnnotationBorderStyleType=a.AnnotationActionEventType=a.AbortException=void 0,a.assert=_t,a.bytesToString=U,a.createValidAbsoluteUrl=At,a.getModificationDate=vt,a.getVerbosityLevel=ct,a.info=nt,a.isArrayBuffer=pt,a.isArrayEqual=St,a.normalizeUnicode=Et,a.objectFromMap=E,a.objectSize=b,a.setVerbosityLevel=et,a.shadow=X,a.string32=l,a.stringToBytes=e,a.stringToPDFString=st,a.stringToUTF8String=rt,a.unreachable=mt,a.utf8StringToString=ft,a.warn=ut;const I=[1,0,0,1,0,0];a.IDENTITY_MATRIX=I;const d=[.001,0,0,.001,0,0];a.FONT_IDENTITY_MATRIX=d;const _=1e7;a.MAX_IMAGE_SIZE_TO_CACHE=_;const M=1.35;a.LINE_FACTOR=M;const H=.35;a.LINE_DESCENT_FACTOR=H;const Z=H/M;a.BASELINE_FACTOR=Z;const O={ANY:1,DISPLAY:2,PRINT:4,SAVE:8,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,OPLIST:256};a.RenderingIntentFlag=O;const F={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3};a.AnnotationMode=F;const v="pdfjs_internal_editor_";a.AnnotationEditorPrefix=v;const j={DISABLE:-1,NONE:0,FREETEXT:3,INK:15};a.AnnotationEditorType=j;const w={FREETEXT_SIZE:1,FREETEXT_COLOR:2,FREETEXT_OPACITY:3,INK_COLOR:11,INK_THICKNESS:12,INK_OPACITY:13};a.AnnotationEditorParamsType=w;const T={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048};a.PermissionFlag=T;const p={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_ADD_TO_PATH:4,STROKE_ADD_TO_PATH:5,FILL_STROKE_ADD_TO_PATH:6,ADD_TO_PATH:7,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4};a.TextRenderingMode=p;const u={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3};a.ImageKind=u;const o={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26};a.AnnotationType=o;const A={MARKED:"Marked",REVIEW:"Review"};a.AnnotationStateModelType=A;const x={MARKED:"Marked",UNMARKED:"Unmarked"};a.AnnotationMarkedState=x;const C={ACCEPTED:"Accepted",REJECTED:"Rejected",CANCELLED:"Cancelled",COMPLETED:"Completed",NONE:"None"};a.AnnotationReviewState=C;const m={GROUP:"Group",REPLY:"R"};a.AnnotationReplyType=m;const t={INVISIBLE:1,HIDDEN:2,PRINT:4,NOZOOM:8,NOROTATE:16,NOVIEW:32,READONLY:64,LOCKED:128,TOGGLENOVIEW:256,LOCKEDCONTENTS:512};a.AnnotationFlag=t;const c={READONLY:1,REQUIRED:2,NOEXPORT:4,MULTILINE:4096,PASSWORD:8192,NOTOGGLETOOFF:16384,RADIO:32768,PUSHBUTTON:65536,COMBO:131072,EDIT:262144,SORT:524288,FILESELECT:1048576,MULTISELECT:2097152,DONOTSPELLCHECK:4194304,DONOTSCROLL:8388608,COMB:16777216,RICHTEXT:33554432,RADIOSINUNISON:33554432,COMMITONSELCHANGE:67108864};a.AnnotationFieldFlag=c;const i={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5};a.AnnotationBorderStyleType=i;const n={E:"Mouse Enter",X:"Mouse Exit",D:"Mouse Down",U:"Mouse Up",Fo:"Focus",Bl:"Blur",PO:"PageOpen",PC:"PageClose",PV:"PageVisible",PI:"PageInvisible",K:"Keystroke",F:"Format",V:"Validate",C:"Calculate"};a.AnnotationActionEventType=n;const h={WC:"WillClose",WS:"WillSave",DS:"DidSave",WP:"WillPrint",DP:"DidPrint"};a.DocumentActionEventType=h;const R={O:"PageOpen",C:"PageClose"};a.PageActionEventType=R;const s={ERRORS:0,WARNINGS:1,INFOS:5};a.VerbosityLevel=s;const D={NONE:0,BINARY:1};a.CMapCompressionType=D;const q={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91};a.OPS=q;const Y={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};a.PasswordResponses=Y;let Q=s.WARNINGS;function et(ht){Number.isInteger(ht)&&(Q=ht)}function ct(){return Q}function nt(ht){Q>=s.INFOS&&console.log(`Info: ${ht}`)}function ut(ht){Q>=s.WARNINGS&&console.log(`Warning: ${ht}`)}function mt(ht){throw new Error(ht)}function _t(ht,k){ht||mt(k)}function xt(ht){switch(ht==null?void 0:ht.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function At(ht,k=null,N=null){if(!ht)return null;try{if(N&&typeof ht=="string"){if(N.addDefaultProtocol&&ht.startsWith("www.")){const bt=ht.match(/\./g);(bt==null?void 0:bt.length)>=2&&(ht=`http://${ht}`)}if(N.tryConvertEncoding)try{ht=rt(ht)}catch{}}const dt=k?new URL(ht,k):new URL(ht);if(xt(dt))return dt}catch{}return null}function X(ht,k,N,dt=!1){return Object.defineProperty(ht,k,{value:N,enumerable:!dt,configurable:!0,writable:!1}),N}const f=function(){function k(N,dt){this.constructor===k&&mt("Cannot initialize BaseException."),this.message=N,this.name=dt}return k.prototype=new Error,k.constructor=k,k}();a.BaseException=f;class g extends f{constructor(k,N){super(k,"PasswordException"),this.code=N}}a.PasswordException=g;class S extends f{constructor(k,N){super(k,"UnknownErrorException"),this.details=N}}a.UnknownErrorException=S;class $ extends f{constructor(k){super(k,"InvalidPDFException")}}a.InvalidPDFException=$;class W extends f{constructor(k){super(k,"MissingPDFException")}}a.MissingPDFException=W;class z extends f{constructor(k,N){super(k,"UnexpectedResponseException"),this.status=N}}a.UnexpectedResponseException=z;class L extends f{constructor(k){super(k,"FormatError")}}a.FormatError=L;class B extends f{constructor(k){super(k,"AbortException")}}a.AbortException=B;function U(ht){(typeof ht!="object"||(ht==null?void 0:ht.length)===void 0)&&mt("Invalid argument for bytesToString");const k=ht.length,N=8192;if(k<N)return String.fromCharCode.apply(null,ht);const dt=[];for(let bt=0;bt<k;bt+=N){const Pt=Math.min(bt+N,k),wt=ht.subarray(bt,Pt);dt.push(String.fromCharCode.apply(null,wt))}return dt.join("")}function e(ht){typeof ht!="string"&&mt("Invalid argument for stringToBytes");const k=ht.length,N=new Uint8Array(k);for(let dt=0;dt<k;++dt)N[dt]=ht.charCodeAt(dt)&255;return N}function l(ht){return String.fromCharCode(ht>>24&255,ht>>16&255,ht>>8&255,ht&255)}function b(ht){return Object.keys(ht).length}function E(ht){const k=Object.create(null);for(const[N,dt]of ht)k[N]=dt;return k}function P(){const ht=new Uint8Array(4);return ht[0]=1,new Uint32Array(ht.buffer,0,1)[0]===1}function V(){try{return new Function(""),!0}catch{return!1}}class it{static get isLittleEndian(){return X(this,"isLittleEndian",P())}static get isEvalSupported(){return X(this,"isEvalSupported",V())}static get isOffscreenCanvasSupported(){return X(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get platform(){return typeof navigator>"u"?X(this,"platform",{isWin:!1,isMac:!1}):X(this,"platform",{isWin:navigator.platform.includes("Win"),isMac:navigator.platform.includes("Mac")})}}a.FeatureTest=it;const J=[...Array(256).keys()].map(ht=>ht.toString(16).padStart(2,"0"));class ot{static makeHexColor(k,N,dt){return`#${J[k]}${J[N]}${J[dt]}`}static scaleMinMax(k,N){let dt;k[0]?(k[0]<0&&(dt=N[0],N[0]=N[1],N[1]=dt),N[0]*=k[0],N[1]*=k[0],k[3]<0&&(dt=N[2],N[2]=N[3],N[3]=dt),N[2]*=k[3],N[3]*=k[3]):(dt=N[0],N[0]=N[2],N[2]=dt,dt=N[1],N[1]=N[3],N[3]=dt,k[1]<0&&(dt=N[2],N[2]=N[3],N[3]=dt),N[2]*=k[1],N[3]*=k[1],k[2]<0&&(dt=N[0],N[0]=N[1],N[1]=dt),N[0]*=k[2],N[1]*=k[2]),N[0]+=k[4],N[1]+=k[4],N[2]+=k[5],N[3]+=k[5]}static transform(k,N){return[k[0]*N[0]+k[2]*N[1],k[1]*N[0]+k[3]*N[1],k[0]*N[2]+k[2]*N[3],k[1]*N[2]+k[3]*N[3],k[0]*N[4]+k[2]*N[5]+k[4],k[1]*N[4]+k[3]*N[5]+k[5]]}static applyTransform(k,N){const dt=k[0]*N[0]+k[1]*N[2]+N[4],bt=k[0]*N[1]+k[1]*N[3]+N[5];return[dt,bt]}static applyInverseTransform(k,N){const dt=N[0]*N[3]-N[1]*N[2],bt=(k[0]*N[3]-k[1]*N[2]+N[2]*N[5]-N[4]*N[3])/dt,Pt=(-k[0]*N[1]+k[1]*N[0]+N[4]*N[1]-N[5]*N[0])/dt;return[bt,Pt]}static getAxialAlignedBoundingBox(k,N){const dt=ot.applyTransform(k,N),bt=ot.applyTransform(k.slice(2,4),N),Pt=ot.applyTransform([k[0],k[3]],N),wt=ot.applyTransform([k[2],k[1]],N);return[Math.min(dt[0],bt[0],Pt[0],wt[0]),Math.min(dt[1],bt[1],Pt[1],wt[1]),Math.max(dt[0],bt[0],Pt[0],wt[0]),Math.max(dt[1],bt[1],Pt[1],wt[1])]}static inverseTransform(k){const N=k[0]*k[3]-k[1]*k[2];return[k[3]/N,-k[1]/N,-k[2]/N,k[0]/N,(k[2]*k[5]-k[4]*k[3])/N,(k[4]*k[1]-k[5]*k[0])/N]}static singularValueDecompose2dScale(k){const N=[k[0],k[2],k[1],k[3]],dt=k[0]*N[0]+k[1]*N[2],bt=k[0]*N[1]+k[1]*N[3],Pt=k[2]*N[0]+k[3]*N[2],wt=k[2]*N[1]+k[3]*N[3],kt=(dt+wt)/2,Rt=Math.sqrt((dt+wt)**2-4*(dt*wt-Pt*bt))/2,Ot=kt+Rt||1,Ct=kt-Rt||1;return[Math.sqrt(Ot),Math.sqrt(Ct)]}static normalizeRect(k){const N=k.slice(0);return k[0]>k[2]&&(N[0]=k[2],N[2]=k[0]),k[1]>k[3]&&(N[1]=k[3],N[3]=k[1]),N}static intersect(k,N){const dt=Math.max(Math.min(k[0],k[2]),Math.min(N[0],N[2])),bt=Math.min(Math.max(k[0],k[2]),Math.max(N[0],N[2]));if(dt>bt)return null;const Pt=Math.max(Math.min(k[1],k[3]),Math.min(N[1],N[3])),wt=Math.min(Math.max(k[1],k[3]),Math.max(N[1],N[3]));return Pt>wt?null:[dt,Pt,bt,wt]}static bezierBoundingBox(k,N,dt,bt,Pt,wt,kt,Rt){const Ot=[],Ct=[[],[]];let Nt,Dt,It,Mt,Ut,Gt,Wt,$t;for(let zt=0;zt<2;++zt){if(zt===0?(Dt=6*k-12*dt+6*Pt,Nt=-3*k+9*dt-9*Pt+3*kt,It=3*dt-3*k):(Dt=6*N-12*bt+6*wt,Nt=-3*N+9*bt-9*wt+3*Rt,It=3*bt-3*N),Math.abs(Nt)<1e-12){if(Math.abs(Dt)<1e-12)continue;Mt=-It/Dt,0<Mt&&Mt<1&&Ot.push(Mt);continue}Wt=Dt*Dt-4*It*Nt,$t=Math.sqrt(Wt),!(Wt<0)&&(Ut=(-Dt+$t)/(2*Nt),0<Ut&&Ut<1&&Ot.push(Ut),Gt=(-Dt-$t)/(2*Nt),0<Gt&&Gt<1&&Ot.push(Gt))}let jt=Ot.length,Bt;const qt=jt;for(;jt--;)Mt=Ot[jt],Bt=1-Mt,Ct[0][jt]=Bt*Bt*Bt*k+3*Bt*Bt*Mt*dt+3*Bt*Mt*Mt*Pt+Mt*Mt*Mt*kt,Ct[1][jt]=Bt*Bt*Bt*N+3*Bt*Bt*Mt*bt+3*Bt*Mt*Mt*wt+Mt*Mt*Mt*Rt;return Ct[0][qt]=k,Ct[1][qt]=N,Ct[0][qt+1]=kt,Ct[1][qt+1]=Rt,Ct[0].length=Ct[1].length=qt+2,[Math.min(...Ct[0]),Math.min(...Ct[1]),Math.max(...Ct[0]),Math.max(...Ct[1])]}}a.Util=ot;const lt=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,728,711,710,729,733,731,730,732,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8226,8224,8225,8230,8212,8211,402,8260,8249,8250,8722,8240,8222,8220,8221,8216,8217,8218,8482,64257,64258,321,338,352,376,381,305,322,339,353,382,0,8364];function st(ht){if(ht[0]>="ï"){let N;if(ht[0]==="þ"&&ht[1]==="ÿ"?N="utf-16be":ht[0]==="ÿ"&&ht[1]==="þ"?N="utf-16le":ht[0]==="ï"&&ht[1]==="»"&&ht[2]==="¿"&&(N="utf-8"),N)try{const dt=new TextDecoder(N,{fatal:!0}),bt=e(ht);return dt.decode(bt)}catch(dt){ut(`stringToPDFString: "${dt}".`)}}const k=[];for(let N=0,dt=ht.length;N<dt;N++){const bt=lt[ht.charCodeAt(N)];k.push(bt?String.fromCharCode(bt):ht.charAt(N))}return k.join("")}function rt(ht){return decodeURIComponent(escape(ht))}function ft(ht){return unescape(encodeURIComponent(ht))}function pt(ht){return typeof ht=="object"&&(ht==null?void 0:ht.byteLength)!==void 0}function St(ht,k){if(ht.length!==k.length)return!1;for(let N=0,dt=ht.length;N<dt;N++)if(ht[N]!==k[N])return!1;return!0}function vt(ht=new Date){return[ht.getUTCFullYear().toString(),(ht.getUTCMonth()+1).toString().padStart(2,"0"),ht.getUTCDate().toString().padStart(2,"0"),ht.getUTCHours().toString().padStart(2,"0"),ht.getUTCMinutes().toString().padStart(2,"0"),ht.getUTCSeconds().toString().padStart(2,"0")].join("")}class Tt{constructor(){tt(this,Ft,!1);this.promise=new Promise((k,N)=>{this.resolve=dt=>{gt(this,Ft,!0),k(dt)},this.reject=dt=>{gt(this,Ft,!0),N(dt)}})}get settled(){return y(this,Ft)}}Ft=new WeakMap,a.PromiseCapability=Tt;let K=null,yt=null;function Et(ht){return K||(K=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,yt=new Map([["ﬅ","ſt"]])),ht.replaceAll(K,(k,N,dt)=>N?N.normalize("NFKC"):yt.get(dt))}},(__unused_webpack_module,exports,__w_pdfjs_require__)=>{var G,I,d,_,Jt,H,ae,O,F,v,j,w,T,p,u,fe,A,x,pe,m,t;Object.defineProperty(exports,"__esModule",{value:!0}),exports.build=exports.RenderTask=exports.PDFWorkerUtil=exports.PDFWorker=exports.PDFPageProxy=exports.PDFDocumentProxy=exports.PDFDocumentLoadingTask=exports.PDFDataRangeTransport=exports.LoopbackPort=exports.DefaultStandardFontDataFactory=exports.DefaultFilterFactory=exports.DefaultCanvasFactory=exports.DefaultCMapReaderFactory=void 0,exports.getDocument=getDocument,exports.version=void 0;var _util=__w_pdfjs_require__(1),_annotation_storage=__w_pdfjs_require__(3),_display_utils=__w_pdfjs_require__(6),_font_loader=__w_pdfjs_require__(9),_canvas=__w_pdfjs_require__(11),_worker_options=__w_pdfjs_require__(14),_is_node=__w_pdfjs_require__(10),_message_handler=__w_pdfjs_require__(15),_metadata=__w_pdfjs_require__(16),_optional_content_config=__w_pdfjs_require__(17),_transport_stream=__w_pdfjs_require__(18),_xfa_text=__w_pdfjs_require__(19);const DEFAULT_RANGE_CHUNK_SIZE=65536,RENDERING_CANCELLED_TIMEOUT=100,DELAYED_CLEANUP_TIMEOUT=5e3;let DefaultCanvasFactory=_display_utils.DOMCanvasFactory;exports.DefaultCanvasFactory=DefaultCanvasFactory;let DefaultCMapReaderFactory=_display_utils.DOMCMapReaderFactory;exports.DefaultCMapReaderFactory=DefaultCMapReaderFactory;let DefaultFilterFactory=_display_utils.DOMFilterFactory;exports.DefaultFilterFactory=DefaultFilterFactory;let DefaultStandardFontDataFactory=_display_utils.DOMStandardFontDataFactory;if(exports.DefaultStandardFontDataFactory=DefaultStandardFontDataFactory,_is_node.isNodeJS){const{NodeCanvasFactory:i,NodeCMapReaderFactory:n,NodeFilterFactory:h,NodeStandardFontDataFactory:R}=__w_pdfjs_require__(20);exports.DefaultCanvasFactory=DefaultCanvasFactory=i,exports.DefaultCMapReaderFactory=DefaultCMapReaderFactory=n,exports.DefaultFilterFactory=DefaultFilterFactory=h,exports.DefaultStandardFontDataFactory=DefaultStandardFontDataFactory=R}let createPDFNetworkStream;if(_is_node.isNodeJS){const{PDFNodeStream:i}=__w_pdfjs_require__(21);createPDFNetworkStream=n=>new i(n)}else{const{PDFNetworkStream:i}=__w_pdfjs_require__(24),{PDFFetchStream:n}=__w_pdfjs_require__(25);createPDFNetworkStream=h=>(0,_display_utils.isValidFetchUrl)(h.url)?new n(h):new i(h)}function getDocument(i){if(typeof i=="string"||i instanceof URL?i={url:i}:(0,_util.isArrayBuffer)(i)&&(i={data:i}),typeof i!="object")throw new Error("Invalid parameter in getDocument, need parameter object.");if(!i.url&&!i.data&&!i.range)throw new Error("Invalid parameter object: need either .data, .range or .url");const n=new PDFDocumentLoadingTask,{docId:h}=n,R=i.url?getUrlProp(i.url):null,s=i.data?getDataProp(i.data):null,D=i.httpHeaders||null,q=i.withCredentials===!0,Y=i.password??null,Q=i.range instanceof PDFDataRangeTransport?i.range:null,et=Number.isInteger(i.rangeChunkSize)&&i.rangeChunkSize>0?i.rangeChunkSize:DEFAULT_RANGE_CHUNK_SIZE;let ct=i.worker instanceof PDFWorker?i.worker:null;const nt=i.verbosity,ut=typeof i.docBaseUrl=="string"&&!(0,_display_utils.isDataScheme)(i.docBaseUrl)?i.docBaseUrl:null,mt=typeof i.cMapUrl=="string"?i.cMapUrl:null,_t=i.cMapPacked!==!1,xt=i.CMapReaderFactory||DefaultCMapReaderFactory,At=typeof i.standardFontDataUrl=="string"?i.standardFontDataUrl:null,X=i.StandardFontDataFactory||DefaultStandardFontDataFactory,f=i.stopAtErrors!==!0,g=Number.isInteger(i.maxImageSize)&&i.maxImageSize>-1?i.maxImageSize:-1,S=i.isEvalSupported!==!1,$=typeof i.isOffscreenCanvasSupported=="boolean"?i.isOffscreenCanvasSupported:!_is_node.isNodeJS,W=Number.isInteger(i.canvasMaxAreaInBytes)?i.canvasMaxAreaInBytes:-1,z=typeof i.disableFontFace=="boolean"?i.disableFontFace:_is_node.isNodeJS,L=i.fontExtraProperties===!0,B=i.enableXfa===!0,U=i.ownerDocument||globalThis.document,e=i.disableRange===!0,l=i.disableStream===!0,b=i.disableAutoFetch===!0,E=i.pdfBug===!0,P=Q?Q.length:i.length??NaN,V=typeof i.useSystemFonts=="boolean"?i.useSystemFonts:!_is_node.isNodeJS&&!z,it=typeof i.useWorkerFetch=="boolean"?i.useWorkerFetch:xt===_display_utils.DOMCMapReaderFactory&&X===_display_utils.DOMStandardFontDataFactory&&(0,_display_utils.isValidFetchUrl)(mt,document.baseURI)&&(0,_display_utils.isValidFetchUrl)(At,document.baseURI),J=i.canvasFactory||new DefaultCanvasFactory({ownerDocument:U}),ot=i.filterFactory||new DefaultFilterFactory({docId:h,ownerDocument:U}),lt=null;(0,_util.setVerbosityLevel)(nt);const st={canvasFactory:J,filterFactory:ot};if(it||(st.cMapReaderFactory=new xt({baseUrl:mt,isCompressed:_t}),st.standardFontDataFactory=new X({baseUrl:At})),!ct){const pt={verbosity:nt,port:_worker_options.GlobalWorkerOptions.workerPort};ct=pt.port?PDFWorker.fromPort(pt):new PDFWorker(pt),n._worker=ct}const rt={docId:h,apiVersion:"3.6.172",data:s,password:Y,disableAutoFetch:b,rangeChunkSize:et,length:P,docBaseUrl:ut,enableXfa:B,evaluatorOptions:{maxImageSize:g,disableFontFace:z,ignoreErrors:f,isEvalSupported:S,isOffscreenCanvasSupported:$,canvasMaxAreaInBytes:W,fontExtraProperties:L,useSystemFonts:V,cMapUrl:it?mt:null,standardFontDataUrl:it?At:null}},ft={ignoreErrors:f,isEvalSupported:S,disableFontFace:z,fontExtraProperties:L,enableXfa:B,ownerDocument:U,disableAutoFetch:b,pdfBug:E,styleElement:lt};return ct.promise.then(function(){if(n.destroyed)throw new Error("Loading aborted");const pt=_fetchDocument(ct,rt),St=new Promise(function(vt){let Tt;Q?Tt=new _transport_stream.PDFDataTransportStream({length:P,initialData:Q.initialData,progressiveDone:Q.progressiveDone,contentDispositionFilename:Q.contentDispositionFilename,disableRange:e,disableStream:l},Q):s||(Tt=createPDFNetworkStream({url:R,length:P,httpHeaders:D,withCredentials:q,rangeChunkSize:et,disableRange:e,disableStream:l})),vt(Tt)});return Promise.all([pt,St]).then(function([vt,Tt]){if(n.destroyed)throw new Error("Loading aborted");const K=new _message_handler.MessageHandler(h,vt,ct.port),yt=new WorkerTransport(K,n,Tt,ft,st);n._transport=yt,K.send("Ready",null)})}).catch(n._capability.reject),n}async function _fetchDocument(i,n){if(i.destroyed)throw new Error("Worker was destroyed");const h=await i.messageHandler.sendWithPromise("GetDocRequest",n,n.data?[n.data.buffer]:null);if(i.destroyed)throw new Error("Worker was destroyed");return h}function getUrlProp(i){if(i instanceof URL)return i.href;try{return new URL(i,window.location).href}catch{if(_is_node.isNodeJS&&typeof i=="string")return i}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function getDataProp(i){if(_is_node.isNodeJS&&typeof Buffer<"u"&&i instanceof Buffer)return(0,_display_utils.deprecated)("Please provide binary data as `Uint8Array`, rather than `Buffer`."),new Uint8Array(i);if(i instanceof Uint8Array&&i.byteLength===i.buffer.byteLength)return i;if(typeof i=="string")return(0,_util.stringToBytes)(i);if(typeof i=="object"&&!isNaN(i==null?void 0:i.length)||(0,_util.isArrayBuffer)(i))return new Uint8Array(i);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}const a=class{constructor(){this._capability=new _util.PromiseCapability,this._transport=null,this._worker=null,this.docId=`d${re(a,G)._++}`,this.destroyed=!1,this.onPassword=null,this.onProgress=null}get promise(){return this._capability.promise}async destroy(){var n;this.destroyed=!0,await((n=this._transport)==null?void 0:n.destroy()),this._transport=null,this._worker&&(this._worker.destroy(),this._worker=null)}};let PDFDocumentLoadingTask=a;G=new WeakMap,tt(PDFDocumentLoadingTask,G,0),exports.PDFDocumentLoadingTask=PDFDocumentLoadingTask;class PDFDataRangeTransport{constructor(n,h,R=!1,s=null){this.length=n,this.initialData=h,this.progressiveDone=R,this.contentDispositionFilename=s,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._progressiveDoneListeners=[],this._readyCapability=new _util.PromiseCapability}addRangeListener(n){this._rangeListeners.push(n)}addProgressListener(n){this._progressListeners.push(n)}addProgressiveReadListener(n){this._progressiveReadListeners.push(n)}addProgressiveDoneListener(n){this._progressiveDoneListeners.push(n)}onDataRange(n,h){for(const R of this._rangeListeners)R(n,h)}onDataProgress(n,h){this._readyCapability.promise.then(()=>{for(const R of this._progressListeners)R(n,h)})}onDataProgressiveRead(n){this._readyCapability.promise.then(()=>{for(const h of this._progressiveReadListeners)h(n)})}onDataProgressiveDone(){this._readyCapability.promise.then(()=>{for(const n of this._progressiveDoneListeners)n()})}transportReady(){this._readyCapability.resolve()}requestDataRange(n,h){(0,_util.unreachable)("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}exports.PDFDataRangeTransport=PDFDataRangeTransport;class PDFDocumentProxy{constructor(n,h){this._pdfInfo=n,this._transport=h}get annotationStorage(){return this._transport.annotationStorage}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return(0,_util.shadow)(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(n){return this._transport.getPage(n)}getPageIndex(n){return this._transport.getPageIndex(n)}getDestinations(){return this._transport.getDestinations()}getDestination(n){return this._transport.getDestination(n)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJavaScript(){return this._transport.getJavaScript()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig(){return this._transport.getOptionalContentConfig()}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(n=!1){return this._transport.startCleanup(n||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}exports.PDFDocumentProxy=PDFDocumentProxy;class PDFPageProxy{constructor(n,h,R,s=!1){tt(this,_);tt(this,H);tt(this,I,null);tt(this,d,!1);this._pageIndex=n,this._pageInfo=h,this._transport=R,this._stats=s?new _display_utils.StatTimer:null,this._pdfBug=s,this.commonObjs=R.commonObjs,this.objs=new PDFObjects,this._maybeCleanupAfterRender=!1,this._intentStates=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:n,rotation:h=this.rotate,offsetX:R=0,offsetY:s=0,dontFlip:D=!1}={}){return new _display_utils.PageViewport({viewBox:this.view,scale:n,rotation:h,offsetX:R,offsetY:s,dontFlip:D})}getAnnotations({intent:n="display"}={}){const h=this._transport.getRenderingIntent(n);return this._transport.getAnnotations(this._pageIndex,h.renderingIntent)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get isPureXfa(){return(0,_util.shadow)(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){var n;return((n=this._transport._htmlForXfa)==null?void 0:n.children[this._pageIndex])||null}render({canvasContext:n,viewport:h,intent:R="display",annotationMode:s=_util.AnnotationMode.ENABLE,transform:D=null,background:q=null,optionalContentConfigPromise:Y=null,annotationCanvasMap:Q=null,pageColors:et=null,printAnnotationStorage:ct=null}){var X,f,g;if((X=arguments[0])!=null&&X.canvasFactory)throw new Error("render no longer accepts the `canvasFactory`-option, please pass it to the `getDocument`-function instead.");(f=this._stats)==null||f.time("Overall");const nt=this._transport.getRenderingIntent(R,s,ct);gt(this,d,!1),at(this,H,ae).call(this),Y||(Y=this._transport.getOptionalContentConfig());let ut=this._intentStates.get(nt.cacheKey);ut||(ut=Object.create(null),this._intentStates.set(nt.cacheKey,ut)),ut.streamReaderCancelTimeout&&(clearTimeout(ut.streamReaderCancelTimeout),ut.streamReaderCancelTimeout=null);const mt=!!(nt.renderingIntent&_util.RenderingIntentFlag.PRINT);ut.displayReadyCapability||(ut.displayReadyCapability=new _util.PromiseCapability,ut.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(g=this._stats)==null||g.time("Page Request"),this._pumpOperatorList(nt));const _t=S=>{var $,W;ut.renderTasks.delete(xt),(this._maybeCleanupAfterRender||mt)&&gt(this,d,!0),at(this,_,Jt).call(this,!mt),S?(xt.capability.reject(S),this._abortOperatorList({intentState:ut,reason:S instanceof Error?S:new Error(S)})):xt.capability.resolve(),($=this._stats)==null||$.timeEnd("Rendering"),(W=this._stats)==null||W.timeEnd("Overall")},xt=new InternalRenderTask({callback:_t,params:{canvasContext:n,viewport:h,transform:D,background:q},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:Q,operatorList:ut.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!mt,pdfBug:this._pdfBug,pageColors:et});(ut.renderTasks||(ut.renderTasks=new Set)).add(xt);const At=xt.task;return Promise.all([ut.displayReadyCapability.promise,Y]).then(([S,$])=>{var W;if(y(this,d)){_t();return}(W=this._stats)==null||W.time("Rendering"),xt.initializeGraphics({transparency:S,optionalContentConfig:$}),xt.operatorListChanged()}).catch(_t),At}getOperatorList({intent:n="display",annotationMode:h=_util.AnnotationMode.ENABLE,printAnnotationStorage:R=null}={}){var Q;function s(){q.operatorList.lastChunk&&(q.opListReadCapability.resolve(q.operatorList),q.renderTasks.delete(Y))}const D=this._transport.getRenderingIntent(n,h,R,!0);let q=this._intentStates.get(D.cacheKey);q||(q=Object.create(null),this._intentStates.set(D.cacheKey,q));let Y;return q.opListReadCapability||(Y=Object.create(null),Y.operatorListChanged=s,q.opListReadCapability=new _util.PromiseCapability,(q.renderTasks||(q.renderTasks=new Set)).add(Y),q.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(Q=this._stats)==null||Q.time("Page Request"),this._pumpOperatorList(D)),q.opListReadCapability.promise}streamTextContent({includeMarkedContent:n=!1,disableNormalization:h=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:n===!0,disableNormalization:h===!0},{highWaterMark:100,size(s){return s.items.length}})}getTextContent(n={}){if(this._transport._htmlForXfa)return this.getXfa().then(R=>_xfa_text.XfaText.textContent(R));const h=this.streamTextContent(n);return new Promise(function(R,s){function D(){q.read().then(function({value:Q,done:et}){if(et){R(Y);return}Object.assign(Y.styles,Q.styles),Y.items.push(...Q.items),D()},s)}const q=h.getReader(),Y={items:[],styles:Object.create(null)};D()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const n=[];for(const h of this._intentStates.values())if(this._abortOperatorList({intentState:h,reason:new Error("Page was destroyed."),force:!0}),!h.opListReadCapability)for(const R of h.renderTasks)n.push(R.completed),R.cancel();return this.objs.clear(),gt(this,d,!1),at(this,H,ae).call(this),Promise.all(n)}cleanup(n=!1){gt(this,d,!0);const h=at(this,_,Jt).call(this,!1);return n&&h&&this._stats&&(this._stats=new _display_utils.StatTimer),h}_startRenderPage(n,h){var s,D;const R=this._intentStates.get(h);R&&((s=this._stats)==null||s.timeEnd("Page Request"),(D=R.displayReadyCapability)==null||D.resolve(n))}_renderPageChunk(n,h){for(let R=0,s=n.length;R<s;R++)h.operatorList.fnArray.push(n.fnArray[R]),h.operatorList.argsArray.push(n.argsArray[R]);h.operatorList.lastChunk=n.lastChunk,h.operatorList.separateAnnots=n.separateAnnots;for(const R of h.renderTasks)R.operatorListChanged();n.lastChunk&&at(this,_,Jt).call(this,!0)}_pumpOperatorList({renderingIntent:n,cacheKey:h,annotationStorageMap:R}){const D=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:n,cacheKey:h,annotationStorage:R}).getReader(),q=this._intentStates.get(h);q.streamReader=D;const Y=()=>{D.read().then(({value:Q,done:et})=>{if(et){q.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(Q,q),Y())},Q=>{if(q.streamReader=null,!this._transport.destroyed){if(q.operatorList){q.operatorList.lastChunk=!0;for(const et of q.renderTasks)et.operatorListChanged();at(this,_,Jt).call(this,!0)}if(q.displayReadyCapability)q.displayReadyCapability.reject(Q);else if(q.opListReadCapability)q.opListReadCapability.reject(Q);else throw Q}})};Y()}_abortOperatorList({intentState:n,reason:h,force:R=!1}){if(n.streamReader){if(n.streamReaderCancelTimeout&&(clearTimeout(n.streamReaderCancelTimeout),n.streamReaderCancelTimeout=null),!R){if(n.renderTasks.size>0)return;if(h instanceof _display_utils.RenderingCancelledException){let s=RENDERING_CANCELLED_TIMEOUT;h.extraDelay>0&&h.extraDelay<1e3&&(s+=h.extraDelay),n.streamReaderCancelTimeout=setTimeout(()=>{n.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:n,reason:h,force:!0})},s);return}}if(n.streamReader.cancel(new _util.AbortException(h.message)).catch(()=>{}),n.streamReader=null,!this._transport.destroyed){for(const[s,D]of this._intentStates)if(D===n){this._intentStates.delete(s);break}this.cleanup()}}}get stats(){return this._stats}}I=new WeakMap,d=new WeakMap,_=new WeakSet,Jt=function(n=!1){if(at(this,H,ae).call(this),!y(this,d))return!1;if(n)return gt(this,I,setTimeout(()=>{gt(this,I,null),at(this,_,Jt).call(this,!1)},DELAYED_CLEANUP_TIMEOUT)),!1;for(const{renderTasks:h,operatorList:R}of this._intentStates.values())if(h.size>0||!R.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),gt(this,d,!1),!0},H=new WeakSet,ae=function(){y(this,I)&&(clearTimeout(y(this,I)),gt(this,I,null))},exports.PDFPageProxy=PDFPageProxy;class LoopbackPort{constructor(){tt(this,O,new Set);tt(this,F,Promise.resolve())}postMessage(n,h){const R={data:structuredClone(n,h?{transfer:h}:null)};y(this,F).then(()=>{for(const s of y(this,O))s.call(this,R)})}addEventListener(n,h){y(this,O).add(h)}removeEventListener(n,h){y(this,O).delete(h)}terminate(){y(this,O).clear()}}O=new WeakMap,F=new WeakMap,exports.LoopbackPort=LoopbackPort;const PDFWorkerUtil={isWorkerDisabled:!1,fallbackWorkerSrc:null,fakeWorkerId:0};exports.PDFWorkerUtil=PDFWorkerUtil;{if(_is_node.isNodeJS&&typeof commonjsRequire=="function")PDFWorkerUtil.isWorkerDisabled=!0,PDFWorkerUtil.fallbackWorkerSrc="./pdf.worker.js";else if(typeof document=="object"){const i=(v=document==null?void 0:document.currentScript)==null?void 0:v.src;i&&(PDFWorkerUtil.fallbackWorkerSrc=i.replace(/(\.(?:min\.)?js)(\?.*)?$/i,".worker$1$2"))}PDFWorkerUtil.isSameOrigin=function(i,n){let h;try{if(h=new URL(i),!h.origin||h.origin==="null")return!1}catch{return!1}const R=new URL(n,h);return h.origin===R.origin},PDFWorkerUtil.createCDNWrapper=function(i){const n=`importScripts("${i}");`;return URL.createObjectURL(new Blob([n]))}}const _PDFWorker=class{constructor({name:i=null,port:n=null,verbosity:h=(0,_util.getVerbosityLevel)()}={}){if(n&&y(_PDFWorker,j).has(n))throw new Error("Cannot use more than one PDFWorker per port.");if(this.name=i,this.destroyed=!1,this.verbosity=h,this._readyCapability=new _util.PromiseCapability,this._port=null,this._webWorker=null,this._messageHandler=null,n){y(_PDFWorker,j).set(n,this),this._initializeFromPort(n);return}this._initialize()}get promise(){return this._readyCapability.promise}get port(){return this._port}get messageHandler(){return this._messageHandler}_initializeFromPort(i){this._port=i,this._messageHandler=new _message_handler.MessageHandler("main","worker",i),this._messageHandler.on("ready",function(){}),this._readyCapability.resolve(),this._messageHandler.send("configure",{verbosity:this.verbosity})}_initialize(){if(!PDFWorkerUtil.isWorkerDisabled&&!_PDFWorker._mainThreadWorkerMessageHandler){let{workerSrc:i}=_PDFWorker;try{PDFWorkerUtil.isSameOrigin(window.location.href,i)||(i=PDFWorkerUtil.createCDNWrapper(new URL(i,window.location).href));const n=new Worker(i),h=new _message_handler.MessageHandler("main","worker",n),R=()=>{n.removeEventListener("error",s),h.destroy(),n.terminate(),this.destroyed?this._readyCapability.reject(new Error("Worker was destroyed")):this._setupFakeWorker()},s=()=>{this._webWorker||R()};n.addEventListener("error",s),h.on("test",q=>{if(n.removeEventListener("error",s),this.destroyed){R();return}q?(this._messageHandler=h,this._port=n,this._webWorker=n,this._readyCapability.resolve(),h.send("configure",{verbosity:this.verbosity})):(this._setupFakeWorker(),h.destroy(),n.terminate())}),h.on("ready",q=>{if(n.removeEventListener("error",s),this.destroyed){R();return}try{D()}catch{this._setupFakeWorker()}});const D=()=>{const q=new Uint8Array;h.send("test",q,[q.buffer])};D();return}catch{(0,_util.info)("The worker has been disabled.")}}this._setupFakeWorker()}_setupFakeWorker(){PDFWorkerUtil.isWorkerDisabled||((0,_util.warn)("Setting up fake worker."),PDFWorkerUtil.isWorkerDisabled=!0),_PDFWorker._setupFakeWorkerGlobal.then(i=>{if(this.destroyed){this._readyCapability.reject(new Error("Worker was destroyed"));return}const n=new LoopbackPort;this._port=n;const h=`fake${PDFWorkerUtil.fakeWorkerId++}`,R=new _message_handler.MessageHandler(h+"_worker",h,n);i.setup(R,n);const s=new _message_handler.MessageHandler(h,h+"_worker",n);this._messageHandler=s,this._readyCapability.resolve(),s.send("configure",{verbosity:this.verbosity})}).catch(i=>{this._readyCapability.reject(new Error(`Setting up fake worker failed: "${i.message}".`))})}destroy(){this.destroyed=!0,this._webWorker&&(this._webWorker.terminate(),this._webWorker=null),y(_PDFWorker,j).delete(this._port),this._port=null,this._messageHandler&&(this._messageHandler.destroy(),this._messageHandler=null)}static fromPort(i){if(!(i!=null&&i.port))throw new Error("PDFWorker.fromPort - invalid method signature.");return y(this,j).has(i.port)?y(this,j).get(i.port):new _PDFWorker(i)}static get workerSrc(){if(_worker_options.GlobalWorkerOptions.workerSrc)return _worker_options.GlobalWorkerOptions.workerSrc;if(PDFWorkerUtil.fallbackWorkerSrc!==null)return _is_node.isNodeJS||(0,_display_utils.deprecated)('No "GlobalWorkerOptions.workerSrc" specified.'),PDFWorkerUtil.fallbackWorkerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _mainThreadWorkerMessageHandler(){var i;try{return((i=globalThis.pdfjsWorker)==null?void 0:i.WorkerMessageHandler)||null}catch{return null}}static get _setupFakeWorkerGlobal(){const loader=async()=>{const mainWorkerMessageHandler=this._mainThreadWorkerMessageHandler;if(mainWorkerMessageHandler)return mainWorkerMessageHandler;if(_is_node.isNodeJS&&typeof commonjsRequire=="function"){const worker=eval("require")(this.workerSrc);return worker.WorkerMessageHandler}return await(0,_display_utils.loadScript)(this.workerSrc),window.pdfjsWorker.WorkerMessageHandler};return(0,_util.shadow)(this,"_setupFakeWorkerGlobal",loader())}};let PDFWorker=_PDFWorker;j=new WeakMap,tt(PDFWorker,j,new WeakMap),exports.PDFWorker=PDFWorker;class WorkerTransport{constructor(n,h,R,s,D){tt(this,u);tt(this,w,new Map);tt(this,T,new Map);tt(this,p,new Map);this.messageHandler=n,this.loadingTask=h,this.commonObjs=new PDFObjects,this.fontLoader=new _font_loader.FontLoader({ownerDocument:s.ownerDocument,styleElement:s.styleElement}),this._params=s,this.canvasFactory=D.canvasFactory,this.filterFactory=D.filterFactory,this.cMapReaderFactory=D.cMapReaderFactory,this.standardFontDataFactory=D.standardFontDataFactory,this.destroyed=!1,this.destroyCapability=null,this._passwordCapability=null,this._networkStream=R,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=new _util.PromiseCapability,this.setupMessageHandler()}get annotationStorage(){return(0,_util.shadow)(this,"annotationStorage",new _annotation_storage.AnnotationStorage)}getRenderingIntent(n,h=_util.AnnotationMode.ENABLE,R=null,s=!1){let D=_util.RenderingIntentFlag.DISPLAY,q=null;switch(n){case"any":D=_util.RenderingIntentFlag.ANY;break;case"display":break;case"print":D=_util.RenderingIntentFlag.PRINT;break;default:(0,_util.warn)(`getRenderingIntent - invalid intent: ${n}`)}switch(h){case _util.AnnotationMode.DISABLE:D+=_util.RenderingIntentFlag.ANNOTATIONS_DISABLE;break;case _util.AnnotationMode.ENABLE:break;case _util.AnnotationMode.ENABLE_FORMS:D+=_util.RenderingIntentFlag.ANNOTATIONS_FORMS;break;case _util.AnnotationMode.ENABLE_STORAGE:D+=_util.RenderingIntentFlag.ANNOTATIONS_STORAGE,q=(D&_util.RenderingIntentFlag.PRINT&&R instanceof _annotation_storage.PrintAnnotationStorage?R:this.annotationStorage).serializable;break;default:(0,_util.warn)(`getRenderingIntent - invalid annotationMode: ${h}`)}return s&&(D+=_util.RenderingIntentFlag.OPLIST),{renderingIntent:D,cacheKey:`${D}_${_annotation_storage.AnnotationStorage.getHash(q)}`,annotationStorageMap:q}}destroy(){if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=new _util.PromiseCapability,this._passwordCapability&&this._passwordCapability.reject(new Error("Worker was destroyed during onPassword callback"));const n=[];for(const R of y(this,T).values())n.push(R._destroy());y(this,T).clear(),y(this,p).clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const h=this.messageHandler.sendWithPromise("Terminate",null);return n.push(h),Promise.all(n).then(()=>{this.commonObjs.clear(),this.fontLoader.clear(),y(this,w).clear(),this.filterFactory.destroy(),this._networkStream&&this._networkStream.cancelAllRequests(new _util.AbortException("Worker was terminated.")),this.messageHandler&&(this.messageHandler.destroy(),this.messageHandler=null),this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:n,loadingTask:h}=this;n.on("GetReader",(R,s)=>{(0,_util.assert)(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=D=>{this._lastProgress={loaded:D.loaded,total:D.total}},s.onPull=()=>{this._fullReader.read().then(function({value:D,done:q}){if(q){s.close();return}(0,_util.assert)(D instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),s.enqueue(new Uint8Array(D),1,[D])}).catch(D=>{s.error(D)})},s.onCancel=D=>{this._fullReader.cancel(D),s.ready.catch(q=>{if(!this.destroyed)throw q})}}),n.on("ReaderHeadersReady",R=>{const s=new _util.PromiseCapability,D=this._fullReader;return D.headersReady.then(()=>{var q;(!D.isStreamingSupported||!D.isRangeSupported)&&(this._lastProgress&&((q=h.onProgress)==null||q.call(h,this._lastProgress)),D.onProgress=Y=>{var Q;(Q=h.onProgress)==null||Q.call(h,{loaded:Y.loaded,total:Y.total})}),s.resolve({isStreamingSupported:D.isStreamingSupported,isRangeSupported:D.isRangeSupported,contentLength:D.contentLength})},s.reject),s.promise}),n.on("GetRangeReader",(R,s)=>{(0,_util.assert)(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const D=this._networkStream.getRangeReader(R.begin,R.end);if(!D){s.close();return}s.onPull=()=>{D.read().then(function({value:q,done:Y}){if(Y){s.close();return}(0,_util.assert)(q instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),s.enqueue(new Uint8Array(q),1,[q])}).catch(q=>{s.error(q)})},s.onCancel=q=>{D.cancel(q),s.ready.catch(Y=>{if(!this.destroyed)throw Y})}}),n.on("GetDoc",({pdfInfo:R})=>{this._numPages=R.numPages,this._htmlForXfa=R.htmlForXfa,delete R.htmlForXfa,h._capability.resolve(new PDFDocumentProxy(R,this))}),n.on("DocException",function(R){let s;switch(R.name){case"PasswordException":s=new _util.PasswordException(R.message,R.code);break;case"InvalidPDFException":s=new _util.InvalidPDFException(R.message);break;case"MissingPDFException":s=new _util.MissingPDFException(R.message);break;case"UnexpectedResponseException":s=new _util.UnexpectedResponseException(R.message,R.status);break;case"UnknownErrorException":s=new _util.UnknownErrorException(R.message,R.details);break;default:(0,_util.unreachable)("DocException - expected a valid Error.")}h._capability.reject(s)}),n.on("PasswordRequest",R=>{if(this._passwordCapability=new _util.PromiseCapability,h.onPassword){const s=D=>{D instanceof Error?this._passwordCapability.reject(D):this._passwordCapability.resolve({password:D})};try{h.onPassword(s,R.code)}catch(D){this._passwordCapability.reject(D)}}else this._passwordCapability.reject(new _util.PasswordException(R.message,R.code));return this._passwordCapability.promise}),n.on("DataLoaded",R=>{var s;(s=h.onProgress)==null||s.call(h,{loaded:R.length,total:R.length}),this.downloadInfoCapability.resolve(R)}),n.on("StartRenderPage",R=>{if(this.destroyed)return;y(this,T).get(R.pageIndex)._startRenderPage(R.transparency,R.cacheKey)}),n.on("commonobj",([R,s,D])=>{var q;if(!this.destroyed&&!this.commonObjs.has(R))switch(s){case"Font":const Y=this._params;if("error"in D){const ct=D.error;(0,_util.warn)(`Error during font loading: ${ct}`),this.commonObjs.resolve(R,ct);break}const Q=Y.pdfBug&&((q=globalThis.FontInspector)!=null&&q.enabled)?(ct,nt)=>globalThis.FontInspector.fontAdded(ct,nt):null,et=new _font_loader.FontFaceObject(D,{isEvalSupported:Y.isEvalSupported,disableFontFace:Y.disableFontFace,ignoreErrors:Y.ignoreErrors,inspectFont:Q});this.fontLoader.bind(et).catch(ct=>n.sendWithPromise("FontFallback",{id:R})).finally(()=>{!Y.fontExtraProperties&&et.data&&(et.data=null),this.commonObjs.resolve(R,et)});break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(R,D);break;default:throw new Error(`Got unknown common object type ${s}`)}}),n.on("obj",([R,s,D,q])=>{var Q;if(this.destroyed)return;const Y=y(this,T).get(s);if(!Y.objs.has(R))switch(D){case"Image":if(Y.objs.resolve(R,q),q){let et;if(q.bitmap){const{width:ct,height:nt}=q;et=ct*nt*4}else et=((Q=q.data)==null?void 0:Q.length)||0;et>_util.MAX_IMAGE_SIZE_TO_CACHE&&(Y._maybeCleanupAfterRender=!0)}break;case"Pattern":Y.objs.resolve(R,q);break;default:throw new Error(`Got unknown object type ${D}`)}}),n.on("DocProgress",R=>{var s;this.destroyed||(s=h.onProgress)==null||s.call(h,{loaded:R.loaded,total:R.total})}),n.on("FetchBuiltInCMap",R=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.cMapReaderFactory?this.cMapReaderFactory.fetch(R):Promise.reject(new Error("CMapReaderFactory not initialized, see the `useWorkerFetch` parameter."))),n.on("FetchStandardFontData",R=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.standardFontDataFactory?this.standardFontDataFactory.fetch(R):Promise.reject(new Error("StandardFontDataFactory not initialized, see the `useWorkerFetch` parameter.")))}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){var n;return this.annotationStorage.size<=0&&(0,_util.warn)("saveDocument called while `annotationStorage` is empty, please use the getData-method instead."),this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:this.annotationStorage.serializable,filename:((n=this._fullReader)==null?void 0:n.filename)??null}).finally(()=>{this.annotationStorage.resetModified()})}getPage(n){if(!Number.isInteger(n)||n<=0||n>this._numPages)return Promise.reject(new Error("Invalid page request."));const h=n-1,R=y(this,p).get(h);if(R)return R;const s=this.messageHandler.sendWithPromise("GetPage",{pageIndex:h}).then(D=>{if(this.destroyed)throw new Error("Transport destroyed");const q=new PDFPageProxy(h,D,this,this._params.pdfBug);return y(this,T).set(h,q),q});return y(this,p).set(h,s),s}getPageIndex(n){return typeof n!="object"||n===null||!Number.isInteger(n.num)||n.num<0||!Number.isInteger(n.gen)||n.gen<0?Promise.reject(new Error("Invalid pageIndex request.")):this.messageHandler.sendWithPromise("GetPageIndex",{num:n.num,gen:n.gen})}getAnnotations(n,h){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:n,intent:h})}getFieldObjects(){return at(this,u,fe).call(this,"GetFieldObjects")}hasJSActions(){return at(this,u,fe).call(this,"HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(n){return typeof n!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:n})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getJavaScript(){return this.messageHandler.sendWithPromise("GetJavaScript",null)}getDocJSActions(){return this.messageHandler.sendWithPromise("GetDocJSActions",null)}getPageJSActions(n){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:n})}getStructTree(n){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:n})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(){return this.messageHandler.sendWithPromise("GetOptionalContentConfig",null).then(n=>new _optional_content_config.OptionalContentConfig(n))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const n="GetMetadata",h=y(this,w).get(n);if(h)return h;const R=this.messageHandler.sendWithPromise(n,null).then(s=>{var D,q;return{info:s[0],metadata:s[1]?new _metadata.Metadata(s[1]):null,contentDispositionFilename:((D=this._fullReader)==null?void 0:D.filename)??null,contentLength:((q=this._fullReader)==null?void 0:q.contentLength)??null}});return y(this,w).set(n,R),R}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(n=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const h of y(this,T).values())if(!h.cleanup())throw new Error(`startCleanup: Page ${h.pageNumber} is currently rendering.`);this.commonObjs.clear(),n||this.fontLoader.clear(),y(this,w).clear(),this.filterFactory.destroy(!0)}}get loadingParams(){const{disableAutoFetch:n,enableXfa:h}=this._params;return(0,_util.shadow)(this,"loadingParams",{disableAutoFetch:n,enableXfa:h})}}w=new WeakMap,T=new WeakMap,p=new WeakMap,u=new WeakSet,fe=function(n,h=null){const R=y(this,w).get(n);if(R)return R;const s=this.messageHandler.sendWithPromise(n,h);return y(this,w).set(n,s),s};class PDFObjects{constructor(){tt(this,x);tt(this,A,Object.create(null))}get(n,h=null){if(h){const s=at(this,x,pe).call(this,n);return s.capability.promise.then(()=>h(s.data)),null}const R=y(this,A)[n];if(!(R!=null&&R.capability.settled))throw new Error(`Requesting object that isn't resolved yet ${n}.`);return R.data}has(n){const h=y(this,A)[n];return(h==null?void 0:h.capability.settled)||!1}resolve(n,h=null){const R=at(this,x,pe).call(this,n);R.data=h,R.capability.resolve()}clear(){var n;for(const h in y(this,A)){const{data:R}=y(this,A)[h];(n=R==null?void 0:R.bitmap)==null||n.close()}gt(this,A,Object.create(null))}}A=new WeakMap,x=new WeakSet,pe=function(n){const h=y(this,A)[n];return h||(y(this,A)[n]={capability:new _util.PromiseCapability,data:null})};class RenderTask{constructor(n){tt(this,m,null);gt(this,m,n),this.onContinue=null}get promise(){return y(this,m).capability.promise}cancel(n=0){y(this,m).cancel(null,n)}get separateAnnots(){const{separateAnnots:n}=y(this,m).operatorList;if(!n)return!1;const{annotationCanvasMap:h}=y(this,m);return n.form||n.canvas&&(h==null?void 0:h.size)>0}}m=new WeakMap,exports.RenderTask=RenderTask;const c=class{constructor({callback:n,params:h,objs:R,commonObjs:s,annotationCanvasMap:D,operatorList:q,pageIndex:Y,canvasFactory:Q,filterFactory:et,useRequestAnimationFrame:ct=!1,pdfBug:nt=!1,pageColors:ut=null}){this.callback=n,this.params=h,this.objs=R,this.commonObjs=s,this.annotationCanvasMap=D,this.operatorListIdx=null,this.operatorList=q,this._pageIndex=Y,this.canvasFactory=Q,this.filterFactory=et,this._pdfBug=nt,this.pageColors=ut,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=ct===!0&&typeof window<"u",this.cancelled=!1,this.capability=new _util.PromiseCapability,this.task=new RenderTask(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=h.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:n=!1,optionalContentConfig:h}){var Y,Q;if(this.cancelled)return;if(this._canvas){if(y(c,t).has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");y(c,t).add(this._canvas)}this._pdfBug&&((Y=globalThis.StepperManager)!=null&&Y.enabled)&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:R,viewport:s,transform:D,background:q}=this.params;this.gfx=new _canvas.CanvasGraphics(R,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:h},this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:D,viewport:s,transparency:n,background:q}),this.operatorListIdx=0,this.graphicsReady=!0,(Q=this.graphicsReadyCallback)==null||Q.call(this)}cancel(n=null,h=0){var R;this.running=!1,this.cancelled=!0,(R=this.gfx)==null||R.endDrawing(),this._canvas&&y(c,t).delete(this._canvas),this.callback(n||new _display_utils.RenderingCancelledException(`Rendering cancelled, page ${this._pageIndex+1}`,"canvas",h))}operatorListChanged(){var n;if(!this.graphicsReady){this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound);return}(n=this.stepper)==null||n.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?window.requestAnimationFrame(()=>{this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(this.pageColors),this._canvas&&y(c,t).delete(this._canvas),this.callback())))}};let InternalRenderTask=c;t=new WeakMap,tt(InternalRenderTask,t,new WeakSet);const version="3.6.172";exports.version=version;const build="4d3dfe254";exports.build=build},(G,a,I)=>{var O,F,v,Le,w;Object.defineProperty(a,"__esModule",{value:!0}),a.PrintAnnotationStorage=a.AnnotationStorage=void 0;var d=I(1),_=I(4),M=I(8);class H{constructor(){tt(this,v);tt(this,O,!1);tt(this,F,new Map);this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(p,u){const o=y(this,F).get(p);return o===void 0?u:Object.assign(u,o)}getRawValue(p){return y(this,F).get(p)}remove(p){if(y(this,F).delete(p),y(this,F).size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function"){for(const u of y(this,F).values())if(u instanceof _.AnnotationEditor)return;this.onAnnotationEditor(null)}}setValue(p,u){const o=y(this,F).get(p);let A=!1;if(o!==void 0)for(const[x,C]of Object.entries(u))o[x]!==C&&(A=!0,o[x]=C);else A=!0,y(this,F).set(p,u);A&&at(this,v,Le).call(this),u instanceof _.AnnotationEditor&&typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(u.constructor._type)}has(p){return y(this,F).has(p)}getAll(){return y(this,F).size>0?(0,d.objectFromMap)(y(this,F)):null}setAll(p){for(const[u,o]of Object.entries(p))this.setValue(u,o)}get size(){return y(this,F).size}resetModified(){y(this,O)&&(gt(this,O,!1),typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new Z(this)}get serializable(){if(y(this,F).size===0)return null;const p=new Map;for(const[u,o]of y(this,F)){const A=o instanceof _.AnnotationEditor?o.serialize():o;A&&p.set(u,A)}return p}static getHash(p){if(!p)return"";const u=new M.MurmurHash3_64;for(const[o,A]of p)u.update(`${o}:${JSON.stringify(A)}`);return u.hexdigest()}}O=new WeakMap,F=new WeakMap,v=new WeakSet,Le=function(){y(this,O)||(gt(this,O,!0),typeof this.onSetModified=="function"&&this.onSetModified())},a.AnnotationStorage=H;class Z extends H{constructor(u){super();tt(this,w,null);gt(this,w,structuredClone(u.serializable))}get print(){(0,d.unreachable)("Should not call PrintAnnotationStorage.print")}get serializable(){return y(this,w)}}w=new WeakMap,a.PrintAnnotationStorage=Z},(G,a,I)=>{var H,Z,O,F,v,j;Object.defineProperty(a,"__esModule",{value:!0}),a.AnnotationEditor=void 0;var d=I(5),_=I(1);const w=class{constructor(p){tt(this,H,this.focusin.bind(this));tt(this,Z,this.focusout.bind(this));tt(this,O,!1);tt(this,F,!1);tt(this,v,!1);Lt(this,"_uiManager",null);tt(this,j,w._zIndex++);this.constructor===w&&(0,_.unreachable)("Cannot initialize AnnotationEditor."),this.parent=p.parent,this.id=p.id,this.width=this.height=null,this.pageIndex=p.parent.pageIndex,this.name=p.name,this.div=null,this._uiManager=p.uiManager;const{rotation:u,rawDims:{pageWidth:o,pageHeight:A,pageX:x,pageY:C}}=this.parent.viewport;this.rotation=u,this.pageRotation=(360+u-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[o,A],this.pageTranslation=[x,C];const[m,t]=this.parentDimensions;this.x=p.x/m,this.y=p.y/t,this.isAttachedToDOM=!1}static get _defaultLineColor(){return(0,_.shadow)(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}addCommands(p){this._uiManager.addCommands(p)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=y(this,j)}setParent(p){p!==null&&(this.pageIndex=p.pageIndex,this.pageDimensions=p.pageDimensions),this.parent=p}focusin(p){y(this,O)?gt(this,O,!1):this.parent.setSelected(this)}focusout(p){var o;if(!this.isAttachedToDOM)return;const u=p.relatedTarget;u!=null&&u.closest(`#${this.id}`)||(p.preventDefault(),(o=this.parent)!=null&&o.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}dragstart(p){const u=this.parent.div.getBoundingClientRect();this.startX=p.clientX-u.x,this.startY=p.clientY-u.y,p.dataTransfer.setData("text/plain",this.id),p.dataTransfer.effectAllowed="move"}setAt(p,u,o,A){const[x,C]=this.parentDimensions;[o,A]=this.screenToPageTranslation(o,A),this.x=(p+o)/x,this.y=(u+A)/C,this.div.style.left=`${100*this.x}%`,this.div.style.top=`${100*this.y}%`}translate(p,u){const[o,A]=this.parentDimensions;[p,u]=this.screenToPageTranslation(p,u),this.x+=p/o,this.y+=u/A,this.div.style.left=`${100*this.x}%`,this.div.style.top=`${100*this.y}%`}screenToPageTranslation(p,u){switch(this.parentRotation){case 90:return[u,-p];case 180:return[-p,-u];case 270:return[-u,p];default:return[p,u]}}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{realScale:p}=this._uiManager.viewParameters,[u,o]=this.pageDimensions;return[u*p,o*p]}setDims(p,u){const[o,A]=this.parentDimensions;this.div.style.width=`${100*p/o}%`,this.div.style.height=`${100*u/A}%`}fixDims(){const{style:p}=this.div,{height:u,width:o}=p,A=o.endsWith("%"),x=u.endsWith("%");if(A&&x)return;const[C,m]=this.parentDimensions;A||(p.width=`${100*parseFloat(o)/C}%`),x||(p.height=`${100*parseFloat(u)/m}%`)}getInitialTranslation(){return[0,0]}render(){this.div=document.createElement("div"),this.div.setAttribute("data-editor-rotation",(360-this.rotation)%360),this.div.className=this.name,this.div.setAttribute("id",this.id),this.div.setAttribute("tabIndex",0),this.setInForeground(),this.div.addEventListener("focusin",y(this,H)),this.div.addEventListener("focusout",y(this,Z));const[p,u]=this.getInitialTranslation();return this.translate(p,u),(0,d.bindEvents)(this,this.div,["dragstart","pointerdown"]),this.div}pointerdown(p){const{isMac:u}=_.FeatureTest.platform;if(p.button!==0||p.ctrlKey&&u){p.preventDefault();return}p.ctrlKey&&!u||p.shiftKey||p.metaKey&&u?this.parent.toggleSelected(this):this.parent.setSelected(this),gt(this,O,!0)}getRect(p,u){const o=this.parentScale,[A,x]=this.pageDimensions,[C,m]=this.pageTranslation,t=p/o,c=u/o,i=this.x*A,n=this.y*x,h=this.width*A,R=this.height*x;switch(this.rotation){case 0:return[i+t+C,x-n-c-R+m,i+t+h+C,x-n-c+m];case 90:return[i+c+C,x-n+t+m,i+c+R+C,x-n+t+h+m];case 180:return[i-t-h+C,x-n+c+m,i-t+C,x-n+c+R+m];case 270:return[i-c-R+C,x-n-t-h+m,i-c+C,x-n-t+m];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(p,u){const[o,A,x,C]=p,m=x-o,t=C-A;switch(this.rotation){case 0:return[o,u-C,m,t];case 90:return[o,u-A,t,m];case 180:return[x,u-A,m,t];case 270:return[x,u-C,t,m];default:throw new Error("Invalid rotation")}}onceAdded(){}isEmpty(){return!1}enableEditMode(){gt(this,v,!0)}disableEditMode(){gt(this,v,!1)}isInEditMode(){return y(this,v)}shouldGetKeyboardEvents(){return!1}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}rebuild(){var p;(p=this.div)==null||p.addEventListener("focusin",y(this,H))}serialize(){(0,_.unreachable)("An editor must be serializable")}static deserialize(p,u,o){const A=new this.prototype.constructor({parent:u,id:u.getNextId(),uiManager:o});A.rotation=p.rotation;const[x,C]=A.pageDimensions,[m,t,c,i]=A.getRectInCurrentCoords(p.rect,C);return A.x=m/x,A.y=t/C,A.width=c/x,A.height=i/C,A}remove(){this.div.removeEventListener("focusin",y(this,H)),this.div.removeEventListener("focusout",y(this,Z)),this.isEmpty()||this.commit(),this.parent.remove(this)}select(){var p;(p=this.div)==null||p.classList.add("selectedEditor")}unselect(){var p;(p=this.div)==null||p.classList.remove("selectedEditor")}updateParams(p,u){}disableEditing(){}enableEditing(){}get propertiesToUpdate(){return{}}get contentDiv(){return this.div}get isEditing(){return y(this,F)}set isEditing(p){gt(this,F,p),p?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null)}};let M=w;H=new WeakMap,Z=new WeakMap,O=new WeakMap,F=new WeakMap,v=new WeakMap,j=new WeakMap,Lt(M,"_colorManager",new d.ColorManager),Lt(M,"_zIndex",1),a.AnnotationEditor=M},(G,a,I)=>{var w,T,p,u,o,A,Ie,m,t,c,i,n,h,R,s,D,q,Y,Q,et,ct,nt,ut,mt,_t,xt,At,X,f,g,S,Ne,W,ge,L,je,U,Be,l,Ht,E,ee,V,Ue,J,Ge,lt,me,rt,ne,pt,be;Object.defineProperty(a,"__esModule",{value:!0}),a.KeyboardManager=a.CommandManager=a.ColorManager=a.AnnotationEditorUIManager=void 0,a.bindEvents=M,a.opacityToHex=H;var d=I(1),_=I(6);function M(Tt,K,yt){for(const Et of yt)K.addEventListener(Et,Tt[Et].bind(Tt))}function H(Tt){return Math.round(Math.min(255,Math.max(1,255*Tt))).toString(16).padStart(2,"0")}class Z{constructor(){tt(this,w,0)}getId(){return`${d.AnnotationEditorPrefix}${re(this,w)._++}`}}w=new WeakMap;class O{constructor(K=128){tt(this,T,[]);tt(this,p,!1);tt(this,u,void 0);tt(this,o,-1);gt(this,u,K)}add({cmd:K,undo:yt,mustExec:Et,type:Ft=NaN,overwriteIfSameType:ht=!1,keepUndo:k=!1}){if(Et&&K(),y(this,p))return;const N={cmd:K,undo:yt,type:Ft};if(y(this,o)===-1){y(this,T).length>0&&(y(this,T).length=0),gt(this,o,0),y(this,T).push(N);return}if(ht&&y(this,T)[y(this,o)].type===Ft){k&&(N.undo=y(this,T)[y(this,o)].undo),y(this,T)[y(this,o)]=N;return}const dt=y(this,o)+1;dt===y(this,u)?y(this,T).splice(0,1):(gt(this,o,dt),dt<y(this,T).length&&y(this,T).splice(dt)),y(this,T).push(N)}undo(){y(this,o)!==-1&&(gt(this,p,!0),y(this,T)[y(this,o)].undo(),gt(this,p,!1),gt(this,o,y(this,o)-1))}redo(){y(this,o)<y(this,T).length-1&&(gt(this,o,y(this,o)+1),gt(this,p,!0),y(this,T)[y(this,o)].cmd(),gt(this,p,!1))}hasSomethingToUndo(){return y(this,o)!==-1}hasSomethingToRedo(){return y(this,o)<y(this,T).length-1}destroy(){gt(this,T,null)}}T=new WeakMap,p=new WeakMap,u=new WeakMap,o=new WeakMap,a.CommandManager=O;class F{constructor(K){tt(this,A);this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:yt}=d.FeatureTest.platform;for(const[Et,Ft]of K)for(const ht of Et){const k=ht.startsWith("mac+");yt&&k?(this.callbacks.set(ht.slice(4),Ft),this.allKeys.add(ht.split("+").at(-1))):!yt&&!k&&(this.callbacks.set(ht,Ft),this.allKeys.add(ht.split("+").at(-1)))}}exec(K,yt){if(!this.allKeys.has(yt.key))return;const Et=this.callbacks.get(at(this,A,Ie).call(this,yt));Et&&(Et.bind(K)(),yt.stopPropagation(),yt.preventDefault())}}A=new WeakSet,Ie=function(K){K.altKey&&this.buffer.push("alt"),K.ctrlKey&&this.buffer.push("ctrl"),K.metaKey&&this.buffer.push("meta"),K.shiftKey&&this.buffer.push("shift"),this.buffer.push(K.key);const yt=this.buffer.join("+");return this.buffer.length=0,yt},a.KeyboardManager=F;const C=class{get _colors(){const K=new Map([["CanvasText",null],["Canvas",null]]);return(0,_.getColorValues)(K),(0,d.shadow)(this,"_colors",K)}convert(K){const yt=(0,_.getRGB)(K);if(!window.matchMedia("(forced-colors: active)").matches)return yt;for(const[Et,Ft]of this._colors)if(Ft.every((ht,k)=>ht===yt[k]))return C._colorsMapping.get(Et);return yt}getHexCode(K){const yt=this._colors.get(K);return yt?d.Util.makeHexColor(...yt):K}};let v=C;Lt(v,"_colorsMapping",new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]])),a.ColorManager=v;const vt=class{constructor(K,yt,Et){tt(this,S);tt(this,W);tt(this,L);tt(this,U);tt(this,l);tt(this,E);tt(this,V);tt(this,J);tt(this,lt);tt(this,rt);tt(this,pt);tt(this,m,null);tt(this,t,new Map);tt(this,c,new Map);tt(this,i,null);tt(this,n,new O);tt(this,h,0);tt(this,R,null);tt(this,s,new Set);tt(this,D,null);tt(this,q,new Z);tt(this,Y,!1);tt(this,Q,d.AnnotationEditorType.NONE);tt(this,et,new Set);tt(this,ct,this.copy.bind(this));tt(this,nt,this.cut.bind(this));tt(this,ut,this.paste.bind(this));tt(this,mt,this.keydown.bind(this));tt(this,_t,this.onEditingAction.bind(this));tt(this,xt,this.onPageChanging.bind(this));tt(this,At,this.onScaleChanging.bind(this));tt(this,X,this.onRotationChanging.bind(this));tt(this,f,{isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1});tt(this,g,null);gt(this,g,K),gt(this,D,yt),y(this,D)._on("editingaction",y(this,_t)),y(this,D)._on("pagechanging",y(this,xt)),y(this,D)._on("scalechanging",y(this,At)),y(this,D)._on("rotationchanging",y(this,X)),gt(this,i,Et),this.viewParameters={realScale:_.PixelsPerInch.PDF_TO_CSS_UNITS,rotation:0}}destroy(){at(this,W,ge).call(this),y(this,D)._off("editingaction",y(this,_t)),y(this,D)._off("pagechanging",y(this,xt)),y(this,D)._off("scalechanging",y(this,At)),y(this,D)._off("rotationchanging",y(this,X));for(const K of y(this,c).values())K.destroy();y(this,c).clear(),y(this,t).clear(),y(this,s).clear(),gt(this,m,null),y(this,et).clear(),y(this,n).destroy()}onPageChanging({pageNumber:K}){gt(this,h,K-1)}focusMainContainer(){y(this,g).focus()}addShouldRescale(K){y(this,s).add(K)}removeShouldRescale(K){y(this,s).delete(K)}onScaleChanging({scale:K}){this.commitOrRemove(),this.viewParameters.realScale=K*_.PixelsPerInch.PDF_TO_CSS_UNITS;for(const yt of y(this,s))yt.onScaleChanging()}onRotationChanging({pagesRotation:K}){this.commitOrRemove(),this.viewParameters.rotation=K}addToAnnotationStorage(K){!K.isEmpty()&&y(this,i)&&!y(this,i).has(K.id)&&y(this,i).setValue(K.id,K)}copy(K){if(K.preventDefault(),y(this,m)&&y(this,m).commitOrRemove(),!this.hasSelection)return;const yt=[];for(const Et of y(this,et))Et.isEmpty()||yt.push(Et.serialize());yt.length!==0&&K.clipboardData.setData("application/pdfjs",JSON.stringify(yt))}cut(K){this.copy(K),this.delete()}paste(K){K.preventDefault();let yt=K.clipboardData.getData("application/pdfjs");if(!yt)return;try{yt=JSON.parse(yt)}catch(Ft){(0,d.warn)(`paste: "${Ft.message}".`);return}if(!Array.isArray(yt))return;this.unselectAll();const Et=y(this,c).get(y(this,h));try{const Ft=[];for(const N of yt){const dt=Et.deserialize(N);if(!dt)return;Ft.push(dt)}const ht=()=>{for(const N of Ft)at(this,lt,me).call(this,N);at(this,pt,be).call(this,Ft)},k=()=>{for(const N of Ft)N.remove()};this.addCommands({cmd:ht,undo:k,mustExec:!0})}catch(Ft){(0,d.warn)(`paste: "${Ft.message}".`)}}keydown(K){var yt;(yt=this.getActive())!=null&&yt.shouldGetKeyboardEvents()||vt._keyboardManager.exec(this,K)}onEditingAction(K){["undo","redo","delete","selectAll"].includes(K.name)&&this[K.name]()}setEditingState(K){K?(at(this,S,Ne).call(this),at(this,L,je).call(this),at(this,l,Ht).call(this,{isEditing:y(this,Q)!==d.AnnotationEditorType.NONE,isEmpty:at(this,rt,ne).call(this),hasSomethingToUndo:y(this,n).hasSomethingToUndo(),hasSomethingToRedo:y(this,n).hasSomethingToRedo(),hasSelectedEditor:!1})):(at(this,W,ge).call(this),at(this,U,Be).call(this),at(this,l,Ht).call(this,{isEditing:!1}))}registerEditorTypes(K){if(!y(this,R)){gt(this,R,K);for(const yt of y(this,R))at(this,E,ee).call(this,yt.defaultPropertiesToUpdate)}}getId(){return y(this,q).getId()}get currentLayer(){return y(this,c).get(y(this,h))}get currentPageIndex(){return y(this,h)}addLayer(K){y(this,c).set(K.pageIndex,K),y(this,Y)?K.enable():K.disable()}removeLayer(K){y(this,c).delete(K.pageIndex)}updateMode(K){if(gt(this,Q,K),K===d.AnnotationEditorType.NONE)this.setEditingState(!1),at(this,J,Ge).call(this);else{this.setEditingState(!0),at(this,V,Ue).call(this);for(const yt of y(this,c).values())yt.updateMode(K)}}updateToolbar(K){K!==y(this,Q)&&y(this,D).dispatch("switchannotationeditormode",{source:this,mode:K})}updateParams(K,yt){if(y(this,R)){for(const Et of y(this,et))Et.updateParams(K,yt);for(const Et of y(this,R))Et.updateDefaultParams(K,yt)}}getEditors(K){const yt=[];for(const Et of y(this,t).values())Et.pageIndex===K&&yt.push(Et);return yt}getEditor(K){return y(this,t).get(K)}addEditor(K){y(this,t).set(K.id,K)}removeEditor(K){var yt;y(this,t).delete(K.id),this.unselect(K),(yt=y(this,i))==null||yt.remove(K.id)}setActiveEditor(K){y(this,m)!==K&&(gt(this,m,K),K&&at(this,E,ee).call(this,K.propertiesToUpdate))}toggleSelected(K){if(y(this,et).has(K)){y(this,et).delete(K),K.unselect(),at(this,l,Ht).call(this,{hasSelectedEditor:this.hasSelection});return}y(this,et).add(K),K.select(),at(this,E,ee).call(this,K.propertiesToUpdate),at(this,l,Ht).call(this,{hasSelectedEditor:!0})}setSelected(K){for(const yt of y(this,et))yt!==K&&yt.unselect();y(this,et).clear(),y(this,et).add(K),K.select(),at(this,E,ee).call(this,K.propertiesToUpdate),at(this,l,Ht).call(this,{hasSelectedEditor:!0})}isSelected(K){return y(this,et).has(K)}unselect(K){K.unselect(),y(this,et).delete(K),at(this,l,Ht).call(this,{hasSelectedEditor:this.hasSelection})}get hasSelection(){return y(this,et).size!==0}undo(){y(this,n).undo(),at(this,l,Ht).call(this,{hasSomethingToUndo:y(this,n).hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:at(this,rt,ne).call(this)})}redo(){y(this,n).redo(),at(this,l,Ht).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:y(this,n).hasSomethingToRedo(),isEmpty:at(this,rt,ne).call(this)})}addCommands(K){y(this,n).add(K),at(this,l,Ht).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:at(this,rt,ne).call(this)})}delete(){if(this.commitOrRemove(),!this.hasSelection)return;const K=[...y(this,et)],yt=()=>{for(const Ft of K)Ft.remove()},Et=()=>{for(const Ft of K)at(this,lt,me).call(this,Ft)};this.addCommands({cmd:yt,undo:Et,mustExec:!0})}commitOrRemove(){var K;(K=y(this,m))==null||K.commitOrRemove()}selectAll(){for(const K of y(this,et))K.commit();at(this,pt,be).call(this,y(this,t).values())}unselectAll(){if(y(this,m)){y(this,m).commitOrRemove();return}if(y(this,et).size!==0){for(const K of y(this,et))K.unselect();y(this,et).clear(),at(this,l,Ht).call(this,{hasSelectedEditor:!1})}}isActive(K){return y(this,m)===K}getActive(){return y(this,m)}getMode(){return y(this,Q)}};let j=vt;m=new WeakMap,t=new WeakMap,c=new WeakMap,i=new WeakMap,n=new WeakMap,h=new WeakMap,R=new WeakMap,s=new WeakMap,D=new WeakMap,q=new WeakMap,Y=new WeakMap,Q=new WeakMap,et=new WeakMap,ct=new WeakMap,nt=new WeakMap,ut=new WeakMap,mt=new WeakMap,_t=new WeakMap,xt=new WeakMap,At=new WeakMap,X=new WeakMap,f=new WeakMap,g=new WeakMap,S=new WeakSet,Ne=function(){y(this,g).addEventListener("keydown",y(this,mt))},W=new WeakSet,ge=function(){y(this,g).removeEventListener("keydown",y(this,mt))},L=new WeakSet,je=function(){document.addEventListener("copy",y(this,ct)),document.addEventListener("cut",y(this,nt)),document.addEventListener("paste",y(this,ut))},U=new WeakSet,Be=function(){document.removeEventListener("copy",y(this,ct)),document.removeEventListener("cut",y(this,nt)),document.removeEventListener("paste",y(this,ut))},l=new WeakSet,Ht=function(K){Object.entries(K).some(([Et,Ft])=>y(this,f)[Et]!==Ft)&&y(this,D).dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(y(this,f),K)})},E=new WeakSet,ee=function(K){y(this,D).dispatch("annotationeditorparamschanged",{source:this,details:K})},V=new WeakSet,Ue=function(){if(!y(this,Y)){gt(this,Y,!0);for(const K of y(this,c).values())K.enable()}},J=new WeakSet,Ge=function(){if(this.unselectAll(),y(this,Y)){gt(this,Y,!1);for(const K of y(this,c).values())K.disable()}},lt=new WeakSet,me=function(K){const yt=y(this,c).get(K.pageIndex);yt?yt.addOrRebuild(K):this.addEditor(K)},rt=new WeakSet,ne=function(){if(y(this,t).size===0)return!0;if(y(this,t).size===1)for(const K of y(this,t).values())return K.isEmpty();return!1},pt=new WeakSet,be=function(K){y(this,et).clear();for(const yt of K)yt.isEmpty()||(y(this,et).add(yt),yt.select());at(this,l,Ht).call(this,{hasSelectedEditor:!0})},Lt(j,"_keyboardManager",new F([[["ctrl+a","mac+meta+a"],vt.prototype.selectAll],[["ctrl+z","mac+meta+z"],vt.prototype.undo],[["ctrl+y","ctrl+shift+Z","mac+meta+shift+Z"],vt.prototype.redo],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete"],vt.prototype.delete],[["Escape","mac+Escape"],vt.prototype.unselectAll]])),a.AnnotationEditorUIManager=j},(G,a,I)=>{var ct,nt,ut,mt,_t,xt,At,X,f,Qt,S,Yt,W,Vt;Object.defineProperty(a,"__esModule",{value:!0}),a.StatTimer=a.RenderingCancelledException=a.PixelsPerInch=a.PageViewport=a.PDFDateString=a.DOMStandardFontDataFactory=a.DOMSVGFactory=a.DOMFilterFactory=a.DOMCanvasFactory=a.DOMCMapReaderFactory=a.AnnotationPrefix=void 0,a.deprecated=i,a.getColorValues=D,a.getCurrentTransform=q,a.getCurrentTransformInverse=Y,a.getFilenameFromUrl=x,a.getPdfFilenameFromUrl=C,a.getRGB=s,a.getXfaPageViewport=R,a.isDataScheme=o,a.isPdfFile=A,a.isValidFetchUrl=t,a.loadScript=c,a.setLayerDimensions=Q;var d=I(7),_=I(1);const M="http://www.w3.org/2000/svg",H="pdfjs_internal_id_";a.AnnotationPrefix=H;const et=class{};let Z=et;Lt(Z,"CSS",96),Lt(Z,"PDF",72),Lt(Z,"PDF_TO_CSS_UNITS",et.CSS/et.PDF),a.PixelsPerInch=Z;class O extends d.BaseFilterFactory{constructor({docId:U,ownerDocument:e=globalThis.document}={}){super();tt(this,f);tt(this,S);tt(this,W);tt(this,ct,void 0);tt(this,nt,void 0);tt(this,ut,void 0);tt(this,mt,void 0);tt(this,_t,void 0);tt(this,xt,void 0);tt(this,At,void 0);tt(this,X,0);gt(this,ut,U),gt(this,mt,e)}addFilter(U){if(!U)return"none";let e=y(this,f,Qt).get(U);if(e)return e;let l,b,E,P;if(U.length===1){const lt=U[0],st=new Array(256);for(let rt=0;rt<256;rt++)st[rt]=lt[rt]/255;P=l=b=E=st.join(",")}else{const[lt,st,rt]=U,ft=new Array(256),pt=new Array(256),St=new Array(256);for(let vt=0;vt<256;vt++)ft[vt]=lt[vt]/255,pt[vt]=st[vt]/255,St[vt]=rt[vt]/255;l=ft.join(","),b=pt.join(","),E=St.join(","),P=`${l}${b}${E}`}if(e=y(this,f,Qt).get(P),e)return y(this,f,Qt).set(U,e),e;const V=`g_${y(this,ut)}_transfer_map_${re(this,X)._++}`,it=`url(#${V})`;y(this,f,Qt).set(U,it),y(this,f,Qt).set(P,it);const J=y(this,mt).createElementNS(M,"filter",M);J.setAttribute("id",V),J.setAttribute("color-interpolation-filters","sRGB");const ot=y(this,mt).createElementNS(M,"feComponentTransfer");return J.append(ot),at(this,W,Vt).call(this,ot,"feFuncR",l),at(this,W,Vt).call(this,ot,"feFuncG",b),at(this,W,Vt).call(this,ot,"feFuncB",E),y(this,S,Yt).append(J),it}addHCMFilter(U,e){var rt;const l=`${U}-${e}`;if(y(this,xt)===l)return y(this,At);if(gt(this,xt,l),gt(this,At,"none"),(rt=y(this,_t))==null||rt.remove(),!U||!e)return y(this,At);y(this,S,Yt).style.color=U,U=getComputedStyle(y(this,S,Yt)).getPropertyValue("color");const b=s(U);U=_.Util.makeHexColor(...b),y(this,S,Yt).style.color=e,e=getComputedStyle(y(this,S,Yt)).getPropertyValue("color");const E=s(e);if(e=_.Util.makeHexColor(...E),y(this,S,Yt).style.color="",U==="#000000"&&e==="#ffffff"||U===e)return y(this,At);const P=new Array(256);for(let ft=0;ft<=255;ft++){const pt=ft/255;P[ft]=pt<=.03928?pt/12.92:((pt+.055)/1.055)**2.4}const V=P.join(","),it=`g_${y(this,ut)}_hcm_filter`,J=gt(this,_t,y(this,mt).createElementNS(M,"filter",M));J.setAttribute("id",it),J.setAttribute("color-interpolation-filters","sRGB");let ot=y(this,mt).createElementNS(M,"feComponentTransfer");J.append(ot),at(this,W,Vt).call(this,ot,"feFuncR",V),at(this,W,Vt).call(this,ot,"feFuncG",V),at(this,W,Vt).call(this,ot,"feFuncB",V);const lt=y(this,mt).createElementNS(M,"feColorMatrix");lt.setAttribute("type","matrix"),lt.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),J.append(lt),ot=y(this,mt).createElementNS(M,"feComponentTransfer"),J.append(ot);const st=(ft,pt)=>{const St=b[ft]/255,vt=E[ft]/255,Tt=new Array(pt+1);for(let K=0;K<=pt;K++)Tt[K]=St+K/pt*(vt-St);return Tt.join(",")};return at(this,W,Vt).call(this,ot,"feFuncR",st(0,5)),at(this,W,Vt).call(this,ot,"feFuncG",st(1,5)),at(this,W,Vt).call(this,ot,"feFuncB",st(2,5)),y(this,S,Yt).append(J),gt(this,At,`url(#${it})`),y(this,At)}destroy(U=!1){U&&y(this,At)||(y(this,nt)&&(y(this,nt).parentNode.parentNode.remove(),gt(this,nt,null)),y(this,ct)&&(y(this,ct).clear(),gt(this,ct,null)),gt(this,X,0))}}ct=new WeakMap,nt=new WeakMap,ut=new WeakMap,mt=new WeakMap,_t=new WeakMap,xt=new WeakMap,At=new WeakMap,X=new WeakMap,f=new WeakSet,Qt=function(){return y(this,ct)||gt(this,ct,new Map)},S=new WeakSet,Yt=function(){if(!y(this,nt)){const U=y(this,mt).createElement("div"),{style:e}=U;e.visibility="hidden",e.contain="strict",e.width=e.height=0,e.position="absolute",e.top=e.left=0,e.zIndex=-1;const l=y(this,mt).createElementNS(M,"svg");l.setAttribute("width",0),l.setAttribute("height",0),gt(this,nt,y(this,mt).createElementNS(M,"defs")),U.append(l),l.append(y(this,nt)),y(this,mt).body.append(U)}return y(this,nt)},W=new WeakSet,Vt=function(U,e,l){const b=y(this,mt).createElementNS(M,e);b.setAttribute("type","discrete"),b.setAttribute("tableValues",l),U.append(b)},a.DOMFilterFactory=O;class F extends d.BaseCanvasFactory{constructor({ownerDocument:B=globalThis.document}={}){super(),this._document=B}_createCanvas(B,U){const e=this._document.createElement("canvas");return e.width=B,e.height=U,e}}a.DOMCanvasFactory=F;async function v(L,B=!1){if(t(L,document.baseURI)){const U=await fetch(L);if(!U.ok)throw new Error(U.statusText);return B?new Uint8Array(await U.arrayBuffer()):(0,_.stringToBytes)(await U.text())}return new Promise((U,e)=>{const l=new XMLHttpRequest;l.open("GET",L,!0),B&&(l.responseType="arraybuffer"),l.onreadystatechange=()=>{if(l.readyState===XMLHttpRequest.DONE){if(l.status===200||l.status===0){let b;if(B&&l.response?b=new Uint8Array(l.response):!B&&l.responseText&&(b=(0,_.stringToBytes)(l.responseText)),b){U(b);return}}e(new Error(l.statusText))}},l.send(null)})}class j extends d.BaseCMapReaderFactory{_fetchData(B,U){return v(B,this.isCompressed).then(e=>({cMapData:e,compressionType:U}))}}a.DOMCMapReaderFactory=j;class w extends d.BaseStandardFontDataFactory{_fetchData(B){return v(B,!0)}}a.DOMStandardFontDataFactory=w;class T extends d.BaseSVGFactory{_createSVG(B){return document.createElementNS(M,B)}}a.DOMSVGFactory=T;class p{constructor({viewBox:B,scale:U,rotation:e,offsetX:l=0,offsetY:b=0,dontFlip:E=!1}){this.viewBox=B,this.scale=U,this.rotation=e,this.offsetX=l,this.offsetY=b;const P=(B[2]+B[0])/2,V=(B[3]+B[1])/2;let it,J,ot,lt;switch(e%=360,e<0&&(e+=360),e){case 180:it=-1,J=0,ot=0,lt=1;break;case 90:it=0,J=1,ot=1,lt=0;break;case 270:it=0,J=-1,ot=-1,lt=0;break;case 0:it=1,J=0,ot=0,lt=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}E&&(ot=-ot,lt=-lt);let st,rt,ft,pt;it===0?(st=Math.abs(V-B[1])*U+l,rt=Math.abs(P-B[0])*U+b,ft=(B[3]-B[1])*U,pt=(B[2]-B[0])*U):(st=Math.abs(P-B[0])*U+l,rt=Math.abs(V-B[1])*U+b,ft=(B[2]-B[0])*U,pt=(B[3]-B[1])*U),this.transform=[it*U,J*U,ot*U,lt*U,st-it*U*P-ot*U*V,rt-J*U*P-lt*U*V],this.width=ft,this.height=pt}get rawDims(){const{viewBox:B}=this;return(0,_.shadow)(this,"rawDims",{pageWidth:B[2]-B[0],pageHeight:B[3]-B[1],pageX:B[0],pageY:B[1]})}clone({scale:B=this.scale,rotation:U=this.rotation,offsetX:e=this.offsetX,offsetY:l=this.offsetY,dontFlip:b=!1}={}){return new p({viewBox:this.viewBox.slice(),scale:B,rotation:U,offsetX:e,offsetY:l,dontFlip:b})}convertToViewportPoint(B,U){return _.Util.applyTransform([B,U],this.transform)}convertToViewportRectangle(B){const U=_.Util.applyTransform([B[0],B[1]],this.transform),e=_.Util.applyTransform([B[2],B[3]],this.transform);return[U[0],U[1],e[0],e[1]]}convertToPdfPoint(B,U){return _.Util.applyInverseTransform([B,U],this.transform)}}a.PageViewport=p;class u extends _.BaseException{constructor(B,U,e=0){super(B,"RenderingCancelledException"),this.type=U,this.extraDelay=e}}a.RenderingCancelledException=u;function o(L){const B=L.length;let U=0;for(;U<B&&L[U].trim()==="";)U++;return L.substring(U,U+5).toLowerCase()==="data:"}function A(L){return typeof L=="string"&&/\.pdf$/i.test(L)}function x(L,B=!1){return B||([L]=L.split(/[#?]/,1)),L.substring(L.lastIndexOf("/")+1)}function C(L,B="document.pdf"){if(typeof L!="string")return B;if(o(L))return(0,_.warn)('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),B;const U=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/,e=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,l=U.exec(L);let b=e.exec(l[1])||e.exec(l[2])||e.exec(l[3]);if(b&&(b=b[0],b.includes("%")))try{b=e.exec(decodeURIComponent(b))[0]}catch{}return b||B}class m{constructor(){Lt(this,"started",Object.create(null));Lt(this,"times",[])}time(B){B in this.started&&(0,_.warn)(`Timer is already running for ${B}`),this.started[B]=Date.now()}timeEnd(B){B in this.started||(0,_.warn)(`Timer has not been started for ${B}`),this.times.push({name:B,start:this.started[B],end:Date.now()}),delete this.started[B]}toString(){const B=[];let U=0;for(const{name:e}of this.times)U=Math.max(e.length,U);for(const{name:e,start:l,end:b}of this.times)B.push(`${e.padEnd(U)} ${b-l}ms
`);return B.join("")}}a.StatTimer=m;function t(L,B){try{const{protocol:U}=B?new URL(L,B):new URL(L);return U==="http:"||U==="https:"}catch{return!1}}function c(L,B=!1){return new Promise((U,e)=>{const l=document.createElement("script");l.src=L,l.onload=function(b){B&&l.remove(),U(b)},l.onerror=function(){e(new Error(`Cannot load script at: ${l.src}`))},(document.head||document.documentElement).append(l)})}function i(L){console.log("Deprecated API usage: "+L)}let n;class h{static toDateObject(B){if(!B||typeof B!="string")return null;n||(n=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"));const U=n.exec(B);if(!U)return null;const e=parseInt(U[1],10);let l=parseInt(U[2],10);l=l>=1&&l<=12?l-1:0;let b=parseInt(U[3],10);b=b>=1&&b<=31?b:1;let E=parseInt(U[4],10);E=E>=0&&E<=23?E:0;let P=parseInt(U[5],10);P=P>=0&&P<=59?P:0;let V=parseInt(U[6],10);V=V>=0&&V<=59?V:0;const it=U[7]||"Z";let J=parseInt(U[8],10);J=J>=0&&J<=23?J:0;let ot=parseInt(U[9],10)||0;return ot=ot>=0&&ot<=59?ot:0,it==="-"?(E+=J,P+=ot):it==="+"&&(E-=J,P-=ot),new Date(Date.UTC(e,l,b,E,P,V))}}a.PDFDateString=h;function R(L,{scale:B=1,rotation:U=0}){const{width:e,height:l}=L.attributes.style,b=[0,0,parseInt(e),parseInt(l)];return new p({viewBox:b,scale:B,rotation:U})}function s(L){if(L.startsWith("#")){const B=parseInt(L.slice(1),16);return[(B&16711680)>>16,(B&65280)>>8,B&255]}return L.startsWith("rgb(")?L.slice(4,-1).split(",").map(B=>parseInt(B)):L.startsWith("rgba(")?L.slice(5,-1).split(",").map(B=>parseInt(B)).slice(0,3):((0,_.warn)(`Not a valid color format: "${L}"`),[0,0,0])}function D(L){const B=document.createElement("span");B.style.visibility="hidden",document.body.append(B);for(const U of L.keys()){B.style.color=U;const e=window.getComputedStyle(B).color;L.set(U,s(e))}B.remove()}function q(L){const{a:B,b:U,c:e,d:l,e:b,f:E}=L.getTransform();return[B,U,e,l,b,E]}function Y(L){const{a:B,b:U,c:e,d:l,e:b,f:E}=L.getTransform().invertSelf();return[B,U,e,l,b,E]}function Q(L,B,U=!1,e=!0){if(B instanceof p){const{pageWidth:l,pageHeight:b}=B.rawDims,{style:E}=L,P=`calc(var(--scale-factor) * ${l}px)`,V=`calc(var(--scale-factor) * ${b}px)`;!U||B.rotation%180===0?(E.width=P,E.height=V):(E.width=V,E.height=P)}e&&L.setAttribute("data-main-rotation",B.rotation)}},(G,a,I)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.BaseStandardFontDataFactory=a.BaseSVGFactory=a.BaseFilterFactory=a.BaseCanvasFactory=a.BaseCMapReaderFactory=void 0;var d=I(1);class _{constructor(){this.constructor===_&&(0,d.unreachable)("Cannot initialize BaseFilterFactory.")}addFilter(v){return"none"}addHCMFilter(v,j){return"none"}destroy(v=!1){}}a.BaseFilterFactory=_;class M{constructor(){this.constructor===M&&(0,d.unreachable)("Cannot initialize BaseCanvasFactory.")}create(v,j){if(v<=0||j<=0)throw new Error("Invalid canvas size");const w=this._createCanvas(v,j);return{canvas:w,context:w.getContext("2d")}}reset(v,j,w){if(!v.canvas)throw new Error("Canvas is not specified");if(j<=0||w<=0)throw new Error("Invalid canvas size");v.canvas.width=j,v.canvas.height=w}destroy(v){if(!v.canvas)throw new Error("Canvas is not specified");v.canvas.width=0,v.canvas.height=0,v.canvas=null,v.context=null}_createCanvas(v,j){(0,d.unreachable)("Abstract method `_createCanvas` called.")}}a.BaseCanvasFactory=M;class H{constructor({baseUrl:v=null,isCompressed:j=!0}){this.constructor===H&&(0,d.unreachable)("Cannot initialize BaseCMapReaderFactory."),this.baseUrl=v,this.isCompressed=j}async fetch({name:v}){if(!this.baseUrl)throw new Error('The CMap "baseUrl" parameter must be specified, ensure that the "cMapUrl" and "cMapPacked" API parameters are provided.');if(!v)throw new Error("CMap name must be specified.");const j=this.baseUrl+v+(this.isCompressed?".bcmap":""),w=this.isCompressed?d.CMapCompressionType.BINARY:d.CMapCompressionType.NONE;return this._fetchData(j,w).catch(T=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${j}`)})}_fetchData(v,j){(0,d.unreachable)("Abstract method `_fetchData` called.")}}a.BaseCMapReaderFactory=H;class Z{constructor({baseUrl:v=null}){this.constructor===Z&&(0,d.unreachable)("Cannot initialize BaseStandardFontDataFactory."),this.baseUrl=v}async fetch({filename:v}){if(!this.baseUrl)throw new Error('The standard font "baseUrl" parameter must be specified, ensure that the "standardFontDataUrl" API parameter is provided.');if(!v)throw new Error("Font filename must be specified.");const j=`${this.baseUrl}${v}`;return this._fetchData(j).catch(w=>{throw new Error(`Unable to load font data at: ${j}`)})}_fetchData(v){(0,d.unreachable)("Abstract method `_fetchData` called.")}}a.BaseStandardFontDataFactory=Z;class O{constructor(){this.constructor===O&&(0,d.unreachable)("Cannot initialize BaseSVGFactory.")}create(v,j,w=!1){if(v<=0||j<=0)throw new Error("Invalid SVG dimensions");const T=this._createSVG("svg:svg");return T.setAttribute("version","1.1"),w||(T.setAttribute("width",`${v}px`),T.setAttribute("height",`${j}px`)),T.setAttribute("preserveAspectRatio","none"),T.setAttribute("viewBox",`0 0 ${v} ${j}`),T}createElement(v){if(typeof v!="string")throw new Error("Invalid SVG element type");return this._createSVG(v)}_createSVG(v){(0,d.unreachable)("Abstract method `_createSVG` called.")}}a.BaseSVGFactory=O},(G,a,I)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.MurmurHash3_64=void 0;var d=I(1);const _=3285377520,M=4294901760,H=65535;class Z{constructor(F){this.h1=F?F&4294967295:_,this.h2=F?F&4294967295:_}update(F){let v,j;if(typeof F=="string"){v=new Uint8Array(F.length*2),j=0;for(let i=0,n=F.length;i<n;i++){const h=F.charCodeAt(i);h<=255?v[j++]=h:(v[j++]=h>>>8,v[j++]=h&255)}}else if((0,d.isArrayBuffer)(F))v=F.slice(),j=v.byteLength;else throw new Error("Wrong data format in MurmurHash3_64_update. Input must be a string or array.");const w=j>>2,T=j-w*4,p=new Uint32Array(v.buffer,0,w);let u=0,o=0,A=this.h1,x=this.h2;const C=3432918353,m=461845907,t=C&H,c=m&H;for(let i=0;i<w;i++)i&1?(u=p[i],u=u*C&M|u*t&H,u=u<<15|u>>>17,u=u*m&M|u*c&H,A^=u,A=A<<13|A>>>19,A=A*5+3864292196):(o=p[i],o=o*C&M|o*t&H,o=o<<15|o>>>17,o=o*m&M|o*c&H,x^=o,x=x<<13|x>>>19,x=x*5+3864292196);switch(u=0,T){case 3:u^=v[w*4+2]<<16;case 2:u^=v[w*4+1]<<8;case 1:u^=v[w*4],u=u*C&M|u*t&H,u=u<<15|u>>>17,u=u*m&M|u*c&H,w&1?A^=u:x^=u}this.h1=A,this.h2=x}hexdigest(){let F=this.h1,v=this.h2;return F^=v>>>1,F=F*3981806797&M|F*36045&H,v=v*4283543511&M|((v<<16|F>>>16)*2950163797&M)>>>16,F^=v>>>1,F=F*444984403&M|F*60499&H,v=v*3301882366&M|((v<<16|F>>>16)*3120437893&M)>>>16,F^=v>>>1,(F>>>0).toString(16).padStart(8,"0")+(v>>>0).toString(16).padStart(8,"0")}}a.MurmurHash3_64=Z},(G,a,I)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.FontLoader=a.FontFaceObject=void 0;var d=I(1),_=I(10);class M{constructor({ownerDocument:O=globalThis.document,styleElement:F=null}){this._document=O,this.nativeFontFaces=[],this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(O){this.nativeFontFaces.push(O),this._document.fonts.add(O)}insertRule(O){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const F=this.styleElement.sheet;F.insertRule(O,F.cssRules.length)}clear(){for(const O of this.nativeFontFaces)this._document.fonts.delete(O);this.nativeFontFaces.length=0,this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async bind(O){if(O.attached||O.missingFile)return;if(O.attached=!0,this.isFontLoadingAPISupported){const v=O.createNativeFontFace();if(v){this.addNativeFontFace(v);try{await v.loaded}catch(j){throw(0,d.warn)(`Failed to load font '${v.family}': '${j}'.`),O.disableFontFace=!0,j}}return}const F=O.createFontFaceRule();if(F){if(this.insertRule(F),this.isSyncFontLoadingSupported)return;await new Promise(v=>{const j=this._queueLoadingCallback(v);this._prepareFontLoadEvent(O,j)})}}get isFontLoadingAPISupported(){var F;const O=!!((F=this._document)!=null&&F.fonts);return(0,d.shadow)(this,"isFontLoadingAPISupported",O)}get isSyncFontLoadingSupported(){let O=!1;return(_.isNodeJS||typeof navigator<"u"&&/Mozilla\/5.0.*?rv:\d+.*? Gecko/.test(navigator.userAgent))&&(O=!0),(0,d.shadow)(this,"isSyncFontLoadingSupported",O)}_queueLoadingCallback(O){function F(){for((0,d.assert)(!j.done,"completeRequest() cannot be called twice."),j.done=!0;v.length>0&&v[0].done;){const w=v.shift();setTimeout(w.callback,0)}}const{loadingRequests:v}=this,j={done:!1,complete:F,callback:O};return v.push(j),j}get _loadTestFont(){const O=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return(0,d.shadow)(this,"_loadTestFont",O)}_prepareFontLoadEvent(O,F){function v(s,D){return s.charCodeAt(D)<<24|s.charCodeAt(D+1)<<16|s.charCodeAt(D+2)<<8|s.charCodeAt(D+3)&255}function j(s,D,q,Y){const Q=s.substring(0,D),et=s.substring(D+q);return Q+Y+et}let w,T;const p=this._document.createElement("canvas");p.width=1,p.height=1;const u=p.getContext("2d");let o=0;function A(s,D){if(++o>30){(0,d.warn)("Load test font never loaded."),D();return}if(u.font="30px "+s,u.fillText(".",0,20),u.getImageData(0,0,1,1).data[3]>0){D();return}setTimeout(A.bind(null,s,D))}const x=`lt${Date.now()}${this.loadTestFontId++}`;let C=this._loadTestFont;C=j(C,976,x.length,x);const t=16,c=1482184792;let i=v(C,t);for(w=0,T=x.length-3;w<T;w+=4)i=i-c+v(x,w)|0;w<x.length&&(i=i-c+v(x+"XXX",w)|0),C=j(C,t,4,(0,d.string32)(i));const n=`url(data:font/opentype;base64,${btoa(C)});`,h=`@font-face {font-family:"${x}";src:${n}}`;this.insertRule(h);const R=this._document.createElement("div");R.style.visibility="hidden",R.style.width=R.style.height="10px",R.style.position="absolute",R.style.top=R.style.left="0px";for(const s of[O.loadedName,x]){const D=this._document.createElement("span");D.textContent="Hi",D.style.fontFamily=s,R.append(D)}this._document.body.append(R),A(x,()=>{R.remove(),F.complete()})}}a.FontLoader=M;class H{constructor(O,{isEvalSupported:F=!0,disableFontFace:v=!1,ignoreErrors:j=!1,inspectFont:w=null}){this.compiledGlyphs=Object.create(null);for(const T in O)this[T]=O[T];this.isEvalSupported=F!==!1,this.disableFontFace=v===!0,this.ignoreErrors=j===!0,this._inspectFont=w}createNativeFontFace(){var F;if(!this.data||this.disableFontFace)return null;let O;if(!this.cssFontInfo)O=new FontFace(this.loadedName,this.data,{});else{const v={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(v.style=`oblique ${this.cssFontInfo.italicAngle}deg`),O=new FontFace(this.cssFontInfo.fontFamily,this.data,v)}return(F=this._inspectFont)==null||F.call(this,this),O}createFontFaceRule(){var j;if(!this.data||this.disableFontFace)return null;const O=(0,d.bytesToString)(this.data),F=`url(data:${this.mimetype};base64,${btoa(O)});`;let v;if(!this.cssFontInfo)v=`@font-face {font-family:"${this.loadedName}";src:${F}}`;else{let w=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(w+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),v=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${w}src:${F}}`}return(j=this._inspectFont)==null||j.call(this,this,F),v}getPathGenerator(O,F){if(this.compiledGlyphs[F]!==void 0)return this.compiledGlyphs[F];let v;try{v=O.get(this.loadedName+"_path_"+F)}catch(j){if(!this.ignoreErrors)throw j;return(0,d.warn)(`getPathGenerator - ignoring character: "${j}".`),this.compiledGlyphs[F]=function(w,T){}}if(this.isEvalSupported&&d.FeatureTest.isEvalSupported){const j=[];for(const w of v){const T=w.args!==void 0?w.args.join(","):"";j.push("c.",w.cmd,"(",T,`);
`)}return this.compiledGlyphs[F]=new Function("c","size",j.join(""))}return this.compiledGlyphs[F]=function(j,w){for(const T of v)T.cmd==="scale"&&(T.args=[w,-w]),j[T.cmd].apply(j,T.args)}}}a.FontFaceObject=H},(G,a)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.isNodeJS=void 0;const I=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser");a.isNodeJS=I},(G,a,I)=>{var ut,ye,_t,Ae;Object.defineProperty(a,"__esModule",{value:!0}),a.CanvasGraphics=void 0;var d=I(1),_=I(6),M=I(12),H=I(13),Z=I(10);const O=16,F=100,v=4096,j=15,w=10,T=1e3,p=16;function u(X,f){if(X._removeMirroring)throw new Error("Context is already forwarding operations.");X.__originalSave=X.save,X.__originalRestore=X.restore,X.__originalRotate=X.rotate,X.__originalScale=X.scale,X.__originalTranslate=X.translate,X.__originalTransform=X.transform,X.__originalSetTransform=X.setTransform,X.__originalResetTransform=X.resetTransform,X.__originalClip=X.clip,X.__originalMoveTo=X.moveTo,X.__originalLineTo=X.lineTo,X.__originalBezierCurveTo=X.bezierCurveTo,X.__originalRect=X.rect,X.__originalClosePath=X.closePath,X.__originalBeginPath=X.beginPath,X._removeMirroring=()=>{X.save=X.__originalSave,X.restore=X.__originalRestore,X.rotate=X.__originalRotate,X.scale=X.__originalScale,X.translate=X.__originalTranslate,X.transform=X.__originalTransform,X.setTransform=X.__originalSetTransform,X.resetTransform=X.__originalResetTransform,X.clip=X.__originalClip,X.moveTo=X.__originalMoveTo,X.lineTo=X.__originalLineTo,X.bezierCurveTo=X.__originalBezierCurveTo,X.rect=X.__originalRect,X.closePath=X.__originalClosePath,X.beginPath=X.__originalBeginPath,delete X._removeMirroring},X.save=function(){f.save(),this.__originalSave()},X.restore=function(){f.restore(),this.__originalRestore()},X.translate=function(S,$){f.translate(S,$),this.__originalTranslate(S,$)},X.scale=function(S,$){f.scale(S,$),this.__originalScale(S,$)},X.transform=function(S,$,W,z,L,B){f.transform(S,$,W,z,L,B),this.__originalTransform(S,$,W,z,L,B)},X.setTransform=function(S,$,W,z,L,B){f.setTransform(S,$,W,z,L,B),this.__originalSetTransform(S,$,W,z,L,B)},X.resetTransform=function(){f.resetTransform(),this.__originalResetTransform()},X.rotate=function(S){f.rotate(S),this.__originalRotate(S)},X.clip=function(S){f.clip(S),this.__originalClip(S)},X.moveTo=function(g,S){f.moveTo(g,S),this.__originalMoveTo(g,S)},X.lineTo=function(g,S){f.lineTo(g,S),this.__originalLineTo(g,S)},X.bezierCurveTo=function(g,S,$,W,z,L){f.bezierCurveTo(g,S,$,W,z,L),this.__originalBezierCurveTo(g,S,$,W,z,L)},X.rect=function(g,S,$,W){f.rect(g,S,$,W),this.__originalRect(g,S,$,W)},X.closePath=function(){f.closePath(),this.__originalClosePath()},X.beginPath=function(){f.beginPath(),this.__originalBeginPath()}}class o{constructor(f){this.canvasFactory=f,this.cache=Object.create(null)}getCanvas(f,g,S){let $;return this.cache[f]!==void 0?($=this.cache[f],this.canvasFactory.reset($,g,S)):($=this.canvasFactory.create(g,S),this.cache[f]=$),$}delete(f){delete this.cache[f]}clear(){for(const f in this.cache){const g=this.cache[f];this.canvasFactory.destroy(g),delete this.cache[f]}}}function A(X,f,g,S,$,W,z,L,B,U){const[e,l,b,E,P,V]=(0,_.getCurrentTransform)(X);if(l===0&&b===0){const ot=z*e+P,lt=Math.round(ot),st=L*E+V,rt=Math.round(st),ft=(z+B)*e+P,pt=Math.abs(Math.round(ft)-lt)||1,St=(L+U)*E+V,vt=Math.abs(Math.round(St)-rt)||1;return X.setTransform(Math.sign(e),0,0,Math.sign(E),lt,rt),X.drawImage(f,g,S,$,W,0,0,pt,vt),X.setTransform(e,l,b,E,P,V),[pt,vt]}if(e===0&&E===0){const ot=L*b+P,lt=Math.round(ot),st=z*l+V,rt=Math.round(st),ft=(L+U)*b+P,pt=Math.abs(Math.round(ft)-lt)||1,St=(z+B)*l+V,vt=Math.abs(Math.round(St)-rt)||1;return X.setTransform(0,Math.sign(l),Math.sign(b),0,lt,rt),X.drawImage(f,g,S,$,W,0,0,vt,pt),X.setTransform(e,l,b,E,P,V),[vt,pt]}X.drawImage(f,g,S,$,W,z,L,B,U);const it=Math.hypot(e,l),J=Math.hypot(b,E);return[it*B,J*U]}function x(X){const{width:f,height:g}=X;if(f>T||g>T)return null;const S=1e3,$=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),W=f+1;let z=new Uint8Array(W*(g+1)),L,B,U;const e=f+7&-8;let l=new Uint8Array(e*g),b=0;for(const J of X.data){let ot=128;for(;ot>0;)l[b++]=J&ot?0:255,ot>>=1}let E=0;for(b=0,l[b]!==0&&(z[0]=1,++E),B=1;B<f;B++)l[b]!==l[b+1]&&(z[B]=l[b]?2:1,++E),b++;for(l[b]!==0&&(z[B]=2,++E),L=1;L<g;L++){b=L*e,U=L*W,l[b-e]!==l[b]&&(z[U]=l[b]?1:8,++E);let J=(l[b]?4:0)+(l[b-e]?8:0);for(B=1;B<f;B++)J=(J>>2)+(l[b+1]?4:0)+(l[b-e+1]?8:0),$[J]&&(z[U+B]=$[J],++E),b++;if(l[b-e]!==l[b]&&(z[U+B]=l[b]?2:4,++E),E>S)return null}for(b=e*(g-1),U=L*W,l[b]!==0&&(z[U]=8,++E),B=1;B<f;B++)l[b]!==l[b+1]&&(z[U+B]=l[b]?4:8,++E),b++;if(l[b]!==0&&(z[U+B]=4,++E),E>S)return null;const P=new Int32Array([0,W,-1,0,-W,0,0,0,1]),V=new Path2D;for(L=0;E&&L<=g;L++){let J=L*W;const ot=J+f;for(;J<ot&&!z[J];)J++;if(J===ot)continue;V.moveTo(J%W,L);const lt=J;let st=z[J];do{const rt=P[st];do J+=rt;while(!z[J]);const ft=z[J];ft!==5&&ft!==10?(st=ft,z[J]=0):(st=ft&51*st>>4,z[J]&=st>>2|st<<2),V.lineTo(J%W,J/W|0),z[J]||--E}while(lt!==J);--L}return l=null,z=null,function(J){J.save(),J.scale(1/f,-1/g),J.translate(0,-g),J.fill(V),J.beginPath(),J.restore()}}class C{constructor(f,g){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=d.IDENTITY_MATRIX,this.textMatrixScale=1,this.fontMatrix=d.FONT_IDENTITY_MATRIX,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=d.TextRenderingMode.FILL,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.transferMaps="none",this.startNewPathAndClipBox([0,0,f,g])}clone(){const f=Object.create(this);return f.clipBox=this.clipBox.slice(),f}setCurrentPoint(f,g){this.x=f,this.y=g}updatePathMinMax(f,g,S){[g,S]=d.Util.applyTransform([g,S],f),this.minX=Math.min(this.minX,g),this.minY=Math.min(this.minY,S),this.maxX=Math.max(this.maxX,g),this.maxY=Math.max(this.maxY,S)}updateRectMinMax(f,g){const S=d.Util.applyTransform(g,f),$=d.Util.applyTransform(g.slice(2),f);this.minX=Math.min(this.minX,S[0],$[0]),this.minY=Math.min(this.minY,S[1],$[1]),this.maxX=Math.max(this.maxX,S[0],$[0]),this.maxY=Math.max(this.maxY,S[1],$[1])}updateScalingPathMinMax(f,g){d.Util.scaleMinMax(f,g),this.minX=Math.min(this.minX,g[0]),this.maxX=Math.max(this.maxX,g[1]),this.minY=Math.min(this.minY,g[2]),this.maxY=Math.max(this.maxY,g[3])}updateCurvePathMinMax(f,g,S,$,W,z,L,B,U,e){const l=d.Util.bezierBoundingBox(g,S,$,W,z,L,B,U);if(e){e[0]=Math.min(e[0],l[0],l[2]),e[1]=Math.max(e[1],l[0],l[2]),e[2]=Math.min(e[2],l[1],l[3]),e[3]=Math.max(e[3],l[1],l[3]);return}this.updateRectMinMax(f,l)}getPathBoundingBox(f=M.PathType.FILL,g=null){const S=[this.minX,this.minY,this.maxX,this.maxY];if(f===M.PathType.STROKE){g||(0,d.unreachable)("Stroke bounding box must include transform.");const $=d.Util.singularValueDecompose2dScale(g),W=$[0]*this.lineWidth/2,z=$[1]*this.lineWidth/2;S[0]-=W,S[1]-=z,S[2]+=W,S[3]+=z}return S}updateClipFromPath(){const f=d.Util.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(f||[0,0,0,0])}isEmptyClip(){return this.minX===1/0}startNewPathAndClipBox(f){this.clipBox=f,this.minX=1/0,this.minY=1/0,this.maxX=0,this.maxY=0}getClippedPathBoundingBox(f=M.PathType.FILL,g=null){return d.Util.intersect(this.clipBox,this.getPathBoundingBox(f,g))}}function m(X,f){if(typeof ImageData<"u"&&f instanceof ImageData){X.putImageData(f,0,0);return}const g=f.height,S=f.width,$=g%p,W=(g-$)/p,z=$===0?W:W+1,L=X.createImageData(S,p);let B=0,U;const e=f.data,l=L.data;let b,E,P,V;if(f.kind===d.ImageKind.GRAYSCALE_1BPP){const it=e.byteLength,J=new Uint32Array(l.buffer,0,l.byteLength>>2),ot=J.length,lt=S+7>>3,st=4294967295,rt=d.FeatureTest.isLittleEndian?4278190080:255;for(b=0;b<z;b++){for(P=b<W?p:$,U=0,E=0;E<P;E++){const ft=it-B;let pt=0;const St=ft>lt?S:ft*8-7,vt=St&-8;let Tt=0,K=0;for(;pt<vt;pt+=8)K=e[B++],J[U++]=K&128?st:rt,J[U++]=K&64?st:rt,J[U++]=K&32?st:rt,J[U++]=K&16?st:rt,J[U++]=K&8?st:rt,J[U++]=K&4?st:rt,J[U++]=K&2?st:rt,J[U++]=K&1?st:rt;for(;pt<St;pt++)Tt===0&&(K=e[B++],Tt=128),J[U++]=K&Tt?st:rt,Tt>>=1}for(;U<ot;)J[U++]=0;X.putImageData(L,0,b*p)}}else if(f.kind===d.ImageKind.RGBA_32BPP){for(E=0,V=S*p*4,b=0;b<W;b++)l.set(e.subarray(B,B+V)),B+=V,X.putImageData(L,0,E),E+=p;b<z&&(V=S*$*4,l.set(e.subarray(B,B+V)),X.putImageData(L,0,E))}else if(f.kind===d.ImageKind.RGB_24BPP)for(P=p,V=S*P,b=0;b<z;b++){for(b>=W&&(P=$,V=S*P),U=0,E=V;E--;)l[U++]=e[B++],l[U++]=e[B++],l[U++]=e[B++],l[U++]=255;X.putImageData(L,0,b*p)}else throw new Error(`bad image kind: ${f.kind}`)}function t(X,f){if(f.bitmap){X.drawImage(f.bitmap,0,0);return}const g=f.height,S=f.width,$=g%p,W=(g-$)/p,z=$===0?W:W+1,L=X.createImageData(S,p);let B=0;const U=f.data,e=L.data;for(let l=0;l<z;l++){const b=l<W?p:$;({srcPos:B}=(0,H.convertBlackAndWhiteToRGBA)({src:U,srcPos:B,dest:e,width:S,height:b,nonBlackColor:0})),X.putImageData(L,0,l*p)}}function c(X,f){const g=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const S of g)X[S]!==void 0&&(f[S]=X[S]);X.setLineDash!==void 0&&(f.setLineDash(X.getLineDash()),f.lineDashOffset=X.lineDashOffset)}function i(X){X.strokeStyle=X.fillStyle="#000000",X.fillRule="nonzero",X.globalAlpha=1,X.lineWidth=1,X.lineCap="butt",X.lineJoin="miter",X.miterLimit=10,X.globalCompositeOperation="source-over",X.font="10px sans-serif",X.setLineDash!==void 0&&(X.setLineDash([]),X.lineDashOffset=0),Z.isNodeJS||(X.filter="none")}function n(X,f,g,S){const $=X.length;for(let W=3;W<$;W+=4){const z=X[W];if(z===0)X[W-3]=f,X[W-2]=g,X[W-1]=S;else if(z<255){const L=255-z;X[W-3]=X[W-3]*z+f*L>>8,X[W-2]=X[W-2]*z+g*L>>8,X[W-1]=X[W-1]*z+S*L>>8}}}function h(X,f,g){const S=X.length,$=1/255;for(let W=3;W<S;W+=4){const z=g?g[X[W]]:X[W];f[W]=f[W]*z*$|0}}function R(X,f,g){const S=X.length;for(let $=3;$<S;$+=4){const W=X[$-3]*77+X[$-2]*152+X[$-1]*28;f[$]=g?f[$]*g[W>>8]>>8:f[$]*W>>16}}function s(X,f,g,S,$,W,z,L,B,U,e){const l=!!W,b=l?W[0]:0,E=l?W[1]:0,P=l?W[2]:0;let V;$==="Luminosity"?V=R:V=h;const J=Math.min(S,Math.ceil(1048576/g));for(let ot=0;ot<S;ot+=J){const lt=Math.min(J,S-ot),st=X.getImageData(L-U,ot+(B-e),g,lt),rt=f.getImageData(L,ot+B,g,lt);l&&n(st.data,b,E,P),V(st.data,rt.data,z),f.putImageData(rt,L,ot+B)}}function D(X,f,g,S){const $=S[0],W=S[1],z=S[2]-$,L=S[3]-W;z===0||L===0||(s(f.context,g,z,L,f.subtype,f.backdrop,f.transferMap,$,W,f.offsetX,f.offsetY),X.save(),X.globalAlpha=1,X.globalCompositeOperation="source-over",X.setTransform(1,0,0,1,0,0),X.drawImage(g.canvas,0,0),X.restore())}function q(X,f){const g=d.Util.singularValueDecompose2dScale(X);g[0]=Math.fround(g[0]),g[1]=Math.fround(g[1]);const S=Math.fround((globalThis.devicePixelRatio||1)*_.PixelsPerInch.PDF_TO_CSS_UNITS);return f!==void 0?f:g[0]<=S||g[1]<=S}const Y=["butt","round","square"],Q=["miter","round","bevel"],et={},ct={},At=class{constructor(f,g,S,$,W,{optionalContentConfig:z,markedContentStack:L=null},B,U){tt(this,ut);tt(this,_t);this.ctx=f,this.current=new C(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=g,this.objs=S,this.canvasFactory=$,this.filterFactory=W,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=L||[],this.optionalContentConfig=z,this.cachedCanvases=new o(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=B,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=U,this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(f,g=null){return typeof f=="string"?f.startsWith("g_")?this.commonObjs.get(f):this.objs.get(f):g}beginDrawing({transform:f,viewport:g,transparency:S=!1,background:$=null}){const W=this.ctx.canvas.width,z=this.ctx.canvas.height,L=this.ctx.fillStyle;if(this.ctx.fillStyle=$||"#ffffff",this.ctx.fillRect(0,0,W,z),this.ctx.fillStyle=L,S){const B=this.cachedCanvases.getCanvas("transparent",W,z);this.compositeCtx=this.ctx,this.transparentCanvas=B.canvas,this.ctx=B.context,this.ctx.save(),this.ctx.transform(...(0,_.getCurrentTransform)(this.compositeCtx))}this.ctx.save(),i(this.ctx),f&&(this.ctx.transform(...f),this.outputScaleX=f[0],this.outputScaleY=f[0]),this.ctx.transform(...g.transform),this.viewportScale=g.scale,this.baseTransform=(0,_.getCurrentTransform)(this.ctx)}executeOperatorList(f,g,S,$){const W=f.argsArray,z=f.fnArray;let L=g||0;const B=W.length;if(B===L)return L;const U=B-L>w&&typeof S=="function",e=U?Date.now()+j:0;let l=0;const b=this.commonObjs,E=this.objs;let P;for(;;){if($!==void 0&&L===$.nextBreakPoint)return $.breakIt(L,S),L;if(P=z[L],P!==d.OPS.dependency)this[P].apply(this,W[L]);else for(const V of W[L]){const it=V.startsWith("g_")?b:E;if(!it.has(V))return it.get(V,S),L}if(L++,L===B)return L;if(U&&++l>w){if(Date.now()>e)return S(),L;l=0}}}endDrawing(){at(this,ut,ye).call(this),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const f of this._cachedBitmapsMap.values()){for(const g of f.values())typeof HTMLCanvasElement<"u"&&g instanceof HTMLCanvasElement&&(g.width=g.height=0);f.clear()}this._cachedBitmapsMap.clear(),at(this,_t,Ae).call(this)}_scaleImage(f,g){const S=f.width,$=f.height;let W=Math.max(Math.hypot(g[0],g[1]),1),z=Math.max(Math.hypot(g[2],g[3]),1),L=S,B=$,U="prescale1",e,l;for(;W>2&&L>1||z>2&&B>1;){let b=L,E=B;W>2&&L>1&&(b=L>=16384?Math.floor(L/2)-1||1:Math.ceil(L/2),W/=L/b),z>2&&B>1&&(E=B>=16384?Math.floor(B/2)-1||1:Math.ceil(B)/2,z/=B/E),e=this.cachedCanvases.getCanvas(U,b,E),l=e.context,l.clearRect(0,0,b,E),l.drawImage(f,0,0,L,B,0,0,b,E),f=e.canvas,L=b,B=E,U=U==="prescale1"?"prescale2":"prescale1"}return{img:f,paintWidth:L,paintHeight:B}}_createMaskCanvas(f){const g=this.ctx,{width:S,height:$}=f,W=this.current.fillColor,z=this.current.patternFill,L=(0,_.getCurrentTransform)(g);let B,U,e,l;if((f.bitmap||f.data)&&f.count>1){const pt=f.bitmap||f.data.buffer;U=JSON.stringify(z?L:[L.slice(0,4),W]),B=this._cachedBitmapsMap.get(pt),B||(B=new Map,this._cachedBitmapsMap.set(pt,B));const St=B.get(U);if(St&&!z){const vt=Math.round(Math.min(L[0],L[2])+L[4]),Tt=Math.round(Math.min(L[1],L[3])+L[5]);return{canvas:St,offsetX:vt,offsetY:Tt}}e=St}e||(l=this.cachedCanvases.getCanvas("maskCanvas",S,$),t(l.context,f));let b=d.Util.transform(L,[1/S,0,0,-1/$,0,0]);b=d.Util.transform(b,[1,0,0,1,0,-$]);const E=d.Util.applyTransform([0,0],b),P=d.Util.applyTransform([S,$],b),V=d.Util.normalizeRect([E[0],E[1],P[0],P[1]]),it=Math.round(V[2]-V[0])||1,J=Math.round(V[3]-V[1])||1,ot=this.cachedCanvases.getCanvas("fillCanvas",it,J),lt=ot.context,st=Math.min(E[0],P[0]),rt=Math.min(E[1],P[1]);lt.translate(-st,-rt),lt.transform(...b),e||(e=this._scaleImage(l.canvas,(0,_.getCurrentTransformInverse)(lt)),e=e.img,B&&z&&B.set(U,e)),lt.imageSmoothingEnabled=q((0,_.getCurrentTransform)(lt),f.interpolate),A(lt,e,0,0,e.width,e.height,0,0,S,$),lt.globalCompositeOperation="source-in";const ft=d.Util.transform((0,_.getCurrentTransformInverse)(lt),[1,0,0,1,-st,-rt]);return lt.fillStyle=z?W.getPattern(g,this,ft,M.PathType.FILL):W,lt.fillRect(0,0,S,$),B&&!z&&(this.cachedCanvases.delete("fillCanvas"),B.set(U,ot.canvas)),{canvas:ot.canvas,offsetX:Math.round(st),offsetY:Math.round(rt)}}setLineWidth(f){f!==this.current.lineWidth&&(this._cachedScaleForStroking=null),this.current.lineWidth=f,this.ctx.lineWidth=f}setLineCap(f){this.ctx.lineCap=Y[f]}setLineJoin(f){this.ctx.lineJoin=Q[f]}setMiterLimit(f){this.ctx.miterLimit=f}setDash(f,g){const S=this.ctx;S.setLineDash!==void 0&&(S.setLineDash(f),S.lineDashOffset=g)}setRenderingIntent(f){}setFlatness(f){}setGState(f){for(const[g,S]of f)switch(g){case"LW":this.setLineWidth(S);break;case"LC":this.setLineCap(S);break;case"LJ":this.setLineJoin(S);break;case"ML":this.setMiterLimit(S);break;case"D":this.setDash(S[0],S[1]);break;case"RI":this.setRenderingIntent(S);break;case"FL":this.setFlatness(S);break;case"Font":this.setFont(S[0],S[1]);break;case"CA":this.current.strokeAlpha=S;break;case"ca":this.current.fillAlpha=S,this.ctx.globalAlpha=S;break;case"BM":this.ctx.globalCompositeOperation=S;break;case"SMask":this.current.activeSMask=S?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(S);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const f=this.inSMaskMode;this.current.activeSMask&&!f?this.beginSMaskMode():!this.current.activeSMask&&f&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const f=this.ctx.canvas.width,g=this.ctx.canvas.height,S="smaskGroupAt"+this.groupLevel,$=this.cachedCanvases.getCanvas(S,f,g);this.suspendedCtx=this.ctx,this.ctx=$.context;const W=this.ctx;W.setTransform(...(0,_.getCurrentTransform)(this.suspendedCtx)),c(this.suspendedCtx,W),u(W,this.suspendedCtx),this.setGState([["BM","source-over"],["ca",1],["CA",1]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),c(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(f){if(!this.current.activeSMask)return;f?(f[0]=Math.floor(f[0]),f[1]=Math.floor(f[1]),f[2]=Math.ceil(f[2]),f[3]=Math.ceil(f[3])):f=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const g=this.current.activeSMask,S=this.suspendedCtx;D(S,g,this.ctx,f),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}save(){this.inSMaskMode?(c(this.ctx,this.suspendedCtx),this.suspendedCtx.save()):this.ctx.save();const f=this.current;this.stateStack.push(f),this.current=f.clone()}restore(){this.stateStack.length===0&&this.inSMaskMode&&this.endSMaskMode(),this.stateStack.length!==0&&(this.current=this.stateStack.pop(),this.inSMaskMode?(this.suspendedCtx.restore(),c(this.suspendedCtx,this.ctx)):this.ctx.restore(),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null)}transform(f,g,S,$,W,z){this.ctx.transform(f,g,S,$,W,z),this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null}constructPath(f,g,S){const $=this.ctx,W=this.current;let z=W.x,L=W.y,B,U;const e=(0,_.getCurrentTransform)($),l=e[0]===0&&e[3]===0||e[1]===0&&e[2]===0,b=l?S.slice(0):null;for(let E=0,P=0,V=f.length;E<V;E++)switch(f[E]|0){case d.OPS.rectangle:z=g[P++],L=g[P++];const it=g[P++],J=g[P++],ot=z+it,lt=L+J;$.moveTo(z,L),it===0||J===0?$.lineTo(ot,lt):($.lineTo(ot,L),$.lineTo(ot,lt),$.lineTo(z,lt)),l||W.updateRectMinMax(e,[z,L,ot,lt]),$.closePath();break;case d.OPS.moveTo:z=g[P++],L=g[P++],$.moveTo(z,L),l||W.updatePathMinMax(e,z,L);break;case d.OPS.lineTo:z=g[P++],L=g[P++],$.lineTo(z,L),l||W.updatePathMinMax(e,z,L);break;case d.OPS.curveTo:B=z,U=L,z=g[P+4],L=g[P+5],$.bezierCurveTo(g[P],g[P+1],g[P+2],g[P+3],z,L),W.updateCurvePathMinMax(e,B,U,g[P],g[P+1],g[P+2],g[P+3],z,L,b),P+=6;break;case d.OPS.curveTo2:B=z,U=L,$.bezierCurveTo(z,L,g[P],g[P+1],g[P+2],g[P+3]),W.updateCurvePathMinMax(e,B,U,z,L,g[P],g[P+1],g[P+2],g[P+3],b),z=g[P+2],L=g[P+3],P+=4;break;case d.OPS.curveTo3:B=z,U=L,z=g[P+2],L=g[P+3],$.bezierCurveTo(g[P],g[P+1],z,L,z,L),W.updateCurvePathMinMax(e,B,U,g[P],g[P+1],z,L,z,L,b),P+=4;break;case d.OPS.closePath:$.closePath();break}l&&W.updateScalingPathMinMax(e,b),W.setCurrentPoint(z,L)}closePath(){this.ctx.closePath()}stroke(f=!0){const g=this.ctx,S=this.current.strokeColor;g.globalAlpha=this.current.strokeAlpha,this.contentVisible&&(typeof S=="object"&&(S!=null&&S.getPattern)?(g.save(),g.strokeStyle=S.getPattern(g,this,(0,_.getCurrentTransformInverse)(g),M.PathType.STROKE),this.rescaleAndStroke(!1),g.restore()):this.rescaleAndStroke(!0)),f&&this.consumePath(this.current.getClippedPathBoundingBox()),g.globalAlpha=this.current.fillAlpha}closeStroke(){this.closePath(),this.stroke()}fill(f=!0){const g=this.ctx,S=this.current.fillColor,$=this.current.patternFill;let W=!1;$&&(g.save(),g.fillStyle=S.getPattern(g,this,(0,_.getCurrentTransformInverse)(g),M.PathType.FILL),W=!0);const z=this.current.getClippedPathBoundingBox();this.contentVisible&&z!==null&&(this.pendingEOFill?(g.fill("evenodd"),this.pendingEOFill=!1):g.fill()),W&&g.restore(),f&&this.consumePath(z)}eoFill(){this.pendingEOFill=!0,this.fill()}fillStroke(){this.fill(!1),this.stroke(!1),this.consumePath()}eoFillStroke(){this.pendingEOFill=!0,this.fillStroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()}endPath(){this.consumePath()}clip(){this.pendingClip=et}eoClip(){this.pendingClip=ct}beginText(){this.current.textMatrix=d.IDENTITY_MATRIX,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const f=this.pendingTextPaths,g=this.ctx;if(f===void 0){g.beginPath();return}g.save(),g.beginPath();for(const S of f)g.setTransform(...S.transform),g.translate(S.x,S.y),S.addToPath(g,S.fontSize);g.restore(),g.clip(),g.beginPath(),delete this.pendingTextPaths}setCharSpacing(f){this.current.charSpacing=f}setWordSpacing(f){this.current.wordSpacing=f}setHScale(f){this.current.textHScale=f/100}setLeading(f){this.current.leading=-f}setFont(f,g){const S=this.commonObjs.get(f),$=this.current;if(!S)throw new Error(`Can't find font for ${f}`);if($.fontMatrix=S.fontMatrix||d.FONT_IDENTITY_MATRIX,($.fontMatrix[0]===0||$.fontMatrix[3]===0)&&(0,d.warn)("Invalid font matrix for font "+f),g<0?(g=-g,$.fontDirection=-1):$.fontDirection=1,this.current.font=S,this.current.fontSize=g,S.isType3Font)return;const W=S.loadedName||"sans-serif";let z="normal";S.black?z="900":S.bold&&(z="bold");const L=S.italic?"italic":"normal",B=`"${W}", ${S.fallbackName}`;let U=g;g<O?U=O:g>F&&(U=F),this.current.fontSizeScale=g/U,this.ctx.font=`${L} ${z} ${U}px ${B}`}setTextRenderingMode(f){this.current.textRenderingMode=f}setTextRise(f){this.current.textRise=f}moveText(f,g){this.current.x=this.current.lineX+=f,this.current.y=this.current.lineY+=g}setLeadingMoveText(f,g){this.setLeading(-g),this.moveText(f,g)}setTextMatrix(f,g,S,$,W,z){this.current.textMatrix=[f,g,S,$,W,z],this.current.textMatrixScale=Math.hypot(f,g),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}nextLine(){this.moveText(0,this.current.leading)}paintChar(f,g,S,$){const W=this.ctx,z=this.current,L=z.font,B=z.textRenderingMode,U=z.fontSize/z.fontSizeScale,e=B&d.TextRenderingMode.FILL_STROKE_MASK,l=!!(B&d.TextRenderingMode.ADD_TO_PATH_FLAG),b=z.patternFill&&!L.missingFile;let E;(L.disableFontFace||l||b)&&(E=L.getPathGenerator(this.commonObjs,f)),L.disableFontFace||b?(W.save(),W.translate(g,S),W.beginPath(),E(W,U),$&&W.setTransform(...$),(e===d.TextRenderingMode.FILL||e===d.TextRenderingMode.FILL_STROKE)&&W.fill(),(e===d.TextRenderingMode.STROKE||e===d.TextRenderingMode.FILL_STROKE)&&W.stroke(),W.restore()):((e===d.TextRenderingMode.FILL||e===d.TextRenderingMode.FILL_STROKE)&&W.fillText(f,g,S),(e===d.TextRenderingMode.STROKE||e===d.TextRenderingMode.FILL_STROKE)&&W.strokeText(f,g,S)),l&&(this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:(0,_.getCurrentTransform)(W),x:g,y:S,fontSize:U,addToPath:E})}get isFontSubpixelAAEnabled(){const{context:f}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);f.scale(1.5,1),f.fillText("I",0,10);const g=f.getImageData(0,0,10,10).data;let S=!1;for(let $=3;$<g.length;$+=4)if(g[$]>0&&g[$]<255){S=!0;break}return(0,d.shadow)(this,"isFontSubpixelAAEnabled",S)}showText(f){const g=this.current,S=g.font;if(S.isType3Font)return this.showType3Text(f);const $=g.fontSize;if($===0)return;const W=this.ctx,z=g.fontSizeScale,L=g.charSpacing,B=g.wordSpacing,U=g.fontDirection,e=g.textHScale*U,l=f.length,b=S.vertical,E=b?1:-1,P=S.defaultVMetrics,V=$*g.fontMatrix[0],it=g.textRenderingMode===d.TextRenderingMode.FILL&&!S.disableFontFace&&!g.patternFill;W.save(),W.transform(...g.textMatrix),W.translate(g.x,g.y+g.textRise),U>0?W.scale(e,-1):W.scale(e,1);let J;if(g.patternFill){W.save();const ft=g.fillColor.getPattern(W,this,(0,_.getCurrentTransformInverse)(W),M.PathType.FILL);J=(0,_.getCurrentTransform)(W),W.restore(),W.fillStyle=ft}let ot=g.lineWidth;const lt=g.textMatrixScale;if(lt===0||ot===0){const ft=g.textRenderingMode&d.TextRenderingMode.FILL_STROKE_MASK;(ft===d.TextRenderingMode.STROKE||ft===d.TextRenderingMode.FILL_STROKE)&&(ot=this.getSinglePixelWidth())}else ot/=lt;if(z!==1&&(W.scale(z,z),ot/=z),W.lineWidth=ot,S.isInvalidPDFjsFont){const ft=[];let pt=0;for(const St of f)ft.push(St.unicode),pt+=St.width;W.fillText(ft.join(""),0,0),g.x+=pt*V*e,W.restore(),this.compose();return}let st=0,rt;for(rt=0;rt<l;++rt){const ft=f[rt];if(typeof ft=="number"){st+=E*ft*$/1e3;continue}let pt=!1;const St=(ft.isSpace?B:0)+L,vt=ft.fontChar,Tt=ft.accent;let K,yt,Et=ft.width;if(b){const ht=ft.vmetric||P,k=-(ft.vmetric?ht[1]:Et*.5)*V,N=ht[2]*V;Et=ht?-ht[0]:Et,K=k/z,yt=(st+N)/z}else K=st/z,yt=0;if(S.remeasure&&Et>0){const ht=W.measureText(vt).width*1e3/$*z;if(Et<ht&&this.isFontSubpixelAAEnabled){const k=Et/ht;pt=!0,W.save(),W.scale(k,1),K/=k}else Et!==ht&&(K+=(Et-ht)/2e3*$/z)}if(this.contentVisible&&(ft.isInFont||S.missingFile)){if(it&&!Tt)W.fillText(vt,K,yt);else if(this.paintChar(vt,K,yt,J),Tt){const ht=K+$*Tt.offset.x/z,k=yt-$*Tt.offset.y/z;this.paintChar(Tt.fontChar,ht,k,J)}}let Ft;b?Ft=Et*V-St*U:Ft=Et*V+St*U,st+=Ft,pt&&W.restore()}b?g.y-=st:g.x+=st*e,W.restore(),this.compose()}showType3Text(f){const g=this.ctx,S=this.current,$=S.font,W=S.fontSize,z=S.fontDirection,L=$.vertical?1:-1,B=S.charSpacing,U=S.wordSpacing,e=S.textHScale*z,l=S.fontMatrix||d.FONT_IDENTITY_MATRIX,b=f.length,E=S.textRenderingMode===d.TextRenderingMode.INVISIBLE;let P,V,it,J;if(!(E||W===0)){for(this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null,g.save(),g.transform(...S.textMatrix),g.translate(S.x,S.y),g.scale(e,z),P=0;P<b;++P){if(V=f[P],typeof V=="number"){J=L*V*W/1e3,this.ctx.translate(J,0),S.x+=J*e;continue}const ot=(V.isSpace?U:0)+B,lt=$.charProcOperatorList[V.operatorListId];if(!lt){(0,d.warn)(`Type3 character "${V.operatorListId}" is not available.`);continue}this.contentVisible&&(this.processingType3=V,this.save(),g.scale(W,W),g.transform(...l),this.executeOperatorList(lt),this.restore()),it=d.Util.applyTransform([V.width,0],l)[0]*W+ot,g.translate(it,0),S.x+=it*e}g.restore(),this.processingType3=null}}setCharWidth(f,g){}setCharWidthAndBounds(f,g,S,$,W,z){this.ctx.rect(S,$,W-S,z-$),this.ctx.clip(),this.endPath()}getColorN_Pattern(f){let g;if(f[0]==="TilingPattern"){const S=f[1],$=this.baseTransform||(0,_.getCurrentTransform)(this.ctx),W={createCanvasGraphics:z=>new At(z,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack})};g=new M.TilingPattern(f,S,this.ctx,W,$)}else g=this._getPattern(f[1],f[2]);return g}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments)}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(f,g,S){const $=d.Util.makeHexColor(f,g,S);this.ctx.strokeStyle=$,this.current.strokeColor=$}setFillRGBColor(f,g,S){const $=d.Util.makeHexColor(f,g,S);this.ctx.fillStyle=$,this.current.fillColor=$,this.current.patternFill=!1}_getPattern(f,g=null){let S;return this.cachedPatterns.has(f)?S=this.cachedPatterns.get(f):(S=(0,M.getShadingPattern)(this.getObject(f)),this.cachedPatterns.set(f,S)),g&&(S.matrix=g),S}shadingFill(f){if(!this.contentVisible)return;const g=this.ctx;this.save();const S=this._getPattern(f);g.fillStyle=S.getPattern(g,this,(0,_.getCurrentTransformInverse)(g),M.PathType.SHADING);const $=(0,_.getCurrentTransformInverse)(g);if($){const W=g.canvas,z=W.width,L=W.height,B=d.Util.applyTransform([0,0],$),U=d.Util.applyTransform([0,L],$),e=d.Util.applyTransform([z,0],$),l=d.Util.applyTransform([z,L],$),b=Math.min(B[0],U[0],e[0],l[0]),E=Math.min(B[1],U[1],e[1],l[1]),P=Math.max(B[0],U[0],e[0],l[0]),V=Math.max(B[1],U[1],e[1],l[1]);this.ctx.fillRect(b,E,P-b,V-E)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){(0,d.unreachable)("Should not call beginInlineImage")}beginImageData(){(0,d.unreachable)("Should not call beginImageData")}paintFormXObjectBegin(f,g){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),Array.isArray(f)&&f.length===6&&this.transform(...f),this.baseTransform=(0,_.getCurrentTransform)(this.ctx),g)){const S=g[2]-g[0],$=g[3]-g[1];this.ctx.rect(g[0],g[1],S,$),this.current.updateRectMinMax((0,_.getCurrentTransform)(this.ctx),g),this.clip(),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(f){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const g=this.ctx;f.isolated||(0,d.info)("TODO: Support non-isolated groups."),f.knockout&&(0,d.warn)("Knockout groups not supported.");const S=(0,_.getCurrentTransform)(g);if(f.matrix&&g.transform(...f.matrix),!f.bbox)throw new Error("Bounding box is required.");let $=d.Util.getAxialAlignedBoundingBox(f.bbox,(0,_.getCurrentTransform)(g));const W=[0,0,g.canvas.width,g.canvas.height];$=d.Util.intersect($,W)||[0,0,0,0];const z=Math.floor($[0]),L=Math.floor($[1]);let B=Math.max(Math.ceil($[2])-z,1),U=Math.max(Math.ceil($[3])-L,1),e=1,l=1;B>v&&(e=B/v,B=v),U>v&&(l=U/v,U=v),this.current.startNewPathAndClipBox([0,0,B,U]);let b="groupAt"+this.groupLevel;f.smask&&(b+="_smask_"+this.smaskCounter++%2);const E=this.cachedCanvases.getCanvas(b,B,U),P=E.context;P.scale(1/e,1/l),P.translate(-z,-L),P.transform(...S),f.smask?this.smaskStack.push({canvas:E.canvas,context:P,offsetX:z,offsetY:L,scaleX:e,scaleY:l,subtype:f.smask.subtype,backdrop:f.smask.backdrop,transferMap:f.smask.transferMap||null,startTransformInverse:null}):(g.setTransform(1,0,0,1,0,0),g.translate(z,L),g.scale(e,l),g.save()),c(g,P),this.ctx=P,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(g),this.groupLevel++}endGroup(f){if(!this.contentVisible)return;this.groupLevel--;const g=this.ctx,S=this.groupStack.pop();if(this.ctx=S,this.ctx.imageSmoothingEnabled=!1,f.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const $=(0,_.getCurrentTransform)(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...$);const W=d.Util.getAxialAlignedBoundingBox([0,0,g.canvas.width,g.canvas.height],$);this.ctx.drawImage(g.canvas,0,0),this.ctx.restore(),this.compose(W)}}beginAnnotation(f,g,S,$,W){if(at(this,ut,ye).call(this),i(this.ctx),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),Array.isArray(g)&&g.length===4){const z=g[2]-g[0],L=g[3]-g[1];if(W&&this.annotationCanvasMap){S=S.slice(),S[4]-=g[0],S[5]-=g[1],g=g.slice(),g[0]=g[1]=0,g[2]=z,g[3]=L;const[B,U]=d.Util.singularValueDecompose2dScale((0,_.getCurrentTransform)(this.ctx)),{viewportScale:e}=this,l=Math.ceil(z*this.outputScaleX*e),b=Math.ceil(L*this.outputScaleY*e);this.annotationCanvas=this.canvasFactory.create(l,b);const{canvas:E,context:P}=this.annotationCanvas;this.annotationCanvasMap.set(f,E),this.annotationCanvas.savedCtx=this.ctx,this.ctx=P,this.ctx.save(),this.ctx.setTransform(B,0,0,-U,0,L*U),i(this.ctx)}else i(this.ctx),this.ctx.rect(g[0],g[1],z,L),this.ctx.clip(),this.endPath()}this.current=new C(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...S),this.transform(...$)}endAnnotation(){this.annotationCanvas&&(this.ctx.restore(),at(this,_t,Ae).call(this),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(f){if(!this.contentVisible)return;const g=f.count;f=this.getObject(f.data,f),f.count=g;const S=this.ctx,$=this.processingType3;if($&&($.compiled===void 0&&($.compiled=x(f)),$.compiled)){$.compiled(S);return}const W=this._createMaskCanvas(f),z=W.canvas;S.save(),S.setTransform(1,0,0,1,0,0),S.drawImage(z,W.offsetX,W.offsetY),S.restore(),this.compose()}paintImageMaskXObjectRepeat(f,g,S=0,$=0,W,z){if(!this.contentVisible)return;f=this.getObject(f.data,f);const L=this.ctx;L.save();const B=(0,_.getCurrentTransform)(L);L.transform(g,S,$,W,0,0);const U=this._createMaskCanvas(f);L.setTransform(1,0,0,1,U.offsetX-B[4],U.offsetY-B[5]);for(let e=0,l=z.length;e<l;e+=2){const b=d.Util.transform(B,[g,S,$,W,z[e],z[e+1]]),[E,P]=d.Util.applyTransform([0,0],b);L.drawImage(U.canvas,E,P)}L.restore(),this.compose()}paintImageMaskXObjectGroup(f){if(!this.contentVisible)return;const g=this.ctx,S=this.current.fillColor,$=this.current.patternFill;for(const W of f){const{data:z,width:L,height:B,transform:U}=W,e=this.cachedCanvases.getCanvas("maskCanvas",L,B),l=e.context;l.save();const b=this.getObject(z,W);t(l,b),l.globalCompositeOperation="source-in",l.fillStyle=$?S.getPattern(l,this,(0,_.getCurrentTransformInverse)(g),M.PathType.FILL):S,l.fillRect(0,0,L,B),l.restore(),g.save(),g.transform(...U),g.scale(1,-1),A(g,e.canvas,0,0,L,B,0,-1,1,1),g.restore()}this.compose()}paintImageXObject(f){if(!this.contentVisible)return;const g=this.getObject(f);if(!g){(0,d.warn)("Dependent image isn't ready yet");return}this.paintInlineImageXObject(g)}paintImageXObjectRepeat(f,g,S,$){if(!this.contentVisible)return;const W=this.getObject(f);if(!W){(0,d.warn)("Dependent image isn't ready yet");return}const z=W.width,L=W.height,B=[];for(let U=0,e=$.length;U<e;U+=2)B.push({transform:[g,0,0,S,$[U],$[U+1]],x:0,y:0,w:z,h:L});this.paintInlineImageXObjectGroup(W,B)}applyTransferMapsToCanvas(f){return this.current.transferMaps!=="none"&&(f.filter=this.current.transferMaps,f.drawImage(f.canvas,0,0),f.filter="none"),f.canvas}applyTransferMapsToBitmap(f){if(this.current.transferMaps==="none")return f.bitmap;const{bitmap:g,width:S,height:$}=f,W=this.cachedCanvases.getCanvas("inlineImage",S,$),z=W.context;return z.filter=this.current.transferMaps,z.drawImage(g,0,0),z.filter="none",W.canvas}paintInlineImageXObject(f){if(!this.contentVisible)return;const g=f.width,S=f.height,$=this.ctx;this.save(),Z.isNodeJS||($.filter="none"),$.scale(1/g,-1/S);let W;if(f.bitmap)W=this.applyTransferMapsToBitmap(f);else if(typeof HTMLElement=="function"&&f instanceof HTMLElement||!f.data)W=f;else{const B=this.cachedCanvases.getCanvas("inlineImage",g,S).context;m(B,f),W=this.applyTransferMapsToCanvas(B)}const z=this._scaleImage(W,(0,_.getCurrentTransformInverse)($));$.imageSmoothingEnabled=q((0,_.getCurrentTransform)($),f.interpolate),A($,z.img,0,0,z.paintWidth,z.paintHeight,0,-S,g,S),this.compose(),this.restore()}paintInlineImageXObjectGroup(f,g){if(!this.contentVisible)return;const S=this.ctx;let $;if(f.bitmap)$=f.bitmap;else{const W=f.width,z=f.height,B=this.cachedCanvases.getCanvas("inlineImage",W,z).context;m(B,f),$=this.applyTransferMapsToCanvas(B)}for(const W of g)S.save(),S.transform(...W.transform),S.scale(1,-1),A(S,$,W.x,W.y,W.w,W.h,0,-1,1,1),S.restore();this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(f){}markPointProps(f,g){}beginMarkedContent(f){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(f,g){f==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(g)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(f){const g=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(f);const S=this.ctx;this.pendingClip&&(g||(this.pendingClip===ct?S.clip("evenodd"):S.clip()),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox),S.beginPath()}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const f=(0,_.getCurrentTransform)(this.ctx);if(f[1]===0&&f[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(f[0]),Math.abs(f[3]));else{const g=Math.abs(f[0]*f[3]-f[2]*f[1]),S=Math.hypot(f[0],f[2]),$=Math.hypot(f[1],f[3]);this._cachedGetSinglePixelWidth=Math.max(S,$)/g}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(!this._cachedScaleForStroking){const{lineWidth:f}=this.current,g=(0,_.getCurrentTransform)(this.ctx);let S,$;if(g[1]===0&&g[2]===0){const W=Math.abs(g[0]),z=Math.abs(g[3]);if(f===0)S=1/W,$=1/z;else{const L=W*f,B=z*f;S=L<1?1/L:1,$=B<1?1/B:1}}else{const W=Math.abs(g[0]*g[3]-g[2]*g[1]),z=Math.hypot(g[0],g[1]),L=Math.hypot(g[2],g[3]);if(f===0)S=L/W,$=z/W;else{const B=f*W;S=L>B?L/B:1,$=z>B?z/B:1}}this._cachedScaleForStroking=[S,$]}return this._cachedScaleForStroking}rescaleAndStroke(f){const{ctx:g}=this,{lineWidth:S}=this.current,[$,W]=this.getScaleForStroking();if(g.lineWidth=S||1,$===1&&W===1){g.stroke();return}let z,L,B;f&&(z=(0,_.getCurrentTransform)(g),L=g.getLineDash().slice(),B=g.lineDashOffset),g.scale($,W);const U=Math.max($,W);g.setLineDash(g.getLineDash().map(e=>e/U)),g.lineDashOffset/=U,g.stroke(),f&&(g.setTransform(...z),g.setLineDash(L),g.lineDashOffset=B)}isContentVisible(){for(let f=this.markedContentStack.length-1;f>=0;f--)if(!this.markedContentStack[f].visible)return!1;return!0}};let nt=At;ut=new WeakSet,ye=function(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)},_t=new WeakSet,Ae=function(){if(this.pageColors){const f=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(f!=="none"){const g=this.ctx.filter;this.ctx.filter=f,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=g}}},a.CanvasGraphics=nt;for(const X in d.OPS)nt.prototype[X]!==void 0&&(nt.prototype[d.OPS[X]]=nt.prototype[X])},(G,a,I)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.TilingPattern=a.PathType=void 0,a.getShadingPattern=T;var d=I(1),_=I(6);const M={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};a.PathType=M;function H(A,x){if(!x)return;const C=x[2]-x[0],m=x[3]-x[1],t=new Path2D;t.rect(x[0],x[1],C,m),A.clip(t)}class Z{constructor(){this.constructor===Z&&(0,d.unreachable)("Cannot initialize BaseShadingPattern.")}getPattern(){(0,d.unreachable)("Abstract method `getPattern` called.")}}class O extends Z{constructor(x){super(),this._type=x[1],this._bbox=x[2],this._colorStops=x[3],this._p0=x[4],this._p1=x[5],this._r0=x[6],this._r1=x[7],this.matrix=null}_createGradient(x){let C;this._type==="axial"?C=x.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(C=x.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const m of this._colorStops)C.addColorStop(m[0],m[1]);return C}getPattern(x,C,m,t){let c;if(t===M.STROKE||t===M.FILL){const i=C.current.getClippedPathBoundingBox(t,(0,_.getCurrentTransform)(x))||[0,0,0,0],n=Math.ceil(i[2]-i[0])||1,h=Math.ceil(i[3]-i[1])||1,R=C.cachedCanvases.getCanvas("pattern",n,h,!0),s=R.context;s.clearRect(0,0,s.canvas.width,s.canvas.height),s.beginPath(),s.rect(0,0,s.canvas.width,s.canvas.height),s.translate(-i[0],-i[1]),m=d.Util.transform(m,[1,0,0,1,i[0],i[1]]),s.transform(...C.baseTransform),this.matrix&&s.transform(...this.matrix),H(s,this._bbox),s.fillStyle=this._createGradient(s),s.fill(),c=x.createPattern(R.canvas,"no-repeat");const D=new DOMMatrix(m);c.setTransform(D)}else H(x,this._bbox),c=this._createGradient(x);return c}}function F(A,x,C,m,t,c,i,n){const h=x.coords,R=x.colors,s=A.data,D=A.width*4;let q;h[C+1]>h[m+1]&&(q=C,C=m,m=q,q=c,c=i,i=q),h[m+1]>h[t+1]&&(q=m,m=t,t=q,q=i,i=n,n=q),h[C+1]>h[m+1]&&(q=C,C=m,m=q,q=c,c=i,i=q);const Y=(h[C]+x.offsetX)*x.scaleX,Q=(h[C+1]+x.offsetY)*x.scaleY,et=(h[m]+x.offsetX)*x.scaleX,ct=(h[m+1]+x.offsetY)*x.scaleY,nt=(h[t]+x.offsetX)*x.scaleX,ut=(h[t+1]+x.offsetY)*x.scaleY;if(Q>=ut)return;const mt=R[c],_t=R[c+1],xt=R[c+2],At=R[i],X=R[i+1],f=R[i+2],g=R[n],S=R[n+1],$=R[n+2],W=Math.round(Q),z=Math.round(ut);let L,B,U,e,l,b,E,P;for(let V=W;V<=z;V++){if(V<ct){let st;V<Q?st=0:st=(Q-V)/(Q-ct),L=Y-(Y-et)*st,B=mt-(mt-At)*st,U=_t-(_t-X)*st,e=xt-(xt-f)*st}else{let st;V>ut?st=1:ct===ut?st=0:st=(ct-V)/(ct-ut),L=et-(et-nt)*st,B=At-(At-g)*st,U=X-(X-S)*st,e=f-(f-$)*st}let it;V<Q?it=0:V>ut?it=1:it=(Q-V)/(Q-ut),l=Y-(Y-nt)*it,b=mt-(mt-g)*it,E=_t-(_t-S)*it,P=xt-(xt-$)*it;const J=Math.round(Math.min(L,l)),ot=Math.round(Math.max(L,l));let lt=D*V+J*4;for(let st=J;st<=ot;st++)it=(L-st)/(L-l),it<0?it=0:it>1&&(it=1),s[lt++]=B-(B-b)*it|0,s[lt++]=U-(U-E)*it|0,s[lt++]=e-(e-P)*it|0,s[lt++]=255}}function v(A,x,C){const m=x.coords,t=x.colors;let c,i;switch(x.type){case"lattice":const n=x.verticesPerRow,h=Math.floor(m.length/n)-1,R=n-1;for(c=0;c<h;c++){let s=c*n;for(let D=0;D<R;D++,s++)F(A,C,m[s],m[s+1],m[s+n],t[s],t[s+1],t[s+n]),F(A,C,m[s+n+1],m[s+1],m[s+n],t[s+n+1],t[s+1],t[s+n])}break;case"triangles":for(c=0,i=m.length;c<i;c+=3)F(A,C,m[c],m[c+1],m[c+2],t[c],t[c+1],t[c+2]);break;default:throw new Error("illegal figure")}}class j extends Z{constructor(x){super(),this._coords=x[2],this._colors=x[3],this._figures=x[4],this._bounds=x[5],this._bbox=x[7],this._background=x[8],this.matrix=null}_createMeshCanvas(x,C,m){const n=Math.floor(this._bounds[0]),h=Math.floor(this._bounds[1]),R=Math.ceil(this._bounds[2])-n,s=Math.ceil(this._bounds[3])-h,D=Math.min(Math.ceil(Math.abs(R*x[0]*1.1)),3e3),q=Math.min(Math.ceil(Math.abs(s*x[1]*1.1)),3e3),Y=R/D,Q=s/q,et={coords:this._coords,colors:this._colors,offsetX:-n,offsetY:-h,scaleX:1/Y,scaleY:1/Q},ct=D+2*2,nt=q+2*2,ut=m.getCanvas("mesh",ct,nt,!1),mt=ut.context,_t=mt.createImageData(D,q);if(C){const At=_t.data;for(let X=0,f=At.length;X<f;X+=4)At[X]=C[0],At[X+1]=C[1],At[X+2]=C[2],At[X+3]=255}for(const At of this._figures)v(_t,At,et);return mt.putImageData(_t,2,2),{canvas:ut.canvas,offsetX:n-2*Y,offsetY:h-2*Q,scaleX:Y,scaleY:Q}}getPattern(x,C,m,t){H(x,this._bbox);let c;if(t===M.SHADING)c=d.Util.singularValueDecompose2dScale((0,_.getCurrentTransform)(x));else if(c=d.Util.singularValueDecompose2dScale(C.baseTransform),this.matrix){const n=d.Util.singularValueDecompose2dScale(this.matrix);c=[c[0]*n[0],c[1]*n[1]]}const i=this._createMeshCanvas(c,t===M.SHADING?null:this._background,C.cachedCanvases);return t!==M.SHADING&&(x.setTransform(...C.baseTransform),this.matrix&&x.transform(...this.matrix)),x.translate(i.offsetX,i.offsetY),x.scale(i.scaleX,i.scaleY),x.createPattern(i.canvas,"no-repeat")}}class w extends Z{getPattern(){return"hotpink"}}function T(A){switch(A[0]){case"RadialAxial":return new O(A);case"Mesh":return new j(A);case"Dummy":return new w}throw new Error(`Unknown IR type: ${A[0]}`)}const p={COLORED:1,UNCOLORED:2},o=class{constructor(x,C,m,t,c){this.operatorList=x[2],this.matrix=x[3]||[1,0,0,1,0,0],this.bbox=x[4],this.xstep=x[5],this.ystep=x[6],this.paintType=x[7],this.tilingType=x[8],this.color=C,this.ctx=m,this.canvasGraphicsFactory=t,this.baseTransform=c}createPatternCanvas(x){const C=this.operatorList,m=this.bbox,t=this.xstep,c=this.ystep,i=this.paintType,n=this.tilingType,h=this.color,R=this.canvasGraphicsFactory;(0,d.info)("TilingType: "+n);const s=m[0],D=m[1],q=m[2],Y=m[3],Q=d.Util.singularValueDecompose2dScale(this.matrix),et=d.Util.singularValueDecompose2dScale(this.baseTransform),ct=[Q[0]*et[0],Q[1]*et[1]],nt=this.getSizeAndScale(t,this.ctx.canvas.width,ct[0]),ut=this.getSizeAndScale(c,this.ctx.canvas.height,ct[1]),mt=x.cachedCanvases.getCanvas("pattern",nt.size,ut.size,!0),_t=mt.context,xt=R.createCanvasGraphics(_t);xt.groupLevel=x.groupLevel,this.setFillAndStrokeStyleToContext(xt,i,h);let At=s,X=D,f=q,g=Y;return s<0&&(At=0,f+=Math.abs(s)),D<0&&(X=0,g+=Math.abs(D)),_t.translate(-(nt.scale*At),-(ut.scale*X)),xt.transform(nt.scale,0,0,ut.scale,0,0),_t.save(),this.clipBbox(xt,At,X,f,g),xt.baseTransform=(0,_.getCurrentTransform)(xt.ctx),xt.executeOperatorList(C),xt.endDrawing(),{canvas:mt.canvas,scaleX:nt.scale,scaleY:ut.scale,offsetX:At,offsetY:X}}getSizeAndScale(x,C,m){x=Math.abs(x);const t=Math.max(o.MAX_PATTERN_SIZE,C);let c=Math.ceil(x*m);return c>=t?c=t:m=c/x,{scale:m,size:c}}clipBbox(x,C,m,t,c){const i=t-C,n=c-m;x.ctx.rect(C,m,i,n),x.current.updateRectMinMax((0,_.getCurrentTransform)(x.ctx),[C,m,t,c]),x.clip(),x.endPath()}setFillAndStrokeStyleToContext(x,C,m){const t=x.ctx,c=x.current;switch(C){case p.COLORED:const i=this.ctx;t.fillStyle=i.fillStyle,t.strokeStyle=i.strokeStyle,c.fillColor=i.fillStyle,c.strokeColor=i.strokeStyle;break;case p.UNCOLORED:const n=d.Util.makeHexColor(m[0],m[1],m[2]);t.fillStyle=n,t.strokeStyle=n,c.fillColor=n,c.strokeColor=n;break;default:throw new d.FormatError(`Unsupported paint type: ${C}`)}}getPattern(x,C,m,t){let c=m;t!==M.SHADING&&(c=d.Util.transform(c,C.baseTransform),this.matrix&&(c=d.Util.transform(c,this.matrix)));const i=this.createPatternCanvas(C);let n=new DOMMatrix(c);n=n.translate(i.offsetX,i.offsetY),n=n.scale(1/i.scaleX,1/i.scaleY);const h=x.createPattern(i.canvas,"repeat");return h.setTransform(n),h}};let u=o;Lt(u,"MAX_PATTERN_SIZE",3e3),a.TilingPattern=u},(G,a,I)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.convertBlackAndWhiteToRGBA=M,a.convertToRGBA=_,a.grayToRGBA=Z;var d=I(1);function _(O){switch(O.kind){case d.ImageKind.GRAYSCALE_1BPP:return M(O);case d.ImageKind.RGB_24BPP:return H(O)}return null}function M({src:O,srcPos:F=0,dest:v,width:j,height:w,nonBlackColor:T=4294967295,inverseDecode:p=!1}){const u=d.FeatureTest.isLittleEndian?4278190080:255,[o,A]=p?[T,u]:[u,T],x=j>>3,C=j&7,m=O.length;v=new Uint32Array(v.buffer);let t=0;for(let c=0;c<w;c++){for(const n=F+x;F<n;F++){const h=F<m?O[F]:255;v[t++]=h&128?A:o,v[t++]=h&64?A:o,v[t++]=h&32?A:o,v[t++]=h&16?A:o,v[t++]=h&8?A:o,v[t++]=h&4?A:o,v[t++]=h&2?A:o,v[t++]=h&1?A:o}if(C===0)continue;const i=F<m?O[F++]:255;for(let n=0;n<C;n++)v[t++]=i&1<<7-n?A:o}return{srcPos:F,destPos:t}}function H({src:O,srcPos:F=0,dest:v,destPos:j=0,width:w,height:T}){let p=0;const u=O.length>>2,o=new Uint32Array(O.buffer,F,u);if(d.FeatureTest.isLittleEndian){for(;p<u-2;p+=3,j+=4){const A=o[p],x=o[p+1],C=o[p+2];v[j]=A|4278190080,v[j+1]=A>>>24|x<<8|4278190080,v[j+2]=x>>>16|C<<16|4278190080,v[j+3]=C>>>8|4278190080}for(let A=p*4,x=O.length;A<x;A+=3)v[j++]=O[A]|O[A+1]<<8|O[A+2]<<16|4278190080}else{for(;p<u-2;p+=3,j+=4){const A=o[p],x=o[p+1],C=o[p+2];v[j]=A|255,v[j+1]=A<<24|x>>>8|255,v[j+2]=x<<16|C>>>16|255,v[j+3]=C<<8|255}for(let A=p*4,x=O.length;A<x;A+=3)v[j++]=O[A]<<24|O[A+1]<<16|O[A+2]<<8|255}return{srcPos:F,destPos:j}}function Z(O,F){if(d.FeatureTest.isLittleEndian)for(let v=0,j=O.length;v<j;v++)F[v]=O[v]*65793|4278190080;else for(let v=0,j=O.length;v<j;v++)F[v]=O[v]*16843008|255}},(G,a)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.GlobalWorkerOptions=void 0;const I=Object.create(null);a.GlobalWorkerOptions=I,I.workerPort=null,I.workerSrc=""},(G,a,I)=>{var O,We,v,He,w,oe;Object.defineProperty(a,"__esModule",{value:!0}),a.MessageHandler=void 0;var d=I(1);const _={UNKNOWN:0,DATA:1,ERROR:2},M={UNKNOWN:0,CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function H(p){switch(p instanceof Error||typeof p=="object"&&p!==null||(0,d.unreachable)('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),p.name){case"AbortException":return new d.AbortException(p.message);case"MissingPDFException":return new d.MissingPDFException(p.message);case"PasswordException":return new d.PasswordException(p.message,p.code);case"UnexpectedResponseException":return new d.UnexpectedResponseException(p.message,p.status);case"UnknownErrorException":return new d.UnknownErrorException(p.message,p.details);default:return new d.UnknownErrorException(p.message,p.toString())}}class Z{constructor(u,o,A){tt(this,O);tt(this,v);tt(this,w);this.sourceName=u,this.targetName=o,this.comObj=A,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),this._onComObjOnMessage=x=>{const C=x.data;if(C.targetName!==this.sourceName)return;if(C.stream){at(this,v,He).call(this,C);return}if(C.callback){const t=C.callbackId,c=this.callbackCapabilities[t];if(!c)throw new Error(`Cannot resolve callback ${t}`);if(delete this.callbackCapabilities[t],C.callback===_.DATA)c.resolve(C.data);else if(C.callback===_.ERROR)c.reject(H(C.reason));else throw new Error("Unexpected callback case");return}const m=this.actionHandler[C.action];if(!m)throw new Error(`Unknown action from worker: ${C.action}`);if(C.callbackId){const t=this.sourceName,c=C.sourceName;new Promise(function(i){i(m(C.data))}).then(function(i){A.postMessage({sourceName:t,targetName:c,callback:_.DATA,callbackId:C.callbackId,data:i})},function(i){A.postMessage({sourceName:t,targetName:c,callback:_.ERROR,callbackId:C.callbackId,reason:H(i)})});return}if(C.streamId){at(this,O,We).call(this,C);return}m(C.data)},A.addEventListener("message",this._onComObjOnMessage)}on(u,o){const A=this.actionHandler;if(A[u])throw new Error(`There is already an actionName called "${u}"`);A[u]=o}send(u,o,A){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:u,data:o},A)}sendWithPromise(u,o,A){const x=this.callbackId++,C=new d.PromiseCapability;this.callbackCapabilities[x]=C;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:u,callbackId:x,data:o},A)}catch(m){C.reject(m)}return C.promise}sendWithStream(u,o,A,x){const C=this.streamId++,m=this.sourceName,t=this.targetName,c=this.comObj;return new ReadableStream({start:i=>{const n=new d.PromiseCapability;return this.streamControllers[C]={controller:i,startCall:n,pullCall:null,cancelCall:null,isClosed:!1},c.postMessage({sourceName:m,targetName:t,action:u,streamId:C,data:o,desiredSize:i.desiredSize},x),n.promise},pull:i=>{const n=new d.PromiseCapability;return this.streamControllers[C].pullCall=n,c.postMessage({sourceName:m,targetName:t,stream:M.PULL,streamId:C,desiredSize:i.desiredSize}),n.promise},cancel:i=>{(0,d.assert)(i instanceof Error,"cancel must have a valid reason");const n=new d.PromiseCapability;return this.streamControllers[C].cancelCall=n,this.streamControllers[C].isClosed=!0,c.postMessage({sourceName:m,targetName:t,stream:M.CANCEL,streamId:C,reason:H(i)}),n.promise}},A)}destroy(){this.comObj.removeEventListener("message",this._onComObjOnMessage)}}O=new WeakSet,We=function(u){const o=u.streamId,A=this.sourceName,x=u.sourceName,C=this.comObj,m=this,t=this.actionHandler[u.action],c={enqueue(i,n=1,h){if(this.isCancelled)return;const R=this.desiredSize;this.desiredSize-=n,R>0&&this.desiredSize<=0&&(this.sinkCapability=new d.PromiseCapability,this.ready=this.sinkCapability.promise),C.postMessage({sourceName:A,targetName:x,stream:M.ENQUEUE,streamId:o,chunk:i},h)},close(){this.isCancelled||(this.isCancelled=!0,C.postMessage({sourceName:A,targetName:x,stream:M.CLOSE,streamId:o}),delete m.streamSinks[o])},error(i){(0,d.assert)(i instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,C.postMessage({sourceName:A,targetName:x,stream:M.ERROR,streamId:o,reason:H(i)}))},sinkCapability:new d.PromiseCapability,onPull:null,onCancel:null,isCancelled:!1,desiredSize:u.desiredSize,ready:null};c.sinkCapability.resolve(),c.ready=c.sinkCapability.promise,this.streamSinks[o]=c,new Promise(function(i){i(t(u.data,c))}).then(function(){C.postMessage({sourceName:A,targetName:x,stream:M.START_COMPLETE,streamId:o,success:!0})},function(i){C.postMessage({sourceName:A,targetName:x,stream:M.START_COMPLETE,streamId:o,reason:H(i)})})},v=new WeakSet,He=function(u){const o=u.streamId,A=this.sourceName,x=u.sourceName,C=this.comObj,m=this.streamControllers[o],t=this.streamSinks[o];switch(u.stream){case M.START_COMPLETE:u.success?m.startCall.resolve():m.startCall.reject(H(u.reason));break;case M.PULL_COMPLETE:u.success?m.pullCall.resolve():m.pullCall.reject(H(u.reason));break;case M.PULL:if(!t){C.postMessage({sourceName:A,targetName:x,stream:M.PULL_COMPLETE,streamId:o,success:!0});break}t.desiredSize<=0&&u.desiredSize>0&&t.sinkCapability.resolve(),t.desiredSize=u.desiredSize,new Promise(function(c){var i;c((i=t.onPull)==null?void 0:i.call(t))}).then(function(){C.postMessage({sourceName:A,targetName:x,stream:M.PULL_COMPLETE,streamId:o,success:!0})},function(c){C.postMessage({sourceName:A,targetName:x,stream:M.PULL_COMPLETE,streamId:o,reason:H(c)})});break;case M.ENQUEUE:if((0,d.assert)(m,"enqueue should have stream controller"),m.isClosed)break;m.controller.enqueue(u.chunk);break;case M.CLOSE:if((0,d.assert)(m,"close should have stream controller"),m.isClosed)break;m.isClosed=!0,m.controller.close(),at(this,w,oe).call(this,m,o);break;case M.ERROR:(0,d.assert)(m,"error should have stream controller"),m.controller.error(H(u.reason)),at(this,w,oe).call(this,m,o);break;case M.CANCEL_COMPLETE:u.success?m.cancelCall.resolve():m.cancelCall.reject(H(u.reason)),at(this,w,oe).call(this,m,o);break;case M.CANCEL:if(!t)break;new Promise(function(c){var i;c((i=t.onCancel)==null?void 0:i.call(t,H(u.reason)))}).then(function(){C.postMessage({sourceName:A,targetName:x,stream:M.CANCEL_COMPLETE,streamId:o,success:!0})},function(c){C.postMessage({sourceName:A,targetName:x,stream:M.CANCEL_COMPLETE,streamId:o,reason:H(c)})}),t.sinkCapability.reject(H(u.reason)),t.isCancelled=!0,delete this.streamSinks[o];break;default:throw new Error("Unexpected stream case")}},w=new WeakSet,oe=async function(u,o){var A,x,C;await Promise.allSettled([(A=u.startCall)==null?void 0:A.promise,(x=u.pullCall)==null?void 0:x.promise,(C=u.cancelCall)==null?void 0:C.promise]),delete this.streamControllers[o]},a.MessageHandler=Z},(G,a,I)=>{var M,H;Object.defineProperty(a,"__esModule",{value:!0}),a.Metadata=void 0;var d=I(1);class _{constructor({parsedData:O,rawData:F}){tt(this,M,void 0);tt(this,H,void 0);gt(this,M,O),gt(this,H,F)}getRaw(){return y(this,H)}get(O){return y(this,M).get(O)??null}getAll(){return(0,d.objectFromMap)(y(this,M))}has(O){return y(this,M).has(O)}}M=new WeakMap,H=new WeakMap,a.Metadata=_},(G,a,I)=>{var O,F,v,j,w,T,_e;Object.defineProperty(a,"__esModule",{value:!0}),a.OptionalContentConfig=void 0;var d=I(1),_=I(8);const M=Symbol("INTERNAL");class H{constructor(o,A){tt(this,O,!0);this.name=o,this.intent=A}get visible(){return y(this,O)}_setVisible(o,A){o!==M&&(0,d.unreachable)("Internal method `_setVisible` called."),gt(this,O,A)}}O=new WeakMap;class Z{constructor(o){tt(this,T);tt(this,F,null);tt(this,v,new Map);tt(this,j,null);tt(this,w,null);if(this.name=null,this.creator=null,o!==null){this.name=o.name,this.creator=o.creator,gt(this,w,o.order);for(const A of o.groups)y(this,v).set(A.id,new H(A.name,A.intent));if(o.baseState==="OFF")for(const A of y(this,v).values())A._setVisible(M,!1);for(const A of o.on)y(this,v).get(A)._setVisible(M,!0);for(const A of o.off)y(this,v).get(A)._setVisible(M,!1);gt(this,j,this.getHash())}}isVisible(o){if(y(this,v).size===0)return!0;if(!o)return(0,d.warn)("Optional content group not defined."),!0;if(o.type==="OCG")return y(this,v).has(o.id)?y(this,v).get(o.id).visible:((0,d.warn)(`Optional content group not found: ${o.id}`),!0);if(o.type==="OCMD"){if(o.expression)return at(this,T,_e).call(this,o.expression);if(!o.policy||o.policy==="AnyOn"){for(const A of o.ids){if(!y(this,v).has(A))return(0,d.warn)(`Optional content group not found: ${A}`),!0;if(y(this,v).get(A).visible)return!0}return!1}else if(o.policy==="AllOn"){for(const A of o.ids){if(!y(this,v).has(A))return(0,d.warn)(`Optional content group not found: ${A}`),!0;if(!y(this,v).get(A).visible)return!1}return!0}else if(o.policy==="AnyOff"){for(const A of o.ids){if(!y(this,v).has(A))return(0,d.warn)(`Optional content group not found: ${A}`),!0;if(!y(this,v).get(A).visible)return!0}return!1}else if(o.policy==="AllOff"){for(const A of o.ids){if(!y(this,v).has(A))return(0,d.warn)(`Optional content group not found: ${A}`),!0;if(y(this,v).get(A).visible)return!1}return!0}return(0,d.warn)(`Unknown optional content policy ${o.policy}.`),!0}return(0,d.warn)(`Unknown group type ${o.type}.`),!0}setVisibility(o,A=!0){if(!y(this,v).has(o)){(0,d.warn)(`Optional content group not found: ${o}`);return}y(this,v).get(o)._setVisible(M,!!A),gt(this,F,null)}get hasInitialVisibility(){return this.getHash()===y(this,j)}getOrder(){return y(this,v).size?y(this,w)?y(this,w).slice():[...y(this,v).keys()]:null}getGroups(){return y(this,v).size>0?(0,d.objectFromMap)(y(this,v)):null}getGroup(o){return y(this,v).get(o)||null}getHash(){if(y(this,F)!==null)return y(this,F);const o=new _.MurmurHash3_64;for(const[A,x]of y(this,v))o.update(`${A}:${x.visible}`);return gt(this,F,o.hexdigest())}}F=new WeakMap,v=new WeakMap,j=new WeakMap,w=new WeakMap,T=new WeakSet,_e=function(o){const A=o.length;if(A<2)return!0;const x=o[0];for(let C=1;C<A;C++){const m=o[C];let t;if(Array.isArray(m))t=at(this,T,_e).call(this,m);else if(y(this,v).has(m))t=y(this,v).get(m).visible;else return(0,d.warn)(`Optional content group not found: ${m}`),!0;switch(x){case"And":if(!t)return!1;break;case"Or":if(t)return!0;break;case"Not":return!t;default:return!0}}return x==="And"},a.OptionalContentConfig=Z},(G,a,I)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.PDFDataTransportStream=void 0;var d=I(1),_=I(6);class M{constructor({length:F,initialData:v,progressiveDone:j=!1,contentDispositionFilename:w=null,disableRange:T=!1,disableStream:p=!1},u){if((0,d.assert)(u,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.'),this._queuedChunks=[],this._progressiveDone=j,this._contentDispositionFilename=w,(v==null?void 0:v.length)>0){const o=v instanceof Uint8Array&&v.byteLength===v.buffer.byteLength?v.buffer:new Uint8Array(v).buffer;this._queuedChunks.push(o)}this._pdfDataRangeTransport=u,this._isStreamingSupported=!p,this._isRangeSupported=!T,this._contentLength=F,this._fullRequestReader=null,this._rangeReaders=[],this._pdfDataRangeTransport.addRangeListener((o,A)=>{this._onReceiveData({begin:o,chunk:A})}),this._pdfDataRangeTransport.addProgressListener((o,A)=>{this._onProgress({loaded:o,total:A})}),this._pdfDataRangeTransport.addProgressiveReadListener(o=>{this._onReceiveData({chunk:o})}),this._pdfDataRangeTransport.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),this._pdfDataRangeTransport.transportReady()}_onReceiveData({begin:F,chunk:v}){const j=v instanceof Uint8Array&&v.byteLength===v.buffer.byteLength?v.buffer:new Uint8Array(v).buffer;if(F===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(j):this._queuedChunks.push(j);else{const w=this._rangeReaders.some(function(T){return T._begin!==F?!1:(T._enqueue(j),!0)});(0,d.assert)(w,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){var F;return((F=this._fullRequestReader)==null?void 0:F._loaded)??0}_onProgress(F){var v,j,w,T;F.total===void 0?(j=(v=this._rangeReaders[0])==null?void 0:v.onProgress)==null||j.call(v,{loaded:F.loaded}):(T=(w=this._fullRequestReader)==null?void 0:w.onProgress)==null||T.call(w,{loaded:F.loaded,total:F.total})}_onProgressiveDone(){var F;(F=this._fullRequestReader)==null||F.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(F){const v=this._rangeReaders.indexOf(F);v>=0&&this._rangeReaders.splice(v,1)}getFullReader(){(0,d.assert)(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const F=this._queuedChunks;return this._queuedChunks=null,new H(this,F,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(F,v){if(v<=this._progressiveDataLength)return null;const j=new Z(this,F,v);return this._pdfDataRangeTransport.requestDataRange(F,v),this._rangeReaders.push(j),j}cancelAllRequests(F){var v;(v=this._fullRequestReader)==null||v.cancel(F);for(const j of this._rangeReaders.slice(0))j.cancel(F);this._pdfDataRangeTransport.abort()}}a.PDFDataTransportStream=M;class H{constructor(F,v,j=!1,w=null){this._stream=F,this._done=j||!1,this._filename=(0,_.isPdfFile)(w)?w:null,this._queuedChunks=v||[],this._loaded=0;for(const T of this._queuedChunks)this._loaded+=T.byteLength;this._requests=[],this._headersReady=Promise.resolve(),F._fullRequestReader=this,this.onProgress=null}_enqueue(F){this._done||(this._requests.length>0?this._requests.shift().resolve({value:F,done:!1}):this._queuedChunks.push(F),this._loaded+=F.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const F=new d.PromiseCapability;return this._requests.push(F),F.promise}cancel(F){this._done=!0;for(const v of this._requests)v.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class Z{constructor(F,v,j){this._stream=F,this._begin=v,this._end=j,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(F){if(!this._done){if(this._requests.length===0)this._queuedChunk=F;else{this._requests.shift().resolve({value:F,done:!1});for(const j of this._requests)j.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const v=this._queuedChunk;return this._queuedChunk=null,{value:v,done:!1}}if(this._done)return{value:void 0,done:!0};const F=new d.PromiseCapability;return this._requests.push(F),F.promise}cancel(F){this._done=!0;for(const v of this._requests)v.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}},(G,a)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.XfaText=void 0;class I{static textContent(_){const M=[],H={items:M,styles:Object.create(null)};function Z(O){var j;if(!O)return;let F=null;const v=O.name;if(v==="#text")F=O.value;else if(I.shouldBuildText(v))(j=O==null?void 0:O.attributes)!=null&&j.textContent?F=O.attributes.textContent:O.value&&(F=O.value);else return;if(F!==null&&M.push({str:F}),!!O.children)for(const w of O.children)Z(w)}return Z(_),H}static shouldBuildText(_){return!(_==="textarea"||_==="input"||_==="option"||_==="select")}}a.XfaText=I},(G,a,I)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.NodeStandardFontDataFactory=a.NodeFilterFactory=a.NodeCanvasFactory=a.NodeCMapReaderFactory=void 0;var d=I(7);const _=function(F){return new Promise((v,j)=>{require$$5.readFile(F,(T,p)=>{if(T||!p){j(new Error(T));return}v(new Uint8Array(p))})})};class M extends d.BaseFilterFactory{}a.NodeFilterFactory=M;class H extends d.BaseCanvasFactory{_createCanvas(v,j){return require$$5.createCanvas(v,j)}}a.NodeCanvasFactory=H;class Z extends d.BaseCMapReaderFactory{_fetchData(v,j){return _(v).then(w=>({cMapData:w,compressionType:j}))}}a.NodeCMapReaderFactory=Z;class O extends d.BaseStandardFontDataFactory{_fetchData(v){return _(v)}}a.NodeStandardFontDataFactory=O},(G,a,I)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.PDFNodeStream=void 0;var d=I(1),_=I(22);const M=require$$5,H=require$$5,Z=require$$5,O=require$$5,F=/^file:\/\/\/[a-zA-Z]:\//;function v(C){const m=O.parse(C);return m.protocol==="file:"||m.host?m:/^[a-z]:[/\\]/i.test(C)?O.parse(`file:///${C}`):(m.host||(m.protocol="file:"),m)}class j{constructor(m){this.source=m,this.url=v(m.url),this.isHttp=this.url.protocol==="http:"||this.url.protocol==="https:",this.isFsUrl=this.url.protocol==="file:",this.httpHeaders=this.isHttp&&m.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var m;return((m=this._fullRequestReader)==null?void 0:m._loaded)??0}getFullReader(){return(0,d.assert)(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=this.isFsUrl?new A(this):new u(this),this._fullRequestReader}getRangeReader(m,t){if(t<=this._progressiveDataLength)return null;const c=this.isFsUrl?new x(this,m,t):new o(this,m,t);return this._rangeRequestReaders.push(c),c}cancelAllRequests(m){var t;(t=this._fullRequestReader)==null||t.cancel(m);for(const c of this._rangeRequestReaders.slice(0))c.cancel(m)}}a.PDFNodeStream=j;class w{constructor(m){this._url=m.url,this._done=!1,this._storedError=null,this.onProgress=null;const t=m.source;this._contentLength=t.length,this._loaded=0,this._filename=null,this._disableRange=t.disableRange||!1,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!t.disableStream,this._isRangeSupported=!t.disableRange,this._readableStream=null,this._readCapability=new d.PromiseCapability,this._headersCapability=new d.PromiseCapability}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var c;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const m=this._readableStream.read();return m===null?(this._readCapability=new d.PromiseCapability,this.read()):(this._loaded+=m.length,(c=this.onProgress)==null||c.call(this,{loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(m).buffer,done:!1})}cancel(m){if(!this._readableStream){this._error(m);return}this._readableStream.destroy(m)}_error(m){this._storedError=m,this._readCapability.resolve()}_setReadableStream(m){this._readableStream=m,m.on("readable",()=>{this._readCapability.resolve()}),m.on("end",()=>{m.destroy(),this._done=!0,this._readCapability.resolve()}),m.on("error",t=>{this._error(t)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new d.AbortException("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class T{constructor(m){this._url=m.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=new d.PromiseCapability;const t=m.source;this._isStreamingSupported=!t.disableStream}get isStreamingSupported(){return this._isStreamingSupported}async read(){var c;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const m=this._readableStream.read();return m===null?(this._readCapability=new d.PromiseCapability,this.read()):(this._loaded+=m.length,(c=this.onProgress)==null||c.call(this,{loaded:this._loaded}),{value:new Uint8Array(m).buffer,done:!1})}cancel(m){if(!this._readableStream){this._error(m);return}this._readableStream.destroy(m)}_error(m){this._storedError=m,this._readCapability.resolve()}_setReadableStream(m){this._readableStream=m,m.on("readable",()=>{this._readCapability.resolve()}),m.on("end",()=>{m.destroy(),this._done=!0,this._readCapability.resolve()}),m.on("error",t=>{this._error(t)}),this._storedError&&this._readableStream.destroy(this._storedError)}}function p(C,m){return{protocol:C.protocol,auth:C.auth,host:C.hostname,port:C.port,path:C.path,method:"GET",headers:m}}class u extends w{constructor(m){super(m);const t=c=>{if(c.statusCode===404){const R=new d.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=R,this._headersCapability.reject(R);return}this._headersCapability.resolve(),this._setReadableStream(c);const i=R=>this._readableStream.headers[R.toLowerCase()],{allowRangeRequests:n,suggestedLength:h}=(0,_.validateRangeRequestCapabilities)({getResponseHeader:i,isHttp:m.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=n,this._contentLength=h||this._contentLength,this._filename=(0,_.extractFilenameFromHeader)(i)};this._request=null,this._url.protocol==="http:"?this._request=H.request(p(this._url,m.httpHeaders),t):this._request=Z.request(p(this._url,m.httpHeaders),t),this._request.on("error",c=>{this._storedError=c,this._headersCapability.reject(c)}),this._request.end()}}class o extends T{constructor(m,t,c){super(m),this._httpHeaders={};for(const n in m.httpHeaders){const h=m.httpHeaders[n];h!==void 0&&(this._httpHeaders[n]=h)}this._httpHeaders.Range=`bytes=${t}-${c-1}`;const i=n=>{if(n.statusCode===404){const h=new d.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=h;return}this._setReadableStream(n)};this._request=null,this._url.protocol==="http:"?this._request=H.request(p(this._url,this._httpHeaders),i):this._request=Z.request(p(this._url,this._httpHeaders),i),this._request.on("error",n=>{this._storedError=n}),this._request.end()}}class A extends w{constructor(m){super(m);let t=decodeURIComponent(this._url.path);F.test(this._url.href)&&(t=t.replace(/^\//,"")),M.lstat(t,(c,i)=>{if(c){c.code==="ENOENT"&&(c=new d.MissingPDFException(`Missing PDF "${t}".`)),this._storedError=c,this._headersCapability.reject(c);return}this._contentLength=i.size,this._setReadableStream(M.createReadStream(t)),this._headersCapability.resolve()})}}class x extends T{constructor(m,t,c){super(m);let i=decodeURIComponent(this._url.path);F.test(this._url.href)&&(i=i.replace(/^\//,"")),this._setReadableStream(M.createReadStream(i,{start:t,end:c-1}))}}},(G,a,I)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.createResponseStatusError=O,a.extractFilenameFromHeader=Z,a.validateRangeRequestCapabilities=H,a.validateResponseStatus=F;var d=I(1),_=I(23),M=I(6);function H({getResponseHeader:v,isHttp:j,rangeChunkSize:w,disableRange:T}){const p={allowRangeRequests:!1,suggestedLength:void 0},u=parseInt(v("Content-Length"),10);return!Number.isInteger(u)||(p.suggestedLength=u,u<=2*w)||T||!j||v("Accept-Ranges")!=="bytes"||(v("Content-Encoding")||"identity")!=="identity"||(p.allowRangeRequests=!0),p}function Z(v){const j=v("Content-Disposition");if(j){let w=(0,_.getFilenameFromContentDispositionHeader)(j);if(w.includes("%"))try{w=decodeURIComponent(w)}catch{}if((0,M.isPdfFile)(w))return w}return null}function O(v,j){return v===404||v===0&&j.startsWith("file:")?new d.MissingPDFException('Missing PDF "'+j+'".'):new d.UnexpectedResponseException(`Unexpected server response (${v}) while retrieving PDF "${j}".`,v)}function F(v){return v===200||v===206}},(G,a,I)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.getFilenameFromContentDispositionHeader=_;var d=I(1);function _(M){let H=!0,Z=O("filename\\*","i").exec(M);if(Z){Z=Z[1];let u=w(Z);return u=unescape(u),u=T(u),u=p(u),v(u)}if(Z=j(M),Z){const u=p(Z);return v(u)}if(Z=O("filename","i").exec(M),Z){Z=Z[1];let u=w(Z);return u=p(u),v(u)}function O(u,o){return new RegExp("(?:^|;)\\s*"+u+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',o)}function F(u,o){if(u){if(!/^[\x00-\xFF]+$/.test(o))return o;try{const A=new TextDecoder(u,{fatal:!0}),x=(0,d.stringToBytes)(o);o=A.decode(x),H=!1}catch{}}return o}function v(u){return H&&/[\x80-\xff]/.test(u)&&(u=F("utf-8",u),H&&(u=F("iso-8859-1",u))),u}function j(u){const o=[];let A;const x=O("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(A=x.exec(u))!==null;){let[,m,t,c]=A;if(m=parseInt(m,10),m in o){if(m===0)break;continue}o[m]=[t,c]}const C=[];for(let m=0;m<o.length&&m in o;++m){let[t,c]=o[m];c=w(c),t&&(c=unescape(c),m===0&&(c=T(c))),C.push(c)}return C.join("")}function w(u){if(u.startsWith('"')){const o=u.slice(1).split('\\"');for(let A=0;A<o.length;++A){const x=o[A].indexOf('"');x!==-1&&(o[A]=o[A].slice(0,x),o.length=A+1),o[A]=o[A].replaceAll(/\\(.)/g,"$1")}u=o.join('"')}return u}function T(u){const o=u.indexOf("'");if(o===-1)return u;const A=u.slice(0,o),C=u.slice(o+1).replace(/^[^']*'/,"");return F(A,C)}function p(u){return!u.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(u)?u:u.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(o,A,x,C){if(x==="q"||x==="Q")return C=C.replaceAll("_"," "),C=C.replaceAll(/=([0-9a-fA-F]{2})/g,function(m,t){return String.fromCharCode(parseInt(t,16))}),F(A,C);try{C=atob(C)}catch{}return F(A,C)})}return""}},(G,a,I)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.PDFNetworkStream=void 0;var d=I(1),_=I(22);const M=200,H=206;function Z(w){const T=w.response;return typeof T!="string"?T:(0,d.stringToBytes)(T).buffer}class O{constructor(T,p={}){this.url=T,this.isHttp=/^https?:/i.test(T),this.httpHeaders=this.isHttp&&p.httpHeaders||Object.create(null),this.withCredentials=p.withCredentials||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}requestRange(T,p,u){const o={begin:T,end:p};for(const A in u)o[A]=u[A];return this.request(o)}requestFull(T){return this.request(T)}request(T){const p=new XMLHttpRequest,u=this.currXhrId++,o=this.pendingRequests[u]={xhr:p};p.open("GET",this.url),p.withCredentials=this.withCredentials;for(const A in this.httpHeaders){const x=this.httpHeaders[A];x!==void 0&&p.setRequestHeader(A,x)}return this.isHttp&&"begin"in T&&"end"in T?(p.setRequestHeader("Range",`bytes=${T.begin}-${T.end-1}`),o.expectedStatus=H):o.expectedStatus=M,p.responseType="arraybuffer",T.onError&&(p.onerror=function(A){T.onError(p.status)}),p.onreadystatechange=this.onStateChange.bind(this,u),p.onprogress=this.onProgress.bind(this,u),o.onHeadersReceived=T.onHeadersReceived,o.onDone=T.onDone,o.onError=T.onError,o.onProgress=T.onProgress,p.send(null),u}onProgress(T,p){var o;const u=this.pendingRequests[T];u&&((o=u.onProgress)==null||o.call(u,p))}onStateChange(T,p){var m,t,c;const u=this.pendingRequests[T];if(!u)return;const o=u.xhr;if(o.readyState>=2&&u.onHeadersReceived&&(u.onHeadersReceived(),delete u.onHeadersReceived),o.readyState!==4||!(T in this.pendingRequests))return;if(delete this.pendingRequests[T],o.status===0&&this.isHttp){(m=u.onError)==null||m.call(u,o.status);return}const A=o.status||M;if(!(A===M&&u.expectedStatus===H)&&A!==u.expectedStatus){(t=u.onError)==null||t.call(u,o.status);return}const C=Z(o);if(A===H){const i=o.getResponseHeader("Content-Range"),n=/bytes (\d+)-(\d+)\/(\d+)/.exec(i);u.onDone({begin:parseInt(n[1],10),chunk:C})}else C?u.onDone({begin:0,chunk:C}):(c=u.onError)==null||c.call(u,o.status)}getRequestXhr(T){return this.pendingRequests[T].xhr}isPendingRequest(T){return T in this.pendingRequests}abortRequest(T){const p=this.pendingRequests[T].xhr;delete this.pendingRequests[T],p.abort()}}class F{constructor(T){this._source=T,this._manager=new O(T.url,{httpHeaders:T.httpHeaders,withCredentials:T.withCredentials}),this._rangeChunkSize=T.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(T){const p=this._rangeRequestReaders.indexOf(T);p>=0&&this._rangeRequestReaders.splice(p,1)}getFullReader(){return(0,d.assert)(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new v(this._manager,this._source),this._fullRequestReader}getRangeReader(T,p){const u=new j(this._manager,T,p);return u.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(u),u}cancelAllRequests(T){var p;(p=this._fullRequestReader)==null||p.cancel(T);for(const u of this._rangeRequestReaders.slice(0))u.cancel(T)}}a.PDFNetworkStream=F;class v{constructor(T,p){this._manager=T;const u={onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=p.url,this._fullRequestId=T.requestFull(u),this._headersReceivedCapability=new d.PromiseCapability,this._disableRange=p.disableRange||!1,this._contentLength=p.length,this._rangeChunkSize=p.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const T=this._fullRequestId,p=this._manager.getRequestXhr(T),u=x=>p.getResponseHeader(x),{allowRangeRequests:o,suggestedLength:A}=(0,_.validateRangeRequestCapabilities)({getResponseHeader:u,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});o&&(this._isRangeSupported=!0),this._contentLength=A||this._contentLength,this._filename=(0,_.extractFilenameFromHeader)(u),this._isRangeSupported&&this._manager.abortRequest(T),this._headersReceivedCapability.resolve()}_onDone(T){if(T&&(this._requests.length>0?this._requests.shift().resolve({value:T.chunk,done:!1}):this._cachedChunks.push(T.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const p of this._requests)p.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(T){this._storedError=(0,_.createResponseStatusError)(T,this._url),this._headersReceivedCapability.reject(this._storedError);for(const p of this._requests)p.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(T){var p;(p=this.onProgress)==null||p.call(this,{loaded:T.loaded,total:T.lengthComputable?T.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersReceivedCapability.promise}async read(){if(this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const T=new d.PromiseCapability;return this._requests.push(T),T.promise}cancel(T){this._done=!0,this._headersReceivedCapability.reject(T);for(const p of this._requests)p.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class j{constructor(T,p,u){this._manager=T;const o={onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=T.url,this._requestId=T.requestRange(p,u,o),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_close(){var T;(T=this.onClosed)==null||T.call(this,this)}_onDone(T){const p=T.chunk;this._requests.length>0?this._requests.shift().resolve({value:p,done:!1}):this._queuedChunk=p,this._done=!0;for(const u of this._requests)u.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(T){this._storedError=(0,_.createResponseStatusError)(T,this._url);for(const p of this._requests)p.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(T){var p;this.isStreamingSupported||(p=this.onProgress)==null||p.call(this,{loaded:T.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const p=this._queuedChunk;return this._queuedChunk=null,{value:p,done:!1}}if(this._done)return{value:void 0,done:!0};const T=new d.PromiseCapability;return this._requests.push(T),T.promise}cancel(T){this._done=!0;for(const p of this._requests)p.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}},(G,a,I)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.PDFFetchStream=void 0;var d=I(1),_=I(22);function M(j,w,T){return{method:"GET",headers:j,signal:T.signal,mode:"cors",credentials:w?"include":"same-origin",redirect:"follow"}}function H(j){const w=new Headers;for(const T in j){const p=j[T];p!==void 0&&w.append(T,p)}return w}function Z(j){return j instanceof Uint8Array?j.buffer:j instanceof ArrayBuffer?j:((0,d.warn)(`getArrayBuffer - unexpected data format: ${j}`),new Uint8Array(j).buffer)}class O{constructor(w){this.source=w,this.isHttp=/^https?:/i.test(w.url),this.httpHeaders=this.isHttp&&w.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var w;return((w=this._fullRequestReader)==null?void 0:w._loaded)??0}getFullReader(){return(0,d.assert)(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new F(this),this._fullRequestReader}getRangeReader(w,T){if(T<=this._progressiveDataLength)return null;const p=new v(this,w,T);return this._rangeRequestReaders.push(p),p}cancelAllRequests(w){var T;(T=this._fullRequestReader)==null||T.cancel(w);for(const p of this._rangeRequestReaders.slice(0))p.cancel(w)}}a.PDFFetchStream=O;class F{constructor(w){this._stream=w,this._reader=null,this._loaded=0,this._filename=null;const T=w.source;this._withCredentials=T.withCredentials||!1,this._contentLength=T.length,this._headersCapability=new d.PromiseCapability,this._disableRange=T.disableRange||!1,this._rangeChunkSize=T.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!T.disableStream,this._isRangeSupported=!T.disableRange,this._headers=H(this._stream.httpHeaders);const p=T.url;fetch(p,M(this._headers,this._withCredentials,this._abortController)).then(u=>{if(!(0,_.validateResponseStatus)(u.status))throw(0,_.createResponseStatusError)(u.status,p);this._reader=u.body.getReader(),this._headersCapability.resolve();const o=C=>u.headers.get(C),{allowRangeRequests:A,suggestedLength:x}=(0,_.validateRangeRequestCapabilities)({getResponseHeader:o,isHttp:this._stream.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=A,this._contentLength=x||this._contentLength,this._filename=(0,_.extractFilenameFromHeader)(o),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new d.AbortException("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var p;await this._headersCapability.promise;const{value:w,done:T}=await this._reader.read();return T?{value:w,done:T}:(this._loaded+=w.byteLength,(p=this.onProgress)==null||p.call(this,{loaded:this._loaded,total:this._contentLength}),{value:Z(w),done:!1})}cancel(w){var T;(T=this._reader)==null||T.cancel(w),this._abortController.abort()}}class v{constructor(w,T,p){this._stream=w,this._reader=null,this._loaded=0;const u=w.source;this._withCredentials=u.withCredentials||!1,this._readCapability=new d.PromiseCapability,this._isStreamingSupported=!u.disableStream,this._abortController=new AbortController,this._headers=H(this._stream.httpHeaders),this._headers.append("Range",`bytes=${T}-${p-1}`);const o=u.url;fetch(o,M(this._headers,this._withCredentials,this._abortController)).then(A=>{if(!(0,_.validateResponseStatus)(A.status))throw(0,_.createResponseStatusError)(A.status,o);this._readCapability.resolve(),this._reader=A.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){var p;await this._readCapability.promise;const{value:w,done:T}=await this._reader.read();return T?{value:w,done:T}:(this._loaded+=w.byteLength,(p=this.onProgress)==null||p.call(this,{loaded:this._loaded}),{value:Z(w),done:!1})}cancel(w){var T;(T=this._reader)==null||T.cancel(w),this._abortController.abort()}}},(G,a,I)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.TextLayerRenderTask=void 0,a.renderTextLayer=u,a.updateTextLayer=o;var d=I(1),_=I(6);const M=1e5,H=30,Z=.8,O=new Map;function F(A,x){let C;if(x&&d.FeatureTest.isOffscreenCanvasSupported)C=new OffscreenCanvas(A,A).getContext("2d",{alpha:!1});else{const m=document.createElement("canvas");m.width=m.height=A,C=m.getContext("2d",{alpha:!1})}return C}function v(A,x){const C=O.get(A);if(C)return C;const m=F(H,x);m.font=`${H}px ${A}`;const t=m.measureText("");let c=t.fontBoundingBoxAscent,i=Math.abs(t.fontBoundingBoxDescent);if(c){const h=c/(c+i);return O.set(A,h),m.canvas.width=m.canvas.height=0,h}m.strokeStyle="red",m.clearRect(0,0,H,H),m.strokeText("g",0,0);let n=m.getImageData(0,0,H,H).data;i=0;for(let h=n.length-1-3;h>=0;h-=4)if(n[h]>0){i=Math.ceil(h/4/H);break}m.clearRect(0,0,H,H),m.strokeText("A",0,H),n=m.getImageData(0,0,H,H).data,c=0;for(let h=0,R=n.length;h<R;h+=4)if(n[h]>0){c=H-Math.floor(h/4/H);break}if(m.canvas.width=m.canvas.height=0,c){const h=c/(c+i);return O.set(A,h),h}return O.set(A,Z),Z}function j(A,x,C){const m=document.createElement("span"),t={angle:0,canvasWidth:0,hasText:x.str!=="",hasEOL:x.hasEOL,fontSize:0};A._textDivs.push(m);const c=d.Util.transform(A._transform,x.transform);let i=Math.atan2(c[1],c[0]);const n=C[x.fontName];n.vertical&&(i+=Math.PI/2);const h=Math.hypot(c[2],c[3]),R=h*v(n.fontFamily,A._isOffscreenCanvasSupported);let s,D;i===0?(s=c[4],D=c[5]-R):(s=c[4]+R*Math.sin(i),D=c[5]-R*Math.cos(i));const q="calc(var(--scale-factor)*",Y=m.style;A._container===A._rootContainer?(Y.left=`${(100*s/A._pageWidth).toFixed(2)}%`,Y.top=`${(100*D/A._pageHeight).toFixed(2)}%`):(Y.left=`${q}${s.toFixed(2)}px)`,Y.top=`${q}${D.toFixed(2)}px)`),Y.fontSize=`${q}${h.toFixed(2)}px)`,Y.fontFamily=n.fontFamily,t.fontSize=h,m.setAttribute("role","presentation"),m.textContent=x.str,m.dir=x.dir,A._fontInspectorEnabled&&(m.dataset.fontName=x.fontName),i!==0&&(t.angle=i*(180/Math.PI));let Q=!1;if(x.str.length>1)Q=!0;else if(x.str!==" "&&x.transform[0]!==x.transform[3]){const et=Math.abs(x.transform[0]),ct=Math.abs(x.transform[3]);et!==ct&&Math.max(et,ct)/Math.min(et,ct)>1.5&&(Q=!0)}Q&&(t.canvasWidth=n.vertical?x.height:x.width),A._textDivProperties.set(m,t),A._isReadableStream&&A._layoutText(m)}function w(A){const{div:x,scale:C,properties:m,ctx:t,prevFontSize:c,prevFontFamily:i}=A,{style:n}=x;let h="";if(m.canvasWidth!==0&&m.hasText){const{fontFamily:R}=n,{canvasWidth:s,fontSize:D}=m;(c!==D||i!==R)&&(t.font=`${D*C}px ${R}`,A.prevFontSize=D,A.prevFontFamily=R);const{width:q}=t.measureText(x.textContent);q>0&&(h=`scaleX(${s*C/q})`)}m.angle!==0&&(h=`rotate(${m.angle}deg) ${h}`),h.length>0&&(n.transform=h)}function T(A){if(A._canceled)return;const x=A._textDivs,C=A._capability;if(x.length>M){C.resolve();return}if(!A._isReadableStream)for(const t of x)A._layoutText(t);C.resolve()}class p{constructor({textContentSource:x,container:C,viewport:m,textDivs:t,textDivProperties:c,textContentItemsStr:i,isOffscreenCanvasSupported:n}){var q;this._textContentSource=x,this._isReadableStream=x instanceof ReadableStream,this._container=this._rootContainer=C,this._textDivs=t||[],this._textContentItemsStr=i||[],this._isOffscreenCanvasSupported=n,this._fontInspectorEnabled=!!((q=globalThis.FontInspector)!=null&&q.enabled),this._reader=null,this._textDivProperties=c||new WeakMap,this._canceled=!1,this._capability=new d.PromiseCapability,this._layoutTextParams={prevFontSize:null,prevFontFamily:null,div:null,scale:m.scale*(globalThis.devicePixelRatio||1),properties:null,ctx:F(0,n)};const{pageWidth:h,pageHeight:R,pageX:s,pageY:D}=m.rawDims;this._transform=[1,0,0,-1,-s,D+R],this._pageWidth=h,this._pageHeight=R,(0,_.setLayerDimensions)(C,m),this._capability.promise.finally(()=>{this._layoutTextParams=null}).catch(()=>{})}get promise(){return this._capability.promise}cancel(){this._canceled=!0,this._reader&&(this._reader.cancel(new d.AbortException("TextLayer task cancelled.")).catch(()=>{}),this._reader=null),this._capability.reject(new d.AbortException("TextLayer task cancelled."))}_processItems(x,C){for(const m of x){if(m.str===void 0){if(m.type==="beginMarkedContentProps"||m.type==="beginMarkedContent"){const t=this._container;this._container=document.createElement("span"),this._container.classList.add("markedContent"),m.id!==null&&this._container.setAttribute("id",`${m.id}`),t.append(this._container)}else m.type==="endMarkedContent"&&(this._container=this._container.parentNode);continue}this._textContentItemsStr.push(m.str),j(this,m,C)}}_layoutText(x){const C=this._layoutTextParams.properties=this._textDivProperties.get(x);if(this._layoutTextParams.div=x,w(this._layoutTextParams),C.hasText&&this._container.append(x),C.hasEOL){const m=document.createElement("br");m.setAttribute("role","presentation"),this._container.append(m)}}_render(){const x=new d.PromiseCapability;let C=Object.create(null);if(this._isReadableStream){const m=()=>{this._reader.read().then(({value:t,done:c})=>{if(c){x.resolve();return}Object.assign(C,t.styles),this._processItems(t.items,C),m()},x.reject)};this._reader=this._textContentSource.getReader(),m()}else if(this._textContentSource){const{items:m,styles:t}=this._textContentSource;this._processItems(m,t),x.resolve()}else throw new Error('No "textContentSource" parameter specified.');x.promise.then(()=>{C=null,T(this)},this._capability.reject)}}a.TextLayerRenderTask=p;function u(A){!A.textContentSource&&(A.textContent||A.textContentStream)&&((0,_.deprecated)("The TextLayerRender `textContent`/`textContentStream` parameters will be removed in the future, please use `textContentSource` instead."),A.textContentSource=A.textContent||A.textContentStream);const{container:x,viewport:C}=A,m=getComputedStyle(x),t=m.getPropertyValue("visibility"),c=parseFloat(m.getPropertyValue("--scale-factor"));t==="visible"&&(!c||Math.abs(c-C.scale)>1e-5)&&console.error("The `--scale-factor` CSS-variable must be set, to the same value as `viewport.scale`, either on the `container`-element itself or higher up in the DOM.");const i=new p(A);return i._render(),i}function o({container:A,viewport:x,textDivs:C,textDivProperties:m,isOffscreenCanvasSupported:t,mustRotate:c=!0,mustRescale:i=!0}){if(c&&(0,_.setLayerDimensions)(A,{rotation:x.rotation}),i){const n=F(0,t),R={prevFontSize:null,prevFontFamily:null,div:null,scale:x.scale*(globalThis.devicePixelRatio||1),properties:null,ctx:n};for(const s of C)R.properties=m.get(s),R.div=s,w(R)}}},(G,a,I)=>{var F,v,j,w,T,p,u,o,A,ve,C,$e,t,Ee,i,xe;Object.defineProperty(a,"__esModule",{value:!0}),a.AnnotationEditorLayer=void 0;var d=I(1),_=I(5),M=I(28),H=I(29),Z=I(6);const h=class{constructor(s){tt(this,A);tt(this,C);tt(this,t);tt(this,i);tt(this,F,void 0);tt(this,v,!1);tt(this,j,this.pointerup.bind(this));tt(this,w,this.pointerdown.bind(this));tt(this,T,new Map);tt(this,p,!1);tt(this,u,!1);tt(this,o,void 0);h._initialized||(h._initialized=!0,M.FreeTextEditor.initialize(s.l10n),H.InkEditor.initialize(s.l10n)),s.uiManager.registerEditorTypes([M.FreeTextEditor,H.InkEditor]),gt(this,o,s.uiManager),this.pageIndex=s.pageIndex,this.div=s.div,gt(this,F,s.accessibilityManager),y(this,o).addLayer(this)}get isEmpty(){return y(this,T).size===0}updateToolbar(s){y(this,o).updateToolbar(s)}updateMode(s=y(this,o).getMode()){at(this,i,xe).call(this),s===d.AnnotationEditorType.INK?(this.addInkEditorIfNeeded(!1),this.disableClick()):this.enableClick(),y(this,o).unselectAll(),s!==d.AnnotationEditorType.NONE&&(this.div.classList.toggle("freeTextEditing",s===d.AnnotationEditorType.FREETEXT),this.div.classList.toggle("inkEditing",s===d.AnnotationEditorType.INK),this.div.hidden=!1)}addInkEditorIfNeeded(s){if(!s&&y(this,o).getMode()!==d.AnnotationEditorType.INK)return;if(!s){for(const q of y(this,T).values())if(q.isEmpty()){q.setInBackground();return}}at(this,t,Ee).call(this,{offsetX:0,offsetY:0}).setInBackground()}setEditingState(s){y(this,o).setEditingState(s)}addCommands(s){y(this,o).addCommands(s)}enable(){this.div.style.pointerEvents="auto";for(const s of y(this,T).values())s.enableEditing()}disable(){this.div.style.pointerEvents="none";for(const s of y(this,T).values())s.disableEditing();at(this,i,xe).call(this),this.isEmpty&&(this.div.hidden=!0)}setActiveEditor(s){y(this,o).getActive()!==s&&y(this,o).setActiveEditor(s)}enableClick(){this.div.addEventListener("pointerdown",y(this,w)),this.div.addEventListener("pointerup",y(this,j))}disableClick(){this.div.removeEventListener("pointerdown",y(this,w)),this.div.removeEventListener("pointerup",y(this,j))}attach(s){y(this,T).set(s.id,s)}detach(s){var D;y(this,T).delete(s.id),(D=y(this,F))==null||D.removePointerInTextLayer(s.contentDiv)}remove(s){y(this,o).removeEditor(s),this.detach(s),s.div.style.display="none",setTimeout(()=>{s.div.style.display="",s.div.remove(),s.isAttachedToDOM=!1,document.activeElement===document.body&&y(this,o).focusMainContainer()},0),y(this,u)||this.addInkEditorIfNeeded(!1)}add(s){if(at(this,A,ve).call(this,s),y(this,o).addEditor(s),this.attach(s),!s.isAttachedToDOM){const D=s.render();this.div.append(D),s.isAttachedToDOM=!0}this.moveEditorInDOM(s),s.onceAdded(),y(this,o).addToAnnotationStorage(s)}moveEditorInDOM(s){var D;(D=y(this,F))==null||D.moveElementInDOM(this.div,s.div,s.contentDiv,!0)}addOrRebuild(s){s.needsToBeRebuilt()?s.rebuild():this.add(s)}addANewEditor(s){const D=()=>{this.addOrRebuild(s)},q=()=>{s.remove()};this.addCommands({cmd:D,undo:q,mustExec:!0})}addUndoableEditor(s){const D=()=>{this.addOrRebuild(s)},q=()=>{s.remove()};this.addCommands({cmd:D,undo:q,mustExec:!1})}getNextId(){return y(this,o).getId()}deserialize(s){switch(s.annotationType){case d.AnnotationEditorType.FREETEXT:return M.FreeTextEditor.deserialize(s,this,y(this,o));case d.AnnotationEditorType.INK:return H.InkEditor.deserialize(s,this,y(this,o))}return null}setSelected(s){y(this,o).setSelected(s)}toggleSelected(s){y(this,o).toggleSelected(s)}isSelected(s){return y(this,o).isSelected(s)}unselect(s){y(this,o).unselect(s)}pointerup(s){const{isMac:D}=d.FeatureTest.platform;if(!(s.button!==0||s.ctrlKey&&D)&&s.target===this.div&&y(this,p)){if(gt(this,p,!1),!y(this,v)){gt(this,v,!0);return}at(this,t,Ee).call(this,s)}}pointerdown(s){const{isMac:D}=d.FeatureTest.platform;if(s.button!==0||s.ctrlKey&&D||s.target!==this.div)return;gt(this,p,!0);const q=y(this,o).getActive();gt(this,v,!q||q.isEmpty())}drop(s){const D=s.dataTransfer.getData("text/plain"),q=y(this,o).getEditor(D);if(!q)return;s.preventDefault(),s.dataTransfer.dropEffect="move",at(this,A,ve).call(this,q);const Y=this.div.getBoundingClientRect(),Q=s.clientX-Y.x,et=s.clientY-Y.y;q.translate(Q-q.startX,et-q.startY),this.moveEditorInDOM(q),q.div.focus()}dragover(s){s.preventDefault()}destroy(){var s,D;((s=y(this,o).getActive())==null?void 0:s.parent)===this&&y(this,o).setActiveEditor(null);for(const q of y(this,T).values())(D=y(this,F))==null||D.removePointerInTextLayer(q.contentDiv),q.setParent(null),q.isAttachedToDOM=!1,q.div.remove();this.div=null,y(this,T).clear(),y(this,o).removeLayer(this)}render({viewport:s}){this.viewport=s,(0,Z.setLayerDimensions)(this.div,s),(0,_.bindEvents)(this,this.div,["dragover","drop"]);for(const D of y(this,o).getEditors(this.pageIndex))this.add(D);this.updateMode()}update({viewport:s}){y(this,o).commitOrRemove(),this.viewport=s,(0,Z.setLayerDimensions)(this.div,{rotation:s.rotation}),this.updateMode()}get pageDimensions(){const{pageWidth:s,pageHeight:D}=this.viewport.rawDims;return[s,D]}};let O=h;F=new WeakMap,v=new WeakMap,j=new WeakMap,w=new WeakMap,T=new WeakMap,p=new WeakMap,u=new WeakMap,o=new WeakMap,A=new WeakSet,ve=function(s){var D;s.parent!==this&&(this.attach(s),(D=s.parent)==null||D.detach(s),s.setParent(this),s.div&&s.isAttachedToDOM&&(s.div.remove(),this.div.append(s.div)))},C=new WeakSet,$e=function(s){switch(y(this,o).getMode()){case d.AnnotationEditorType.FREETEXT:return new M.FreeTextEditor(s);case d.AnnotationEditorType.INK:return new H.InkEditor(s)}return null},t=new WeakSet,Ee=function(s){const D=this.getNextId(),q=at(this,C,$e).call(this,{parent:this,id:D,x:s.offsetX,y:s.offsetY,uiManager:y(this,o)});return q&&this.add(q),q},i=new WeakSet,xe=function(){gt(this,u,!0);for(const s of y(this,T).values())s.isEmpty()&&s.remove();gt(this,u,!1)},Lt(O,"_initialized",!1),a.AnnotationEditorLayer=O},(G,a,I)=>{var Z,O,F,v,j,w,T,p,u,o,qe,x,Ve,m,Xe,c,Se;Object.defineProperty(a,"__esModule",{value:!0}),a.FreeTextEditor=void 0;var d=I(1),_=I(5),M=I(4);const n=class extends M.AnnotationEditor{constructor(s){super({...s,name:"freeTextEditor"});tt(this,o);tt(this,x);tt(this,m);tt(this,c);tt(this,Z,this.editorDivBlur.bind(this));tt(this,O,this.editorDivFocus.bind(this));tt(this,F,this.editorDivInput.bind(this));tt(this,v,this.editorDivKeydown.bind(this));tt(this,j,void 0);tt(this,w,"");tt(this,T,`${this.id}-editor`);tt(this,p,!1);tt(this,u,void 0);gt(this,j,s.color||n._defaultColor||M.AnnotationEditor._defaultLineColor),gt(this,u,s.fontSize||n._defaultFontSize)}static initialize(s){this._l10nPromise=new Map(["free_text2_default_content","editor_free_text2_aria_label"].map(q=>[q,s.get(q)]));const D=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(D.getPropertyValue("--freetext-padding"))}static updateDefaultParams(s,D){switch(s){case d.AnnotationEditorParamsType.FREETEXT_SIZE:n._defaultFontSize=D;break;case d.AnnotationEditorParamsType.FREETEXT_COLOR:n._defaultColor=D;break}}updateParams(s,D){switch(s){case d.AnnotationEditorParamsType.FREETEXT_SIZE:at(this,o,qe).call(this,D);break;case d.AnnotationEditorParamsType.FREETEXT_COLOR:at(this,x,Ve).call(this,D);break}}static get defaultPropertiesToUpdate(){return[[d.AnnotationEditorParamsType.FREETEXT_SIZE,n._defaultFontSize],[d.AnnotationEditorParamsType.FREETEXT_COLOR,n._defaultColor||M.AnnotationEditor._defaultLineColor]]}get propertiesToUpdate(){return[[d.AnnotationEditorParamsType.FREETEXT_SIZE,y(this,u)],[d.AnnotationEditorParamsType.FREETEXT_COLOR,y(this,j)]]}getInitialTranslation(){const s=this.parentScale;return[-n._internalPadding*s,-(n._internalPadding+y(this,u))*s]}rebuild(){super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this))}enableEditMode(){this.isInEditMode()||(this.parent.setEditingState(!1),this.parent.updateToolbar(d.AnnotationEditorType.FREETEXT),super.enableEditMode(),this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this.div.draggable=!1,this.div.removeAttribute("aria-activedescendant"),this.editorDiv.addEventListener("keydown",y(this,v)),this.editorDiv.addEventListener("focus",y(this,O)),this.editorDiv.addEventListener("blur",y(this,Z)),this.editorDiv.addEventListener("input",y(this,F)))}disableEditMode(){this.isInEditMode()&&(this.parent.setEditingState(!0),super.disableEditMode(),this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",y(this,T)),this.div.draggable=!0,this.editorDiv.removeEventListener("keydown",y(this,v)),this.editorDiv.removeEventListener("focus",y(this,O)),this.editorDiv.removeEventListener("blur",y(this,Z)),this.editorDiv.removeEventListener("input",y(this,F)),this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freeTextEditing"))}focusin(s){super.focusin(s),s.target!==this.editorDiv&&this.editorDiv.focus()}onceAdded(){this.width||(this.enableEditMode(),this.editorDiv.focus())}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent.setEditingState(!0),this.parent.div.classList.add("freeTextEditing"),super.remove()}commit(){this.isInEditMode()&&(super.commit(),y(this,p)||(gt(this,p,!0),this.parent.addUndoableEditor(this)),this.disableEditMode(),gt(this,w,at(this,m,Xe).call(this).trimEnd()),at(this,c,Se).call(this))}shouldGetKeyboardEvents(){return this.isInEditMode()}dblclick(s){this.enableEditMode(),this.editorDiv.focus()}keydown(s){s.target===this.div&&s.key==="Enter"&&(this.enableEditMode(),this.editorDiv.focus())}editorDivKeydown(s){n._keyboardManager.exec(this,s)}editorDivFocus(s){this.isEditing=!0}editorDivBlur(s){this.isEditing=!1}editorDivInput(s){this.parent.div.classList.toggle("freeTextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}render(){if(this.div)return this.div;let s,D;this.width&&(s=this.x,D=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",y(this,T)),this.enableEditing(),n._l10nPromise.get("editor_free_text2_aria_label").then(Y=>{var Q;return(Q=this.editorDiv)==null?void 0:Q.setAttribute("aria-label",Y)}),n._l10nPromise.get("free_text2_default_content").then(Y=>{var Q;return(Q=this.editorDiv)==null?void 0:Q.setAttribute("default-content",Y)}),this.editorDiv.contentEditable=!0;const{style:q}=this.editorDiv;if(q.fontSize=`calc(${y(this,u)}px * var(--scale-factor))`,q.color=y(this,j),this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),(0,_.bindEvents)(this,this.div,["dblclick","keydown"]),this.width){const[Y,Q]=this.parentDimensions;this.setAt(s*Y,D*Q,this.width*Y,this.height*Q);for(const et of y(this,w).split(`
`)){const ct=document.createElement("div");ct.append(et?document.createTextNode(et):document.createElement("br")),this.editorDiv.append(ct)}this.div.draggable=!0,this.editorDiv.contentEditable=!1}else this.div.draggable=!1,this.editorDiv.contentEditable=!0;return this.div}get contentDiv(){return this.editorDiv}static deserialize(s,D,q){const Y=super.deserialize(s,D,q);return gt(Y,u,s.fontSize),gt(Y,j,d.Util.makeHexColor(...s.color)),gt(Y,w,s.value),Y}serialize(){if(this.isEmpty())return null;const s=n._internalPadding*this.parentScale,D=this.getRect(s,s),q=M.AnnotationEditor._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:y(this,j));return{annotationType:d.AnnotationEditorType.FREETEXT,color:q,fontSize:y(this,u),value:y(this,w),pageIndex:this.pageIndex,rect:D,rotation:this.rotation}}};let H=n;Z=new WeakMap,O=new WeakMap,F=new WeakMap,v=new WeakMap,j=new WeakMap,w=new WeakMap,T=new WeakMap,p=new WeakMap,u=new WeakMap,o=new WeakSet,qe=function(s){const D=Y=>{this.editorDiv.style.fontSize=`calc(${Y}px * var(--scale-factor))`,this.translate(0,-(Y-y(this,u))*this.parentScale),gt(this,u,Y),at(this,c,Se).call(this)},q=y(this,u);this.addCommands({cmd:()=>{D(s)},undo:()=>{D(q)},mustExec:!0,type:d.AnnotationEditorParamsType.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})},x=new WeakSet,Ve=function(s){const D=y(this,j);this.addCommands({cmd:()=>{gt(this,j,this.editorDiv.style.color=s)},undo:()=>{gt(this,j,this.editorDiv.style.color=D)},mustExec:!0,type:d.AnnotationEditorParamsType.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})},m=new WeakSet,Xe=function(){const s=this.editorDiv.getElementsByTagName("div");if(s.length===0)return this.editorDiv.innerText;const D=[];for(const q of s)D.push(q.innerText.replace(/\r\n?|\n/,""));return D.join(`
`)},c=new WeakSet,Se=function(){const[s,D]=this.parentDimensions;let q;if(this.isAttachedToDOM)q=this.div.getBoundingClientRect();else{const{currentLayer:Y,div:Q}=this,et=Q.style.display;Q.style.display="hidden",Y.div.append(this.div),q=Q.getBoundingClientRect(),Q.remove(),Q.style.display=et}this.width=q.width/s,this.height=q.height/D},Lt(H,"_freeTextDefaultContent",""),Lt(H,"_l10nPromise"),Lt(H,"_internalPadding",0),Lt(H,"_defaultColor",null),Lt(H,"_defaultFontSize",10),Lt(H,"_keyboardManager",new _.KeyboardManager([[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],n.prototype.commitOrRemove]])),Lt(H,"_type","freetext"),a.FreeTextEditor=H},(G,a,I)=>{var F,v,j,w,T,p,u,o,A,x,C,m,t,c,i,ze,h,Ye,s,Ke,q,Je,Q,Te,ct,Qe,ut,Ze,_t,tn,At,Xt,f,Pe,S,le,W,ce,L,Zt,U,Ce,l,de,E,we,V,en,J,nn,lt,sn,rt,Re,pt,ue,vt,te,K,ke;Object.defineProperty(a,"__esModule",{value:!0}),a.InkEditor=void 0,Object.defineProperty(a,"fitCurve",{enumerable:!0,get:function(){return M.fitCurve}});var d=I(1),_=I(4),M=I(30),H=I(5);const Z=16,Et=class extends _.AnnotationEditor{constructor(k){super({...k,name:"inkEditor"});tt(this,i);tt(this,h);tt(this,s);tt(this,q);tt(this,Q);tt(this,ct);tt(this,ut);tt(this,_t);tt(this,At);tt(this,f);tt(this,S);tt(this,W);tt(this,L);tt(this,U);tt(this,l);tt(this,V);tt(this,J);tt(this,lt);tt(this,rt);tt(this,pt);tt(this,vt);tt(this,K);tt(this,F,0);tt(this,v,0);tt(this,j,0);tt(this,w,this.canvasPointermove.bind(this));tt(this,T,this.canvasPointerleave.bind(this));tt(this,p,this.canvasPointerup.bind(this));tt(this,u,this.canvasPointerdown.bind(this));tt(this,o,!1);tt(this,A,!1);tt(this,x,null);tt(this,C,null);tt(this,m,0);tt(this,t,0);tt(this,c,null);this.color=k.color||null,this.thickness=k.thickness||null,this.opacity=k.opacity||null,this.paths=[],this.bezierPath2D=[],this.currentPath=[],this.scaleFactor=1,this.translationX=this.translationY=0,this.x=0,this.y=0}static initialize(k){this._l10nPromise=new Map(["editor_ink_canvas_aria_label","editor_ink2_aria_label"].map(N=>[N,k.get(N)]))}static updateDefaultParams(k,N){switch(k){case d.AnnotationEditorParamsType.INK_THICKNESS:Et._defaultThickness=N;break;case d.AnnotationEditorParamsType.INK_COLOR:Et._defaultColor=N;break;case d.AnnotationEditorParamsType.INK_OPACITY:Et._defaultOpacity=N/100;break}}updateParams(k,N){switch(k){case d.AnnotationEditorParamsType.INK_THICKNESS:at(this,i,ze).call(this,N);break;case d.AnnotationEditorParamsType.INK_COLOR:at(this,h,Ye).call(this,N);break;case d.AnnotationEditorParamsType.INK_OPACITY:at(this,s,Ke).call(this,N);break}}static get defaultPropertiesToUpdate(){return[[d.AnnotationEditorParamsType.INK_THICKNESS,Et._defaultThickness],[d.AnnotationEditorParamsType.INK_COLOR,Et._defaultColor||_.AnnotationEditor._defaultLineColor],[d.AnnotationEditorParamsType.INK_OPACITY,Math.round(Et._defaultOpacity*100)]]}get propertiesToUpdate(){return[[d.AnnotationEditorParamsType.INK_THICKNESS,this.thickness||Et._defaultThickness],[d.AnnotationEditorParamsType.INK_COLOR,this.color||Et._defaultColor||_.AnnotationEditor._defaultLineColor],[d.AnnotationEditorParamsType.INK_OPACITY,Math.round(100*(this.opacity??Et._defaultOpacity))]]}rebuild(){super.rebuild(),this.div!==null&&(this.canvas||(at(this,S,le).call(this),at(this,W,ce).call(this)),this.isAttachedToDOM||(this.parent.add(this),at(this,L,Zt).call(this)),at(this,vt,te).call(this))}remove(){this.canvas!==null&&(this.isEmpty()||this.commit(),this.canvas.width=this.canvas.height=0,this.canvas.remove(),this.canvas=null,y(this,C).disconnect(),gt(this,C,null),super.remove())}setParent(k){!this.parent&&k?this._uiManager.removeShouldRescale(this):this.parent&&k===null&&this._uiManager.addShouldRescale(this),super.setParent(k)}onScaleChanging(){const[k,N]=this.parentDimensions,dt=this.width*k,bt=this.height*N;this.setDimensions(dt,bt)}enableEditMode(){y(this,o)||this.canvas===null||(super.enableEditMode(),this.div.draggable=!1,this.canvas.addEventListener("pointerdown",y(this,u)),this.canvas.addEventListener("pointerup",y(this,p)))}disableEditMode(){!this.isInEditMode()||this.canvas===null||(super.disableEditMode(),this.div.draggable=!this.isEmpty(),this.div.classList.remove("editing"),this.canvas.removeEventListener("pointerdown",y(this,u)),this.canvas.removeEventListener("pointerup",y(this,p)))}onceAdded(){this.div.draggable=!this.isEmpty()}isEmpty(){return this.paths.length===0||this.paths.length===1&&this.paths[0].length===0}commit(){y(this,o)||(super.commit(),this.isEditing=!1,this.disableEditMode(),this.setInForeground(),gt(this,o,!0),this.div.classList.add("disabled"),at(this,vt,te).call(this,!0),this.parent.addInkEditorIfNeeded(!0),this.parent.moveEditorInDOM(this),this.div.focus({preventScroll:!0}))}focusin(k){super.focusin(k),this.enableEditMode()}canvasPointerdown(k){k.button!==0||!this.isInEditMode()||y(this,o)||(this.setInForeground(),k.type!=="mouse"&&this.div.focus(),k.stopPropagation(),this.canvas.addEventListener("pointerleave",y(this,T)),this.canvas.addEventListener("pointermove",y(this,w)),at(this,ct,Qe).call(this,k.offsetX,k.offsetY))}canvasPointermove(k){k.stopPropagation(),at(this,ut,Ze).call(this,k.offsetX,k.offsetY)}canvasPointerup(k){k.button===0&&this.isInEditMode()&&this.currentPath.length!==0&&(k.stopPropagation(),at(this,f,Pe).call(this,k),this.setInBackground())}canvasPointerleave(k){at(this,f,Pe).call(this,k),this.setInBackground()}render(){if(this.div)return this.div;let k,N;this.width&&(k=this.x,N=this.y),super.render(),Et._l10nPromise.get("editor_ink2_aria_label").then(kt=>{var Rt;return(Rt=this.div)==null?void 0:Rt.setAttribute("aria-label",kt)});const[dt,bt,Pt,wt]=at(this,q,Je).call(this);if(this.setAt(dt,bt,0,0),this.setDims(Pt,wt),at(this,S,le).call(this),this.width){const[kt,Rt]=this.parentDimensions;this.setAt(k*kt,N*Rt,this.width*kt,this.height*Rt),gt(this,A,!0),at(this,L,Zt).call(this),this.setDims(this.width*kt,this.height*Rt),at(this,At,Xt).call(this),at(this,K,ke).call(this),this.div.classList.add("disabled")}else this.div.classList.add("editing"),this.enableEditMode();return at(this,W,ce).call(this),this.div}setDimensions(k,N){const dt=Math.round(k),bt=Math.round(N);if(y(this,m)===dt&&y(this,t)===bt)return;gt(this,m,dt),gt(this,t,bt),this.canvas.style.visibility="hidden",y(this,F)&&Math.abs(y(this,F)-k/N)>.01&&(N=Math.ceil(k/y(this,F)),this.setDims(k,N));const[Pt,wt]=this.parentDimensions;this.width=k/Pt,this.height=N/wt,y(this,o)&&at(this,U,Ce).call(this,k,N),at(this,L,Zt).call(this),at(this,At,Xt).call(this),this.canvas.style.visibility="visible",this.fixDims()}static deserialize(k,N,dt){var Dt,It;const bt=super.deserialize(k,N,dt);bt.thickness=k.thickness,bt.color=d.Util.makeHexColor(...k.color),bt.opacity=k.opacity;const[Pt,wt]=bt.pageDimensions,kt=bt.width*Pt,Rt=bt.height*wt,Ot=bt.parentScale,Ct=k.thickness/2;gt(bt,F,kt/Rt),gt(bt,o,!0),gt(bt,m,Math.round(kt)),gt(bt,t,Math.round(Rt));for(const{bezier:Mt}of k.paths){const Ut=[];bt.paths.push(Ut);let Gt=Ot*(Mt[0]-Ct),Wt=Ot*(Rt-Mt[1]-Ct);for(let jt=2,Bt=Mt.length;jt<Bt;jt+=6){const qt=Ot*(Mt[jt]-Ct),zt=Ot*(Rt-Mt[jt+1]-Ct),se=Ot*(Mt[jt+2]-Ct),ie=Ot*(Rt-Mt[jt+3]-Ct),Oe=Ot*(Mt[jt+4]-Ct),De=Ot*(Rt-Mt[jt+5]-Ct);Ut.push([[Gt,Wt],[qt,zt],[se,ie],[Oe,De]]),Gt=Oe,Wt=De}const $t=at(this,E,we).call(this,Ut);bt.bezierPath2D.push($t)}const Nt=at(Dt=bt,rt,Re).call(Dt);return gt(bt,j,Math.max(Z,Nt[2]-Nt[0])),gt(bt,v,Math.max(Z,Nt[3]-Nt[1])),at(It=bt,U,Ce).call(It,kt,Rt),bt}serialize(){if(this.isEmpty())return null;const k=this.getRect(0,0),N=this.rotation%180===0?k[3]-k[1]:k[2]-k[0],dt=_.AnnotationEditor._colorManager.convert(this.ctx.strokeStyle);return{annotationType:d.AnnotationEditorType.INK,color:dt,thickness:this.thickness,opacity:this.opacity,paths:at(this,V,en).call(this,this.scaleFactor/this.parentScale,this.translationX,this.translationY,N),pageIndex:this.pageIndex,rect:k,rotation:this.rotation}}};let O=Et;F=new WeakMap,v=new WeakMap,j=new WeakMap,w=new WeakMap,T=new WeakMap,p=new WeakMap,u=new WeakMap,o=new WeakMap,A=new WeakMap,x=new WeakMap,C=new WeakMap,m=new WeakMap,t=new WeakMap,c=new WeakMap,i=new WeakSet,ze=function(k){const N=this.thickness;this.addCommands({cmd:()=>{this.thickness=k,at(this,vt,te).call(this)},undo:()=>{this.thickness=N,at(this,vt,te).call(this)},mustExec:!0,type:d.AnnotationEditorParamsType.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0})},h=new WeakSet,Ye=function(k){const N=this.color;this.addCommands({cmd:()=>{this.color=k,at(this,At,Xt).call(this)},undo:()=>{this.color=N,at(this,At,Xt).call(this)},mustExec:!0,type:d.AnnotationEditorParamsType.INK_COLOR,overwriteIfSameType:!0,keepUndo:!0})},s=new WeakSet,Ke=function(k){k/=100;const N=this.opacity;this.addCommands({cmd:()=>{this.opacity=k,at(this,At,Xt).call(this)},undo:()=>{this.opacity=N,at(this,At,Xt).call(this)},mustExec:!0,type:d.AnnotationEditorParamsType.INK_OPACITY,overwriteIfSameType:!0,keepUndo:!0})},q=new WeakSet,Je=function(){const{parentRotation:k,parentDimensions:[N,dt]}=this;switch(k){case 90:return[0,dt,dt,N];case 180:return[N,dt,N,dt];case 270:return[N,0,dt,N];default:return[0,0,N,dt]}},Q=new WeakSet,Te=function(){const{ctx:k,color:N,opacity:dt,thickness:bt,parentScale:Pt,scaleFactor:wt}=this;k.lineWidth=bt*Pt/wt,k.lineCap="round",k.lineJoin="round",k.miterLimit=10,k.strokeStyle=`${N}${(0,H.opacityToHex)(dt)}`},ct=new WeakSet,Qe=function(k,N){this.isEditing=!0,y(this,A)||(gt(this,A,!0),at(this,L,Zt).call(this),this.thickness||(this.thickness=Et._defaultThickness),this.color||(this.color=Et._defaultColor||_.AnnotationEditor._defaultLineColor),this.opacity??(this.opacity=Et._defaultOpacity)),this.currentPath.push([k,N]),gt(this,x,null),at(this,Q,Te).call(this),this.ctx.beginPath(),this.ctx.moveTo(k,N),gt(this,c,()=>{y(this,c)&&(y(this,x)&&(this.isEmpty()?(this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height)):at(this,At,Xt).call(this),this.ctx.lineTo(...y(this,x)),gt(this,x,null),this.ctx.stroke()),window.requestAnimationFrame(y(this,c)))}),window.requestAnimationFrame(y(this,c))},ut=new WeakSet,Ze=function(k,N){const[dt,bt]=this.currentPath.at(-1);k===dt&&N===bt||(this.currentPath.push([k,N]),gt(this,x,[k,N]))},_t=new WeakSet,tn=function(k,N){var Ot;this.ctx.closePath(),gt(this,c,null),k=Math.min(Math.max(k,0),this.canvas.width),N=Math.min(Math.max(N,0),this.canvas.height);const[dt,bt]=this.currentPath.at(-1);(k!==dt||N!==bt)&&this.currentPath.push([k,N]);let Pt;if(this.currentPath.length!==1)Pt=(0,M.fitCurve)(this.currentPath,30,null);else{const Ct=[k,N];Pt=[[Ct,Ct.slice(),Ct.slice(),Ct]]}const wt=at(Ot=Et,E,we).call(Ot,Pt);this.currentPath.length=0;const kt=()=>{this.paths.push(Pt),this.bezierPath2D.push(wt),this.rebuild()},Rt=()=>{this.paths.pop(),this.bezierPath2D.pop(),this.paths.length===0?this.remove():(this.canvas||(at(this,S,le).call(this),at(this,W,ce).call(this)),at(this,vt,te).call(this))};this.addCommands({cmd:kt,undo:Rt,mustExec:!0})},At=new WeakSet,Xt=function(){if(this.isEmpty()){at(this,l,de).call(this);return}at(this,Q,Te).call(this);const{canvas:k,ctx:N}=this;N.setTransform(1,0,0,1,0,0),N.clearRect(0,0,k.width,k.height),at(this,l,de).call(this);for(const dt of this.bezierPath2D)N.stroke(dt)},f=new WeakSet,Pe=function(k){at(this,_t,tn).call(this,k.offsetX,k.offsetY),this.canvas.removeEventListener("pointerleave",y(this,T)),this.canvas.removeEventListener("pointermove",y(this,w)),this.addToAnnotationStorage()},S=new WeakSet,le=function(){this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=0,this.canvas.className="inkEditorCanvas",Et._l10nPromise.get("editor_ink_canvas_aria_label").then(k=>{var N;return(N=this.canvas)==null?void 0:N.setAttribute("aria-label",k)}),this.div.append(this.canvas),this.ctx=this.canvas.getContext("2d")},W=new WeakSet,ce=function(){gt(this,C,new ResizeObserver(k=>{const N=k[0].contentRect;N.width&&N.height&&this.setDimensions(N.width,N.height)})),y(this,C).observe(this.div)},L=new WeakSet,Zt=function(){if(!y(this,A))return;const[k,N]=this.parentDimensions;this.canvas.width=Math.ceil(this.width*k),this.canvas.height=Math.ceil(this.height*N),at(this,l,de).call(this)},U=new WeakSet,Ce=function(k,N){const dt=at(this,pt,ue).call(this),bt=(k-dt)/y(this,j),Pt=(N-dt)/y(this,v);this.scaleFactor=Math.min(bt,Pt)},l=new WeakSet,de=function(){const k=at(this,pt,ue).call(this)/2;this.ctx.setTransform(this.scaleFactor,0,0,this.scaleFactor,this.translationX*this.scaleFactor+k,this.translationY*this.scaleFactor+k)},E=new WeakSet,we=function(k){const N=new Path2D;for(let dt=0,bt=k.length;dt<bt;dt++){const[Pt,wt,kt,Rt]=k[dt];dt===0&&N.moveTo(...Pt),N.bezierCurveTo(wt[0],wt[1],kt[0],kt[1],Rt[0],Rt[1])}return N},V=new WeakSet,en=function(k,N,dt,bt){const wt=[],kt=this.thickness/2;let Rt,Ot;for(const Ct of this.paths){Rt=[],Ot=[];for(let Nt=0,Dt=Ct.length;Nt<Dt;Nt++){const[It,Mt,Ut,Gt]=Ct[Nt],Wt=k*(It[0]+N)+kt,$t=bt-k*(It[1]+dt)-kt,jt=k*(Mt[0]+N)+kt,Bt=bt-k*(Mt[1]+dt)-kt,qt=k*(Ut[0]+N)+kt,zt=bt-k*(Ut[1]+dt)-kt,se=k*(Gt[0]+N)+kt,ie=bt-k*(Gt[1]+dt)-kt;Nt===0&&(Rt.push(Wt,$t),Ot.push(Wt,$t)),Rt.push(jt,Bt,qt,zt,se,ie),at(this,J,nn).call(this,Wt,$t,jt,Bt,qt,zt,se,ie,4,Ot)}wt.push({bezier:Rt,points:Ot})}return wt},J=new WeakSet,nn=function(k,N,dt,bt,Pt,wt,kt,Rt,Ot,Ct){if(at(this,lt,sn).call(this,k,N,dt,bt,Pt,wt,kt,Rt)){Ct.push(kt,Rt);return}for(let Nt=1;Nt<Ot-1;Nt++){const Dt=Nt/Ot,It=1-Dt;let Mt=Dt*k+It*dt,Ut=Dt*N+It*bt,Gt=Dt*dt+It*Pt,Wt=Dt*bt+It*wt;const $t=Dt*Pt+It*kt,jt=Dt*wt+It*Rt;Mt=Dt*Mt+It*Gt,Ut=Dt*Ut+It*Wt,Gt=Dt*Gt+It*$t,Wt=Dt*Wt+It*jt,Mt=Dt*Mt+It*Gt,Ut=Dt*Ut+It*Wt,Ct.push(Mt,Ut)}Ct.push(kt,Rt)},lt=new WeakSet,sn=function(k,N,dt,bt,Pt,wt,kt,Rt){const Ct=(3*dt-2*k-kt)**2,Nt=(3*bt-2*N-Rt)**2,Dt=(3*Pt-k-2*kt)**2,It=(3*wt-N-2*Rt)**2;return Math.max(Ct,Dt)+Math.max(Nt,It)<=10},rt=new WeakSet,Re=function(){let k=1/0,N=-1/0,dt=1/0,bt=-1/0;for(const Pt of this.paths)for(const[wt,kt,Rt,Ot]of Pt){const Ct=d.Util.bezierBoundingBox(...wt,...kt,...Rt,...Ot);k=Math.min(k,Ct[0]),dt=Math.min(dt,Ct[1]),N=Math.max(N,Ct[2]),bt=Math.max(bt,Ct[3])}return[k,dt,N,bt]},pt=new WeakSet,ue=function(){return y(this,o)?Math.ceil(this.thickness*this.parentScale):0},vt=new WeakSet,te=function(k=!1){if(this.isEmpty())return;if(!y(this,o)){at(this,At,Xt).call(this);return}const N=at(this,rt,Re).call(this),dt=at(this,pt,ue).call(this);gt(this,j,Math.max(Z,N[2]-N[0])),gt(this,v,Math.max(Z,N[3]-N[1]));const bt=Math.ceil(dt+y(this,j)*this.scaleFactor),Pt=Math.ceil(dt+y(this,v)*this.scaleFactor),[wt,kt]=this.parentDimensions;this.width=bt/wt,this.height=Pt/kt,gt(this,F,bt/Pt),at(this,K,ke).call(this);const Rt=this.translationX,Ot=this.translationY;this.translationX=-N[0],this.translationY=-N[1],at(this,L,Zt).call(this),at(this,At,Xt).call(this),gt(this,m,bt),gt(this,t,Pt),this.setDims(bt,Pt);const Ct=k?dt/this.scaleFactor/2:0;this.translate(Rt-this.translationX-Ct,Ot-this.translationY-Ct)},K=new WeakSet,ke=function(){const{style:k}=this.div;y(this,F)>=1?(k.minHeight=`${Z}px`,k.minWidth=`${Math.round(y(this,F)*Z)}px`):(k.minWidth=`${Z}px`,k.minHeight=`${Math.round(Z/y(this,F))}px`)},tt(O,E),Lt(O,"_defaultColor",null),Lt(O,"_defaultOpacity",1),Lt(O,"_defaultThickness",1),Lt(O,"_l10nPromise"),Lt(O,"_type","ink"),a.InkEditor=O},(G,a,I)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.fitCurve=void 0;const d=I(31);a.fitCurve=d},G=>{function a(p,u,o){if(!Array.isArray(p))throw new TypeError("First argument should be an array");if(p.forEach(m=>{if(!Array.isArray(m)||m.some(t=>typeof t!="number")||m.length!==p[0].length)throw Error("Each point should be an array of numbers. Each point should have the same amount of numbers.")}),p=p.filter((m,t)=>t===0||!m.every((c,i)=>c===p[t-1][i])),p.length<2)return[];const A=p.length,x=j(p[1],p[0]),C=j(p[A-2],p[A-1]);return I(p,x,C,u,o)}function I(p,u,o,A,x){var m,t,c,i,n,h,R,s,D,q,Y,Q,et;if(p.length===2)return Q=w.vectorLen(w.subtract(p[0],p[1]))/3,m=[p[0],w.addArrays(p[0],w.mulItems(u,Q)),w.addArrays(p[1],w.mulItems(o,Q)),p[1]],[m];if(t=Z(p),[m,i,h]=d(p,t,t,u,o,x),i===0||i<A)return[m];if(i<A*A)for(c=t,n=i,R=h,et=0;et<20;et++){if(c=M(m,p,c),[m,i,h]=d(p,t,c,u,o,x),i<A)return[m];if(h===R){let ct=i/n;if(ct>.9999&&ct<1.0001)break}n=i,R=h}return Y=[],s=w.subtract(p[h-1],p[h+1]),s.every(ct=>ct===0)&&(s=w.subtract(p[h-1],p[h]),[s[0],s[1]]=[-s[1],s[0]]),D=w.normalize(s),q=w.mulItems(D,-1),Y=Y.concat(I(p.slice(0,h+1),u,D,A,x)),Y=Y.concat(I(p.slice(h),q,o,A,x)),Y}function d(p,u,o,A,x,C){var m,t,c;return m=_(p,o,A,x),[t,c]=O(p,m,u),C&&C({bez:m,points:p,params:u,maxErr:t,maxPoint:c}),[m,t,c]}function _(p,u,o,A){var x,C,m,t,c,i,n,h,R,s,D,q,Y,Q,et,ct,nt,ut=p[0],mt=p[p.length-1];for(x=[ut,null,null,mt],C=w.zeros_Xx2x2(u.length),Y=0,Q=u.length;Y<Q;Y++)ct=u[Y],nt=1-ct,m=C[Y],m[0]=w.mulItems(o,3*ct*(nt*nt)),m[1]=w.mulItems(A,3*nt*(ct*ct));for(t=[[0,0],[0,0]],c=[0,0],Y=0,Q=p.length;Y<Q;Y++)ct=u[Y],m=C[Y],t[0][0]+=w.dot(m[0],m[0]),t[0][1]+=w.dot(m[0],m[1]),t[1][0]+=w.dot(m[0],m[1]),t[1][1]+=w.dot(m[1],m[1]),et=w.subtract(p[Y],T.q([ut,ut,mt,mt],ct)),c[0]+=w.dot(m[0],et),c[1]+=w.dot(m[1],et);return i=t[0][0]*t[1][1]-t[1][0]*t[0][1],n=t[0][0]*c[1]-t[1][0]*c[0],h=c[0]*t[1][1]-c[1]*t[0][1],R=i===0?0:h/i,s=i===0?0:n/i,q=w.vectorLen(w.subtract(ut,mt)),D=1e-6*q,R<D||s<D?(x[1]=w.addArrays(ut,w.mulItems(o,q/3)),x[2]=w.addArrays(mt,w.mulItems(A,q/3))):(x[1]=w.addArrays(ut,w.mulItems(o,R)),x[2]=w.addArrays(mt,w.mulItems(A,s))),x}function M(p,u,o){return o.map((A,x)=>H(p,u[x],A))}function H(p,u,o){var A=w.subtract(T.q(p,o),u),x=T.qprime(p,o),C=w.mulMatrix(A,x),m=w.sum(w.squareItems(x))+2*w.mulMatrix(A,T.qprimeprime(p,o));return m===0?o:o-C/m}function Z(p){var u=[],o,A,x;return p.forEach((C,m)=>{o=m?A+w.vectorLen(w.subtract(C,x)):0,u.push(o),A=o,x=C}),u=u.map(C=>C/A),u}function O(p,u,o){var A,x,C,m,t,c,i,n;x=0,C=Math.floor(p.length/2);const h=F(u,10);for(t=0,c=p.length;t<c;t++)i=p[t],n=v(u,o[t],h,10),m=w.subtract(T.q(u,n),i),A=m[0]*m[0]+m[1]*m[1],A>x&&(x=A,C=t);return[x,C]}var F=function(p,u){for(var o,A=[0],x=p[0],C=0,m=1;m<=u;m++)o=T.q(p,m/u),C+=w.vectorLen(w.subtract(o,x)),A.push(C),x=o;return A=A.map(t=>t/C),A};function v(p,u,o,A){if(u<0)return 0;if(u>1)return 1;for(var x,C,m,t,c,i=1;i<=A;i++)if(u<=o[i]){t=(i-1)/A,m=i/A,C=o[i-1],x=o[i],c=(u-C)/(x-C)*(m-t)+t;break}return c}function j(p,u){return w.normalize(w.subtract(p,u))}class w{static zeros_Xx2x2(u){for(var o=[];u--;)o.push([0,0]);return o}static mulItems(u,o){return u.map(A=>A*o)}static mulMatrix(u,o){return u.reduce((A,x,C)=>A+x*o[C],0)}static subtract(u,o){return u.map((A,x)=>A-o[x])}static addArrays(u,o){return u.map((A,x)=>A+o[x])}static addItems(u,o){return u.map(A=>A+o)}static sum(u){return u.reduce((o,A)=>o+A)}static dot(u,o){return w.mulMatrix(u,o)}static vectorLen(u){return Math.hypot(...u)}static divItems(u,o){return u.map(A=>A/o)}static squareItems(u){return u.map(o=>o*o)}static normalize(u){return this.divItems(u,this.vectorLen(u))}}class T{static q(u,o){var A=1-o,x=w.mulItems(u[0],A*A*A),C=w.mulItems(u[1],3*A*A*o),m=w.mulItems(u[2],3*A*o*o),t=w.mulItems(u[3],o*o*o);return w.addArrays(w.addArrays(x,C),w.addArrays(m,t))}static qprime(u,o){var A=1-o,x=w.mulItems(w.subtract(u[1],u[0]),3*A*A),C=w.mulItems(w.subtract(u[2],u[1]),6*A*o),m=w.mulItems(w.subtract(u[3],u[2]),3*o*o);return w.addArrays(w.addArrays(x,C),m)}static qprimeprime(u,o){return w.addArrays(w.mulItems(w.addArrays(w.subtract(u[2],w.mulItems(u[1],2)),u[0]),6*(1-o)),w.mulItems(w.addArrays(w.subtract(u[3],w.mulItems(u[2],2)),u[1]),6*o))}}G.exports=a,G.exports.fitCubic=I,G.exports.createTangent=j},(G,a,I)=>{var At,Kt,f,rn,$,Fe,z,Me;Object.defineProperty(a,"__esModule",{value:!0}),a.AnnotationLayer=void 0;var d=I(1),_=I(6),M=I(3),H=I(33),Z=I(34);const O=1e3,F=9,v=new WeakSet;function j(U){return{width:U[2]-U[0],height:U[3]-U[1]}}class w{static create(e){switch(e.data.annotationType){case d.AnnotationType.LINK:return new p(e);case d.AnnotationType.TEXT:return new u(e);case d.AnnotationType.WIDGET:switch(e.data.fieldType){case"Tx":return new A(e);case"Btn":return e.data.radioButton?new C(e):e.data.checkBox?new x(e):new m(e);case"Ch":return new t(e)}return new o(e);case d.AnnotationType.POPUP:return new c(e);case d.AnnotationType.FREETEXT:return new n(e);case d.AnnotationType.LINE:return new h(e);case d.AnnotationType.SQUARE:return new R(e);case d.AnnotationType.CIRCLE:return new s(e);case d.AnnotationType.POLYLINE:return new D(e);case d.AnnotationType.CARET:return new Y(e);case d.AnnotationType.INK:return new Q(e);case d.AnnotationType.POLYGON:return new q(e);case d.AnnotationType.HIGHLIGHT:return new et(e);case d.AnnotationType.UNDERLINE:return new ct(e);case d.AnnotationType.SQUIGGLY:return new nt(e);case d.AnnotationType.STRIKEOUT:return new ut(e);case d.AnnotationType.STAMP:return new mt(e);case d.AnnotationType.FILEATTACHMENT:return new _t(e);default:return new T(e)}}}class T{constructor(e,{isRenderable:l=!1,ignoreBorder:b=!1,createQuadrilaterals:E=!1}={}){this.isRenderable=l,this.data=e.data,this.layer=e.layer,this.page=e.page,this.viewport=e.viewport,this.linkService=e.linkService,this.downloadManager=e.downloadManager,this.imageResourcesPath=e.imageResourcesPath,this.renderForms=e.renderForms,this.svgFactory=e.svgFactory,this.annotationStorage=e.annotationStorage,this.enableScripting=e.enableScripting,this.hasJSActions=e.hasJSActions,this._fieldObjects=e.fieldObjects,l&&(this.container=this._createContainer(b)),E&&(this.quadrilaterals=this._createQuadrilaterals(b))}_createContainer(e=!1){const{data:l,page:b,viewport:E}=this,P=document.createElement("section");P.setAttribute("data-annotation-id",l.id),l.noRotate&&P.classList.add("norotate");const{pageWidth:V,pageHeight:it,pageX:J,pageY:ot}=E.rawDims,{width:lt,height:st}=j(l.rect),rt=d.Util.normalizeRect([l.rect[0],b.view[3]-l.rect[1]+b.view[1],l.rect[2],b.view[3]-l.rect[3]+b.view[1]]);if(!e&&l.borderStyle.width>0){P.style.borderWidth=`${l.borderStyle.width}px`;const pt=l.borderStyle.horizontalCornerRadius,St=l.borderStyle.verticalCornerRadius;if(pt>0||St>0){const Tt=`calc(${pt}px * var(--scale-factor)) / calc(${St}px * var(--scale-factor))`;P.style.borderRadius=Tt}else if(this instanceof C){const Tt=`calc(${lt}px * var(--scale-factor)) / calc(${st}px * var(--scale-factor))`;P.style.borderRadius=Tt}switch(l.borderStyle.style){case d.AnnotationBorderStyleType.SOLID:P.style.borderStyle="solid";break;case d.AnnotationBorderStyleType.DASHED:P.style.borderStyle="dashed";break;case d.AnnotationBorderStyleType.BEVELED:(0,d.warn)("Unimplemented border style: beveled");break;case d.AnnotationBorderStyleType.INSET:(0,d.warn)("Unimplemented border style: inset");break;case d.AnnotationBorderStyleType.UNDERLINE:P.style.borderBottomStyle="solid";break}const vt=l.borderColor||null;vt?P.style.borderColor=d.Util.makeHexColor(vt[0]|0,vt[1]|0,vt[2]|0):P.style.borderWidth=0}P.style.left=`${100*(rt[0]-J)/V}%`,P.style.top=`${100*(rt[1]-ot)/it}%`;const{rotation:ft}=l;return l.hasOwnCanvas||ft===0?(P.style.width=`${100*lt/V}%`,P.style.height=`${100*st/it}%`):this.setRotation(ft,P),P}setRotation(e,l=this.container){const{pageWidth:b,pageHeight:E}=this.viewport.rawDims,{width:P,height:V}=j(this.data.rect);let it,J;e%180===0?(it=100*P/b,J=100*V/E):(it=100*V/b,J=100*P/E),l.style.width=`${it}%`,l.style.height=`${J}%`,l.setAttribute("data-main-rotation",(360-e)%360)}get _commonActions(){const e=(l,b,E)=>{const P=E.detail[l];E.target.style[b]=H.ColorConverters[`${P[0]}_HTML`](P.slice(1))};return(0,d.shadow)(this,"_commonActions",{display:l=>{const b=l.detail.display%2===1;this.container.style.visibility=b?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{hidden:b,print:l.detail.display===0||l.detail.display===3})},print:l=>{this.annotationStorage.setValue(this.data.id,{print:l.detail.print})},hidden:l=>{this.container.style.visibility=l.detail.hidden?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{hidden:l.detail.hidden})},focus:l=>{setTimeout(()=>l.target.focus({preventScroll:!1}),0)},userName:l=>{l.target.title=l.detail.userName},readonly:l=>{l.detail.readonly?l.target.setAttribute("readonly",""):l.target.removeAttribute("readonly")},required:l=>{this._setRequired(l.target,l.detail.required)},bgColor:l=>{e("bgColor","backgroundColor",l)},fillColor:l=>{e("fillColor","backgroundColor",l)},fgColor:l=>{e("fgColor","color",l)},textColor:l=>{e("textColor","color",l)},borderColor:l=>{e("borderColor","borderColor",l)},strokeColor:l=>{e("strokeColor","borderColor",l)},rotation:l=>{const b=l.detail.rotation;this.setRotation(b),this.annotationStorage.setValue(this.data.id,{rotation:b})}})}_dispatchEventFromSandbox(e,l){const b=this._commonActions;for(const E of Object.keys(l.detail)){const P=e[E]||b[E];P==null||P(l)}}_setDefaultPropertiesFromJS(e){if(!this.enableScripting)return;const l=this.annotationStorage.getRawValue(this.data.id);if(!l)return;const b=this._commonActions;for(const[E,P]of Object.entries(l)){const V=b[E];if(V){const it={detail:{[E]:P},target:e};V(it),delete l[E]}}}_createQuadrilaterals(e=!1){if(!this.data.quadPoints)return null;const l=[],b=this.data.rect;for(const E of this.data.quadPoints)this.data.rect=[E[2].x,E[2].y,E[1].x,E[1].y],l.push(this._createContainer(e));return this.data.rect=b,l}_createPopup(e,l){let b=this.container;this.quadrilaterals&&(e||(e=this.quadrilaterals),b=this.quadrilaterals[0]),e||(e=document.createElement("div"),e.classList.add("popupTriggerArea"),b.append(e));const P=new i({container:b,trigger:e,color:l.color,titleObj:l.titleObj,modificationDate:l.modificationDate,contentsObj:l.contentsObj,richText:l.richText,hideWrapper:!0}).render();P.style.left="100%",b.append(P)}_renderQuadrilaterals(e){for(const l of this.quadrilaterals)l.classList.add(e);return this.quadrilaterals}render(){(0,d.unreachable)("Abstract method `AnnotationElement.render` called")}_getElementsByName(e,l=null){const b=[];if(this._fieldObjects){const E=this._fieldObjects[e];if(E)for(const{page:P,id:V,exportValues:it}of E){if(P===-1||V===l)continue;const J=typeof it=="string"?it:null,ot=document.querySelector(`[data-element-id="${V}"]`);if(ot&&!v.has(ot)){(0,d.warn)(`_getElementsByName - element not allowed: ${V}`);continue}b.push({id:V,exportValue:J,domElement:ot})}return b}for(const E of document.getElementsByName(e)){const{exportValue:P}=E,V=E.getAttribute("data-element-id");V!==l&&v.has(E)&&b.push({id:V,exportValue:P,domElement:E})}return b}}class p extends T{constructor(l,b=null){super(l,{isRenderable:!0,ignoreBorder:!!(b!=null&&b.ignoreBorder),createQuadrilaterals:!0});tt(this,At);tt(this,f);this.isTooltipOnly=l.data.isTooltipOnly}render(){const{data:l,linkService:b}=this,E=document.createElement("a");E.setAttribute("data-element-id",l.id);let P=!1;return l.url?(b.addLinkAttributes(E,l.url,l.newWindow),P=!0):l.action?(this._bindNamedAction(E,l.action),P=!0):l.attachment?(this._bindAttachment(E,l.attachment),P=!0):l.setOCGState?(at(this,f,rn).call(this,E,l.setOCGState),P=!0):l.dest?(this._bindLink(E,l.dest),P=!0):(l.actions&&(l.actions.Action||l.actions["Mouse Up"]||l.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(E,l),P=!0),l.resetForm?(this._bindResetFormAction(E,l.resetForm),P=!0):this.isTooltipOnly&&!P&&(this._bindLink(E,""),P=!0)),this.quadrilaterals?this._renderQuadrilaterals("linkAnnotation").map((V,it)=>{const J=it===0?E:E.cloneNode();return V.append(J),V}):(this.container.classList.add("linkAnnotation"),P&&this.container.append(E),this.container)}_bindLink(l,b){l.href=this.linkService.getDestinationHash(b),l.onclick=()=>(b&&this.linkService.goToDestination(b),!1),(b||b==="")&&at(this,At,Kt).call(this)}_bindNamedAction(l,b){l.href=this.linkService.getAnchorUrl(""),l.onclick=()=>(this.linkService.executeNamedAction(b),!1),at(this,At,Kt).call(this)}_bindAttachment(l,b){l.href=this.linkService.getAnchorUrl(""),l.onclick=()=>{var E;return(E=this.downloadManager)==null||E.openOrDownloadData(this.container,b.content,b.filename),!1},at(this,At,Kt).call(this)}_bindJSAction(l,b){l.href=this.linkService.getAnchorUrl("");const E=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const P of Object.keys(b.actions)){const V=E.get(P);V&&(l[V]=()=>{var it;return(it=this.linkService.eventBus)==null||it.dispatch("dispatcheventinsandbox",{source:this,detail:{id:b.id,name:P}}),!1})}l.onclick||(l.onclick=()=>!1),at(this,At,Kt).call(this)}_bindResetFormAction(l,b){const E=l.onclick;if(E||(l.href=this.linkService.getAnchorUrl("")),at(this,At,Kt).call(this),!this._fieldObjects){(0,d.warn)('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),E||(l.onclick=()=>!1);return}l.onclick=()=>{var st;E==null||E();const{fields:P,refs:V,include:it}=b,J=[];if(P.length!==0||V.length!==0){const rt=new Set(V);for(const ft of P){const pt=this._fieldObjects[ft]||[];for(const{id:St}of pt)rt.add(St)}for(const ft of Object.values(this._fieldObjects))for(const pt of ft)rt.has(pt.id)===it&&J.push(pt)}else for(const rt of Object.values(this._fieldObjects))J.push(...rt);const ot=this.annotationStorage,lt=[];for(const rt of J){const{id:ft}=rt;switch(lt.push(ft),rt.type){case"text":{const St=rt.defaultValue||"";ot.setValue(ft,{value:St});break}case"checkbox":case"radiobutton":{const St=rt.defaultValue===rt.exportValues;ot.setValue(ft,{value:St});break}case"combobox":case"listbox":{const St=rt.defaultValue||"";ot.setValue(ft,{value:St});break}default:continue}const pt=document.querySelector(`[data-element-id="${ft}"]`);if(pt){if(!v.has(pt)){(0,d.warn)(`_bindResetFormAction - element not allowed: ${ft}`);continue}}else continue;pt.dispatchEvent(new Event("resetform"))}return this.enableScripting&&((st=this.linkService.eventBus)==null||st.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:lt,name:"ResetForm"}})),!1}}}At=new WeakSet,Kt=function(){this.container.setAttribute("data-internal-link","")},f=new WeakSet,rn=function(l,b){l.href=this.linkService.getAnchorUrl(""),l.onclick=()=>(this.linkService.executeSetOCGState(b),!1),at(this,At,Kt).call(this)};class u extends T{constructor(e){var b,E,P;const l=!!(e.data.hasPopup||(b=e.data.titleObj)!=null&&b.str||(E=e.data.contentsObj)!=null&&E.str||(P=e.data.richText)!=null&&P.str);super(e,{isRenderable:l})}render(){this.container.classList.add("textAnnotation");const e=document.createElement("img");return e.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",e.alt="[{{type}} Annotation]",e.dataset.l10nId="text_annotation_type",e.dataset.l10nArgs=JSON.stringify({type:this.data.name}),this.data.hasPopup||this._createPopup(e,this.data),this.container.append(e),this.container}}class o extends T{render(){return this.data.alternativeText&&(this.container.title=this.data.alternativeText),this.container}showElementAndHideCanvas(e){var l;this.data.hasOwnCanvas&&(((l=e.previousSibling)==null?void 0:l.nodeName)==="CANVAS"&&(e.previousSibling.hidden=!0),e.hidden=!1)}_getKeyModifier(e){const{isWin:l,isMac:b}=d.FeatureTest.platform;return l&&e.ctrlKey||b&&e.metaKey}_setEventListener(e,l,b,E){l.includes("mouse")?e.addEventListener(l,P=>{var V;(V=this.linkService.eventBus)==null||V.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:b,value:E(P),shift:P.shiftKey,modifier:this._getKeyModifier(P)}})}):e.addEventListener(l,P=>{var V;(V=this.linkService.eventBus)==null||V.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:b,value:E(P)}})})}_setEventListeners(e,l,b){var E;for(const[P,V]of l)(V==="Action"||(E=this.data.actions)!=null&&E[V])&&this._setEventListener(e,P,V,b)}_setBackgroundColor(e){const l=this.data.backgroundColor||null;e.style.backgroundColor=l===null?"transparent":d.Util.makeHexColor(l[0],l[1],l[2])}_setTextStyle(e){const l=["left","center","right"],{fontColor:b}=this.data.defaultAppearanceData,E=this.data.defaultAppearanceData.fontSize||F,P=e.style;let V;const it=2,J=ot=>Math.round(10*ot)/10;if(this.data.multiLine){const ot=Math.abs(this.data.rect[3]-this.data.rect[1]-it),lt=Math.round(ot/(d.LINE_FACTOR*E))||1,st=ot/lt;V=Math.min(E,J(st/d.LINE_FACTOR))}else{const ot=Math.abs(this.data.rect[3]-this.data.rect[1]-it);V=Math.min(E,J(ot/d.LINE_FACTOR))}P.fontSize=`calc(${V}px * var(--scale-factor))`,P.color=d.Util.makeHexColor(b[0],b[1],b[2]),this.data.textAlignment!==null&&(P.textAlign=l[this.data.textAlignment])}_setRequired(e,l){l?e.setAttribute("required",!0):e.removeAttribute("required"),e.setAttribute("aria-required",l)}}class A extends o{constructor(e){const l=e.renderForms||!e.data.hasAppearance&&!!e.data.fieldValue;super(e,{isRenderable:l})}setPropertyOnSiblings(e,l,b,E){const P=this.annotationStorage;for(const V of this._getElementsByName(e.name,e.id))V.domElement&&(V.domElement[l]=b),P.setValue(V.id,{[E]:b})}render(){var E;const e=this.annotationStorage,l=this.data.id;this.container.classList.add("textWidgetAnnotation");let b=null;if(this.renderForms){const P=e.getValue(l,{value:this.data.fieldValue});let V=P.formattedValue||P.value||"";const it=e.getValue(l,{charLimit:this.data.maxLen}).charLimit;it&&V.length>it&&(V=V.slice(0,it));const J={userValue:V,formattedValue:null,lastCommittedValue:null,commitKey:1};this.data.multiLine?(b=document.createElement("textarea"),b.textContent=V,this.data.doNotScroll&&(b.style.overflowY="hidden")):(b=document.createElement("input"),b.type="text",b.setAttribute("value",V),this.data.doNotScroll&&(b.style.overflowX="hidden")),this.data.hasOwnCanvas&&(b.hidden=!0),v.add(b),b.setAttribute("data-element-id",l),b.disabled=this.data.readOnly,b.name=this.data.fieldName,b.tabIndex=O,this._setRequired(b,this.data.required),it&&(b.maxLength=it),b.addEventListener("input",lt=>{e.setValue(l,{value:lt.target.value}),this.setPropertyOnSiblings(b,"value",lt.target.value,"value")}),b.addEventListener("resetform",lt=>{const st=this.data.defaultFieldValue??"";b.value=J.userValue=st,J.formattedValue=null});let ot=lt=>{const{formattedValue:st}=J;st!=null&&(lt.target.value=st),lt.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){b.addEventListener("focus",st=>{const{target:rt}=st;J.userValue&&(rt.value=J.userValue),J.lastCommittedValue=rt.value,J.commitKey=1}),b.addEventListener("updatefromsandbox",st=>{this.showElementAndHideCanvas(st.target);const rt={value(ft){J.userValue=ft.detail.value??"",e.setValue(l,{value:J.userValue.toString()}),ft.target.value=J.userValue},formattedValue(ft){const{formattedValue:pt}=ft.detail;J.formattedValue=pt,pt!=null&&ft.target!==document.activeElement&&(ft.target.value=pt),e.setValue(l,{formattedValue:pt})},selRange(ft){ft.target.setSelectionRange(...ft.detail.selRange)},charLimit:ft=>{var Tt;const{charLimit:pt}=ft.detail,{target:St}=ft;if(pt===0){St.removeAttribute("maxLength");return}St.setAttribute("maxLength",pt);let vt=J.userValue;!vt||vt.length<=pt||(vt=vt.slice(0,pt),St.value=J.userValue=vt,e.setValue(l,{value:vt}),(Tt=this.linkService.eventBus)==null||Tt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:l,name:"Keystroke",value:vt,willCommit:!0,commitKey:1,selStart:St.selectionStart,selEnd:St.selectionEnd}}))}};this._dispatchEventFromSandbox(rt,st)}),b.addEventListener("keydown",st=>{var pt;J.commitKey=1;let rt=-1;if(st.key==="Escape"?rt=0:st.key==="Enter"&&!this.data.multiLine?rt=2:st.key==="Tab"&&(J.commitKey=3),rt===-1)return;const{value:ft}=st.target;J.lastCommittedValue!==ft&&(J.lastCommittedValue=ft,J.userValue=ft,(pt=this.linkService.eventBus)==null||pt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:l,name:"Keystroke",value:ft,willCommit:!0,commitKey:rt,selStart:st.target.selectionStart,selEnd:st.target.selectionEnd}}))});const lt=ot;ot=null,b.addEventListener("blur",st=>{var ft;if(!st.relatedTarget)return;const{value:rt}=st.target;J.userValue=rt,J.lastCommittedValue!==rt&&((ft=this.linkService.eventBus)==null||ft.dispatch("dispatcheventinsandbox",{source:this,detail:{id:l,name:"Keystroke",value:rt,willCommit:!0,commitKey:J.commitKey,selStart:st.target.selectionStart,selEnd:st.target.selectionEnd}})),lt(st)}),(E=this.data.actions)!=null&&E.Keystroke&&b.addEventListener("beforeinput",st=>{var yt;J.lastCommittedValue=null;const{data:rt,target:ft}=st,{value:pt,selectionStart:St,selectionEnd:vt}=ft;let Tt=St,K=vt;switch(st.inputType){case"deleteWordBackward":{const Et=pt.substring(0,St).match(/\w*[^\w]*$/);Et&&(Tt-=Et[0].length);break}case"deleteWordForward":{const Et=pt.substring(St).match(/^[^\w]*\w*/);Et&&(K+=Et[0].length);break}case"deleteContentBackward":St===vt&&(Tt-=1);break;case"deleteContentForward":St===vt&&(K+=1);break}st.preventDefault(),(yt=this.linkService.eventBus)==null||yt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:l,name:"Keystroke",value:pt,change:rt||"",willCommit:!1,selStart:Tt,selEnd:K}})}),this._setEventListeners(b,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],st=>st.target.value)}if(ot&&b.addEventListener("blur",ot),this.data.comb){const st=(this.data.rect[2]-this.data.rect[0])/it;b.classList.add("comb"),b.style.letterSpacing=`calc(${st}px * var(--scale-factor) - 1ch)`}}else b=document.createElement("div"),b.textContent=this.data.fieldValue,b.style.verticalAlign="middle",b.style.display="table-cell";return this._setTextStyle(b),this._setBackgroundColor(b),this._setDefaultPropertiesFromJS(b),this.container.append(b),this.container}}class x extends o{constructor(e){super(e,{isRenderable:e.renderForms})}render(){const e=this.annotationStorage,l=this.data,b=l.id;let E=e.getValue(b,{value:l.exportValue===l.fieldValue}).value;typeof E=="string"&&(E=E!=="Off",e.setValue(b,{value:E})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const P=document.createElement("input");return v.add(P),P.setAttribute("data-element-id",b),P.disabled=l.readOnly,this._setRequired(P,this.data.required),P.type="checkbox",P.name=l.fieldName,E&&P.setAttribute("checked",!0),P.setAttribute("exportValue",l.exportValue),P.tabIndex=O,P.addEventListener("change",V=>{const{name:it,checked:J}=V.target;for(const ot of this._getElementsByName(it,b)){const lt=J&&ot.exportValue===l.exportValue;ot.domElement&&(ot.domElement.checked=lt),e.setValue(ot.id,{value:lt})}e.setValue(b,{value:J})}),P.addEventListener("resetform",V=>{const it=l.defaultFieldValue||"Off";V.target.checked=it===l.exportValue}),this.enableScripting&&this.hasJSActions&&(P.addEventListener("updatefromsandbox",V=>{const it={value(J){J.target.checked=J.detail.value!=="Off",e.setValue(b,{value:J.target.checked})}};this._dispatchEventFromSandbox(it,V)}),this._setEventListeners(P,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],V=>V.target.checked)),this._setBackgroundColor(P),this._setDefaultPropertiesFromJS(P),this.container.append(P),this.container}}class C extends o{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const e=this.annotationStorage,l=this.data,b=l.id;let E=e.getValue(b,{value:l.fieldValue===l.buttonValue}).value;typeof E=="string"&&(E=E!==l.buttonValue,e.setValue(b,{value:E}));const P=document.createElement("input");if(v.add(P),P.setAttribute("data-element-id",b),P.disabled=l.readOnly,this._setRequired(P,this.data.required),P.type="radio",P.name=l.fieldName,E&&P.setAttribute("checked",!0),P.tabIndex=O,P.addEventListener("change",V=>{const{name:it,checked:J}=V.target;for(const ot of this._getElementsByName(it,b))e.setValue(ot.id,{value:!1});e.setValue(b,{value:J})}),P.addEventListener("resetform",V=>{const it=l.defaultFieldValue;V.target.checked=it!=null&&it===l.buttonValue}),this.enableScripting&&this.hasJSActions){const V=l.buttonValue;P.addEventListener("updatefromsandbox",it=>{const J={value:ot=>{const lt=V===ot.detail.value;for(const st of this._getElementsByName(ot.target.name)){const rt=lt&&st.id===b;st.domElement&&(st.domElement.checked=rt),e.setValue(st.id,{value:rt})}}};this._dispatchEventFromSandbox(J,it)}),this._setEventListeners(P,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],it=>it.target.checked)}return this._setBackgroundColor(P),this._setDefaultPropertiesFromJS(P),this.container.append(P),this.container}}class m extends p{constructor(e){super(e,{ignoreBorder:e.data.hasAppearance})}render(){const e=super.render();e.classList.add("buttonWidgetAnnotation","pushButton"),this.data.alternativeText&&(e.title=this.data.alternativeText);const l=e.lastChild;return this.enableScripting&&this.hasJSActions&&l&&(this._setDefaultPropertiesFromJS(l),l.addEventListener("updatefromsandbox",b=>{this._dispatchEventFromSandbox({},b)})),e}}class t extends o{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const e=this.annotationStorage,l=this.data.id,b=e.getValue(l,{value:this.data.fieldValue}),E=document.createElement("select");v.add(E),E.setAttribute("data-element-id",l),E.disabled=this.data.readOnly,this._setRequired(E,this.data.required),E.name=this.data.fieldName,E.tabIndex=O;let P=this.data.combo&&this.data.options.length>0;this.data.combo||(E.size=this.data.options.length,this.data.multiSelect&&(E.multiple=!0)),E.addEventListener("resetform",lt=>{const st=this.data.defaultFieldValue;for(const rt of E.options)rt.selected=rt.value===st});for(const lt of this.data.options){const st=document.createElement("option");st.textContent=lt.displayValue,st.value=lt.exportValue,b.value.includes(lt.exportValue)&&(st.setAttribute("selected",!0),P=!1),E.append(st)}let V=null;if(P){const lt=document.createElement("option");lt.value=" ",lt.setAttribute("hidden",!0),lt.setAttribute("selected",!0),E.prepend(lt),V=()=>{lt.remove(),E.removeEventListener("input",V),V=null},E.addEventListener("input",V)}const it=lt=>{const st=lt?"value":"textContent",{options:rt,multiple:ft}=E;return ft?Array.prototype.filter.call(rt,pt=>pt.selected).map(pt=>pt[st]):rt.selectedIndex===-1?null:rt[rt.selectedIndex][st]};let J=it(!1);const ot=lt=>{const st=lt.target.options;return Array.prototype.map.call(st,rt=>({displayValue:rt.textContent,exportValue:rt.value}))};return this.enableScripting&&this.hasJSActions?(E.addEventListener("updatefromsandbox",lt=>{const st={value(rt){V==null||V();const ft=rt.detail.value,pt=new Set(Array.isArray(ft)?ft:[ft]);for(const St of E.options)St.selected=pt.has(St.value);e.setValue(l,{value:it(!0)}),J=it(!1)},multipleSelection(rt){E.multiple=!0},remove(rt){const ft=E.options,pt=rt.detail.remove;ft[pt].selected=!1,E.remove(pt),ft.length>0&&Array.prototype.findIndex.call(ft,vt=>vt.selected)===-1&&(ft[0].selected=!0),e.setValue(l,{value:it(!0),items:ot(rt)}),J=it(!1)},clear(rt){for(;E.length!==0;)E.remove(0);e.setValue(l,{value:null,items:[]}),J=it(!1)},insert(rt){const{index:ft,displayValue:pt,exportValue:St}=rt.detail.insert,vt=E.children[ft],Tt=document.createElement("option");Tt.textContent=pt,Tt.value=St,vt?vt.before(Tt):E.append(Tt),e.setValue(l,{value:it(!0),items:ot(rt)}),J=it(!1)},items(rt){const{items:ft}=rt.detail;for(;E.length!==0;)E.remove(0);for(const pt of ft){const{displayValue:St,exportValue:vt}=pt,Tt=document.createElement("option");Tt.textContent=St,Tt.value=vt,E.append(Tt)}E.options.length>0&&(E.options[0].selected=!0),e.setValue(l,{value:it(!0),items:ot(rt)}),J=it(!1)},indices(rt){const ft=new Set(rt.detail.indices);for(const pt of rt.target.options)pt.selected=ft.has(pt.index);e.setValue(l,{value:it(!0)}),J=it(!1)},editable(rt){rt.target.disabled=!rt.detail.editable}};this._dispatchEventFromSandbox(st,lt)}),E.addEventListener("input",lt=>{var rt;const st=it(!0);e.setValue(l,{value:st}),lt.preventDefault(),(rt=this.linkService.eventBus)==null||rt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:l,name:"Keystroke",value:J,changeEx:st,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(E,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],lt=>lt.target.value)):E.addEventListener("input",function(lt){e.setValue(l,{value:it(!0)})}),this.data.combo&&this._setTextStyle(E),this._setBackgroundColor(E),this._setDefaultPropertiesFromJS(E),this.container.append(E),this.container}}const S=class extends T{constructor(e){var E,P,V;const{data:l}=e,b=!S.IGNORE_TYPES.has(l.parentType)&&!!((E=l.titleObj)!=null&&E.str||(P=l.contentsObj)!=null&&P.str||(V=l.richText)!=null&&V.str);super(e,{isRenderable:b})}render(){this.container.classList.add("popupAnnotation");const e=this.layer.querySelectorAll(`[data-annotation-id="${this.data.parentId}"]`);if(e.length===0)return this.container;const l=new i({container:this.container,trigger:Array.from(e),color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText}),b=this.page,E=d.Util.normalizeRect([this.data.parentRect[0],b.view[3]-this.data.parentRect[1]+b.view[1],this.data.parentRect[2],b.view[3]-this.data.parentRect[3]+b.view[1]]),P=E[0]+this.data.parentRect[2]-this.data.parentRect[0],V=E[1],{pageWidth:it,pageHeight:J,pageX:ot,pageY:lt}=this.viewport.rawDims;return this.container.style.left=`${100*(P-ot)/it}%`,this.container.style.top=`${100*(V-lt)/J}%`,this.container.append(l.render()),this.container}};let c=S;Lt(c,"IGNORE_TYPES",new Set(["Line","Square","Circle","PolyLine","Polygon","Ink"]));class i{constructor(e){this.container=e.container,this.trigger=e.trigger,this.color=e.color,this.titleObj=e.titleObj,this.modificationDate=e.modificationDate,this.contentsObj=e.contentsObj,this.richText=e.richText,this.hideWrapper=e.hideWrapper||!1,this.pinned=!1}render(){var it,J;const l=document.createElement("div");l.classList.add("popupWrapper"),this.hideElement=this.hideWrapper?l:this.container,this.hideElement.hidden=!0;const b=document.createElement("div");b.classList.add("popup");const E=this.color;if(E){const ot=.7*(255-E[0])+E[0],lt=.7*(255-E[1])+E[1],st=.7*(255-E[2])+E[2];b.style.backgroundColor=d.Util.makeHexColor(ot|0,lt|0,st|0)}const P=document.createElement("h1");P.dir=this.titleObj.dir,P.textContent=this.titleObj.str,b.append(P);const V=_.PDFDateString.toDateObject(this.modificationDate);if(V){const ot=document.createElement("span");ot.classList.add("popupDate"),ot.textContent="{{date}}, {{time}}",ot.dataset.l10nId="annotation_date_string",ot.dataset.l10nArgs=JSON.stringify({date:V.toLocaleDateString(),time:V.toLocaleTimeString()}),b.append(ot)}if((it=this.richText)!=null&&it.str&&(!((J=this.contentsObj)!=null&&J.str)||this.contentsObj.str===this.richText.str))Z.XfaLayer.render({xfaHtml:this.richText.html,intent:"richText",div:b}),b.lastChild.classList.add("richText","popupContent");else{const ot=this._formatContents(this.contentsObj);b.append(ot)}Array.isArray(this.trigger)||(this.trigger=[this.trigger]);for(const ot of this.trigger)ot.addEventListener("click",this._toggle.bind(this)),ot.addEventListener("mouseover",this._show.bind(this,!1)),ot.addEventListener("mouseout",this._hide.bind(this,!1));return b.addEventListener("click",this._hide.bind(this,!0)),l.append(b),l}_formatContents({str:e,dir:l}){const b=document.createElement("p");b.classList.add("popupContent"),b.dir=l;const E=e.split(/(?:\r\n?|\n)/);for(let P=0,V=E.length;P<V;++P){const it=E[P];b.append(document.createTextNode(it)),P<V-1&&b.append(document.createElement("br"))}return b}_toggle(){this.pinned?this._hide(!0):this._show(!0)}_show(e=!1){e&&(this.pinned=!0),this.hideElement.hidden&&(this.hideElement.hidden=!1,this.container.style.zIndex=parseInt(this.container.style.zIndex)+1e3)}_hide(e=!0){e&&(this.pinned=!1),!this.hideElement.hidden&&!this.pinned&&(this.hideElement.hidden=!0,this.container.style.zIndex=parseInt(this.container.style.zIndex)-1e3)}}class n extends T{constructor(e){var b,E,P;const l=!!(e.data.hasPopup||(b=e.data.titleObj)!=null&&b.str||(E=e.data.contentsObj)!=null&&E.str||(P=e.data.richText)!=null&&P.str);super(e,{isRenderable:l,ignoreBorder:!0}),this.textContent=e.data.textContent}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const e=document.createElement("div");e.classList.add("annotationTextContent"),e.setAttribute("role","comment");for(const l of this.textContent){const b=document.createElement("span");b.textContent=l,e.append(b)}this.container.append(e)}return this.data.hasPopup||this._createPopup(null,this.data),this.container}}class h extends T{constructor(e){var b,E,P;const l=!!(e.data.hasPopup||(b=e.data.titleObj)!=null&&b.str||(E=e.data.contentsObj)!=null&&E.str||(P=e.data.richText)!=null&&P.str);super(e,{isRenderable:l,ignoreBorder:!0})}render(){this.container.classList.add("lineAnnotation");const e=this.data,{width:l,height:b}=j(e.rect),E=this.svgFactory.create(l,b,!0),P=this.svgFactory.createElement("svg:line");return P.setAttribute("x1",e.rect[2]-e.lineCoordinates[0]),P.setAttribute("y1",e.rect[3]-e.lineCoordinates[1]),P.setAttribute("x2",e.rect[2]-e.lineCoordinates[2]),P.setAttribute("y2",e.rect[3]-e.lineCoordinates[3]),P.setAttribute("stroke-width",e.borderStyle.width||1),P.setAttribute("stroke","transparent"),P.setAttribute("fill","transparent"),E.append(P),this.container.append(E),this._createPopup(P,e),this.container}}class R extends T{constructor(e){var b,E,P;const l=!!(e.data.hasPopup||(b=e.data.titleObj)!=null&&b.str||(E=e.data.contentsObj)!=null&&E.str||(P=e.data.richText)!=null&&P.str);super(e,{isRenderable:l,ignoreBorder:!0})}render(){this.container.classList.add("squareAnnotation");const e=this.data,{width:l,height:b}=j(e.rect),E=this.svgFactory.create(l,b,!0),P=e.borderStyle.width,V=this.svgFactory.createElement("svg:rect");return V.setAttribute("x",P/2),V.setAttribute("y",P/2),V.setAttribute("width",l-P),V.setAttribute("height",b-P),V.setAttribute("stroke-width",P||1),V.setAttribute("stroke","transparent"),V.setAttribute("fill","transparent"),E.append(V),this.container.append(E),this._createPopup(V,e),this.container}}class s extends T{constructor(e){var b,E,P;const l=!!(e.data.hasPopup||(b=e.data.titleObj)!=null&&b.str||(E=e.data.contentsObj)!=null&&E.str||(P=e.data.richText)!=null&&P.str);super(e,{isRenderable:l,ignoreBorder:!0})}render(){this.container.classList.add("circleAnnotation");const e=this.data,{width:l,height:b}=j(e.rect),E=this.svgFactory.create(l,b,!0),P=e.borderStyle.width,V=this.svgFactory.createElement("svg:ellipse");return V.setAttribute("cx",l/2),V.setAttribute("cy",b/2),V.setAttribute("rx",l/2-P/2),V.setAttribute("ry",b/2-P/2),V.setAttribute("stroke-width",P||1),V.setAttribute("stroke","transparent"),V.setAttribute("fill","transparent"),E.append(V),this.container.append(E),this._createPopup(V,e),this.container}}class D extends T{constructor(e){var b,E,P;const l=!!(e.data.hasPopup||(b=e.data.titleObj)!=null&&b.str||(E=e.data.contentsObj)!=null&&E.str||(P=e.data.richText)!=null&&P.str);super(e,{isRenderable:l,ignoreBorder:!0}),this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const e=this.data,{width:l,height:b}=j(e.rect),E=this.svgFactory.create(l,b,!0);let P=[];for(const it of e.vertices){const J=it.x-e.rect[0],ot=e.rect[3]-it.y;P.push(J+","+ot)}P=P.join(" ");const V=this.svgFactory.createElement(this.svgElementName);return V.setAttribute("points",P),V.setAttribute("stroke-width",e.borderStyle.width||1),V.setAttribute("stroke","transparent"),V.setAttribute("fill","transparent"),E.append(V),this.container.append(E),this._createPopup(V,e),this.container}}class q extends D{constructor(e){super(e),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class Y extends T{constructor(e){var b,E,P;const l=!!(e.data.hasPopup||(b=e.data.titleObj)!=null&&b.str||(E=e.data.contentsObj)!=null&&E.str||(P=e.data.richText)!=null&&P.str);super(e,{isRenderable:l,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),this.data.hasPopup||this._createPopup(null,this.data),this.container}}class Q extends T{constructor(e){var b,E,P;const l=!!(e.data.hasPopup||(b=e.data.titleObj)!=null&&b.str||(E=e.data.contentsObj)!=null&&E.str||(P=e.data.richText)!=null&&P.str);super(e,{isRenderable:l,ignoreBorder:!0}),this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const e=this.data,{width:l,height:b}=j(e.rect),E=this.svgFactory.create(l,b,!0);for(const P of e.inkLists){let V=[];for(const J of P){const ot=J.x-e.rect[0],lt=e.rect[3]-J.y;V.push(`${ot},${lt}`)}V=V.join(" ");const it=this.svgFactory.createElement(this.svgElementName);it.setAttribute("points",V),it.setAttribute("stroke-width",e.borderStyle.width||1),it.setAttribute("stroke","transparent"),it.setAttribute("fill","transparent"),this._createPopup(it,e),E.append(it)}return this.container.append(E),this.container}}class et extends T{constructor(e){var b,E,P;const l=!!(e.data.hasPopup||(b=e.data.titleObj)!=null&&b.str||(E=e.data.contentsObj)!=null&&E.str||(P=e.data.richText)!=null&&P.str);super(e,{isRenderable:l,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("highlightAnnotation"):(this.container.classList.add("highlightAnnotation"),this.container)}}class ct extends T{constructor(e){var b,E,P;const l=!!(e.data.hasPopup||(b=e.data.titleObj)!=null&&b.str||(E=e.data.contentsObj)!=null&&E.str||(P=e.data.richText)!=null&&P.str);super(e,{isRenderable:l,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("underlineAnnotation"):(this.container.classList.add("underlineAnnotation"),this.container)}}class nt extends T{constructor(e){var b,E,P;const l=!!(e.data.hasPopup||(b=e.data.titleObj)!=null&&b.str||(E=e.data.contentsObj)!=null&&E.str||(P=e.data.richText)!=null&&P.str);super(e,{isRenderable:l,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("squigglyAnnotation"):(this.container.classList.add("squigglyAnnotation"),this.container)}}class ut extends T{constructor(e){var b,E,P;const l=!!(e.data.hasPopup||(b=e.data.titleObj)!=null&&b.str||(E=e.data.contentsObj)!=null&&E.str||(P=e.data.richText)!=null&&P.str);super(e,{isRenderable:l,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("strikeoutAnnotation"):(this.container.classList.add("strikeoutAnnotation"),this.container)}}class mt extends T{constructor(e){var b,E,P;const l=!!(e.data.hasPopup||(b=e.data.titleObj)!=null&&b.str||(E=e.data.contentsObj)!=null&&E.str||(P=e.data.richText)!=null&&P.str);super(e,{isRenderable:l,ignoreBorder:!0})}render(){return this.container.classList.add("stampAnnotation"),this.data.hasPopup||this._createPopup(null,this.data),this.container}}class _t extends T{constructor(e){var E;super(e,{isRenderable:!0});const{filename:l,content:b}=this.data.file;this.filename=(0,_.getFilenameFromUrl)(l,!0),this.content=b,(E=this.linkService.eventBus)==null||E.dispatch("fileattachmentannotation",{source:this,filename:l,content:b})}render(){var l,b;this.container.classList.add("fileAttachmentAnnotation");let e;return this.data.hasAppearance?e=document.createElement("div"):(e=document.createElement("img"),e.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(this.data.name)?"paperclip":"pushpin"}.svg`),e.classList.add("popupTriggerArea"),e.addEventListener("dblclick",this._download.bind(this)),!this.data.hasPopup&&((l=this.data.titleObj)!=null&&l.str||(b=this.data.contentsObj)!=null&&b.str||this.data.richText)&&this._createPopup(e,this.data),this.container.append(e),this.container}_download(){var e;(e=this.downloadManager)==null||e.openOrDownloadData(this.container,this.content,this.filename)}}const B=class{static render(e){var J,ot;const{annotations:l,div:b,viewport:E,accessibilityManager:P}=e;(0,_.setLayerDimensions)(b,E);const V={data:null,layer:b,page:e.page,viewport:E,linkService:e.linkService,downloadManager:e.downloadManager,imageResourcesPath:e.imageResourcesPath||"",renderForms:e.renderForms!==!1,svgFactory:new _.DOMSVGFactory,annotationStorage:e.annotationStorage||new M.AnnotationStorage,enableScripting:e.enableScripting===!0,hasJSActions:e.hasJSActions,fieldObjects:e.fieldObjects};let it=0;for(const lt of l){if(lt.noHTML)continue;if(lt.annotationType!==d.AnnotationType.POPUP){const{width:ft,height:pt}=j(lt.rect);if(ft<=0||pt<=0)continue}V.data=lt;const st=w.create(V);if(!st.isRenderable)continue;const rt=st.render();if(lt.hidden&&(rt.style.visibility="hidden"),Array.isArray(rt))for(const ft of rt)ft.style.zIndex=it++,at(J=B,$,Fe).call(J,ft,lt.id,b,P);else rt.style.zIndex=it++,st instanceof c?b.prepend(rt):at(ot=B,$,Fe).call(ot,rt,lt.id,b,P)}at(this,z,Me).call(this,b,e.annotationCanvasMap)}static update(e){const{annotationCanvasMap:l,div:b,viewport:E}=e;(0,_.setLayerDimensions)(b,{rotation:E.rotation}),at(this,z,Me).call(this,b,l),b.hidden=!1}};let xt=B;$=new WeakSet,Fe=function(e,l,b,E){const P=e.firstChild||e;P.id=`${_.AnnotationPrefix}${l}`,b.append(e),E==null||E.moveElementInDOM(b,e,P,!1)},z=new WeakSet,Me=function(e,l){if(l){for(const[b,E]of l){const P=e.querySelector(`[data-annotation-id="${b}"]`);if(!P)continue;const{firstChild:V}=P;V?V.nodeName==="CANVAS"?V.replaceWith(E):V.before(E):P.append(E)}l.clear()}},tt(xt,$),tt(xt,z),a.AnnotationLayer=xt},(G,a)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.ColorConverters=void 0;function I(_){return Math.floor(Math.max(0,Math.min(1,_))*255).toString(16).padStart(2,"0")}class d{static CMYK_G([M,H,Z,O]){return["G",1-Math.min(1,.3*M+.59*Z+.11*H+O)]}static G_CMYK([M]){return["CMYK",0,0,0,1-M]}static G_RGB([M]){return["RGB",M,M,M]}static G_HTML([M]){const H=I(M);return`#${H}${H}${H}`}static RGB_G([M,H,Z]){return["G",.3*M+.59*H+.11*Z]}static RGB_HTML([M,H,Z]){const O=I(M),F=I(H),v=I(Z);return`#${O}${F}${v}`}static T_HTML(){return"#00000000"}static CMYK_RGB([M,H,Z,O]){return["RGB",1-Math.min(1,M+O),1-Math.min(1,Z+O),1-Math.min(1,H+O)]}static CMYK_HTML(M){const H=this.CMYK_RGB(M).slice(1);return this.RGB_HTML(H)}static RGB_CMYK([M,H,Z]){const O=1-M,F=1-H,v=1-Z,j=Math.min(O,F,v);return["CMYK",O,F,v,j]}}a.ColorConverters=d},(G,a,I)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.XfaLayer=void 0;var d=I(19);class _{static setupStorage(H,Z,O,F,v){const j=F.getValue(Z,{value:null});switch(O.name){case"textarea":if(j.value!==null&&(H.textContent=j.value),v==="print")break;H.addEventListener("input",w=>{F.setValue(Z,{value:w.target.value})});break;case"input":if(O.attributes.type==="radio"||O.attributes.type==="checkbox"){if(j.value===O.attributes.xfaOn?H.setAttribute("checked",!0):j.value===O.attributes.xfaOff&&H.removeAttribute("checked"),v==="print")break;H.addEventListener("change",w=>{F.setValue(Z,{value:w.target.checked?w.target.getAttribute("xfaOn"):w.target.getAttribute("xfaOff")})})}else{if(j.value!==null&&H.setAttribute("value",j.value),v==="print")break;H.addEventListener("input",w=>{F.setValue(Z,{value:w.target.value})})}break;case"select":if(j.value!==null)for(const w of O.children)w.attributes.value===j.value&&(w.attributes.selected=!0);H.addEventListener("input",w=>{const T=w.target.options,p=T.selectedIndex===-1?"":T[T.selectedIndex].value;F.setValue(Z,{value:p})});break}}static setAttributes({html:H,element:Z,storage:O=null,intent:F,linkService:v}){const{attributes:j}=Z,w=H instanceof HTMLAnchorElement;j.type==="radio"&&(j.name=`${j.name}-${F}`);for(const[T,p]of Object.entries(j))if(p!=null)switch(T){case"class":p.length&&H.setAttribute(T,p.join(" "));break;case"dataId":break;case"id":H.setAttribute("data-element-id",p);break;case"style":Object.assign(H.style,p);break;case"textContent":H.textContent=p;break;default:(!w||T!=="href"&&T!=="newWindow")&&H.setAttribute(T,p)}w&&v.addLinkAttributes(H,j.href,j.newWindow),O&&j.dataId&&this.setupStorage(H,j.dataId,Z,O)}static render(H){var u;const Z=H.annotationStorage,O=H.linkService,F=H.xfaHtml,v=H.intent||"display",j=document.createElement(F.name);F.attributes&&this.setAttributes({html:j,element:F,intent:v,linkService:O});const w=[[F,-1,j]],T=H.div;if(T.append(j),H.viewport){const o=`matrix(${H.viewport.transform.join(",")})`;T.style.transform=o}v!=="richText"&&T.setAttribute("class","xfaLayer xfaFont");const p=[];for(;w.length>0;){const[o,A,x]=w.at(-1);if(A+1===o.children.length){w.pop();continue}const C=o.children[++w.at(-1)[1]];if(C===null)continue;const{name:m}=C;if(m==="#text"){const c=document.createTextNode(C.value);p.push(c),x.append(c);continue}let t;if((u=C==null?void 0:C.attributes)!=null&&u.xmlns?t=document.createElementNS(C.attributes.xmlns,m):t=document.createElement(m),x.append(t),C.attributes&&this.setAttributes({html:t,element:C,storage:Z,intent:v,linkService:O}),C.children&&C.children.length>0)w.push([C,-1,t]);else if(C.value){const c=document.createTextNode(C.value);d.XfaText.shouldBuildText(m)&&p.push(c),t.append(c)}}for(const o of T.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))o.setAttribute("readOnly",!0);return{textDivs:p}}static update(H){const Z=`matrix(${H.viewport.transform.join(",")})`;H.div.style.transform=Z,H.div.hidden=!1}}a.XfaLayer=_},(G,a,I)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.SVGGraphics=void 0;var d=I(6),_=I(1),M=I(10);let H=class{constructor(){(0,_.unreachable)("Not implemented: SVGGraphics")}};a.SVGGraphics=H;{let u=function(t){let c=[];const i=[];for(const n of t){if(n.fn==="save"){c.push({fnId:92,fn:"group",items:[]}),i.push(c),c=c.at(-1).items;continue}n.fn==="restore"?c=i.pop():c.push(n)}return c},o=function(t){if(Number.isInteger(t))return t.toString();const c=t.toFixed(10);let i=c.length-1;if(c[i]!=="0")return c;do i--;while(c[i]==="0");return c.substring(0,c[i]==="."?i:i+1)},A=function(t){if(t[4]===0&&t[5]===0){if(t[1]===0&&t[2]===0)return t[0]===1&&t[3]===1?"":`scale(${o(t[0])} ${o(t[3])})`;if(t[0]===t[3]&&t[1]===-t[2]){const c=Math.acos(t[0])*180/Math.PI;return`rotate(${o(c)})`}}else if(t[0]===1&&t[1]===0&&t[2]===0&&t[3]===1)return`translate(${o(t[4])} ${o(t[5])})`;return`matrix(${o(t[0])} ${o(t[1])} ${o(t[2])} ${o(t[3])} ${o(t[4])} ${o(t[5])})`};const Z={fontStyle:"normal",fontWeight:"normal",fillColor:"#000000"},O="http://www.w3.org/XML/1998/namespace",F="http://www.w3.org/1999/xlink",v=["butt","round","square"],j=["miter","round","bevel"],w=function(t,c="",i=!1){if(URL.createObjectURL&&typeof Blob<"u"&&!i)return URL.createObjectURL(new Blob([t],{type:c}));const n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let h=`data:${c};base64,`;for(let R=0,s=t.length;R<s;R+=3){const D=t[R]&255,q=t[R+1]&255,Y=t[R+2]&255,Q=D>>2,et=(D&3)<<4|q>>4,ct=R+1<s?(q&15)<<2|Y>>6:64,nt=R+2<s?Y&63:64;h+=n[Q]+n[et]+n[ct]+n[nt]}return h},T=function(){const t=new Uint8Array([137,80,78,71,13,10,26,10]),c=12,i=new Int32Array(256);for(let Y=0;Y<256;Y++){let Q=Y;for(let et=0;et<8;et++)Q&1?Q=3988292384^Q>>1&2147483647:Q=Q>>1&2147483647;i[Y]=Q}function n(Y,Q,et){let ct=-1;for(let nt=Q;nt<et;nt++){const ut=(ct^Y[nt])&255,mt=i[ut];ct=ct>>>8^mt}return ct^-1}function h(Y,Q,et,ct){let nt=ct;const ut=Q.length;et[nt]=ut>>24&255,et[nt+1]=ut>>16&255,et[nt+2]=ut>>8&255,et[nt+3]=ut&255,nt+=4,et[nt]=Y.charCodeAt(0)&255,et[nt+1]=Y.charCodeAt(1)&255,et[nt+2]=Y.charCodeAt(2)&255,et[nt+3]=Y.charCodeAt(3)&255,nt+=4,et.set(Q,nt),nt+=Q.length;const mt=n(et,ct+4,nt);et[nt]=mt>>24&255,et[nt+1]=mt>>16&255,et[nt+2]=mt>>8&255,et[nt+3]=mt&255}function R(Y,Q,et){let ct=1,nt=0;for(let ut=Q;ut<et;++ut)ct=(ct+(Y[ut]&255))%65521,nt=(nt+ct)%65521;return nt<<16|ct}function s(Y){if(!M.isNodeJS)return D(Y);try{let Q;parseInt(process.versions.node)>=8?Q=Y:Q=Buffer.from(Y);const et=require$$5.deflateSync(Q,{level:9});return et instanceof Uint8Array?et:new Uint8Array(et)}catch(Q){(0,_.warn)("Not compressing PNG because zlib.deflateSync is unavailable: "+Q)}return D(Y)}function D(Y){let Q=Y.length;const et=65535,ct=Math.ceil(Q/et),nt=new Uint8Array(2+Q+ct*5+4);let ut=0;nt[ut++]=120,nt[ut++]=156;let mt=0;for(;Q>et;)nt[ut++]=0,nt[ut++]=255,nt[ut++]=255,nt[ut++]=0,nt[ut++]=0,nt.set(Y.subarray(mt,mt+et),ut),ut+=et,mt+=et,Q-=et;nt[ut++]=1,nt[ut++]=Q&255,nt[ut++]=Q>>8&255,nt[ut++]=~Q&65535&255,nt[ut++]=(~Q&65535)>>8&255,nt.set(Y.subarray(mt),ut),ut+=Y.length-mt;const _t=R(Y,0,Y.length);return nt[ut++]=_t>>24&255,nt[ut++]=_t>>16&255,nt[ut++]=_t>>8&255,nt[ut++]=_t&255,nt}function q(Y,Q,et,ct){const nt=Y.width,ut=Y.height;let mt,_t,xt;const At=Y.data;switch(Q){case _.ImageKind.GRAYSCALE_1BPP:_t=0,mt=1,xt=nt+7>>3;break;case _.ImageKind.RGB_24BPP:_t=2,mt=8,xt=nt*3;break;case _.ImageKind.RGBA_32BPP:_t=6,mt=8,xt=nt*4;break;default:throw new Error("invalid format")}const X=new Uint8Array((1+xt)*ut);let f=0,g=0;for(let B=0;B<ut;++B)X[f++]=0,X.set(At.subarray(g,g+xt),f),g+=xt,f+=xt;if(Q===_.ImageKind.GRAYSCALE_1BPP&&ct){f=0;for(let B=0;B<ut;B++){f++;for(let U=0;U<xt;U++)X[f++]^=255}}const S=new Uint8Array([nt>>24&255,nt>>16&255,nt>>8&255,nt&255,ut>>24&255,ut>>16&255,ut>>8&255,ut&255,mt,_t,0,0,0]),$=s(X),W=t.length+c*3+S.length+$.length,z=new Uint8Array(W);let L=0;return z.set(t,L),L+=t.length,h("IHDR",S,z,L),L+=c+S.length,h("IDATA",$,z,L),L+=c+$.length,h("IEND",new Uint8Array(0),z,L),w(z,"image/png",et)}return function(Q,et,ct){const nt=Q.kind===void 0?_.ImageKind.GRAYSCALE_1BPP:Q.kind;return q(Q,nt,et,ct)}}();class p{constructor(){this.fontSizeScale=1,this.fontWeight=Z.fontWeight,this.fontSize=0,this.textMatrix=_.IDENTITY_MATRIX,this.fontMatrix=_.FONT_IDENTITY_MATRIX,this.leading=0,this.textRenderingMode=_.TextRenderingMode.FILL,this.textMatrixScale=1,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRise=0,this.fillColor=Z.fillColor,this.strokeColor="#000000",this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.lineJoin="",this.lineCap="",this.miterLimit=0,this.dashArray=[],this.dashPhase=0,this.dependencies=[],this.activeClipUrl=null,this.clipGroup=null,this.maskId=""}clone(){return Object.create(this)}setCurrentPoint(c,i){this.x=c,this.y=i}}let x=0,C=0,m=0;a.SVGGraphics=H=class{constructor(t,c,i=!1){(0,d.deprecated)("The SVG back-end is no longer maintained and *may* be removed in the future."),this.svgFactory=new d.DOMSVGFactory,this.current=new p,this.transformMatrix=_.IDENTITY_MATRIX,this.transformStack=[],this.extraStack=[],this.commonObjs=t,this.objs=c,this.pendingClip=null,this.pendingEOFill=!1,this.embedFonts=!1,this.embeddedFonts=Object.create(null),this.cssStyle=null,this.forceDataSchema=!!i,this._operatorIdMapping=[];for(const n in _.OPS)this._operatorIdMapping[_.OPS[n]]=n}getObject(t,c=null){return typeof t=="string"?t.startsWith("g_")?this.commonObjs.get(t):this.objs.get(t):c}save(){this.transformStack.push(this.transformMatrix);const t=this.current;this.extraStack.push(t),this.current=t.clone()}restore(){this.transformMatrix=this.transformStack.pop(),this.current=this.extraStack.pop(),this.pendingClip=null,this.tgrp=null}group(t){this.save(),this.executeOpTree(t),this.restore()}loadDependencies(t){const c=t.fnArray,i=t.argsArray;for(let n=0,h=c.length;n<h;n++)if(c[n]===_.OPS.dependency)for(const R of i[n]){const s=R.startsWith("g_")?this.commonObjs:this.objs,D=new Promise(q=>{s.get(R,q)});this.current.dependencies.push(D)}return Promise.all(this.current.dependencies)}transform(t,c,i,n,h,R){const s=[t,c,i,n,h,R];this.transformMatrix=_.Util.transform(this.transformMatrix,s),this.tgrp=null}getSVG(t,c){this.viewport=c;const i=this._initialize(c);return this.loadDependencies(t).then(()=>(this.transformMatrix=_.IDENTITY_MATRIX,this.executeOpTree(this.convertOpList(t)),i))}convertOpList(t){const c=this._operatorIdMapping,i=t.argsArray,n=t.fnArray,h=[];for(let R=0,s=n.length;R<s;R++){const D=n[R];h.push({fnId:D,fn:c[D],args:i[R]})}return u(h)}executeOpTree(t){for(const c of t){const i=c.fn,n=c.fnId,h=c.args;switch(n|0){case _.OPS.beginText:this.beginText();break;case _.OPS.dependency:break;case _.OPS.setLeading:this.setLeading(h);break;case _.OPS.setLeadingMoveText:this.setLeadingMoveText(h[0],h[1]);break;case _.OPS.setFont:this.setFont(h);break;case _.OPS.showText:this.showText(h[0]);break;case _.OPS.showSpacedText:this.showText(h[0]);break;case _.OPS.endText:this.endText();break;case _.OPS.moveText:this.moveText(h[0],h[1]);break;case _.OPS.setCharSpacing:this.setCharSpacing(h[0]);break;case _.OPS.setWordSpacing:this.setWordSpacing(h[0]);break;case _.OPS.setHScale:this.setHScale(h[0]);break;case _.OPS.setTextMatrix:this.setTextMatrix(h[0],h[1],h[2],h[3],h[4],h[5]);break;case _.OPS.setTextRise:this.setTextRise(h[0]);break;case _.OPS.setTextRenderingMode:this.setTextRenderingMode(h[0]);break;case _.OPS.setLineWidth:this.setLineWidth(h[0]);break;case _.OPS.setLineJoin:this.setLineJoin(h[0]);break;case _.OPS.setLineCap:this.setLineCap(h[0]);break;case _.OPS.setMiterLimit:this.setMiterLimit(h[0]);break;case _.OPS.setFillRGBColor:this.setFillRGBColor(h[0],h[1],h[2]);break;case _.OPS.setStrokeRGBColor:this.setStrokeRGBColor(h[0],h[1],h[2]);break;case _.OPS.setStrokeColorN:this.setStrokeColorN(h);break;case _.OPS.setFillColorN:this.setFillColorN(h);break;case _.OPS.shadingFill:this.shadingFill(h[0]);break;case _.OPS.setDash:this.setDash(h[0],h[1]);break;case _.OPS.setRenderingIntent:this.setRenderingIntent(h[0]);break;case _.OPS.setFlatness:this.setFlatness(h[0]);break;case _.OPS.setGState:this.setGState(h[0]);break;case _.OPS.fill:this.fill();break;case _.OPS.eoFill:this.eoFill();break;case _.OPS.stroke:this.stroke();break;case _.OPS.fillStroke:this.fillStroke();break;case _.OPS.eoFillStroke:this.eoFillStroke();break;case _.OPS.clip:this.clip("nonzero");break;case _.OPS.eoClip:this.clip("evenodd");break;case _.OPS.paintSolidColorImageMask:this.paintSolidColorImageMask();break;case _.OPS.paintImageXObject:this.paintImageXObject(h[0]);break;case _.OPS.paintInlineImageXObject:this.paintInlineImageXObject(h[0]);break;case _.OPS.paintImageMaskXObject:this.paintImageMaskXObject(h[0]);break;case _.OPS.paintFormXObjectBegin:this.paintFormXObjectBegin(h[0],h[1]);break;case _.OPS.paintFormXObjectEnd:this.paintFormXObjectEnd();break;case _.OPS.closePath:this.closePath();break;case _.OPS.closeStroke:this.closeStroke();break;case _.OPS.closeFillStroke:this.closeFillStroke();break;case _.OPS.closeEOFillStroke:this.closeEOFillStroke();break;case _.OPS.nextLine:this.nextLine();break;case _.OPS.transform:this.transform(h[0],h[1],h[2],h[3],h[4],h[5]);break;case _.OPS.constructPath:this.constructPath(h[0],h[1]);break;case _.OPS.endPath:this.endPath();break;case 92:this.group(c.items);break;default:(0,_.warn)(`Unimplemented operator ${i}`);break}}}setWordSpacing(t){this.current.wordSpacing=t}setCharSpacing(t){this.current.charSpacing=t}nextLine(){this.moveText(0,this.current.leading)}setTextMatrix(t,c,i,n,h,R){const s=this.current;s.textMatrix=s.lineMatrix=[t,c,i,n,h,R],s.textMatrixScale=Math.hypot(t,c),s.x=s.lineX=0,s.y=s.lineY=0,s.xcoords=[],s.ycoords=[],s.tspan=this.svgFactory.createElement("svg:tspan"),s.tspan.setAttributeNS(null,"font-family",s.fontFamily),s.tspan.setAttributeNS(null,"font-size",`${o(s.fontSize)}px`),s.tspan.setAttributeNS(null,"y",o(-s.y)),s.txtElement=this.svgFactory.createElement("svg:text"),s.txtElement.append(s.tspan)}beginText(){const t=this.current;t.x=t.lineX=0,t.y=t.lineY=0,t.textMatrix=_.IDENTITY_MATRIX,t.lineMatrix=_.IDENTITY_MATRIX,t.textMatrixScale=1,t.tspan=this.svgFactory.createElement("svg:tspan"),t.txtElement=this.svgFactory.createElement("svg:text"),t.txtgrp=this.svgFactory.createElement("svg:g"),t.xcoords=[],t.ycoords=[]}moveText(t,c){const i=this.current;i.x=i.lineX+=t,i.y=i.lineY+=c,i.xcoords=[],i.ycoords=[],i.tspan=this.svgFactory.createElement("svg:tspan"),i.tspan.setAttributeNS(null,"font-family",i.fontFamily),i.tspan.setAttributeNS(null,"font-size",`${o(i.fontSize)}px`),i.tspan.setAttributeNS(null,"y",o(-i.y))}showText(t){const c=this.current,i=c.font,n=c.fontSize;if(n===0)return;const h=c.fontSizeScale,R=c.charSpacing,s=c.wordSpacing,D=c.fontDirection,q=c.textHScale*D,Y=i.vertical,Q=Y?1:-1,et=i.defaultVMetrics,ct=n*c.fontMatrix[0];let nt=0;for(const _t of t){if(_t===null){nt+=D*s;continue}else if(typeof _t=="number"){nt+=Q*_t*n/1e3;continue}const xt=(_t.isSpace?s:0)+R,At=_t.fontChar;let X,f,g=_t.width;if(Y){let $;const W=_t.vmetric||et;$=_t.vmetric?W[1]:g*.5,$=-$*ct;const z=W[2]*ct;g=W?-W[0]:g,X=$/h,f=(nt+z)/h}else X=nt/h,f=0;(_t.isInFont||i.missingFile)&&(c.xcoords.push(c.x+X),Y&&c.ycoords.push(-c.y+f),c.tspan.textContent+=At);let S;Y?S=g*ct-xt*D:S=g*ct+xt*D,nt+=S}c.tspan.setAttributeNS(null,"x",c.xcoords.map(o).join(" ")),Y?c.tspan.setAttributeNS(null,"y",c.ycoords.map(o).join(" ")):c.tspan.setAttributeNS(null,"y",o(-c.y)),Y?c.y-=nt:c.x+=nt*q,c.tspan.setAttributeNS(null,"font-family",c.fontFamily),c.tspan.setAttributeNS(null,"font-size",`${o(c.fontSize)}px`),c.fontStyle!==Z.fontStyle&&c.tspan.setAttributeNS(null,"font-style",c.fontStyle),c.fontWeight!==Z.fontWeight&&c.tspan.setAttributeNS(null,"font-weight",c.fontWeight);const ut=c.textRenderingMode&_.TextRenderingMode.FILL_STROKE_MASK;if(ut===_.TextRenderingMode.FILL||ut===_.TextRenderingMode.FILL_STROKE?(c.fillColor!==Z.fillColor&&c.tspan.setAttributeNS(null,"fill",c.fillColor),c.fillAlpha<1&&c.tspan.setAttributeNS(null,"fill-opacity",c.fillAlpha)):c.textRenderingMode===_.TextRenderingMode.ADD_TO_PATH?c.tspan.setAttributeNS(null,"fill","transparent"):c.tspan.setAttributeNS(null,"fill","none"),ut===_.TextRenderingMode.STROKE||ut===_.TextRenderingMode.FILL_STROKE){const _t=1/(c.textMatrixScale||1);this._setStrokeAttributes(c.tspan,_t)}let mt=c.textMatrix;c.textRise!==0&&(mt=mt.slice(),mt[5]+=c.textRise),c.txtElement.setAttributeNS(null,"transform",`${A(mt)} scale(${o(q)}, -1)`),c.txtElement.setAttributeNS(O,"xml:space","preserve"),c.txtElement.append(c.tspan),c.txtgrp.append(c.txtElement),this._ensureTransformGroup().append(c.txtElement)}setLeadingMoveText(t,c){this.setLeading(-c),this.moveText(t,c)}addFontStyle(t){if(!t.data)throw new Error('addFontStyle: No font data available, ensure that the "fontExtraProperties" API parameter is set.');this.cssStyle||(this.cssStyle=this.svgFactory.createElement("svg:style"),this.cssStyle.setAttributeNS(null,"type","text/css"),this.defs.append(this.cssStyle));const c=w(t.data,t.mimetype,this.forceDataSchema);this.cssStyle.textContent+=`@font-face { font-family: "${t.loadedName}"; src: url(${c}); }
`}setFont(t){const c=this.current,i=this.commonObjs.get(t[0]);let n=t[1];c.font=i,this.embedFonts&&!i.missingFile&&!this.embeddedFonts[i.loadedName]&&(this.addFontStyle(i),this.embeddedFonts[i.loadedName]=i),c.fontMatrix=i.fontMatrix||_.FONT_IDENTITY_MATRIX;let h="normal";i.black?h="900":i.bold&&(h="bold");const R=i.italic?"italic":"normal";n<0?(n=-n,c.fontDirection=-1):c.fontDirection=1,c.fontSize=n,c.fontFamily=i.loadedName,c.fontWeight=h,c.fontStyle=R,c.tspan=this.svgFactory.createElement("svg:tspan"),c.tspan.setAttributeNS(null,"y",o(-c.y)),c.xcoords=[],c.ycoords=[]}endText(){var c;const t=this.current;t.textRenderingMode&_.TextRenderingMode.ADD_TO_PATH_FLAG&&((c=t.txtElement)!=null&&c.hasChildNodes())&&(t.element=t.txtElement,this.clip("nonzero"),this.endPath())}setLineWidth(t){t>0&&(this.current.lineWidth=t)}setLineCap(t){this.current.lineCap=v[t]}setLineJoin(t){this.current.lineJoin=j[t]}setMiterLimit(t){this.current.miterLimit=t}setStrokeAlpha(t){this.current.strokeAlpha=t}setStrokeRGBColor(t,c,i){this.current.strokeColor=_.Util.makeHexColor(t,c,i)}setFillAlpha(t){this.current.fillAlpha=t}setFillRGBColor(t,c,i){this.current.fillColor=_.Util.makeHexColor(t,c,i),this.current.tspan=this.svgFactory.createElement("svg:tspan"),this.current.xcoords=[],this.current.ycoords=[]}setStrokeColorN(t){this.current.strokeColor=this._makeColorN_Pattern(t)}setFillColorN(t){this.current.fillColor=this._makeColorN_Pattern(t)}shadingFill(t){const c=this.viewport.width,i=this.viewport.height,n=_.Util.inverseTransform(this.transformMatrix),h=_.Util.applyTransform([0,0],n),R=_.Util.applyTransform([0,i],n),s=_.Util.applyTransform([c,0],n),D=_.Util.applyTransform([c,i],n),q=Math.min(h[0],R[0],s[0],D[0]),Y=Math.min(h[1],R[1],s[1],D[1]),Q=Math.max(h[0],R[0],s[0],D[0]),et=Math.max(h[1],R[1],s[1],D[1]),ct=this.svgFactory.createElement("svg:rect");ct.setAttributeNS(null,"x",q),ct.setAttributeNS(null,"y",Y),ct.setAttributeNS(null,"width",Q-q),ct.setAttributeNS(null,"height",et-Y),ct.setAttributeNS(null,"fill",this._makeShadingPattern(t)),this.current.fillAlpha<1&&ct.setAttributeNS(null,"fill-opacity",this.current.fillAlpha),this._ensureTransformGroup().append(ct)}_makeColorN_Pattern(t){return t[0]==="TilingPattern"?this._makeTilingPattern(t):this._makeShadingPattern(t)}_makeTilingPattern(t){const c=t[1],i=t[2],n=t[3]||_.IDENTITY_MATRIX,[h,R,s,D]=t[4],q=t[5],Y=t[6],Q=t[7],et=`shading${m++}`,[ct,nt,ut,mt]=_.Util.normalizeRect([..._.Util.applyTransform([h,R],n),..._.Util.applyTransform([s,D],n)]),[_t,xt]=_.Util.singularValueDecompose2dScale(n),At=q*_t,X=Y*xt,f=this.svgFactory.createElement("svg:pattern");f.setAttributeNS(null,"id",et),f.setAttributeNS(null,"patternUnits","userSpaceOnUse"),f.setAttributeNS(null,"width",At),f.setAttributeNS(null,"height",X),f.setAttributeNS(null,"x",`${ct}`),f.setAttributeNS(null,"y",`${nt}`);const g=this.svg,S=this.transformMatrix,$=this.current.fillColor,W=this.current.strokeColor,z=this.svgFactory.create(ut-ct,mt-nt);if(this.svg=z,this.transformMatrix=n,Q===2){const L=_.Util.makeHexColor(...c);this.current.fillColor=L,this.current.strokeColor=L}return this.executeOpTree(this.convertOpList(i)),this.svg=g,this.transformMatrix=S,this.current.fillColor=$,this.current.strokeColor=W,f.append(z.childNodes[0]),this.defs.append(f),`url(#${et})`}_makeShadingPattern(t){switch(typeof t=="string"&&(t=this.objs.get(t)),t[0]){case"RadialAxial":const c=`shading${m++}`,i=t[3];let n;switch(t[1]){case"axial":const h=t[4],R=t[5];n=this.svgFactory.createElement("svg:linearGradient"),n.setAttributeNS(null,"id",c),n.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),n.setAttributeNS(null,"x1",h[0]),n.setAttributeNS(null,"y1",h[1]),n.setAttributeNS(null,"x2",R[0]),n.setAttributeNS(null,"y2",R[1]);break;case"radial":const s=t[4],D=t[5],q=t[6],Y=t[7];n=this.svgFactory.createElement("svg:radialGradient"),n.setAttributeNS(null,"id",c),n.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),n.setAttributeNS(null,"cx",D[0]),n.setAttributeNS(null,"cy",D[1]),n.setAttributeNS(null,"r",Y),n.setAttributeNS(null,"fx",s[0]),n.setAttributeNS(null,"fy",s[1]),n.setAttributeNS(null,"fr",q);break;default:throw new Error(`Unknown RadialAxial type: ${t[1]}`)}for(const h of i){const R=this.svgFactory.createElement("svg:stop");R.setAttributeNS(null,"offset",h[0]),R.setAttributeNS(null,"stop-color",h[1]),n.append(R)}return this.defs.append(n),`url(#${c})`;case"Mesh":return(0,_.warn)("Unimplemented pattern Mesh"),null;case"Dummy":return"hotpink";default:throw new Error(`Unknown IR type: ${t[0]}`)}}setDash(t,c){this.current.dashArray=t,this.current.dashPhase=c}constructPath(t,c){const i=this.current;let n=i.x,h=i.y,R=[],s=0;for(const D of t)switch(D|0){case _.OPS.rectangle:n=c[s++],h=c[s++];const q=c[s++],Y=c[s++],Q=n+q,et=h+Y;R.push("M",o(n),o(h),"L",o(Q),o(h),"L",o(Q),o(et),"L",o(n),o(et),"Z");break;case _.OPS.moveTo:n=c[s++],h=c[s++],R.push("M",o(n),o(h));break;case _.OPS.lineTo:n=c[s++],h=c[s++],R.push("L",o(n),o(h));break;case _.OPS.curveTo:n=c[s+4],h=c[s+5],R.push("C",o(c[s]),o(c[s+1]),o(c[s+2]),o(c[s+3]),o(n),o(h)),s+=6;break;case _.OPS.curveTo2:R.push("C",o(n),o(h),o(c[s]),o(c[s+1]),o(c[s+2]),o(c[s+3])),n=c[s+2],h=c[s+3],s+=4;break;case _.OPS.curveTo3:n=c[s+2],h=c[s+3],R.push("C",o(c[s]),o(c[s+1]),o(n),o(h),o(n),o(h)),s+=4;break;case _.OPS.closePath:R.push("Z");break}R=R.join(" "),i.path&&t.length>0&&t[0]!==_.OPS.rectangle&&t[0]!==_.OPS.moveTo?R=i.path.getAttributeNS(null,"d")+R:(i.path=this.svgFactory.createElement("svg:path"),this._ensureTransformGroup().append(i.path)),i.path.setAttributeNS(null,"d",R),i.path.setAttributeNS(null,"fill","none"),i.element=i.path,i.setCurrentPoint(n,h)}endPath(){const t=this.current;if(t.path=null,!this.pendingClip)return;if(!t.element){this.pendingClip=null;return}const c=`clippath${x++}`,i=this.svgFactory.createElement("svg:clipPath");i.setAttributeNS(null,"id",c),i.setAttributeNS(null,"transform",A(this.transformMatrix));const n=t.element.cloneNode(!0);if(this.pendingClip==="evenodd"?n.setAttributeNS(null,"clip-rule","evenodd"):n.setAttributeNS(null,"clip-rule","nonzero"),this.pendingClip=null,i.append(n),this.defs.append(i),t.activeClipUrl){t.clipGroup=null;for(const h of this.extraStack)h.clipGroup=null;i.setAttributeNS(null,"clip-path",t.activeClipUrl)}t.activeClipUrl=`url(#${c})`,this.tgrp=null}clip(t){this.pendingClip=t}closePath(){const t=this.current;if(t.path){const c=`${t.path.getAttributeNS(null,"d")}Z`;t.path.setAttributeNS(null,"d",c)}}setLeading(t){this.current.leading=-t}setTextRise(t){this.current.textRise=t}setTextRenderingMode(t){this.current.textRenderingMode=t}setHScale(t){this.current.textHScale=t/100}setRenderingIntent(t){}setFlatness(t){}setGState(t){for(const[c,i]of t)switch(c){case"LW":this.setLineWidth(i);break;case"LC":this.setLineCap(i);break;case"LJ":this.setLineJoin(i);break;case"ML":this.setMiterLimit(i);break;case"D":this.setDash(i[0],i[1]);break;case"RI":this.setRenderingIntent(i);break;case"FL":this.setFlatness(i);break;case"Font":this.setFont(i);break;case"CA":this.setStrokeAlpha(i);break;case"ca":this.setFillAlpha(i);break;default:(0,_.warn)(`Unimplemented graphic state operator ${c}`);break}}fill(){const t=this.current;t.element&&(t.element.setAttributeNS(null,"fill",t.fillColor),t.element.setAttributeNS(null,"fill-opacity",t.fillAlpha),this.endPath())}stroke(){const t=this.current;t.element&&(this._setStrokeAttributes(t.element),t.element.setAttributeNS(null,"fill","none"),this.endPath())}_setStrokeAttributes(t,c=1){const i=this.current;let n=i.dashArray;c!==1&&n.length>0&&(n=n.map(function(h){return c*h})),t.setAttributeNS(null,"stroke",i.strokeColor),t.setAttributeNS(null,"stroke-opacity",i.strokeAlpha),t.setAttributeNS(null,"stroke-miterlimit",o(i.miterLimit)),t.setAttributeNS(null,"stroke-linecap",i.lineCap),t.setAttributeNS(null,"stroke-linejoin",i.lineJoin),t.setAttributeNS(null,"stroke-width",o(c*i.lineWidth)+"px"),t.setAttributeNS(null,"stroke-dasharray",n.map(o).join(" ")),t.setAttributeNS(null,"stroke-dashoffset",o(c*i.dashPhase)+"px")}eoFill(){var t;(t=this.current.element)==null||t.setAttributeNS(null,"fill-rule","evenodd"),this.fill()}fillStroke(){this.stroke(),this.fill()}eoFillStroke(){var t;(t=this.current.element)==null||t.setAttributeNS(null,"fill-rule","evenodd"),this.fillStroke()}closeStroke(){this.closePath(),this.stroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.closePath(),this.eoFillStroke()}paintSolidColorImageMask(){const t=this.svgFactory.createElement("svg:rect");t.setAttributeNS(null,"x","0"),t.setAttributeNS(null,"y","0"),t.setAttributeNS(null,"width","1px"),t.setAttributeNS(null,"height","1px"),t.setAttributeNS(null,"fill",this.current.fillColor),this._ensureTransformGroup().append(t)}paintImageXObject(t){const c=this.getObject(t);if(!c){(0,_.warn)(`Dependent image with object ID ${t} is not ready yet`);return}this.paintInlineImageXObject(c)}paintInlineImageXObject(t,c){const i=t.width,n=t.height,h=T(t,this.forceDataSchema,!!c),R=this.svgFactory.createElement("svg:rect");R.setAttributeNS(null,"x","0"),R.setAttributeNS(null,"y","0"),R.setAttributeNS(null,"width",o(i)),R.setAttributeNS(null,"height",o(n)),this.current.element=R,this.clip("nonzero");const s=this.svgFactory.createElement("svg:image");s.setAttributeNS(F,"xlink:href",h),s.setAttributeNS(null,"x","0"),s.setAttributeNS(null,"y",o(-n)),s.setAttributeNS(null,"width",o(i)+"px"),s.setAttributeNS(null,"height",o(n)+"px"),s.setAttributeNS(null,"transform",`scale(${o(1/i)} ${o(-1/n)})`),c?c.append(s):this._ensureTransformGroup().append(s)}paintImageMaskXObject(t){const c=this.getObject(t.data,t);if(c.bitmap){(0,_.warn)("paintImageMaskXObject: ImageBitmap support is not implemented, ensure that the `isOffscreenCanvasSupported` API parameter is disabled.");return}const i=this.current,n=c.width,h=c.height,R=i.fillColor;i.maskId=`mask${C++}`;const s=this.svgFactory.createElement("svg:mask");s.setAttributeNS(null,"id",i.maskId);const D=this.svgFactory.createElement("svg:rect");D.setAttributeNS(null,"x","0"),D.setAttributeNS(null,"y","0"),D.setAttributeNS(null,"width",o(n)),D.setAttributeNS(null,"height",o(h)),D.setAttributeNS(null,"fill",R),D.setAttributeNS(null,"mask",`url(#${i.maskId})`),this.defs.append(s),this._ensureTransformGroup().append(D),this.paintInlineImageXObject(c,s)}paintFormXObjectBegin(t,c){if(Array.isArray(t)&&t.length===6&&this.transform(t[0],t[1],t[2],t[3],t[4],t[5]),c){const i=c[2]-c[0],n=c[3]-c[1],h=this.svgFactory.createElement("svg:rect");h.setAttributeNS(null,"x",c[0]),h.setAttributeNS(null,"y",c[1]),h.setAttributeNS(null,"width",o(i)),h.setAttributeNS(null,"height",o(n)),this.current.element=h,this.clip("nonzero"),this.endPath()}}paintFormXObjectEnd(){}_initialize(t){const c=this.svgFactory.create(t.width,t.height),i=this.svgFactory.createElement("svg:defs");c.append(i),this.defs=i;const n=this.svgFactory.createElement("svg:g");return n.setAttributeNS(null,"transform",A(t.transform)),c.append(n),this.svg=n,c}_ensureClipGroup(){if(!this.current.clipGroup){const t=this.svgFactory.createElement("svg:g");t.setAttributeNS(null,"clip-path",this.current.activeClipUrl),this.svg.append(t),this.current.clipGroup=t}return this.current.clipGroup}_ensureTransformGroup(){return this.tgrp||(this.tgrp=this.svgFactory.createElement("svg:g"),this.tgrp.setAttributeNS(null,"transform",A(this.transformMatrix)),this.current.activeClipUrl?this._ensureClipGroup().append(this.tgrp):this.svg.append(this.tgrp)),this.tgrp}}}}],__webpack_module_cache__={};function __w_pdfjs_require__(G){var a=__webpack_module_cache__[G];if(a!==void 0)return a.exports;var I=__webpack_module_cache__[G]={exports:{}};return __webpack_modules__[G](I,I.exports,__w_pdfjs_require__),I.exports}var __webpack_exports__={};return(()=>{var G=__webpack_exports__;Object.defineProperty(G,"__esModule",{value:!0}),Object.defineProperty(G,"AbortException",{enumerable:!0,get:function(){return a.AbortException}}),Object.defineProperty(G,"AnnotationEditorLayer",{enumerable:!0,get:function(){return M.AnnotationEditorLayer}}),Object.defineProperty(G,"AnnotationEditorParamsType",{enumerable:!0,get:function(){return a.AnnotationEditorParamsType}}),Object.defineProperty(G,"AnnotationEditorType",{enumerable:!0,get:function(){return a.AnnotationEditorType}}),Object.defineProperty(G,"AnnotationEditorUIManager",{enumerable:!0,get:function(){return H.AnnotationEditorUIManager}}),Object.defineProperty(G,"AnnotationLayer",{enumerable:!0,get:function(){return Z.AnnotationLayer}}),Object.defineProperty(G,"AnnotationMode",{enumerable:!0,get:function(){return a.AnnotationMode}}),Object.defineProperty(G,"CMapCompressionType",{enumerable:!0,get:function(){return a.CMapCompressionType}}),Object.defineProperty(G,"FeatureTest",{enumerable:!0,get:function(){return a.FeatureTest}}),Object.defineProperty(G,"GlobalWorkerOptions",{enumerable:!0,get:function(){return O.GlobalWorkerOptions}}),Object.defineProperty(G,"InvalidPDFException",{enumerable:!0,get:function(){return a.InvalidPDFException}}),Object.defineProperty(G,"MissingPDFException",{enumerable:!0,get:function(){return a.MissingPDFException}}),Object.defineProperty(G,"OPS",{enumerable:!0,get:function(){return a.OPS}}),Object.defineProperty(G,"PDFDataRangeTransport",{enumerable:!0,get:function(){return I.PDFDataRangeTransport}}),Object.defineProperty(G,"PDFDateString",{enumerable:!0,get:function(){return d.PDFDateString}}),Object.defineProperty(G,"PDFWorker",{enumerable:!0,get:function(){return I.PDFWorker}}),Object.defineProperty(G,"PasswordResponses",{enumerable:!0,get:function(){return a.PasswordResponses}}),Object.defineProperty(G,"PermissionFlag",{enumerable:!0,get:function(){return a.PermissionFlag}}),Object.defineProperty(G,"PixelsPerInch",{enumerable:!0,get:function(){return d.PixelsPerInch}}),Object.defineProperty(G,"PromiseCapability",{enumerable:!0,get:function(){return a.PromiseCapability}}),Object.defineProperty(G,"RenderingCancelledException",{enumerable:!0,get:function(){return d.RenderingCancelledException}}),Object.defineProperty(G,"SVGGraphics",{enumerable:!0,get:function(){return F.SVGGraphics}}),Object.defineProperty(G,"UnexpectedResponseException",{enumerable:!0,get:function(){return a.UnexpectedResponseException}}),Object.defineProperty(G,"Util",{enumerable:!0,get:function(){return a.Util}}),Object.defineProperty(G,"VerbosityLevel",{enumerable:!0,get:function(){return a.VerbosityLevel}}),Object.defineProperty(G,"XfaLayer",{enumerable:!0,get:function(){return v.XfaLayer}}),Object.defineProperty(G,"build",{enumerable:!0,get:function(){return I.build}}),Object.defineProperty(G,"createValidAbsoluteUrl",{enumerable:!0,get:function(){return a.createValidAbsoluteUrl}}),Object.defineProperty(G,"getDocument",{enumerable:!0,get:function(){return I.getDocument}}),Object.defineProperty(G,"getFilenameFromUrl",{enumerable:!0,get:function(){return d.getFilenameFromUrl}}),Object.defineProperty(G,"getPdfFilenameFromUrl",{enumerable:!0,get:function(){return d.getPdfFilenameFromUrl}}),Object.defineProperty(G,"getXfaPageViewport",{enumerable:!0,get:function(){return d.getXfaPageViewport}}),Object.defineProperty(G,"isDataScheme",{enumerable:!0,get:function(){return d.isDataScheme}}),Object.defineProperty(G,"isPdfFile",{enumerable:!0,get:function(){return d.isPdfFile}}),Object.defineProperty(G,"loadScript",{enumerable:!0,get:function(){return d.loadScript}}),Object.defineProperty(G,"normalizeUnicode",{enumerable:!0,get:function(){return a.normalizeUnicode}}),Object.defineProperty(G,"renderTextLayer",{enumerable:!0,get:function(){return _.renderTextLayer}}),Object.defineProperty(G,"setLayerDimensions",{enumerable:!0,get:function(){return d.setLayerDimensions}}),Object.defineProperty(G,"shadow",{enumerable:!0,get:function(){return a.shadow}}),Object.defineProperty(G,"updateTextLayer",{enumerable:!0,get:function(){return _.updateTextLayer}}),Object.defineProperty(G,"version",{enumerable:!0,get:function(){return I.version}});var a=__w_pdfjs_require__(1),I=__w_pdfjs_require__(2),d=__w_pdfjs_require__(6),_=__w_pdfjs_require__(26),M=__w_pdfjs_require__(27),H=__w_pdfjs_require__(5),Z=__w_pdfjs_require__(32),O=__w_pdfjs_require__(14),F=__w_pdfjs_require__(35),v=__w_pdfjs_require__(34)})(),__webpack_exports__})())})(pdf$1);var pdfExports=pdf$1.exports;const pdf=getDefaultExportFromCjs(pdfExports),pdfjsModule=_mergeNamespaces({__proto__:null,default:pdf},[pdfExports]),pdfjs="default"in pdfjsModule?pdf:pdfjsModule,pdfjs$1=pdfjs;var __spreadArray=globalThis&&globalThis.__spreadArray||function(G,a,I){if(I||arguments.length===2)for(var d=0,_=a.length,M;d<_;d++)(M||!(d in a))&&(M||(M=Array.prototype.slice.call(a,0,d)),M[d]=a[d]);return G.concat(M||Array.prototype.slice.call(a))},clipboardEvents=["onCopy","onCut","onPaste"],compositionEvents=["onCompositionEnd","onCompositionStart","onCompositionUpdate"],focusEvents=["onFocus","onBlur"],formEvents=["onInput","onInvalid","onReset","onSubmit"],imageEvents=["onLoad","onError"],keyboardEvents=["onKeyDown","onKeyPress","onKeyUp"],mediaEvents=["onAbort","onCanPlay","onCanPlayThrough","onDurationChange","onEmptied","onEncrypted","onEnded","onError","onLoadedData","onLoadedMetadata","onLoadStart","onPause","onPlay","onPlaying","onProgress","onRateChange","onSeeked","onSeeking","onStalled","onSuspend","onTimeUpdate","onVolumeChange","onWaiting"],mouseEvents=["onClick","onContextMenu","onDoubleClick","onMouseDown","onMouseEnter","onMouseLeave","onMouseMove","onMouseOut","onMouseOver","onMouseUp"],dragEvents=["onDrag","onDragEnd","onDragEnter","onDragExit","onDragLeave","onDragOver","onDragStart","onDrop"],selectionEvents=["onSelect"],touchEvents=["onTouchCancel","onTouchEnd","onTouchMove","onTouchStart"],pointerEvents=["onPointerDown","onPointerMove","onPointerUp","onPointerCancel","onGotPointerCapture","onLostPointerCapture","onPointerEnter","onPointerLeave","onPointerOver","onPointerOut"],uiEvents=["onScroll"],wheelEvents=["onWheel"],animationEvents=["onAnimationStart","onAnimationEnd","onAnimationIteration"],transitionEvents=["onTransitionEnd"],otherEvents=["onToggle"],changeEvents=["onChange"],allEvents=__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray([],clipboardEvents,!0),compositionEvents,!0),focusEvents,!0),formEvents,!0),imageEvents,!0),keyboardEvents,!0),mediaEvents,!0),mouseEvents,!0),dragEvents,!0),selectionEvents,!0),touchEvents,!0),pointerEvents,!0),uiEvents,!0),wheelEvents,!0),animationEvents,!0),transitionEvents,!0),changeEvents,!0),otherEvents,!0);function makeEventProps(G,a){var I={};return allEvents.forEach(function(d){var _=G[d];_&&(a?I[d]=function(M){return _(M,a(d))}:I[d]=_)}),I}function makeCancellablePromise(G){var a=!1,I=new Promise(function(d,_){G.then(function(M){return!a&&d(M)}).catch(function(M){return!a&&_(M)})});return{promise:I,cancel:function(){a=!0}}}function r(G){var a,I,d="";if(typeof G=="string"||typeof G=="number")d+=G;else if(typeof G=="object")if(Array.isArray(G))for(a=0;a<G.length;a++)G[a]&&(I=r(G[a]))&&(d&&(d+=" "),d+=I);else for(a in G)G[a]&&(d&&(d+=" "),d+=a);return d}function clsx(){for(var G,a,I=0,d="";I<arguments.length;)(G=arguments[I++])&&(a=r(G))&&(d&&(d+=" "),d+=a);return d}var isProduction$1=!0,prefix="Invariant failed";function invariant(G,a){if(!G){if(isProduction$1)throw new Error(prefix);var I=typeof a=="function"?a():a,d=I?"".concat(prefix,": ").concat(I):prefix;throw new Error(d)}}var isProduction=!0;function warning(G,a){if(!isProduction){if(G)return;var I="Warning: "+a;typeof console<"u"&&console.warn(I);try{throw Error(I)}catch{}}}const DocumentContext=reactExports.createContext(null);function Message({children:G,type:a}){return React.createElement("div",{className:`react-pdf__message react-pdf__message--${a}`},G)}const DEFAULT_LINK_REL="noopener noreferrer nofollow";class LinkService{constructor(){this.externalLinkEnabled=!0,this.externalLinkRel=void 0,this.externalLinkTarget=void 0,this.isInPresentationMode=!1,this.pdfDocument=void 0,this.pdfViewer=void 0}setDocument(a){this.pdfDocument=a}setViewer(a){this.pdfViewer=a}setExternalLinkRel(a){this.externalLinkRel=a}setExternalLinkTarget(a){this.externalLinkTarget=a}setHistory(){}get pagesCount(){return this.pdfDocument?this.pdfDocument.numPages:0}get page(){return invariant(this.pdfViewer,"PDF viewer is not initialized."),this.pdfViewer.currentPageNumber||0}set page(a){invariant(this.pdfViewer,"PDF viewer is not initialized."),this.pdfViewer.currentPageNumber=a}get rotation(){return 0}set rotation(a){}goToDestination(a){return new Promise(I=>{invariant(this.pdfDocument,"PDF document not loaded."),invariant(a,"Destination is not specified."),typeof a=="string"?this.pdfDocument.getDestination(a).then(I):Array.isArray(a)?I(a):a.then(I)}).then(I=>{invariant(Array.isArray(I),`"${I}" is not a valid destination array.`);const d=I[0];new Promise(_=>{invariant(this.pdfDocument,"PDF document not loaded."),d instanceof Object?this.pdfDocument.getPageIndex(d).then(M=>{_(M)}).catch(()=>{invariant(!1,`"${d}" is not a valid page reference.`)}):typeof d=="number"?_(d):invariant(!1,`"${d}" is not a valid destination reference.`)}).then(_=>{const M=_+1;invariant(this.pdfViewer,"PDF viewer is not initialized."),invariant(M>=1&&M<=this.pagesCount,`"${M}" is not a valid page number.`),this.pdfViewer.scrollPageIntoView({dest:I,pageIndex:_,pageNumber:M})})})}navigateTo(a){this.goToDestination(a)}goToPage(a){const I=a-1;invariant(this.pdfViewer,"PDF viewer is not initialized."),invariant(a>=1&&a<=this.pagesCount,`"${a}" is not a valid page number.`),this.pdfViewer.scrollPageIntoView({pageIndex:I,pageNumber:a})}addLinkAttributes(a,I,d){a.href=I,a.rel=this.externalLinkRel||DEFAULT_LINK_REL,a.target=d?"_blank":this.externalLinkTarget||""}getDestinationHash(){return"#"}getAnchorUrl(){return"#"}setHash(){}executeNamedAction(){}cachePageRef(){}isPageVisible(){return!0}isPageCached(){return!0}executeSetOCGState(){}}const PasswordResponses={NEED_PASSWORD:1,INCORRECT_PASSWORD:2},PasswordResponses$1=PasswordResponses,isBrowser=typeof document<"u",isLocalFileSystem=isBrowser&&window.location.protocol==="file:";function isDefined(G){return typeof G<"u"}function isProvided(G){return isDefined(G)&&G!==null}function isString(G){return typeof G=="string"}function isArrayBuffer(G){return G instanceof ArrayBuffer}function isBlob(G){return invariant(isBrowser,"isBlob can only be used in a browser environment"),G instanceof Blob}function isDataURI(G){return isString(G)&&/^data:/.test(G)}function dataURItoByteString(G){invariant(isDataURI(G),"Invalid data URI.");const[a="",I=""]=G.split(",");return a.split(";").indexOf("base64")!==-1?atob(I):unescape(I)}function getDevicePixelRatio(){return isBrowser&&window.devicePixelRatio||1}const allowFileAccessFromFilesTip="On Chromium based browsers, you can use --allow-file-access-from-files flag for debugging purposes.";function displayCORSWarning(){warning(!isLocalFileSystem,`Loading PDF as base64 strings/URLs may not work on protocols other than HTTP/HTTPS. ${allowFileAccessFromFilesTip}`)}function displayWorkerWarning(){warning(!isLocalFileSystem,`Loading PDF.js worker may not work on protocols other than HTTP/HTTPS. ${allowFileAccessFromFilesTip}`)}function cancelRunningTask(G){G&&G.cancel&&G.cancel()}function makePageCallback(G,a){return Object.defineProperty(G,"width",{get(){return this.view[2]*a},configurable:!0}),Object.defineProperty(G,"height",{get(){return this.view[3]*a},configurable:!0}),Object.defineProperty(G,"originalWidth",{get(){return this.view[2]},configurable:!0}),Object.defineProperty(G,"originalHeight",{get(){return this.view[3]},configurable:!0}),G}function isCancelException(G){return G.name==="RenderingCancelledException"}function loadFromFile(G){return new Promise((a,I)=>{const d=new FileReader;d.onload=()=>{if(!d.result)return I(new Error("Error while reading a file."));a(d.result)},d.onerror=_=>{if(!_.target)return I(new Error("Error while reading a file."));const{error:M}=_.target;if(!M)return I(new Error("Error while reading a file."));switch(M.code){case M.NOT_FOUND_ERR:return I(new Error("Error while reading a file: File not found."));case M.SECURITY_ERR:return I(new Error("Error while reading a file: Security error."));case M.ABORT_ERR:return I(new Error("Error while reading a file: Aborted."));default:return I(new Error("Error while reading a file."))}},d.readAsArrayBuffer(G)})}function reducer(G,a){switch(a.type){case"RESOLVE":return{value:a.value,error:void 0};case"REJECT":return{value:!1,error:a.error};case"RESET":return{value:void 0,error:void 0};default:return G}}function useResolver(){return reactExports.useReducer(reducer,{value:void 0,error:void 0})}const{PDFDataRangeTransport:PDFDataRangeTransport$1}=pdfjs$1,eventProps=(()=>{const G={};return allEvents.forEach(a=>{G[a]=PropTypes.func}),G})(),isTypedArray=PropTypes.oneOfType([PropTypes.instanceOf(Int8Array),PropTypes.instanceOf(Uint8Array),PropTypes.instanceOf(Uint8ClampedArray),PropTypes.instanceOf(Int16Array),PropTypes.instanceOf(Uint16Array),PropTypes.instanceOf(Int32Array),PropTypes.instanceOf(Uint32Array),PropTypes.instanceOf(Float32Array),PropTypes.instanceOf(Float64Array)]),fileTypes=[PropTypes.string,PropTypes.instanceOf(ArrayBuffer),PropTypes.shape({data:PropTypes.oneOfType([PropTypes.string,PropTypes.instanceOf(ArrayBuffer),PropTypes.arrayOf(PropTypes.number.isRequired),isTypedArray]).isRequired}),PropTypes.shape({range:PropTypes.instanceOf(PDFDataRangeTransport$1).isRequired}),PropTypes.shape({url:PropTypes.string.isRequired})];typeof Blob<"u"&&fileTypes.push(PropTypes.instanceOf(Blob));const isClassName=PropTypes.oneOfType([PropTypes.string,PropTypes.arrayOf(PropTypes.string)]),isFile=PropTypes.oneOfType(fileTypes);PropTypes.instanceOf(LinkService);PropTypes.oneOf(["_self","_blank","_parent","_top"]);PropTypes.shape({commonObjs:PropTypes.shape({}).isRequired,getAnnotations:PropTypes.func.isRequired,getTextContent:PropTypes.func.isRequired,getViewport:PropTypes.func.isRequired,render:PropTypes.func.isRequired});const isPageIndex=function G(a,I,d){const{[I]:_,pageNumber:M,pdf:H}=a;if(!isDefined(H))return null;if(isDefined(_)){if(typeof _!="number")return new Error(`\`${I}\` of type \`${typeof _}\` supplied to \`${d}\`, expected \`number\`.`);if(_<0)return new Error(`Expected \`${I}\` to be greater or equal to 0.`);const{numPages:Z}=H;if(_+1>Z)return new Error(`Expected \`${I}\` to be less or equal to ${Z-1}.`)}else if(!isDefined(M))return new Error(`\`${I}\` not supplied. Either pageIndex or pageNumber must be supplied to \`${d}\`.`);return null},isPageNumber=function G(a,I,d){const{[I]:_,pageIndex:M,pdf:H}=a;if(!isDefined(H))return null;if(isDefined(_)){if(typeof _!="number")return new Error(`\`${I}\` of type \`${typeof _}\` supplied to \`${d}\`, expected \`number\`.`);if(_<1)return new Error(`Expected \`${I}\` to be greater or equal to 1.`);const{numPages:Z}=H;if(_>Z)return new Error(`Expected \`${I}\` to be less or equal to ${Z}.`)}else if(!isDefined(M))return new Error(`\`${I}\` not supplied. Either pageIndex or pageNumber must be supplied to \`${d}\`.`);return null},isPdf=PropTypes.oneOfType([PropTypes.any,PropTypes.oneOf([!1])]),isRef=PropTypes.oneOfType([PropTypes.func,PropTypes.exact({current:PropTypes.any})]),isRenderMode=PropTypes.oneOf(["canvas","custom","none","svg"]),isRotate=PropTypes.oneOf([0,90,180,270]);var __awaiter=globalThis&&globalThis.__awaiter||function(G,a,I,d){function _(M){return M instanceof I?M:new I(function(H){H(M)})}return new(I||(I=Promise))(function(M,H){function Z(v){try{F(d.next(v))}catch(j){H(j)}}function O(v){try{F(d.throw(v))}catch(j){H(j)}}function F(v){v.done?M(v.value):_(v.value).then(Z,O)}F((d=d.apply(G,a||[])).next())})},__rest$1=globalThis&&globalThis.__rest||function(G,a){var I={};for(var d in G)Object.prototype.hasOwnProperty.call(G,d)&&a.indexOf(d)<0&&(I[d]=G[d]);if(G!=null&&typeof Object.getOwnPropertySymbols=="function")for(var _=0,d=Object.getOwnPropertySymbols(G);_<d.length;_++)a.indexOf(d[_])<0&&Object.prototype.propertyIsEnumerable.call(G,d[_])&&(I[d[_]]=G[d[_]]);return I};const{PDFDataRangeTransport}=pdfjs$1,defaultOnPassword=(G,a)=>{switch(a){case PasswordResponses$1.NEED_PASSWORD:{const I=prompt("Enter the password to open this PDF file.");G(I);break}case PasswordResponses$1.INCORRECT_PASSWORD:{const I=prompt("Invalid password. Please try again.");G(I);break}}},Document=reactExports.forwardRef(function G(a,I){var{children:d,className:_,error:M="Failed to load PDF file.",externalLinkRel:H,externalLinkTarget:Z,file:O,inputRef:F,imageResourcesPath:v,loading:j="Loading PDF…",noData:w="No PDF file specified.",onItemClick:T,onLoadError:p,onLoadProgress:u,onLoadSuccess:o,onPassword:A=defaultOnPassword,onSourceError:x,onSourceSuccess:C,options:m,renderMode:t,rotate:c}=a,i=__rest$1(a,["children","className","error","externalLinkRel","externalLinkTarget","file","inputRef","imageResourcesPath","loading","noData","onItemClick","onLoadError","onLoadProgress","onLoadSuccess","onPassword","onSourceError","onSourceSuccess","options","renderMode","rotate"]);const[n,h]=useResolver(),{value:R,error:s}=n,[D,q]=useResolver(),{value:Y,error:Q}=D,et=reactExports.useRef(new LinkService),ct=reactExports.useRef([]),nt=reactExports.useRef({scrollPageIntoView:e=>{const{dest:l,pageNumber:b,pageIndex:E=b-1}=e;if(T){T({dest:l,pageIndex:E,pageNumber:b});return}const P=ct.current[E];if(P){P.scrollIntoView();return}warning(!1,`An internal link leading to page ${b} was clicked, but neither <Document> was provided with onItemClick nor it was able to find the page within itself. Either provide onItemClick to <Document> and handle navigating by yourself or ensure that all pages are rendered within <Document>.`)}});reactExports.useImperativeHandle(I,()=>({linkService:et,pages:ct,viewer:nt}),[]);function ut(){C&&C()}function mt(){s&&(warning(!1,s.toString()),x&&x(s))}function _t(){h({type:"RESET"})}reactExports.useEffect(_t,[O,h]);const xt=reactExports.useCallback(()=>__awaiter(this,void 0,void 0,function*(){if(!O)return null;if(typeof O=="string")return isDataURI(O)?{data:dataURItoByteString(O)}:(displayCORSWarning(),{url:O});if(O instanceof PDFDataRangeTransport)return{range:O};if(isArrayBuffer(O))return{data:O};if(isBrowser&&isBlob(O))return{data:yield loadFromFile(O)};if(invariant(typeof O=="object","Invalid parameter in file, need either Uint8Array, string or a parameter object"),invariant("data"in O||"range"in O||"url"in O,"Invalid parameter object: need either .data, .range or .url"),"url"in O&&typeof O.url=="string"){if(isDataURI(O.url)){const{url:e}=O,l=__rest$1(O,["url"]),b=dataURItoByteString(e);return Object.assign({data:b},l)}displayCORSWarning()}return O}),[O]);reactExports.useEffect(()=>{const e=makeCancellablePromise(xt());return e.promise.then(l=>{h({type:"RESOLVE",value:l})}).catch(l=>{h({type:"REJECT",error:l})}),()=>{cancelRunningTask(e)}},[xt,h]),reactExports.useEffect(()=>{if(!(typeof R>"u")){if(R===!1){mt();return}ut()}},[R]);function At(){Y&&(o&&o(Y),ct.current=new Array(Y.numPages),et.current.setDocument(Y))}function X(){Q&&(warning(!1,Q.toString()),p&&p(Q))}function f(){q({type:"RESET"})}reactExports.useEffect(f,[q,R]);function g(){if(!R)return;const e=m?Object.assign(Object.assign({},R),m):R,l=pdfjs$1.getDocument(e);u&&(l.onProgress=u),A&&(l.onPassword=A);const b=l;return b.promise.then(E=>{q({type:"RESOLVE",value:E})}).catch(E=>{b.destroyed||q({type:"REJECT",error:E})}),()=>{b.destroy()}}reactExports.useEffect(g,[m,q,R]),reactExports.useEffect(()=>{if(!(typeof Y>"u")){if(Y===!1){X();return}At()}},[Y]);function S(){et.current.setViewer(nt.current),et.current.setExternalLinkRel(H),et.current.setExternalLinkTarget(Z)}reactExports.useEffect(S,[H,Z]);function $(e,l){ct.current[e]=l}function W(e){delete ct.current[e]}const z=reactExports.useMemo(()=>({imageResourcesPath:v,linkService:et.current,onItemClick:T,pdf:Y,registerPage:$,renderMode:t,rotate:c,unregisterPage:W}),[v,T,Y,t,c]),L=reactExports.useMemo(()=>makeEventProps(i,()=>Y),[i,Y]);function B(){return React.createElement(DocumentContext.Provider,{value:z},d)}function U(){return O?Y==null?React.createElement(Message,{type:"loading"},typeof j=="function"?j():j):Y===!1?React.createElement(Message,{type:"error"},typeof M=="function"?M():M):B():React.createElement(Message,{type:"no-data"},typeof w=="function"?w():w)}return React.createElement("div",Object.assign({className:clsx("react-pdf__Document",_),ref:F,style:{["--scale-factor"]:"1"}},L),U())}),isFunctionOrNode$1=PropTypes.oneOfType([PropTypes.func,PropTypes.node]);Document.propTypes=Object.assign(Object.assign({},eventProps),{children:PropTypes.node,className:isClassName,error:isFunctionOrNode$1,externalLinkRel:PropTypes.string,externalLinkTarget:PropTypes.oneOf(["_self","_blank","_parent","_top"]),file:isFile,imageResourcesPath:PropTypes.string,inputRef:isRef,loading:isFunctionOrNode$1,noData:isFunctionOrNode$1,onItemClick:PropTypes.func,onLoadError:PropTypes.func,onLoadProgress:PropTypes.func,onLoadSuccess:PropTypes.func,onPassword:PropTypes.func,onSourceError:PropTypes.func,onSourceSuccess:PropTypes.func,options:PropTypes.shape({canvasFactory:PropTypes.any,canvasMaxAreaInBytes:PropTypes.number,cMapPacked:PropTypes.bool,CMapReaderFactory:PropTypes.any,cMapUrl:PropTypes.string,disableAutoFetch:PropTypes.bool,disableFontFace:PropTypes.bool,disableRange:PropTypes.bool,disableStream:PropTypes.bool,docBaseUrl:PropTypes.string,enableXfa:PropTypes.bool,filterFactory:PropTypes.any,fontExtraProperties:PropTypes.bool,httpHeaders:PropTypes.object,isEvalSupported:PropTypes.bool,isOffscreenCanvasSupported:PropTypes.bool,length:PropTypes.number,maxImageSize:PropTypes.number,ownerDocument:PropTypes.any,password:PropTypes.string,pdfBug:PropTypes.bool,rangeChunkSize:PropTypes.number,StandardFontDataFactory:PropTypes.any,standardFontDataUrl:PropTypes.string,stopAtErrors:PropTypes.bool,useSystemFonts:PropTypes.bool,useWorkerFetch:PropTypes.bool,verbosity:PropTypes.number,withCredentials:PropTypes.bool,worker:PropTypes.any}),rotate:PropTypes.number});const Document$1=Document;function useDocumentContext(){return reactExports.useContext(DocumentContext)}function mergeRefs(){for(var G=[],a=0;a<arguments.length;a++)G[a]=arguments[a];var I=G.filter(Boolean);if(I.length<=1){var d=I[0];return d||null}return function(M){I.forEach(function(H){typeof H=="function"?H(M):H&&(H.current=M)})}}const PageContext=reactExports.createContext(null),PDF_ROLE_TO_HTML_ROLE={Document:null,DocumentFragment:null,Part:"group",Sect:"group",Div:"group",Aside:"note",NonStruct:"none",P:null,H:"heading",Title:null,FENote:"note",Sub:"group",Lbl:null,Span:null,Em:null,Strong:null,Link:"link",Annot:"note",Form:"form",Ruby:null,RB:null,RT:null,RP:null,Warichu:null,WT:null,WP:null,L:"list",LI:"listitem",LBody:null,Table:"table",TR:"row",TH:"columnheader",TD:"cell",THead:"columnheader",TBody:null,TFoot:null,Caption:null,Figure:"figure",Formula:null,Artifact:null},HEADING_PATTERN=/^H(\d+)$/;function isPdfRole(G){return G in PDF_ROLE_TO_HTML_ROLE}function isStructTreeNode(G){return"children"in G}function isStructTreeNodeWithOnlyContentChild(G){return isStructTreeNode(G)?G.children.length===1&&0 in G.children&&"id"in G.children[0]:!1}function getRoleAttributes(G){const a={};if(isStructTreeNode(G)){const{role:I}=G,d=I.match(HEADING_PATTERN);if(d)a.role="heading",a["aria-level"]=Number(d[1]);else if(isPdfRole(I)){const _=PDF_ROLE_TO_HTML_ROLE[I];_&&(a.role=_)}}return a}function getBaseAttributes(G){const a={};if(isStructTreeNode(G)){if(G.alt!==void 0&&(a["aria-label"]=G.alt),G.lang!==void 0&&(a.lang=G.lang),isStructTreeNodeWithOnlyContentChild(G)){const[I]=G.children;if(I){const d=getBaseAttributes(I);return Object.assign(Object.assign({},a),d)}}}else"id"in G&&(a["aria-owns"]=G.id);return a}function getAttributes(G){return G?Object.assign(Object.assign({},getRoleAttributes(G)),getBaseAttributes(G)):null}function StructTreeItem({className:G,node:a}){const I=reactExports.useMemo(()=>getAttributes(a),[a]),d=reactExports.useMemo(()=>!isStructTreeNode(a)||isStructTreeNodeWithOnlyContentChild(a)?null:a.children.map((_,M)=>React.createElement(StructTreeItem,{key:M,node:_})),[a]);return React.createElement("span",Object.assign({className:G},I),d)}function usePageContext(){return reactExports.useContext(PageContext)}function StructTree(){const G=usePageContext();invariant(G,"Unable to find Page context.");const{onGetStructTreeError:a,onGetStructTreeSuccess:I}=G,[d,_]=useResolver(),{value:M,error:H}=d,{customTextRenderer:Z,page:O}=G;function F(){M&&I&&I(M)}function v(){H&&(warning(!1,H.toString()),a&&a(H))}function j(){_({type:"RESET"})}reactExports.useEffect(j,[_,O]);function w(){if(Z||!O)return;const T=makeCancellablePromise(O.getStructTree()),p=T;return T.promise.then(u=>{_({type:"RESOLVE",value:u})}).catch(u=>{_({type:"REJECT",error:u})}),()=>cancelRunningTask(p)}return reactExports.useEffect(w,[Z,O,_]),reactExports.useEffect(()=>{if(M!==void 0){if(M===!1){v();return}F()}},[M]),M?React.createElement(StructTreeItem,{className:"react-pdf__Page__structTree structTree",node:M}):null}const ANNOTATION_MODE=pdfjs$1.AnnotationMode;function PageCanvas(G){const a=usePageContext();invariant(a,"Unable to find Page context.");const I=Object.assign(Object.assign({},a),G),{_className:d,canvasBackground:_,devicePixelRatio:M=getDevicePixelRatio(),onRenderError:H,onRenderSuccess:Z,page:O,renderForms:F,renderTextLayer:v,rotate:j,scale:w}=I,{canvasRef:T}=G;invariant(O,"Attempted to render page canvas, but no page was specified.");const p=reactExports.useRef(null);function u(){O&&Z&&Z(makePageCallback(O,w))}function o(t){isCancelException(t)||(warning(!1,t.toString()),H&&H(t))}const A=reactExports.useMemo(()=>O.getViewport({scale:w*M,rotation:j}),[M,O,j,w]),x=reactExports.useMemo(()=>O.getViewport({scale:w,rotation:j}),[O,j,w]);function C(){if(!O)return;O.cleanup();const{current:t}=p;if(!t)return;t.width=A.width,t.height=A.height,t.style.width=`${Math.floor(x.width)}px`,t.style.height=`${Math.floor(x.height)}px`,t.style.visibility="hidden";const c={annotationMode:F?ANNOTATION_MODE.ENABLE_FORMS:ANNOTATION_MODE.ENABLE,canvasContext:t.getContext("2d",{alpha:!1}),viewport:A};_&&(c.background=_);const i=O.render(c),n=i;return i.promise.then(()=>{t.style.visibility="",u()}).catch(o),()=>cancelRunningTask(n)}reactExports.useEffect(C,[_,p,M,O,F,A,x]);const m=reactExports.useCallback(()=>{const{current:t}=p;t&&(t.width=0,t.height=0)},[p]);return reactExports.useEffect(()=>m,[m]),React.createElement("canvas",{className:`${d}__canvas`,dir:"ltr",ref:mergeRefs(T,p),style:{display:"block",userSelect:"none"}},v?React.createElement(StructTree,null):null)}function PageSVG(){const G=usePageContext();invariant(G,"Unable to find Page context.");const{_className:a,onRenderSuccess:I,onRenderError:d,page:_,rotate:M,scale:H}=G;invariant(_,"Attempted to render page SVG, but no page was specified.");const[Z,O]=useResolver(),{value:F,error:v}=Z;function j(){_&&I&&I(makePageCallback(_,H))}function w(){v&&(isCancelException(v)||(warning(!1,v.toString()),d&&d(v)))}const T=reactExports.useMemo(()=>_.getViewport({scale:H,rotation:M}),[_,M,H]);function p(){O({type:"RESET"})}reactExports.useEffect(p,[_,O,T]);function u(){if(!_)return;const C=makeCancellablePromise(_.getOperatorList());return C.promise.then(m=>{new pdfjs$1.SVGGraphics(_.commonObjs,_.objs).getSVG(m,T).then(c=>{O({type:"RESOLVE",value:c})}).catch(c=>{O({type:"REJECT",error:c})})}).catch(m=>{O({type:"REJECT",error:m})}),()=>cancelRunningTask(C)}reactExports.useEffect(u,[_,O,T]),reactExports.useEffect(()=>{if(F!==void 0){if(F===!1){w();return}j()}},[F]);function o(C){if(!C||!F)return;C.firstElementChild||C.appendChild(F);const{width:m,height:t}=T;F.setAttribute("width",`${m}`),F.setAttribute("height",`${t}`)}const{width:A,height:x}=T;return React.createElement("div",{className:`${a}__svg`,ref:C=>o(C),style:{display:"block",backgroundColor:"white",overflow:"hidden",width:A,height:x,userSelect:"none"}})}function isTextItem(G){return"str"in G}function TextLayer(){const G=usePageContext();invariant(G,"Unable to find Page context.");const{customTextRenderer:a,onGetTextError:I,onGetTextSuccess:d,onRenderTextLayerError:_,onRenderTextLayerSuccess:M,page:H,pageIndex:Z,pageNumber:O,rotate:F,scale:v}=G;invariant(H,"Attempted to load page text content, but no page was specified.");const[j,w]=useResolver(),{value:T,error:p}=j,u=reactExports.useRef(null),o=reactExports.useRef();warning(parseInt(window.getComputedStyle(document.body).getPropertyValue("--react-pdf-text-layer"),10)===1,"TextLayer styles not found. Read more: https://github.com/wojtekmaj/react-pdf#support-for-text-layer");function A(){T&&d&&d(T)}function x(){p&&(warning(!1,p.toString()),I&&I(p))}function C(){w({type:"RESET"})}reactExports.useEffect(C,[H,w]);function m(){if(!H)return;const s=makeCancellablePromise(H.getTextContent()),D=s;return s.promise.then(q=>{w({type:"RESOLVE",value:q})}).catch(q=>{w({type:"REJECT",error:q})}),()=>cancelRunningTask(D)}reactExports.useEffect(m,[H,w]),reactExports.useEffect(()=>{if(T!==void 0){if(T===!1){x();return}A()}},[T]);const t=reactExports.useCallback(()=>{M&&M()},[M]),c=reactExports.useCallback(s=>{warning(!1,s.toString()),_&&_(s)},[_]);function i(){const s=o.current;s&&s.classList.add("active")}function n(){const s=o.current;s&&s.classList.remove("active")}const h=reactExports.useMemo(()=>H.getViewport({scale:v,rotation:F}),[H,F,v]);function R(){if(!H||!T)return;const{current:s}=u;if(!s)return;s.innerHTML="";const D=H.streamTextContent({includeMarkedContent:!0}),q={container:s,textContentSource:D,viewport:h},Y=pdfjs$1.renderTextLayer(q),Q=Y;return Y.promise.then(()=>{const et=document.createElement("div");et.className="endOfContent",s.append(et),o.current=et;const nt=!!s.querySelector(".markedContent")?s.querySelectorAll(".markedContent > *:not(.markedContent"):s.children;if(a){let ut=0;T.items.forEach((mt,_t)=>{if(!isTextItem(mt))return;const xt=nt[ut];if(!xt)return;const At=a(Object.assign({pageIndex:Z,pageNumber:O,itemIndex:_t},mt));xt.innerHTML=At,ut+=mt.str&&mt.hasEOL?2:1})}t()}).catch(c),()=>cancelRunningTask(Q)}return reactExports.useLayoutEffect(R,[a,c,t,H,Z,O,T,h]),React.createElement("div",{className:clsx("react-pdf__Page__textContent","textLayer"),onMouseUp:n,onMouseDown:i,ref:u})}function AnnotationLayer(){const G=useDocumentContext();invariant(G,"Unable to find Document context. Did you wrap <Page /> in <Document />?");const a=usePageContext();invariant(a,"Unable to find Page context.");const I=Object.assign(Object.assign({},G),a),{imageResourcesPath:d,linkService:_,onGetAnnotationsError:M,onGetAnnotationsSuccess:H,onRenderAnnotationLayerError:Z,onRenderAnnotationLayerSuccess:O,page:F,pdf:v,renderForms:j,rotate:w,scale:T=1}=I;invariant(F,"Attempted to load page annotations, but no page was specified.");const[p,u]=useResolver(),{value:o,error:A}=p,x=reactExports.useRef(null);warning(parseInt(window.getComputedStyle(document.body).getPropertyValue("--react-pdf-annotation-layer"),10)===1,"AnnotationLayer styles not found. Read more: https://github.com/wojtekmaj/react-pdf#support-for-annotations");function C(){o&&H&&H(o)}function m(){A&&(warning(!1,A.toString()),M&&M(A))}function t(){u({type:"RESET"})}reactExports.useEffect(t,[u,F]);function c(){if(!F)return;const s=makeCancellablePromise(F.getAnnotations()),D=s;return s.promise.then(q=>{u({type:"RESOLVE",value:q})}).catch(q=>{u({type:"REJECT",error:q})}),()=>{cancelRunningTask(D)}}reactExports.useEffect(c,[u,F,j]),reactExports.useEffect(()=>{if(o!==void 0){if(o===!1){m();return}C()}},[o]);function i(){O&&O()}function n(s){warning(!1,`${s}`),Z&&Z(s)}const h=reactExports.useMemo(()=>F.getViewport({scale:T,rotation:w}),[F,w,T]);function R(){if(!v||!F||!o)return;const{current:s}=x;if(!s)return;const D=h.clone({dontFlip:!0}),q={annotations:o,annotationStorage:v.annotationStorage,div:s,downloadManager:null,imageResourcesPath:d,linkService:_,page:F,renderForms:j,viewport:D};s.innerHTML="";try{pdfjs$1.AnnotationLayer.render(q),i()}catch(Y){n(Y)}return()=>{}}return reactExports.useEffect(R,[o,d,_,F,j,h]),React.createElement("div",{className:clsx("react-pdf__Page__annotations","annotationLayer"),ref:x})}var __rest=globalThis&&globalThis.__rest||function(G,a){var I={};for(var d in G)Object.prototype.hasOwnProperty.call(G,d)&&a.indexOf(d)<0&&(I[d]=G[d]);if(G!=null&&typeof Object.getOwnPropertySymbols=="function")for(var _=0,d=Object.getOwnPropertySymbols(G);_<d.length;_++)a.indexOf(d[_])<0&&Object.prototype.propertyIsEnumerable.call(G,d[_])&&(I[d[_]]=G[d[_]]);return I};const defaultScale=1,Page=function G(a){const I=useDocumentContext();invariant(I,"Unable to find Document context. Did you wrap <Page /> in <Document />?");const d=Object.assign(Object.assign({},I),a),{_className:_="react-pdf__Page",_enableRegisterUnregisterPage:M=!0,canvasBackground:H,canvasRef:Z,children:O,className:F,customRenderer:v,customTextRenderer:j,devicePixelRatio:w,error:T="Failed to load the page.",height:p,inputRef:u,loading:o="Loading page…",noData:A="No page specified.",onGetAnnotationsError:x,onGetAnnotationsSuccess:C,onGetStructTreeError:m,onGetStructTreeSuccess:t,onGetTextError:c,onGetTextSuccess:i,onLoadError:n,onLoadSuccess:h,onRenderAnnotationLayerError:R,onRenderAnnotationLayerSuccess:s,onRenderError:D,onRenderSuccess:q,onRenderTextLayerError:Y,onRenderTextLayerSuccess:Q,pageIndex:et,pageNumber:ct,pdf:nt,registerPage:ut,renderAnnotationLayer:mt=!0,renderForms:_t=!1,renderMode:xt="canvas",renderTextLayer:At=!0,rotate:X,scale:f=defaultScale,unregisterPage:g,width:S}=d,$=__rest(d,["_className","_enableRegisterUnregisterPage","canvasBackground","canvasRef","children","className","customRenderer","customTextRenderer","devicePixelRatio","error","height","inputRef","loading","noData","onGetAnnotationsError","onGetAnnotationsSuccess","onGetStructTreeError","onGetStructTreeSuccess","onGetTextError","onGetTextSuccess","onLoadError","onLoadSuccess","onRenderAnnotationLayerError","onRenderAnnotationLayerSuccess","onRenderError","onRenderSuccess","onRenderTextLayerError","onRenderTextLayerSuccess","pageIndex","pageNumber","pdf","registerPage","renderAnnotationLayer","renderForms","renderMode","renderTextLayer","rotate","scale","unregisterPage","width"]),[W,z]=useResolver(),{value:L,error:B}=W,U=reactExports.useRef(null);invariant(nt,"Attempted to load a page, but no document was specified.");const e=isProvided(ct)?ct-1:et??null,l=ct??(isProvided(et)?et+1:null),b=X??(L?L.rotate:null),E=reactExports.useMemo(()=>{if(!L)return null;let yt=1;const Et=f??defaultScale;if(S||p){const Ft=L.getViewport({scale:1,rotation:b});S?yt=S/Ft.width:p&&(yt=p/Ft.height)}return Et*yt},[p,L,b,f,S]);function P(){return()=>{isProvided(e)&&M&&g&&g(e)}}reactExports.useEffect(P,[M,nt,e,g]);function V(){if(h){if(!L||!E)return;h(makePageCallback(L,E))}if(M&&ut){if(!isProvided(e)||!U.current)return;ut(e,U.current)}}function it(){B&&(warning(!1,B.toString()),n&&n(B))}function J(){z({type:"RESET"})}reactExports.useEffect(J,[z,nt,e]);function ot(){if(!nt||!l)return;const yt=makeCancellablePromise(nt.getPage(l)),Et=yt;return yt.promise.then(Ft=>{z({type:"RESOLVE",value:Ft})}).catch(Ft=>{z({type:"REJECT",error:Ft})}),()=>cancelRunningTask(Et)}reactExports.useEffect(ot,[z,nt,e,l,ut]),reactExports.useEffect(()=>{if(L!==void 0){if(L===!1){it();return}V()}},[L,E]);const lt=reactExports.useMemo(()=>L&&isProvided(e)&&l&&isProvided(b)&&isProvided(E)?{_className:_,canvasBackground:H,customTextRenderer:j,devicePixelRatio:w,onGetAnnotationsError:x,onGetAnnotationsSuccess:C,onGetStructTreeError:m,onGetStructTreeSuccess:t,onGetTextError:c,onGetTextSuccess:i,onRenderAnnotationLayerError:R,onRenderAnnotationLayerSuccess:s,onRenderError:D,onRenderSuccess:q,onRenderTextLayerError:Y,onRenderTextLayerSuccess:Q,page:L,pageIndex:e,pageNumber:l,renderForms:_t,renderTextLayer:At,rotate:b,scale:E}:null,[_,H,j,w,x,C,m,t,c,i,R,s,D,q,Y,Q,L,e,l,_t,At,b,E]),st=reactExports.useMemo(()=>makeEventProps($,()=>L&&(E?makePageCallback(L,E):void 0)),[$,L,E]),rt=`${e}@${E}/${b}`,ft=`${e}/${b}`;function pt(){switch(xt){case"custom":return invariant(v,'renderMode was set to "custom", but no customRenderer was passed.'),React.createElement(v,{key:`${rt}_custom`});case"none":return null;case"svg":return React.createElement(PageSVG,{key:`${ft}_svg`});case"canvas":default:return React.createElement(PageCanvas,{key:`${rt}_canvas`,canvasRef:Z})}}function St(){return At?React.createElement(TextLayer,{key:`${rt}_text`}):null}function vt(){return mt?React.createElement(AnnotationLayer,{key:`${rt}_annotations`}):null}function Tt(){return React.createElement(PageContext.Provider,{value:lt},pt(),St(),vt(),O)}function K(){return l?nt===null||L===void 0||L===null?React.createElement(Message,{type:"loading"},typeof o=="function"?o():o):nt===!1||L===!1?React.createElement(Message,{type:"error"},typeof T=="function"?T():T):Tt():React.createElement(Message,{type:"no-data"},typeof A=="function"?A():A)}return React.createElement("div",Object.assign({className:clsx(_,F),"data-page-number":l,ref:mergeRefs(u,U),style:{["--scale-factor"]:`${E}`,backgroundColor:H||"white",position:"relative",minWidth:"min-content",minHeight:"min-content"}},st),K())},isFunctionOrNode=PropTypes.oneOfType([PropTypes.func,PropTypes.node]);Page.propTypes=Object.assign(Object.assign({},eventProps),{canvasBackground:PropTypes.string,canvasRef:isRef,children:PropTypes.node,className:isClassName,customRenderer:PropTypes.func,customTextRenderer:PropTypes.func,devicePixelRatio:PropTypes.number,error:isFunctionOrNode,height:PropTypes.number,imageResourcesPath:PropTypes.string,inputRef:isRef,loading:isFunctionOrNode,noData:isFunctionOrNode,onGetTextError:PropTypes.func,onGetTextSuccess:PropTypes.func,onLoadError:PropTypes.func,onLoadSuccess:PropTypes.func,onRenderError:PropTypes.func,onRenderSuccess:PropTypes.func,onRenderTextLayerError:PropTypes.func,onRenderTextLayerSuccess:PropTypes.func,pageIndex:isPageIndex,pageNumber:isPageNumber,pdf:isPdf,renderAnnotationLayer:PropTypes.bool,renderForms:PropTypes.bool,renderMode:isRenderMode,renderTextLayer:PropTypes.bool,rotate:isRotate,scale:PropTypes.number,width:PropTypes.number});const Page$1=Page;displayWorkerWarning();pdfjs$1.GlobalWorkerOptions.workerSrc="pdf.worker.js";pdfjs$1.GlobalWorkerOptions.workerSrc=new URL("/assets/pdf.worker.min-bc10fb5c.js",self.location).toString();const PdfCustom=G=>{const{className:a,source:I}=G,[d,_]=reactExports.useState(),[M,H]=reactExports.useState(1),Z=({numPages:O})=>{_(O)};return jsxRuntimeExports.jsx("div",{className:`w-full h-full flex border rounded-xl  items-center justify-center text-xs ${a??""}`,children:jsxRuntimeExports.jsx(Document$1,{className:"pdf-card",file:{url:I},loading:jsxRuntimeExports.jsx("div",{className:"w-full h-full flex items-center justify-center text-xxs",children:"Loading PDF..."}),onLoadSuccess:Z,error:jsxRuntimeExports.jsx("div",{className:"w-full h-full flex items-center justify-center text-xxs",children:"Failed to load PDF"}),children:jsxRuntimeExports.jsx(Page$1,{className:"pdf-card-page",pageNumber:M,renderAnnotationLayer:!1,renderTextLayer:!1,loading:jsxRuntimeExports.jsx("div",{className:"w-full h-full flex items-center justify-center text-xxs",children:"Loading Page..."})})})})},PdfCustom$1=React.memo(PdfCustom),FILE_TYPES={IMAGE:"image",VIDEO:"video",PDF:"pdf",AUDIO:"audio"},initialMediaGallerySectionInfo={uid:"",placeOfUpload:"",name:"",fileName:"",category:"",type:"",sectionName:"",fileType:"",download:"",url:""},PLACE_OF_UPLOAD_KYC={LOGIN_QDE:"Login - QDE",LOGIN_APPLICANT:"Login - Applicant",LOGIN_COAPPLICANTS:"Login - Co-Applicants",LOGIN_GUARANTORS:"Login - Guarantors",LOGIN_CORPORATE_COAPPLICANT:"Login - Corporate Co-Applicants",LOGIN_CORPORATE_GUARANTORS:"Login - Corporate Guarantors",LOGIN_DEPENDANTS:"Login - Dependants"},ImagePreview=G=>{const{src:a,alt:I}=G,[d,_]=reactExports.useState(0),[M,H]=reactExports.useState(1),Z=()=>{_(O=>O<=-270?0:O-90)};return jsxRuntimeExports.jsxs("div",{className:"flex flex-col h-full justify-between",children:[jsxRuntimeExports.jsx("div",{className:"max-h-[380px] overflow-hidden",children:jsxRuntimeExports.jsx("img",{src:a,alt:I,className:"object-fill",style:{width:"100%",height:"100%",transform:`scale(${M}) rotate(${d}deg)`,objectFit:"contain"}})}),jsxRuntimeExports.jsxs("div",{className:"w-full self-end mt-1 flex justify-start items-center gap-4 z-40",children:[jsxRuntimeExports.jsx("button",{className:"cursor-pointer",onClick:Z,children:jsxRuntimeExports.jsx("img",{src:RotateIcon,alt:"rotate"})}),jsxRuntimeExports.jsxs("div",{className:"h-6 right-control rounded-lg flex gap-1 px-2 bg-secondary-steelBlue-1000",children:[jsxRuntimeExports.jsx("button",{className:"w-3 self-center zoom-out-control cursor-pointer",onClick:()=>{H(O=>O>=1.1?Math.round((O-.1)*10)/10:1)},children:jsxRuntimeExports.jsx("img",{src:ZoomOutIcon,alt:"zoomOut"})}),jsxRuntimeExports.jsx("input",{className:"cropper-zoom-range",type:"range",value:M,min:1,max:3,step:.1,"aria-labelledby":"Zoom",onChange:O=>H(Number(O.target.value))}),jsxRuntimeExports.jsx("button",{className:"w-3 self-center zoom-in-control cursor-pointer",onClick:()=>{H(O=>O<=2.9?Math.round((O+.1)*10)/10:3)},children:jsxRuntimeExports.jsx("img",{src:ZoomInIcon,alt:"zoomIn"})})]})]})]})},MediaGallery=G=>{const{visible:a,list:I,currentSection:d,onToggleVisibility:_}=G,[M,H]=reactExports.useState(initialMediaGallerySectionInfo),[Z,O]=reactExports.useState(""),[F,v]=reactExports.useState(null),[j,w]=reactExports.useState(!1),T=reactExports.useRef(null);reactExports.useEffect(()=>{console.log("Media Gallery mounted")},[]),reactExports.useEffect(()=>{d&&H(d)},[d]),reactExports.useEffect(()=>{(async()=>{M.url&&(w(!0),x(await M.url).then(n=>{O(n),w(!1)}).catch(n=>{console.log(n),w(!1)}))})()},[M]),reactExports.useEffect(()=>{A()},[I]);const p=()=>{console.log("left click");const i=Number(F)-1;v(i),H(I[i])},u=()=>{console.log("right click");const i=Number(F)+1;v(i),H(I[i])},o=async()=>{var h,R,s,D,q,Y,Q;const i=await x(await M.url),n=document.createElement("a");if(n.href=i,n.download=M.fileName,(h=M==null?void 0:M.fileType)!=null&&h.includes(FILE_TYPES.VIDEO)){const et=await axios.get(i,{responseType:"blob"}),ct=window.URL.createObjectURL(new Blob([et.data])),nt=document.createElement("a");nt.href=ct,nt.setAttribute("download",`file-vid-${Math.random().toString(36).substring(2)}.mp4`),document.body.appendChild(nt),nt.click(),(R=document.parentNode)==null||R.removeChild(nt),URL.revokeObjectURL(ct);return}else if((s=M==null?void 0:M.fileType)!=null&&s.includes(FILE_TYPES.AUDIO)){const et=await axios.get(i,{responseType:"blob"}),ct=window.URL.createObjectURL(new Blob([et.data])),nt=document.createElement("a");nt.href=ct,nt.setAttribute("download",`file-aud-${Math.random().toString(36).substring(2)}.mp3`),document.body.appendChild(nt),nt.click(),(D=document.parentNode)==null||D.removeChild(nt),URL.revokeObjectURL(ct);return}else((q=M==null?void 0:M.fileType)!=null&&q.includes(FILE_TYPES.PDF)||(Y=M==null?void 0:M.fileType)!=null&&Y.includes(FILE_TYPES.IMAGE))&&(n.target="_blank",n.rel="noreferrer noopener");document.body.appendChild(n),n.click(),(Q=n.parentNode)==null||Q.removeChild(n),URL.revokeObjectURL(i)},A=()=>{if(I.length>0){const i=I.findIndex(n=>n.uid===M.uid);i>-1&&v(i)}},x=async i=>{try{return(await FileUploadService.getSignedURL(i)).data.SignedUrl}catch(n){console.log(n)}},C=()=>jsxRuntimeExports.jsx(reactExports.Fragment,{children:jsxRuntimeExports.jsx("div",{className:"w-full h-[400px]",children:jsxRuntimeExports.jsx(PdfCustom$1,{source:Z})})}),m=()=>jsxRuntimeExports.jsx("div",{className:"w-full",children:jsxRuntimeExports.jsx("video",{ref:T,className:"w-full h-[400px] max-h-[450px] rounded-lg",src:Z,controls:!0,controlsList:"nodownload",disablePictureInPicture:!0})}),t=()=>jsxRuntimeExports.jsx("div",{className:"w-full h-[400px]",children:jsxRuntimeExports.jsx("div",{className:"w-full h-full",children:jsxRuntimeExports.jsx(AudioPlayer,{className:"rounded-lg",mediaSource:Z})})}),c=()=>{const{fileType:i}=M;return j?jsxRuntimeExports.jsx("div",{className:"flex flex-col gap-6 h-full justify-center items-center bg-primary-sapphireBlue-100",children:jsxRuntimeExports.jsx(SkeletonCustom,{borderRadius:"8px",height:"436px"})}):i!=null&&i.includes(FILE_TYPES.IMAGE)?jsxRuntimeExports.jsx(ImagePreview,{src:Z,alt:M.fileName}):i!=null&&i.includes(FILE_TYPES.VIDEO)?m():i!=null&&i.includes(FILE_TYPES.AUDIO)?t():i!=null&&i.includes(FILE_TYPES.PDF)?C():jsxRuntimeExports.jsxs("div",{className:"flex flex-col gap-6 h-full justify-center items-center bg-primary-sapphireBlue-100",children:[jsxRuntimeExports.jsx("img",{src:DocIcon}),jsxRuntimeExports.jsx("a",{className:"text-xs font-normal underline text-secondary-steelBlue-500",href:Z,target:"_blank",children:"Click to open in a new tab"})]})};return jsxRuntimeExports.jsx("div",{className:"media-gallery-container",children:jsxRuntimeExports.jsx(DialogBox,{className:"dialog-media-gallery h-[526px] rounded-xl",visible:a,closable:!1,style:{width:"70vw"},children:jsxRuntimeExports.jsxs("div",{className:"flex flex-col w-full h-full gap-2.5",children:[jsxRuntimeExports.jsx("div",{className:"flex justify-end",children:jsxRuntimeExports.jsx("button",{onClick:_,children:jsxRuntimeExports.jsx("img",{src:CloseIcon})})}),jsxRuntimeExports.jsxs("div",{className:"flex-grow w-full flex flex-row gap-4 ",children:[jsxRuntimeExports.jsx("div",{className:"w-3/5 rounded-lg",children:c()}),jsxRuntimeExports.jsxs("div",{className:"w-2/5 flex flex-col gap-5",children:[jsxRuntimeExports.jsxs("div",{className:"flex flex-row w-full ",children:[jsxRuntimeExports.jsx("div",{className:"w-1/2 text-secondary-steelBlue-500 font-normal text-xs",children:"Place of upload :"}),jsxRuntimeExports.jsx("div",{className:"w-1/2 text-xs text-black font-normal",title:M.placeOfUpload??"-",children:M.placeOfUpload??"-"})]}),jsxRuntimeExports.jsxs("div",{className:"flex flex-row w-full ",children:[jsxRuntimeExports.jsx("div",{className:"w-1/2 text-secondary-steelBlue-500 font-normal text-xs",children:"Name :"}),jsxRuntimeExports.jsx("div",{className:"w-1/2 text-xs text-black font-normal",title:M.name??"-",children:M.name??"-"})]}),jsxRuntimeExports.jsxs("div",{className:"flex flex-row w-full",children:[jsxRuntimeExports.jsx("div",{className:"w-1/2 text-secondary-steelBlue-500 font-normal text-xs",children:"File Name :"}),jsxRuntimeExports.jsx("div",{className:"w-1/2 text-xs text-black font-normal",title:M.fileName??"-",children:M.fileName??"-"})]}),jsxRuntimeExports.jsxs("div",{className:"flex flex-row w-full ",children:[jsxRuntimeExports.jsx("div",{className:"w-1/2 text-secondary-steelBlue-500 font-normal text-xs",title:M.category??"-",children:"Category :"}),jsxRuntimeExports.jsx("div",{className:"w-1/2 text-xs text-black font-normal",title:M.category??"-",children:M.category??"-"})]}),jsxRuntimeExports.jsxs("div",{className:"flex flex-row w-full ",children:[jsxRuntimeExports.jsx("div",{className:"w-1/2 text-secondary-steelBlue-500 font-normal text-xs",children:"Type :"}),jsxRuntimeExports.jsx("div",{className:"w-1/2 text-xs text-black font-normal",title:M.type??"-",children:M.type??"-"})]}),jsxRuntimeExports.jsxs("div",{className:"flex flex-row w-full ",children:[jsxRuntimeExports.jsx("div",{className:"w-1/2 text-secondary-steelBlue-500 font-normal text-xs",children:"Section :"}),jsxRuntimeExports.jsx("div",{className:"w-1/2 text-xs text-black font-normal",title:M.sectionName??"-",children:M.sectionName??"-"})]}),jsxRuntimeExports.jsxs("div",{className:"flex flex-row w-full ",children:[jsxRuntimeExports.jsx("div",{className:"w-1/2 text-secondary-steelBlue-500 font-normal text-xs",children:"File Type :"}),jsxRuntimeExports.jsx("div",{className:"w-1/2 text-xs text-black font-normal",title:M.fileType,children:M.fileType??"-"})]}),jsxRuntimeExports.jsxs("div",{className:"flex flex-row w-full ",children:[jsxRuntimeExports.jsx("div",{className:"w-1/2 text-secondary-steelBlue-500 font-normal text-xs",children:"Download"}),jsxRuntimeExports.jsx("div",{className:"w-1/2 text-xs text-black font-normal",children:jsxRuntimeExports.jsx("button",{className:"flex justify-center items-center rounded-full h-9 w-9 bg-[#EBECEE] disabled:opacity-50",onClick:o,children:jsxRuntimeExports.jsx("img",{src:DownloadRowIcon})})})]}),I.length?jsxRuntimeExports.jsxs("div",{className:"flex flex-row items-center gap-5 mt-10",children:[jsxRuntimeExports.jsx("button",{className:"flex justify-center items-center rounded-full h-9 w-9 bg-[#EBECEE] disabled:opacity-50",onClick:p,disabled:Number(F)===0,children:jsxRuntimeExports.jsx("img",{src:LeftIcon})}),jsxRuntimeExports.jsxs("p",{className:"text-xs font-normal",children:[Number(F)>=0?Number(F)+1:"--",jsxRuntimeExports.jsx("span",{className:"text-secondary-steelBlue-500",children:` / ${I.length}`})]}),jsxRuntimeExports.jsx("button",{className:"flex justify-center items-center rounded-full h-9 w-9 bg-[#EBECEE] disabled:opacity-50",onClick:u,disabled:Number(F)===I.length-1,children:jsxRuntimeExports.jsx("img",{src:RightIcon})})]}):jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{})]})]})]})})})};export{MediaGallery as M,PdfCustom$1 as P,RotateIcon as R,ZoomOutIcon as Z,ZoomInIcon as a,PLACE_OF_UPLOAD_KYC as b,initialMediaGallerySectionInfo as i};
//# sourceMappingURL=MediaGallery-5884b284.js.map
