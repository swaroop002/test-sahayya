import{w as ge,r as s,ad as A,ae as D,af as I,y as Ce,j as e,J as d,T as y,aI as M,aG as Te,aW as L,aX as q,ao as _,a8 as m,aU as be,p as U,aJ as x,l as p,aL as V,aF as l,aO as u,aY as B,aZ as H,d as $e,a_ as ke}from"./index-e8217573.js";import{B as h}from"./ButtonBox-9e46519a.js";import{D as Se}from"./Dialog-adadaf64.js";import{E as we}from"./ErrorDialog-d5eef4d7.js";import{I as Pe}from"./InputTextArea-b90aad1d.js";import{L as W}from"./LinkButton-92540c18.js";import{P as Oe}from"./PageTitle-b3bba3d4.js";import{R as Ae}from"./ReadOnlyTable-86accb69.js";import{S as N}from"./SectionTitle-9f9277ec.js";import{T as De}from"./Toast-ae99ea5b.js";import{C as i}from"./column.esm-938bad7d.js";import{A as R}from"./ApprovalRequestService-f8cdf7f8.js";import"./kebab-menu-8835ad2e.js";import"./withAuth-6de36ebf.js";import"./No_data-1720c54e.js";import"./SimpleDropDown-061a3470.js";import"./virtualscroller.esm-9939945c.js";import"./datatable.esm-f474a654.js";import"./paginator.esm-11c2c115.js";import"./TransitionGroup-c8afe0ce.js";const Ie=g=>{const[n,F]=s.useState(""),[f,v]=s.useState(!1),[Me,C]=s.useState(!1),[T,$]=s.useState(""),[Y,J]=s.useState(""),[a,G]=s.useState({}),[c,Q]=s.useState({}),[,k]=s.useState(void 0),[b,S]=s.useState(""),[X,w]=s.useState(!1),E=s.useRef(null),[K,Z]=s.useState({limit:10,loading:!1,totalRecords:0,start:0,search:"",runCustomQuery:!1,records:[]}),j=s.useRef(null),r=s.useRef(new A({validators:{...D()},...I(),autoForceUpdate:{forceUpdate:()=>k(t=>!t)}}));s.useEffect(()=>{const t=Ce.parse(g.location.search);t!=null&&t.uid&&(t==null?void 0:t.uid)!==void 0&&(F(t.uid),Z({...K,search:`uid=${t.uid}`}))},[]),s.useEffect(()=>{n&&z()},[n]);const z=async()=>{const t=await R.getAllForApprovalRequestSummary(0,100,`/uid/${n}`);try{console.log(t==null?void 0:t.data,"response"),console.log(t),J(t==null?void 0:t.data.reasonForChange),G(t==null?void 0:t.data)}catch(o){console.log(o)}};s.useEffect(()=>{var t;n!==""&&n!==void 0&&((t=j==null?void 0:j.current)==null||t.search())},[n]),s.useEffect(()=>{var t;b!=""&&((t=E==null?void 0:E.current)==null||t.showFunction())},[b]),s.useEffect(()=>{T&&w(!0)},[T]),s.useEffect(()=>{console.log("object")},[a.checkerComments]);const ee=t=>{const{name:o,value:Re}=t.target;Q({...a,checkerComments:Re})},P=()=>{g.navigate(L)},O=async()=>R.approveRequest(a.uid,c).then(t=>{C(!1),S(q.APPROVED)}).catch(t=>{$(_(t))}),te=async()=>{var t;if((t=r==null?void 0:r.current)==null||t.showMessageFor("checkerComments"),!!(c!=null&&c.checkerComments))return console.log(a),R.rejectRequest(a.uid,c).then(o=>{v(!1),S(q.REJECTED)}).catch(o=>{$(_(o))})},ae=()=>e.jsx("div",{className:"flex",children:e.jsx(m,{label:"input.masterData.approvalRequestSearch.entity",className:"mr-1"})}),se=t=>e.jsx("div",{className:"text-primary-ptext-900 font-BrownLight text-left",children:be(t.entity)}),re=()=>e.jsx("div",{className:"flex",children:e.jsx(m,{label:"input.masterData.approvalRequestSearch.name",className:"mr-1"})}),oe=t=>e.jsx("div",{className:"text-primary-ptext-900 font-BrownLight text-left",children:t.name}),le=()=>e.jsx("div",{className:"flex",children:e.jsx(m,{label:"input.masterData.approvalRequestSearch.maker",className:"mr-1"})}),ie=t=>e.jsx("div",{className:"w-40",children:e.jsx("div",{className:"text-primary-ptext-900 font-BrownLight text-left",children:t.createdByUserName})}),ne=()=>e.jsx("div",{className:"flex",children:e.jsx("p",{className:"mr-1",children:"Created On"})}),ce=t=>e.jsx("div",{className:"w-40 text-primary-ptext-900 font-BrownLight text-left",children:U(t.createdAt)}),de=()=>e.jsx(m,{label:"input.masterData.approvalRequestSearch.operation",className:"mr-1"}),me=t=>e.jsx("div",{className:"w-30 text-primary-ptext-900 font-BrownLight text-left",children:t.operationType}),xe=()=>e.jsx(m,{label:"input.masterData.staticMaster.checker",className:"mr-1"}),pe=t=>e.jsx("div",{className:"text-primary-ptext-900 font-BrownLight text-left",children:t.checkedByUserName}),ue=()=>e.jsx("div",{className:"flex",children:e.jsx(m,{label:"tableHeader.masterData.approvalRequestSearch.checkedOn",className:"mr-1"})}),he=t=>e.jsx("div",{className:"text-primary-ptext-900 font-BrownLight text-left w-30",children:`${U(t.checkedOn)}`}),fe=()=>e.jsx("div",{className:"flex",children:e.jsx(m,{label:"tableHeader.masterData.approvalRequestSearch.status",className:"mr-1"})}),ve=t=>e.jsx("div",{className:"text-primary-ptext-900 font-BrownLight text-left w-30",children:t==null?void 0:t.status}),Ee=()=>{console.log(a);const t=JSON.parse(a.reqPayload).uid;return a.entity==x.STATIC_MASTER_TYPE?`${p}/${V}?mode=${l.REVIEW}&uid=${a.uid}&reviewMode=${u.OLD}&id=${a.id}`:a.entity==x.USER_PROFILE?`${p}/${B}?mode=${l.REVIEW}&uid=${a.uid}&reviewMode=${u.OLD}&id=${a.id}`:a.entity==x.INCOME_SCHEME?`${p}/${H}?mode=${l.REVIEW}&uid=${t}&reviewMode=${u.OLD}&id=${a.id}`:$e},je=()=>{if(a.entity==x.STATIC_MASTER_TYPE)return`${p}/${V}?mode=${l.REVIEW}&uid=${a.uid}&reviewMode=${u.NEW}&id=${a.id}`;if(a.entity==x.USER_PROFILE)return`${p}/${B}?mode=${l.REVIEW}&uid=${a.uid}&reviewMode=${u.OLD}&id=${a.id}`;if(a.entity==x.INCOME_SCHEME)return`${p}/${H}?mode=${l.REVIEW}&approvalUid=${a.uid}&reviewMode=${u.NEW}&id=${a.id}&finalData=${a.finalStateJson}`;if(a.entity==x.PRODUCT)return`${p}/${ke}?mode=${a.operationType==M.CREATE?l.REVIEW_CREATE:l.REVIEW}&uid=${a.uid}&reviewMode=${u.NEW}&id=${a.id}`},ye=t=>{var o;(o=r==null?void 0:r.current)==null||o.showMessageFor("checkerComments")},Ne=()=>{var t;r.current=new A({validators:{...D()},...I(),autoForceUpdate:{forceUpdate:()=>k(o=>!o)}}),(t=r==null?void 0:r.current)==null||t.hideMessages()};return e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsxs("div",{className:"flex w-full justify-between items-center",children:[e.jsx(Oe,{title:"heading.masterData.approvalRequest"}),a.status=="PENDING"?e.jsxs("div",{className:"flex gap-10",children:[e.jsxs("div",{className:"flex gap-5",children:[e.jsx(h,{buttonType:d.CANCEL_OUTLINE,onClick:P}),e.jsx(h,{buttonType:d.REJECT_PRIMARY,onClick:()=>{v(!0)}})]}),e.jsx(h,{className:"approve-primary",buttonType:d.APPROVE,onClickWithLoader:O})]}):e.jsx("div",{className:"flex ",children:e.jsx(h,{buttonType:d.CLOSE_OUTLINE,onClick:P})})]}),e.jsx(N,{title:"sectionTitle.masterData.approvalRequest.summary"}),e.jsxs(Ae,{standardDataFormatPromise:R.getAll,dataKey:"id",search:`&uid=${n}&`,ref:j,paginator:!1,className:"border border-secondary-concrete px-0  mt-4 rounded-lg read-only-table w-full h-40 overflow-auto approval-request-wrapper",style:{width:"100%"},children:[e.jsx(i,{className:"text-primary-ptext-1000 text-left text-xs  p-1 h-12 pl-6",header:ae,body:se}),e.jsx(i,{className:"text-primary-ptext-1000 text-left text-xs  p-1 h-12 pl-6",header:re,body:oe}),e.jsx(i,{className:"text-primary-ptext-1000 text-left text-xs w-1/12  p-1 h-12 pl-6",header:le,body:ie}),e.jsx(i,{className:"text-primary-ptext-1000 text-left text-xs  p-1 h-12 pl-6",header:ne,body:ce}),e.jsx(i,{className:"text-primary-ptext-1000 text-left text-xs  p-1 h-12 pl-6",header:de,body:me}),e.jsx(i,{className:"text-primary-ptext-1000 text-left text-xs  p-1 h-12 pl-6",header:xe,body:pe}),e.jsx(i,{className:"text-primary-ptext-1000 text-left text-xs  p-1 h-12 pl-6",header:ue,body:he}),e.jsx(i,{className:"text-primary-ptext-1000 text-left text-xs  p-1 h-12 pl-6",header:fe,body:ve})]}),e.jsxs("div",{className:"flex justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"flex mt-6",children:e.jsx(N,{title:"sectionTitle.masterData.approvalRequest.reason"})}),e.jsx("div",{className:"mt-2",children:e.jsx(y,{label:Y,className:"text-primary-labelColor  text-xs  text-left"})})]}),a.checkerComments&&e.jsxs("div",{children:[e.jsx("div",{className:"flex mt-6",children:e.jsx(N,{title:a.status=="APPROVED"?"dialogTitle.masterData.approvalRequest.approval":"dialogTitle.masterData.approvalRequest.reject"})}),e.jsx("div",{className:"mt-4",children:e.jsx(y,{label:a.checkerComments,className:"text-primary-labelColor  text-xs  text-left"})})]})]}),a.status=="PENDING"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"flex mt-6",children:e.jsx(N,{title:"sectionTitle.masterData.approvalRequest.data"})}),e.jsxs("div",{className:"flex w-100 justify-between",children:[a.operationType==M.CREATE?e.jsx(y,{label:"sectionTitle.masterData.approvalRequest.oldValue",className:"text-secondary-gray-500 hover:text-primary-buttonPrimaryHoverColor text-xs focus:text-secondary-gray-500"}):e.jsx(W,{label:"sectionTitle.masterData.approvalRequest.oldValue",path:Ee(),target:"_blank"}),e.jsx(W,{label:"sectionTitle.masterData.approvalRequest.newValue",path:je(),target:"_blank"})]})]}),e.jsxs(Se,{onHide:()=>{v(!1),C(!1)},visible:f,modal:!0,closable:!1,dismissableMask:!0,className:"!w-132 !h-76.5",children:[e.jsx(y,{label:f?"dialogTitle.masterData.approvalRequest.reject":"dialogTitle.masterData.approvalRequest.approval",className:"text-primary-ptext-1000 text-base font-Roboto font-bold flex items-center justify-center"}),e.jsx("div",{children:e.jsx(Pe,{className:"border border-secondary-gray-200 rounded-md overflow-auto !w-120 !h-24 p-4 text-xs text-secondary-gray-500",value:a.checkerComments,onChange:ee,name:"checkerComments",label:"dialogTitle.masterData.approvalRequest.reason",validation:r.current.message("checkerComments",c.checkerComments,"mandatory"),onBlur:ye})}),e.jsxs("div",{className:"flex justify-center mt-4",children:[e.jsx("div",{className:"mr-3",children:e.jsx(h,{buttonType:d.CANCEL_OUTLINE,onClick:()=>{v(!1),C(!1),Ne()}})}),e.jsx("div",{className:"mr-3",children:e.jsx(h,{buttonType:f?d.REJECT_PRIMARY:d.APPROVE,onClickWithLoader:f?te:O,disabled:!c.checkerComments})})]})]}),e.jsx("div",{className:"",children:e.jsx(De,{position:"bottom-right",ref:E,toastText:b,variant:Te.PRIMARY,onRemove:()=>g.navigate(L)})}),e.jsx(we,{onHide:()=>w(!1),visible:X,errorMessage:T})]})},st=ge(Ie);export{st as default};
//# sourceMappingURL=PageApprovalRequest-d8e8487a.js.map
