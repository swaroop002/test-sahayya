{"version":3,"file":"PageCAM-44d3a3d2.js","sources":["../../src/views/transaction/PageCAM/PageCAM.tsx"],"sourcesContent":["import { updateLoanDetail } from \"actions/LoanDetailActions\";\nimport ErrorDialog from \"components/ErrorDialog/ErrorDialog\";\nimport Loader from \"components/Loader/Loader\";\nimport Text from \"components/Text/Text\";\nimport { ToastPositionType } from \"primereact/toast\";\nimport { Suspense, useEffect, useRef, useState } from \"react\";\nimport { useDispatch } from \"react-redux\";\nimport { NavLink, Outlet, Route, Routes, useParams } from \"react-router-dom\";\nimport { linkAuthRoute } from \"routes\";\nimport LoanService from \"services/transaction/LoanService\";\nimport { LOAN_STAGE_STATUS, TOAST_STYLE_TYPE } from \"utils/Constant\";\n\nimport {\n  LINK_CAM,\n  LINK_CAM_CREDIT_DOCUMENT,\n  LINK_CAM_DOCUMENT_CHECK,\n  LINK_CAM_INCOME_EXPENSE,\n  LINK_CAM_LOAN_DETAILS,\n  LINK_CAM_QUERY,\n  LINK_CAM_RECOMMENDATION,\n  LINK_LOAN_DETAIL,\n  camRoutes,\n} from \"../../../transactionRoutes\";\nimport { ScrollableTabs, getTabClassName } from \"../PageDDE/Login/Login\";\nimport TextButton from \"components/TextButton/TextButton\";\nimport SimpleOverlayPanel from \"components/SimpleOverlayPanel/SimpleOverlayPanel\";\nimport { formatDate } from \"utils/CommonUtil\";\nconst CAM_MENU = [\n  {\n    id: 1,\n    name: \"Document Check\",\n    path: LINK_CAM_DOCUMENT_CHECK,\n  },\n  {\n    id: 2,\n    name: \"Loan Details\",\n    path: LINK_CAM_LOAN_DETAILS,\n  },\n  {\n    id: 3,\n    name: \"Income & Expense Details\",\n    path: LINK_CAM_INCOME_EXPENSE,\n  },\n  {\n    id: 4,\n    name: \"Recommendation\",\n    path: LINK_CAM_RECOMMENDATION,\n  },\n  {\n    id: 5,\n    name: \"Credit Document\",\n    path: LINK_CAM_CREDIT_DOCUMENT,\n  },\n  {\n    id: 6,\n    name: \"Query\",\n    path: LINK_CAM_QUERY,\n  },\n];\ninterface IButtonDisabled {\n  stageComplete: boolean;\n  submit: boolean;\n}\n\nconst initialButtonDisabled: IButtonDisabled = {\n  stageComplete: false,\n  submit: false,\n};\n\nconst PageCAM = () => {\n\n \n  const params: { loanUid?: string; stageUid?: string } = useParams();\n  const dispatch = useDispatch();\n  const overlayPanelRef = useRef(null);\n\n  const [showDialogAPIError, setShowDialogAPIError] = useState(false);\n  const [errorMessage, setErrorMessage] = useState<any>(\"\");\n  const [position] = useState<ToastPositionType | undefined>(\"bottom-right\");\n  const [buttonDisabled, setButtonDisabled] = useState({\n    ...initialButtonDisabled,\n  });\n  const [dataForViewDetails, setDataForViewDetails] = useState({\n    assignedTo: \"\",\n    delegateTo: \"\",\n    initiation: \"\",\n  });\n  const [toastMessage, setToastMessage] = useState(\"\");\n  const [toastMessageVariant, setToastMessageVariant] = useState(TOAST_STYLE_TYPE.PRIMARY);\n  const [triggerToast, setTriggerToast] = useState(false);\n  const toastMessageRef = useRef(null);\n  useEffect(() => {\n    getLoanDetail();\n  }, []);\n  useEffect(() => {\n    if (toastMessageRef?.current && toastMessage !== \"\") {\n      // @ts-ignore: will be fixed in future\n      toastMessageRef?.current?.showFunction();\n    }\n  }, [toastMessage, toastMessageVariant, triggerToast]);\n  const getLoanDetail = () => {\n    const uid = params.loanUid;\n    const search = `&uid=${uid}`;\n    LoanService.getAll(0, 1, search)\n      .then((res) => {\n        console.log(\"res===\", res.data.results[0]);\n\n        const results = res.data.results[0];\n        dispatch(updateLoanDetail(results));\n        if (\n          results?.legalStatus === LOAN_STAGE_STATUS.COMPLETED ||\n          results?.legalStatus === LOAN_STAGE_STATUS.CANCELLED\n        ) {\n          setButtonDisabled((prevState) => ({ ...prevState, stageComplete: true, submit: true }));\n        } else if (results?.legalStatus === LOAN_STAGE_STATUS.IN_REVIEW) {\n          setButtonDisabled((prevState) => ({ ...prevState, stageComplete: false, submit: true }));\n        } else {\n          setButtonDisabled((prevState) => ({ ...prevState, stageComplete: false, submit: false }));\n        }\n      })\n      .catch((err) => {\n        console.log(err);\n      });\n  };\n\n  const onStageDetail = (e: any) => {\n    const viewDetailData: any = localStorage.getItem(\"stageDetail\");\n    setDataForViewDetails({\n      assignedTo: JSON.parse(viewDetailData)?.assignee?.name ?? \"NA\",\n      delegateTo: JSON.parse(viewDetailData)?.delegate?.name ?? \"NA\",\n      initiation: JSON.parse(viewDetailData)?.createdAtSystemDate ?? \"NA\",\n    });\n    if (overlayPanelRef.current) {\n      // @ts-ignore: Will fix later\n      overlayPanelRef.current?.toggle(e);\n    }\n  };\n\n  const renderLoanDetail = () => {\n    return (\n      <div className=\"flex flex-col gap-4 p-5 \">\n        <div className=\"flex flex-row justify-between items-center\">\n          <div className=\"text-sm text-secondary-stext-900\">Assigned to :</div>\n          <div className=\"text-sm text-secondary-stext-900  font-bold ml-2\">\n            {dataForViewDetails?.assignedTo}\n          </div>\n        </div>\n        <div className=\"flex flex-row justify-between items-center\">\n          <div className=\"text-sm text-secondary-stext-900\">Delegated to :</div>\n          <div className=\"text-sm text-secondary-stext-900  font-bold ml-2\">\n            {dataForViewDetails?.delegateTo}\n          </div>\n        </div>\n        <div className=\"flex flex-row justify-between items-center\">\n          <div className=\"text-sm text-secondary-stext-900\">Date of Initiation :</div>\n          <div className=\"text-sm text-secondary-stext-900  font-bold ml-2\">\n            {formatDate(dataForViewDetails?.initiation)}\n          </div>\n        </div>\n      </div>\n    );\n  };\n\n  return (\n    <div>\n      <div className=\"flex flex-col gap-5 \">\n        <div className=\"flex items-center justify-between gap-5 w-full\">\n          <div className=\"flex items-center gap-5 \">\n            <div className=\"border-r flex gap-3 items-center border-secondary-stext-600 px-5 py-2  flex-shrink-0 \">\n              <Text\n                className=\"text-primary-ptext-1000 font-bold\"\n                label={\"label.cam.cam&Recommendation\"}\n              ></Text>\n              <TextButton\n                className=\"underline text-xs  !text-black  \"\n                label={\"View Details\"}\n                onClick={onStageDetail}\n              ></TextButton>\n            </div>\n\n            <ScrollableTabs>\n              {CAM_MENU.map((menu) => (\n                <NavLink\n                  key={menu.path}\n                  className={getTabClassName}\n                  to={`${linkAuthRoute}${LINK_LOAN_DETAIL}${LINK_CAM}/${params.loanUid}/${params.stageUid}${menu.path}`}\n                >\n                  {menu.name}\n                </NavLink>\n              ))}\n            </ScrollableTabs>\n          </div>\n          <div className=\"w-1/12 flex gap-4 justify-end\"></div>\n        </div>\n\n        <div className=\"legal-layout-body-content\">\n          {/* Need to update the above class */}\n          <Suspense fallback={<Loader />}>\n            <Routes>\n              {camRoutes.map((route, index) => {\n                return <Route key={index} path={route.path} element={<route.component />} />;\n              })}\n            </Routes>\n          </Suspense>\n          <Outlet />\n        </div>\n\n        <ErrorDialog\n          onHide={() => {\n            setShowDialogAPIError(false);\n            setErrorMessage(\"\");\n          }}\n          visible={showDialogAPIError}\n          errorMessage={errorMessage}\n        />\n        <SimpleOverlayPanel\n          className=\"rounded-lg shadow-lg !w-80 p-1.5 \"\n          ref={overlayPanelRef}\n          content={renderLoanDetail()}\n        />\n        {/* <ToastCustom\n          position={position}\n          ref={toastMessageRef}\n          toastText={toastMessage}\n          variant={toastMessageVariant}\n          onRemove={() => {\n            const URL = linkBasePath + linkAuthRoute + LINK_LOAN_LIST;\n            window.location.href = URL;\n          }}\n        /> */}\n      </div>\n    </div>\n  );\n};\n\nexport default PageCAM;\n"],"names":["CAM_MENU","LINK_CAM_DOCUMENT_CHECK","LINK_CAM_LOAN_DETAILS","LINK_CAM_INCOME_EXPENSE","LINK_CAM_RECOMMENDATION","LINK_CAM_CREDIT_DOCUMENT","LINK_CAM_QUERY","initialButtonDisabled","PageCAM","params","useParams","dispatch","useDispatch","overlayPanelRef","useRef","showDialogAPIError","setShowDialogAPIError","useState","errorMessage","setErrorMessage","buttonDisabled","setButtonDisabled","dataForViewDetails","setDataForViewDetails","toastMessage","setToastMessage","toastMessageVariant","setToastMessageVariant","TOAST_STYLE_TYPE","triggerToast","setTriggerToast","toastMessageRef","useEffect","getLoanDetail","_a","search","LoanService","res","results","updateLoanDetail","LOAN_STAGE_STATUS","prevState","err","onStageDetail","e","viewDetailData","_b","_d","_c","_e","_f","renderLoanDetail","jsxs","jsx","formatDate","Text","TextButton","ScrollableTabs","menu","NavLink","getTabClassName","linkAuthRoute","LINK_LOAN_DETAIL","LINK_CAM","Suspense","Loader","Routes","camRoutes","route","index","Route","Outlet","ErrorDialog","SimpleOverlayPanel"],"mappings":"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"}