import{q as D,r,aF as l,aG as _,ao as x,j as i,c8 as Y,aH as w,d3 as F}from"./index-e8217573.js";import{D as G,a as y}from"./DocumentUploader-e2ec1a13.js";import{E as V}from"./ErrorDialog-d5eef4d7.js";import{S as W}from"./SaveComponent-160c5b32.js";import{S as K}from"./Section-00ef9f2b.js";import{T as $}from"./Toast-ae99ea5b.js";import{C as O}from"./CamService-5ccef840.js";import{s as q,p as H,a as k}from"./Helper-03e9d878.js";import{S as J}from"./Skeleton-7e12d019.js";import"./loader-5f2cfb31.js";import"./AutoComplete-0bca608a.js";import"./search_icon-459d6871.js";import"./withAuth-6de36ebf.js";import"./virtualscroller.esm-9939945c.js";import"./ButtonBox-9e46519a.js";import"./kebab-menu-8835ad2e.js";import"./DatePicker-b1c13861.js";import"./FileUploadCustom-5ab7fd25.js";import"./Loading-783a01c7.js";import"./MediaGallery-5884b284.js";import"./Download_Icon-51fc7f46.js";import"./Dialog-adadaf64.js";import"./index-8739acfd.js";import"./FileUploadService-1aaf11f7.js";import"./FileUploadMenuBox-f47dc693.js";import"./MenuBox-defc36b0.js";import"./SimpleDropDown-061a3470.js";import"./IconButton-36693dd9.js";import"./sortIcon-54357a29.js";import"./eye_icon-081bddb3.js";import"./InputBox-b9e88f52.js";import"./DocumentService-a293b5f4.js";import"./StaticMasterDataService-689a6eca.js";import"./link-0172a3d4.js";import"./TransitionGroup-c8afe0ce.js";const X={uid:"",sectionCode:"",docTypeUid:"",isLoading:!1,savedDocuments:[]},ht=()=>{var P,I;const o=D(),[T,p]=r.useState(l.VIEW),[e,d]=r.useState({...X}),[M,f]=r.useState(!1),[m,E]=r.useState(""),[n,g]=r.useState("");r.useState(_.PRIMARY);const[C,R]=r.useState(!1),A=r.useRef(null),s=r.useRef(null);r.useEffect(()=>{h()},[]);const h=()=>{U()},U=async()=>{d(t=>({...t,isLoading:!0}));try{const t=await O.getCreditDocuments(`loanUid=${o==null?void 0:o.loanUid}&stageUid=${o==null?void 0:o.stageUid}`);d(a=>{var c;return{...a,savedDocuments:q((c=t==null?void 0:t.data)==null?void 0:c.loanDocuments),isLoading:!1}})}catch(t){E(x(t)),d(a=>({...a,isLoading:!1}))}};r.useEffect(()=>{var t;s!=null&&s.current&&n!==""&&((t=s==null?void 0:s.current)==null||t.showFunction(),g(""))},[n,C]),r.useEffect(()=>{m&&f(!0)},[m]);const b=()=>{p(l.VIEW)},j=async()=>{var c;const t=(c=A.current)==null?void 0:c.getUploadedData();if(!t)return;const a=L(t);try{await O.updateCreditDocuments(a),g(w.SAVED),R(!C),p(l.VIEW),U()}catch(N){E(x(N))}},L=t=>({uid:e.uid,loan:{uid:o==null?void 0:o.loanUid},stage:{uid:o==null?void 0:o.stageUid},loanDocuments:t!=null&&t.documentUid?[{uid:t==null?void 0:t.uid,docType:{uid:t==null?void 0:t.documentUid},docNo:(t==null?void 0:t[`${t.primaryKeyAttributeName}`])??null,dob:t.dob?t.dob:null,loanSectionKey:F.CAM_CREDIT_DOCUMENT,docCategory:t==null?void 0:t.documentCategory,attributes:H(t),documentSections:k(t==null?void 0:t.documentSectionUrls)}]:[]});return i.jsxs("div",{className:"flex flex-col",children:[i.jsx(K,{title:"label.cam.recommendation.creditDoc",children:e!=null&&e.isLoading?i.jsx(J,{height:"19.375rem",width:"100%",borderRadius:"8px",animation:"wave"}):i.jsx(W,{title:"label.cam.recommendation.docAndRec",pageMode:T,onEdit:()=>p(l.EDIT),onCancel:b,onSave:j,children:i.jsx(G,{ref:A,mandatoryDocUpload:!0,savedDocument:(P=e.savedDocuments)!=null&&P[0]?(I=e.savedDocuments)==null?void 0:I[0]:{},mode:T===l.EDIT?y.EDIT:y.VIEW,queryParamForDocList:Y.DOCUMENT_CATEGORY_CREDIT_DOCUMENTS,docUploadTypeTitle:"PDF/JPG/Excel/ZIP"})})}),i.jsx($,{position:"bottom-right",ref:s,toastText:n,variant:_.PRIMARY}),i.jsx(V,{onHide:()=>{f(!1),E("")},visible:M,errorMessage:m})]})};export{ht as default};
//# sourceMappingURL=PageCreditDocument-f1fb8c67.js.map
