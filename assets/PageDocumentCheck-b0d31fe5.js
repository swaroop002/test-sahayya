import{q as Me,r,aG as Pe,R as ve,ad as Q,ae as Z,af as D,j as t,ax as w,aF as P,d$ as E,aH as Ce,ao as Ne,o as C}from"./index-e8217573.js";import Re,{DOCUMENT_CHECK_MODULE as Ie}from"./PageAssetDocumentCheck-f0428b47.js";import{E as je}from"./ErrorDialog-d5eef4d7.js";import{T as Ye}from"./Toast-ae99ea5b.js";import{S as Ae}from"./SaveComponent-160c5b32.js";import{S as Ue}from"./Section-00ef9f2b.js";import{E as Be,C as M}from"./EditableTableV2-6afcb42b.js";import{S as Fe}from"./SimpleDropDown-061a3470.js";import{I as ke}from"./InputBox-b9e88f52.js";import{I as $e,B as _e}from"./IconButton-36693dd9.js";import{M as Le}from"./MenuBox-defc36b0.js";import{C as ee}from"./CamService-5ccef840.js";import{n as A}from"./Helper-54d1e873.js";import{i as Oe,M as Ge}from"./MediaGallery-5884b284.js";import{S as se}from"./SystemDatePicker-abe08a29.js";import"./ReadOnlyTable-86accb69.js";import"./No_data-1720c54e.js";import"./datatable.esm-f474a654.js";import"./paginator.esm-11c2c115.js";import"./virtualscroller.esm-9939945c.js";import"./SimpleTab-27fa8860.js";import"./FileUploadMenuBox-f47dc693.js";import"./kebab-menu-8835ad2e.js";import"./Skeleton-7e12d019.js";import"./ApplicantService-924aa5cb.js";import"./QcService-39051cda.js";import"./ImagePreview-952ca75e.js";import"./Loading-783a01c7.js";import"./FileUploadService-1aaf11f7.js";import"./InputTextArea-b90aad1d.js";import"./withAuth-6de36ebf.js";import"./RichTextEditor-a03bd2fb.js";import"./index-8739acfd.js";import"./ButtonBox-9e46519a.js";import"./Dialog-adadaf64.js";import"./useSelector-dc41929a.js";import"./AddressService-27926b64.js";import"./FinalOpinion-c6d0ce35.js";import"./LegalService-c6087928.js";import"./link-0172a3d4.js";import"./loader-5f2cfb31.js";import"./sortIcon-54357a29.js";import"./Download_Icon-51fc7f46.js";import"./eye_icon-081bddb3.js";import"./TransitionGroup-c8afe0ce.js";import"./Helper-03e9d878.js";import"./DocumentUploader-e2ec1a13.js";import"./AutoComplete-0bca608a.js";import"./search_icon-459d6871.js";import"./DatePicker-b1c13861.js";import"./FileUploadCustom-5ab7fd25.js";import"./DocumentService-a293b5f4.js";import"./StaticMasterDataService-689a6eca.js";const We={dropdownOptions:{addressType:[],businessProof:[],rcuStatus:[],verificationStatus:[]},businessProof:[],pageMode:{businessProof:P.VIEW},isLoading:{businessProof:!1}},Vs=()=>{var _,L,O;const c=Me(),[ne,U]=r.useState(!1),[N,B]=r.useState(""),[d,R]=r.useState({...We}),[I,te]=r.useState(""),[F,Ve]=r.useState(Pe.PRIMARY),[k,oe]=r.useState(!1),[ie,$]=r.useState(!1),[re,ce]=r.useState({...Oe}),f=r.useRef(null),m=ve.useRef(null),le=r.useRef(null),[,v]=r.useState(!1),o=r.useRef(new Q({validators:{...Z()},...D(),autoForceUpdate:{forceUpdate:()=>v(e=>!e)}})),de=[{items:[]}];r.useEffect(()=>{var e;f!=null&&f.current&&I!==""&&((e=f==null?void 0:f.current)==null||e.showFunction())},[I,F,k]),r.useEffect(()=>{N&&U(!0)},[N]);const j=(e,s)=>{var i;console.log("handle change");let n={...s.rowData};n={...n,[`${s.field}`]:e.target.value},(i=m.current)==null||i.reportDataChange(n)},Y=e=>{var s,n;(n=o==null?void 0:o.current)==null||n.showMessageFor((s=e==null?void 0:e.target)==null?void 0:s.name)},me=()=>{var s,n;let e=!1;return e=((s=o==null?void 0:o.current)==null?void 0:s.allValid())??!1,e||(v(i=>!i),(n=o==null?void 0:o.current)==null||n.showMessages(),v(i=>!i),!1)},ue=async()=>{var e,s;if(me()){const n=xe();try{await ee.updateIncomeDocuments(n),te(Ce.SAVED),oe(!k),R(i=>({...i,pageMode:{...i.pageMode,businessProof:P.VIEW}})),(e=m.current)==null||e.clearAll(),(s=m.current)==null||s.search()}catch(i){B(Ne(i))}}},ae=()=>{R(e=>({...e,pageMode:{...e.pageMode,businessProof:P.EDIT}}))},pe=()=>{var e,s;R(n=>({...n,pageMode:{...n.pageMode,businessProof:P.VIEW}})),(e=m.current)==null||e.clearAll(),(s=m.current)==null||s.search()},fe=(e,s)=>{var i,u,a,p,l,x,h,g,T,S,y,b,G,W,V,H,q,K,X,z,J;let n={uid:"",placeOfUpload:"",name:"",fileName:"",fileType:"",download:"",category:"",type:"",sectionName:"",url:""};s!=null&&s.loanDocument&&(n={uid:((i=s==null?void 0:s.loanDocument)==null?void 0:i.uid)??"",placeOfUpload:"",name:((a=(u=s==null?void 0:s.loanDocument)==null?void 0:u.applicant)==null?void 0:a.firstName)??"-",fileName:((x=(l=(p=s==null?void 0:s.loanDocument)==null?void 0:p.documentSections)==null?void 0:l[0])==null?void 0:x.fileName)??"-",fileType:((T=(g=(h=s==null?void 0:s.loanDocument)==null?void 0:h.documentSections)==null?void 0:g[0])==null?void 0:T.fileType)??"-",download:"",category:((G=(b=(y=(S=s==null?void 0:s.loanDocument)==null?void 0:S.documentSections)==null?void 0:y[0])==null?void 0:b.loanDocument)==null?void 0:G.docCategory)??"-",type:((V=(W=s==null?void 0:s.loanDocument)==null?void 0:W.docType)==null?void 0:V.name)??"-",sectionName:((K=(q=(H=s==null?void 0:s.loanDocument)==null?void 0:H.documentSections)==null?void 0:q[0])==null?void 0:K.sectionName)??"-",url:((J=(z=(X=s==null?void 0:s.loanDocument)==null?void 0:X.documentSections)==null?void 0:z[0])==null?void 0:J.url)??""}),ce(n),$(!0)},xe=()=>{var u,a,p;let e=((u=m.current)==null?void 0:u.getAddedRecords())??[],s=((a=m.current)==null?void 0:a.getDeletedRecords())??[],n=((p=m.current)==null?void 0:p.getUpdatedRecords())??[];return e=e.map(l=>({...A(l)})),s=s.map(l=>A(l)),n=n.map(l=>A(l)),[...e,...s,...n]},he=()=>{var e;o.current=new Q({validators:{...Z()},...D(),autoForceUpdate:{forceUpdate:()=>v(s=>!s)}}),(e=o==null?void 0:o.current)==null||e.hideMessages()},ge=()=>{he()},Te=e=>{var s,n,i,u,a,p,l,x,h,g,T,S,y,b;return console.log("rowData Uid BusinessProof",e.uid),t.jsx("div",{className:"pt-4",children:t.jsx(Fe,{hideLabel:!0,placeholder:"placeholder.legal.documentCopyType",name:`documentProof${e==null?void 0:e.uid}`,value:`${((n=(s=e==null?void 0:e.loanDocument)==null?void 0:s.docType)==null?void 0:n.name)??((l=(p=(a=(u=(i=e==null?void 0:e.loanDocument)==null?void 0:i.documentSections)==null?void 0:u[0])==null?void 0:a.loanDocument)==null?void 0:p.docType)==null?void 0:l.name)}`,variant:C.PRIMARY,options:[`${((h=(x=e==null?void 0:e.loanDocument)==null?void 0:x.docType)==null?void 0:h.name)??((b=(y=(S=(T=(g=e==null?void 0:e.loanDocument)==null?void 0:g.documentSections)==null?void 0:T[0])==null?void 0:S.loanDocument)==null?void 0:y.docType)==null?void 0:b.name)}`],disabled:!0})})},Se=e=>{var s;return t.jsx("div",{className:"pt-4",children:t.jsx(se,{hideLabel:!0,name:`dateOfDocument${e.uid}`,onChange:n=>j(n,{rowData:e,field:"docYearFrom"}),showMinMaxRange:!0,value:e!=null&&e.docYearFrom?new Date(e==null?void 0:e.docYearFrom):"",variant:C.SECONDARY,onBlur:Y,validation:(s=o==null?void 0:o.current)==null?void 0:s.message(`dateOfDocument${e.uid}`,e.docYearFrom,"mandatory")})})},ye=e=>{var s;return t.jsx("div",{className:"pt-4",children:t.jsx(se,{hideLabel:!0,name:`docYearTo${e.uid}`,onChange:n=>j(n,{rowData:e,field:"docYearTo"}),showMinMaxRange:!0,value:e!=null&&e.docYearTo?new Date(e==null?void 0:e.docYearTo):"",variant:C.SECONDARY,onBlur:Y,validation:(s=o==null?void 0:o.current)==null?void 0:s.message(`docYearTo${e.uid}`,e.docYearTo,"mandatory")})})},be=e=>{var s;return t.jsx("div",{className:"pt-4",children:t.jsx(ke,{name:`remarks${e==null?void 0:e.uid}`,hideLabel:!0,variant:C.SECONDARY,value:e==null?void 0:e.remarks,onBlur:Y,onChange:n=>j(n,{rowData:e,field:"remarks"}),validation:(s=o==null?void 0:o.current)==null?void 0:s.message(`remarks${e==null?void 0:e.uid}`,e==null?void 0:e.remarks,"mandatory")})})},Ee=e=>t.jsx("div",{className:"flex gap-2 justify-center items-center",children:t.jsx(w,{override:{read:!1},children:t.jsx("div",{className:"flex-shrink-0",children:t.jsx($e,{buttonType:_e.VIEW,onClick:s=>fe(s,e)})})})});return t.jsxs("div",{className:"grid gap-5",children:[t.jsx(Ue,{title:"label.cam.businessProofDocument",children:t.jsx(Ae,{title:"",pageMode:(_=d==null?void 0:d.pageMode)==null?void 0:_.businessProof,disabled:(L=d==null?void 0:d.isLoading)==null?void 0:L.businessProof,onSave:ue,onCancel:pe,onEdit:ae,children:t.jsx(w,{override:{read:((O=d==null?void 0:d.pageMode)==null?void 0:O.businessProof)===P.VIEW},children:c!=null&&c.loanUid&&(c!=null&&c.stageUid)?t.jsxs(Be,{ref:m,uniqueKey:"uid",standardDataFormatPromise:ee.getIncomeDocumentList,search:`&isActive=${!0}&loanUid=${(c==null?void 0:c.loanUid)??""}&stageUid=${(c==null?void 0:c.stageUid)??""}`,mode:"UPDATE",variant:"secondary",onUpdateCallback:ge,paginator:!1,className:"table-auto-height",children:[t.jsx(M,{header:E.t("label.cam.documentProof"),className:"text-primary-ptext-1000 text-left text-xs h-12 pl-6",body:Te}),t.jsx(M,{header:E.t("label.cam.documentYearFrom"),className:" text-primary-ptext-1000 text-xs h-12 pl-6",body:Se}),t.jsx(M,{header:E.t("label.cam.documentYearTo"),className:" text-primary-ptext-1000 text-xs h-12 pl-6",body:ye}),t.jsx(M,{header:E.t("label.cam.Remark"),className:" text-primary-ptext-1000 text-xs h-12 pl-6",body:be}),t.jsx(M,{header:E.t("label.investmentInfo.table.colTitle.action"),className:"text-primary-ptext-1000 text-right text-xs h-12 px-6",style:{minWidth:"50px",width:"50px"},body:Ee})]}):null})})}),t.jsx(Re,{module:Ie.CAM}),t.jsx(Ge,{visible:ie,onToggleVisibility:()=>$(e=>!e),list:[],currentSection:re}),t.jsx(Le,{ref:le,model:de,variant:"SECONDARY",buttonClassName:"!bg-transparent",className:"width-full-menubox bg-white  w-max p-1.5 rounded-md mt-0.5 border shadow-autoCompletePanel"}),t.jsx(je,{onHide:()=>{U(!1),B("")},visible:ne,errorMessage:N}),t.jsx(Ye,{position:"bottom-right",ref:f,toastText:I,variant:F})]})};export{Vs as default};
//# sourceMappingURL=PageDocumentCheck-b0d31fe5.js.map
