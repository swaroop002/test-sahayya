import{r,f2 as Te,j as l,R as at,J as F,T as j,o as Ee,f3 as C,f as Gt,w as kt,q as Ht,dG as a,f4 as ce,aG as Ne,ad as ze,ae as Je,af as Ze,v as I,eq as Kt,ao as Me,d4 as Ye,f5 as O,f6 as Vt,b as $t,l as Ft,i as De,cZ as we,c_ as et,aw as qt,aH as ge,dg as Xt,aa as tt,f7 as st,eA as lt}from"./index-e8217573.js";import{a as rt}from"./CustomHooks-0ce50620.js";import{A as nt}from"./AutoComplete-0bca608a.js";import{B as q}from"./ButtonBox-9e46519a.js";import{E as Wt}from"./ErrorDialog-d5eef4d7.js";import{D as Qt}from"./Dialog-adadaf64.js";import{E as zt}from"./EditableTableV2-6afcb42b.js";import{I as Jt}from"./ImagePreview-952ca75e.js";import{R as Re}from"./ReadOnlyTable-86accb69.js";import{T as Zt}from"./TextData-06df331b.js";import{C as o}from"./column.esm-938bad7d.js";import{I as Dt,B as wt}from"./IconButton-36693dd9.js";import{I as es}from"./InputBox-b9e88f52.js";import{i as ts,M as ss}from"./MediaGallery-5884b284.js";import{M as ls}from"./MenuBox-defc36b0.js";import{S as ns}from"./SelectButtonBox-10b4d2ac.js";import{D as it}from"./DocumentService-a293b5f4.js";import{I as is}from"./InputTextArea-b90aad1d.js";import{R as cs}from"./RadioButton-86c37166.js";import{S as ct}from"./SimpleDropDown-061a3470.js";import{S as as}from"./Skeleton-7e12d019.js";import{T as rs}from"./Toast-ae99ea5b.js";import{C as ds}from"./BaseChips-c7cc0dee.js";import{A as os}from"./ApplicantService-924aa5cb.js";import{S as Oe}from"./StaticMasterDataService-689a6eca.js";import{S as b}from"./StageService-c1c03c89.js";import"./search_icon-459d6871.js";import"./withAuth-6de36ebf.js";import"./virtualscroller.esm-9939945c.js";import"./kebab-menu-8835ad2e.js";import"./datatable.esm-f474a654.js";import"./paginator.esm-11c2c115.js";import"./Loading-783a01c7.js";import"./FileUploadService-1aaf11f7.js";import"./No_data-1720c54e.js";import"./sortIcon-54357a29.js";import"./Download_Icon-51fc7f46.js";import"./eye_icon-081bddb3.js";import"./index-8739acfd.js";import"./TransitionGroup-c8afe0ce.js";const ms=r.forwardRef((X,Be)=>{var Y,h;const{disabled:g,loanId:s,title:R}=X,[A,ae]=r.useState([]),[Ce,re]=r.useState(!1),[v,B]=r.useState({...ts}),[x,U]=r.useState(!1),[W,Ae]=r.useState(""),[T,Q]=r.useState((h=(Y=Te)==null?void 0:Y[0])==null?void 0:h.value),G=r.useRef(null),k=r.useRef(null),y=rt(),z=[{items:[]}];r.useEffect(()=>{x&&setTimeout(()=>{var n;(n=G==null?void 0:G.current)==null||n.search()},10)},[x,W,T]);const Pe=r.useRef();r.useImperativeHandle(Be,()=>({getSelectedDocumentList:K}));const L=n=>{var i;Ae((i=n==null?void 0:n.target)==null?void 0:i.value)},de=n=>{n.value!=null&&Q(n.value)},J=()=>{U(!0)},ve=()=>{var n,i;Q((i=(n=Te)==null?void 0:n[0])==null?void 0:i.value),U(!1)},Z=n=>{var m,u;const i=[...A];i.unshift({...n}),ae([...i]),Q((u=(m=Te)==null?void 0:m[0])==null?void 0:u.value),U(!1)},D=(n,i)=>{const m=A.filter(u=>u.uid!==i.uid);ae([...m])},H=(n,i)=>{var p;const m=[];m.push({label:"Remove",className:"px-1.5 text-xs text-primary-labelColor h-6.5 hover:bg-primary-sapphireBlue-100",command:()=>{D(n,i)}});const u=[...m];z[0].items=[...u],(p=k==null?void 0:k.current)==null||p.show(n)},M=(n,i)=>{var u,p,pe,fe,he;const m={uid:i==null?void 0:i.uid,placeOfUpload:"",name:"",fileName:i.fileName,fileType:i.fileType,download:"",category:i!=null&&i.isLoanDocument?((u=i==null?void 0:i.loanDocument)==null?void 0:u.docCategory)??"-":i!=null&&i.isKycDocument?"KYC":"-",type:i!=null&&i.isLoanDocument?((pe=(p=i==null?void 0:i.loanDocument)==null?void 0:p.docType)==null?void 0:pe.name)??"-":i!=null&&i.isKycDocument?((he=(fe=i==null?void 0:i.kyc)==null?void 0:fe.docType)==null?void 0:he.name)??"-":"-",sectionName:i!=null&&i.isLoanDocument?(i==null?void 0:i.section)??"-":i!=null&&i.isKycDocument?(i==null?void 0:i.smDocSectionType)??"-":"-",url:i==null?void 0:i.url};B(m),re(!0)},K=()=>[...A],w=n=>l.jsx("div",{className:"flex items-center",children:l.jsx(Jt,{url:n==null?void 0:n.url,className:"w-14 h-14"})}),V=n=>{var i;return l.jsx("div",{className:"flex items-center",children:T===C.LOAN_DOCUMENT?((i=n==null?void 0:n.loanDocument)==null?void 0:i.docCategory)??"-":T===C.KYC_DOCUMENT?"KYC":"-"})},Le=n=>{var i,m,u,p;return l.jsx("div",{className:"flex items-center",children:T===C.LOAN_DOCUMENT?((m=(i=n==null?void 0:n.loanDocument)==null?void 0:i.docType)==null?void 0:m.name)??"-":T===C.KYC_DOCUMENT?((p=(u=n==null?void 0:n.kyc)==null?void 0:u.docType)==null?void 0:p.name)??"-":"-"})},oe=n=>l.jsx("div",{className:"flex items-center",children:T===C.LOAN_DOCUMENT?(n==null?void 0:n.section)??"-":T===C.KYC_DOCUMENT?(n==null?void 0:n.smDocSectionType)??"-":"-"}),me=n=>l.jsx("div",{className:"flex items-center",children:(n==null?void 0:n.fileName)??"-"}),ee=n=>{var i,m;return l.jsx("div",{className:"flex items-center",children:((m=(i=n==null?void 0:n.loanDocument)==null?void 0:i.stage)==null?void 0:m.name)??"-"})},Ge=n=>{var i,m,u,p;return l.jsx("div",{className:"flex items-center",children:((m=(i=n==null?void 0:n.loanDocument)==null?void 0:i.applicant)==null?void 0:m.fullName)??((p=(u=n==null?void 0:n.kyc)==null?void 0:u.applicant)==null?void 0:p.fullName)??"-"})},ue=n=>{var i,m,u,p;return l.jsx("div",{className:"flex items-center",children:((m=(i=n==null?void 0:n.loanDocument)==null?void 0:i.applicant)==null?void 0:m.applicantType)??((p=(u=n==null?void 0:n.kyc)==null?void 0:u.applicant)==null?void 0:p.applicantType)??"-"})},ke=n=>l.jsx("div",{className:"flex items-center",children:Gt(n==null?void 0:n.updatedAtSystemDate)??"-"}),xe=n=>{const i={isLoanDocument:T===C.LOAN_DOCUMENT,isKycDocument:T===C.KYC_DOCUMENT};return l.jsx("div",{className:"flex items-center",children:l.jsx(q,{buttonType:F.UPLOAD_PRIMARY_WITHOUT_LABEL,onClick:()=>Z({...n,...i}),className:"mr-0.5"})})},_e=n=>{var i,m,u,p;return l.jsx("div",{className:"flex items-center",children:n!=null&&n.isLoanDocument?((m=(i=n==null?void 0:n.loanDocument)==null?void 0:i.applicant)==null?void 0:m.applicantType)??"-":n!=null&&n.isKycDocument?(p=(u=n==null?void 0:n.kyc)==null?void 0:u.applicant)==null?void 0:p.applicantType:"-"})},Se=n=>{var i;return l.jsx("div",{className:"flex items-center",children:n!=null&&n.isLoanDocument?((i=n==null?void 0:n.loanDocument)==null?void 0:i.docCategory)??"-":n!=null&&n.isKycDocument?"KYC":"-"})},P=n=>{var i,m,u,p;return l.jsx("div",{className:"flex items-center",children:n!=null&&n.isLoanDocument?((m=(i=n==null?void 0:n.loanDocument)==null?void 0:i.docType)==null?void 0:m.name)??"-":n!=null&&n.isKycDocument?((p=(u=n==null?void 0:n.kyc)==null?void 0:u.docType)==null?void 0:p.name)??"-":"-"})},Ie=n=>l.jsx("div",{className:"flex items-center",children:n!=null&&n.isLoanDocument?(n==null?void 0:n.section)??"-":n!=null&&n.isKycDocument?(n==null?void 0:n.smDocSectionType)??"-":"-"}),E=n=>l.jsxs("div",{className:"flex justify-start items-center space-x-4",children:[l.jsx("div",{className:"flex items-center",children:l.jsx(Dt,{buttonType:wt.VIEW,onClick:i=>{M(i,n)}})}),l.jsx("div",{className:"flex items-center",children:l.jsx(q,{buttonType:F.MENU,onClick:i=>H(i,n)})})]}),$=()=>{const n=T===C.LOAN_DOCUMENT?it.getDocumentList:it.getKycDocumentList,i=T===C.LOAN_DOCUMENT?`loan.uid=${s}&isActive=true&loanDocument.docCategory:lk=${W}`:`loan.uid=${s}&isActive=true`;return l.jsx("div",{className:"flex flex-col justify-start items-start w-full h-full",children:l.jsxs(Re,{standardDataFormatPromise:n,dataKey:"id",search:i,ref:G,className:"border-none flex flex-col h-full existing-doc-table",children:[l.jsx(o,{className:"text-primary-ptext-1000 text-left text-xs  p-1 h-12 pl-6",header:y("label.existing.doc.preview"),body:w}),l.jsx(o,{className:"text-primary-ptext-1000 text-left text-xs  p-1 h-12 pl-6",header:y("label.existing.doc.category"),body:V}),l.jsx(o,{className:"text-primary-ptext-1000 text-left text-xs p-1 h-12 pl-6",header:y("label.existing.doc.type"),body:Le}),l.jsx(o,{className:"text-primary-ptext-1000 text-left text-xs  p-1 h-12 pl-6",header:y("label.existing.doc.section"),body:oe}),l.jsx(o,{className:"text-primary-ptext-1000 text-left text-xs  p-1 h-12 pl-6",header:y("label.existing.doc.file.name"),body:me}),l.jsx(o,{className:"text-primary-ptext-1000 text-left text-xs  p-1 h-12 pl-6",header:y("label.existing.doc.stage.section"),body:ee}),l.jsx(o,{className:"text-primary-ptext-1000 text-left text-xs  p-1 h-12 pl-6",header:y("label.existing.doc.customerName"),body:Ge}),l.jsx(o,{className:"text-primary-ptext-1000 text-left text-xs  p-1 h-12 pl-6",header:y("label.existing.doc.customerType"),body:ue}),l.jsx(o,{className:"text-primary-ptext-1000 text-left text-xs  p-1 h-12 pl-6",header:y("label.existing.doc.uploaded.on"),body:ke}),l.jsx(o,{frozen:!0,className:"text-primary-ptext-1000 text-left text-xs  p-1 h-12 pl-6",header:y("label.existing.doc.action"),body:xe})]})})},be=()=>l.jsx(Qt,{className:"!w-[90%] !py-4 px-8",visible:x,closable:!1,children:l.jsxs("div",{className:"flex flex-col justify-start items-center space-y-4 w-full h-full ",children:[l.jsxs("div",{className:"flex justify-between items-center w-full",children:[l.jsx(j,{className:"text-base text-primary-primaryTextColor font-bold",label:"label.heading.upload.existing.file"}),l.jsx(q,{buttonType:F.CLOSE_OUTLINE,onClick:ve,className:"mr-0.5"})]}),l.jsx("div",{className:"flex justify-start items-center w-full",children:l.jsx("div",{className:"w-74",children:l.jsx(ns,{optionLabel:"name",optionValue:"value",value:T,options:Te,onChange:de})})}),l.jsx("div",{className:"flex flex-col justify-start items-start w-full",children:l.jsx("div",{className:"w-74",children:l.jsx(es,{variant:Ee.SECONDARY,label:"label.text.search.document.category",name:"searchText",className:"",value:W,onChange:L,disabled:T===C.KYC_DOCUMENT})})}),l.jsx("div",{className:"w-full h-full",children:$()})]})});return l.jsxs(at.Fragment,{children:[l.jsxs("div",{className:"mt-3 flex flex-col gap-5 w-full",children:[l.jsxs("div",{className:"flex justify-between items-center",children:[R&&typeof R=="string"?l.jsx(Zt,{label:R,titleClass:"text-primary-sideBarBgColor text-xs mb-1"}):R,l.jsx("div",{className:"self-end",children:l.jsx(q,{buttonType:F.ADD_ASSET,onClick:J})})]}),l.jsx("div",{children:l.jsxs(zt,{ref:Pe,uniqueKey:"uid",paginator:!1,value:A,className:`h-auto existing-doc-read-table ${A!=null&&A.length?"!min-h-auto":"!min-h-50"}`,children:[l.jsx(o,{className:"text-primary-ptext-1000 text-left text-xs  p-1 h-12 pl-6",header:y("label.stages.initiate.applicantType"),body:_e}),l.jsx(o,{header:y("label.existing.document.category"),className:"text-primary-ptext-1000 text-left text-xs h-12 pl-6",body:Se}),l.jsx(o,{header:y("label.existing.document.type"),className:"text-primary-ptext-1000 text-left text-xs h-12 pl-6",body:P}),l.jsx(o,{header:y("label.existing.document.section"),className:"text-primary-ptext-1000 text-left text-xs h-12 pl-6",body:Ie}),l.jsx(o,{header:y("label.existing.document.action"),className:"text-primary-ptext-1000 text-left text-xs h-12 pl-6",body:E})]})})]}),be(),l.jsx(ss,{visible:Ce,onToggleVisibility:()=>re(n=>!n),list:[],currentSection:v}),l.jsx(ls,{ref:k,model:z,variant:"SECONDARY",buttonClassName:"!bg-transparent",className:"width-full-menubox bg-white  w-max p-1.5 rounded-md mt-0.5 border shadow-autoCompletePanel"})]})}),us={stage:"",stageType:"",assignee:{name:"",uid:""},autoComplete2:{name:"",uid:""},ccEmail:[],meetingDate:"",mobileNo:"",description:""},xs=X=>{const g=Ht().loanUid??"",[s,R]=r.useState({...us}),[A,ae]=r.useState(""),[Ce,re]=r.useState([]),[v,B]=r.useState({[a.RCU_REPORT]:[],[a.TECHNICAL_REPORT]:[],[a.LEGAL_REPORT]:[],[a.PD]:[]}),[x,U]=r.useState({selectedRowData:{},selectionObj:{}}),[W,Ae]=r.useState(!1),[T,Q]=r.useState(!0),[G,k]=r.useState({isUploaderVisible:!1,uploaderPosition:ce.TOP}),[y,z]=r.useState(!1),[Pe,L]=r.useState(!1),[de,J]=r.useState([]),[ve,Z]=r.useState("bottom-right"),[D,H]=r.useState(""),[M,K]=r.useState(!1),[w,V]=r.useState(""),[Le,oe]=r.useState(!1),[me,ee]=r.useState(Ne.PRIMARY),[Ge,ue]=r.useState(""),[ke,xe]=r.useState(!1),[_e,Se]=r.useState(!1),P=r.useRef(null),Ie=r.useRef(null),E=r.useRef(null),$=r.useRef(null),be=r.useRef(null),Y=r.useRef(null),h=rt(),[,n]=r.useState(!1),i=r.useRef(new ze({validators:{...Je()},...Ze(),autoForceUpdate:{forceUpdate:()=>n(e=>!e)}})),m=["QC","DEDUPE","CAM_AND_RECOMMENDATION","FINANCIAL_APPROVAL","IN_PRINCIPAL_APPROVAL","FINAL_APPROVAL"],u=[a.LEGAL_REPORT,a.TECHNICAL_REPORT,a.PD];r.useEffect(()=>{ft()},[]),r.useEffect(()=>{var e;if(s!=null&&s.stage&&(vt(),E&&(E!=null&&E.current)&&((s==null?void 0:s.stage)===a.TECHNICAL_REPORT||(s==null?void 0:s.stage)===a.LEGAL_REPORT))){const t=((e=E==null?void 0:E.current)==null?void 0:e.getCurrentRecords())??[];t.length===1&&U(c=>{var d;return{...c,selectedRowData:{...(t==null?void 0:t[0])??{}},selectionObj:{[(d=t==null?void 0:t[0])==null?void 0:d.uid]:!0}}})}},[s==null?void 0:s.stage]),r.useEffect(()=>{w&&oe(!0)},[w]),r.useEffect(()=>{var e;P!=null&&P.current&&D!==""&&((e=P==null?void 0:P.current)==null||e.showFunction())},[D,me,M]);const p=async()=>{var e;try{const t=await b.getStageName(g);if(I(t)){const c=(e=t==null?void 0:t.data)==null?void 0:e.map((d,f)=>{var N;return(N=Kt)==null?void 0:N[d==null?void 0:d.stageName]});re(c)}}catch(t){console.log(t),V(Me(t))}},pe=async()=>{var e,t,c,d;try{const f=await os.getApplicantInfo(0,20,Ye.PRIMARY,g);I(f)&&((e=f.data)!=null&&e.totalRecords)&&ae((d=(c=(t=f.data)==null?void 0:t.results)==null?void 0:c[0])==null?void 0:d.uid)}catch(f){console.log(f),V(Me(f))}},fe=()=>{Oe.getAll(0,1e3,"staticMasterType.code=RCU_TYPE&").then(e=>{I(e)&&B(t=>({...t,[a.RCU_REPORT]:[...e.data.results??[]]}))})},he=()=>{Oe.getAll(0,1e3,"staticMasterType.code=VENDOR_TYPE&").then(e=>{I(e)&&B(t=>({...t,[a.TECHNICAL_REPORT]:[...e.data.results??[]],[a.LEGAL_REPORT]:[...e.data.results??[]]}))})},dt=()=>{Oe.getAll(0,1e3,"staticMasterType.code=PD_TYPE&").then(e=>{I(e)&&B(t=>({...t,[a.PD]:[...e.data.results??[]]}))})},ye=e=>{var t,c;(c=i==null?void 0:i.current)==null||c.showMessageFor((t=e==null?void 0:e.target)==null?void 0:t.name)},ot=()=>{var t,c;let e=!1;return e=(t=i==null?void 0:i.current)==null?void 0:t.allValid(),e||(n(d=>!d),(c=i==null?void 0:i.current)==null||c.showMessages(),n(d=>!d),!1)},je=e=>{e.target.name==="stageType"?R(t=>({...t,autoComplete2:{name:"",uid:""},[e.target.name]:e.target.value})):R(t=>({...t,[e.target.name]:e.target.value}))},He=e=>{const{name:t,value:c}=e.target;R(typeof c=="object"?d=>({...d,[t]:{name:c==null?void 0:c.name,uid:c==null?void 0:c.uid}}):d=>({...d,[t]:{name:c,uid:""}}))},mt=(e,t)=>{U(c=>({...c,selectedRowData:{...t},selectionObj:{[e.target.name]:e.checked}}))},ut=e=>{R(t=>({...t,ccEmail:e.value})),ue(""),xe(!1)},xt=()=>{const e=De+we+"/"+g+et;X==null||X.navigate(e)},pt=async()=>{if(!ot())return;const e=ht();try{const t=await b.initiateStage(e);qt(t)&&(H(ge.INITIATED),ee(Ne.PRIMARY),K(!M),Se(!0))}catch(t){console.log(t),V(Me(t))}},ft=()=>{pe(),p()},ht=()=>{var c,d,f,N,_,S,te,se,le,ne,ie;const e=(c=Y==null?void 0:Y.current)==null?void 0:c.getSelectedDocumentList(),t={loan:{uid:g},applicant:{uid:A},stageName:s==null?void 0:s.stage,assignee:{uid:(d=s==null?void 0:s.assignee)==null?void 0:d.uid},delegate:null,partner:null,remarks:s==null?void 0:s.description,smStageType:s==null?void 0:s.stageType,stageInitiationDetail:{ccEmail:s!=null&&s.ccEmail.length?JSON.stringify(s==null?void 0:s.ccEmail):""},stageDocuments:Array.isArray(e)&&e.length?yt(e):[]};return(s==null?void 0:s.stage)===a.PD&&((f=x==null?void 0:x.selectedRowData)!=null&&f.uid)?t.applicant={uid:(N=x==null?void 0:x.selectedRowData)==null?void 0:N.uid}:t.applicant={uid:A},((s==null?void 0:s.stage)===a.LEGAL_REPORT||(s==null?void 0:s.stage)===a.TECHNICAL_REPORT||(s==null?void 0:s.stage)===a.RCU_REPORT)&&((_=x==null?void 0:x.selectedRowData)!=null&&_.uid)?t.address={uid:(S=x==null?void 0:x.selectedRowData)==null?void 0:S.uid}:t.address=null,(s==null?void 0:s.stage)===a.LEGAL_REPORT||(s==null?void 0:s.stage)===a.TECHNICAL_REPORT||(s==null?void 0:s.stage)===a.RCU_REPORT?(te=s==null?void 0:s.autoComplete2)!=null&&te.uid&&(s.stageType===O.VENDOR_TYPE_INTERNAL?(t.internalVendor={uid:(se=s==null?void 0:s.autoComplete2)==null?void 0:se.uid},t.partner=null):(t.partner={uid:(le=s==null?void 0:s.autoComplete2)==null?void 0:le.uid},t.internalVendor=null)):(ne=s==null?void 0:s.autoComplete2)!=null&&ne.uid&&(t.delegate={uid:(ie=s==null?void 0:s.autoComplete2)==null?void 0:ie.uid}),(s==null?void 0:s.stage)===a.LEGAL_REPORT&&(t.legal={}),(s==null?void 0:s.stage)===a.PD&&(t.pd={}),(s==null?void 0:s.stage)===a.RCU_REPORT&&(t.rcu={}),(s==null?void 0:s.stage)===a.TECHNICAL_REPORT&&(t.technical={}),t},yt=e=>e.map(t=>{var c,d,f,N;return{loan:{},loanDocumentSection:t!=null&&t.isLoanDocument?{uid:(t==null?void 0:t.uid)??""}:null,kycDocument:t!=null&&t.isKycDocument?{uid:(t==null?void 0:t.uid)??""}:null,stageDocType:t!=null&&t.isLoanDocument?(d=(c=t==null?void 0:t.loanDocument)==null?void 0:c.docType)==null?void 0:d.name:t!=null&&t.isKycDocument?(N=(f=t==null?void 0:t.kyc)==null?void 0:f.docType)==null?void 0:N.name:"",stage:{},isSharedAtInitiation:!0}});function Tt(){const{stage:e}=s;switch(e){case a.RCU_REPORT:return"label.text.stage.initiate.RCU.type";case a.TECHNICAL_REPORT:case a.LEGAL_REPORT:return"label.text.stage.initiate.vendor.type";case a.PD:return"label.text.stage.initiate.PD.type";default:return""}}function Nt(){const{stage:e}=s;return e===a.RCU_REPORT||e===a.TECHNICAL_REPORT||e===a.LEGAL_REPORT?"label.text.stage.initiate.internal.assignee":"label.text.stage.initiate.assign.to*"}const gt=[{condition:(e,t)=>e===a.LEGAL_REPORT&&t===O.VENDOR_TYPE_INTERNAL||e===a.TECHNICAL_REPORT&&t===O.VENDOR_TYPE_INTERNAL,label:"label.text.stage.initiate.internal.vendor"},{condition:(e,t)=>e===a.LEGAL_REPORT&&t===O.VENDOR_TYPE_EXTERNAL||e===a.TECHNICAL_REPORT&&t===O.VENDOR_TYPE_EXTERNAL,label:"label.text.stage.initiate.external.vendor"},{condition:e=>[a.RCU_REPORT,a.TECHNICAL_REPORT,a.LEGAL_REPORT].includes(e),label:"label.text.stage.initiate.external.vendor"},{condition:e=>e===a.PD,label:"label.text.stage.initiate.PD.type"},{condition:()=>!0,label:"label.text.stage.initiate.delegate"}];function Et(){const{stage:e,stageType:t}=s,c=gt.find(d=>d.condition(e,t));return c?c.label:"label.text.stage.initiate.delegate"}const Rt=()=>{var e;i.current=new ze({validators:{...Je()},...Ze(),autoForceUpdate:{forceUpdate:()=>n(t=>!t)}}),(e=i==null?void 0:i.current)==null||e.hideMessages()},Ct=e=>{if((s==null?void 0:s.stage)===a.RCU_REPORT||(s==null?void 0:s.stage)===a.LEGAL_REPORT||(s==null?void 0:s.stage)===a.TECHNICAL_REPORT){(s==null?void 0:s.stageType)===O.VENDOR_TYPE_INTERNAL?Pt(e):At(e);return}Ke(e)},Ke=async e=>{var d,f;const{originalEvent:t}=e;let c=[];((d=t==null?void 0:t.target)==null?void 0:d.name)==="assignee"&&z(!0),((f=t==null?void 0:t.target)==null?void 0:f.name)==="autoComplete2"&&L(!0);try{await b.findStageAssignee(0,10,`${e.query}`,g,s==null?void 0:s.stage).then(N=>{var _,S;I(N)&&(c=[...N.data],((_=t==null?void 0:t.target)==null?void 0:_.name)==="assignee"&&z(!1),((S=t==null?void 0:t.target)==null?void 0:S.name)==="autoComplete2"&&L(!1))})}catch{Z("top-right"),H(ge.ERROR),K(!M)}c.length===0&&c.push({name:void 0,code:void 0,uid:void 0}),J(c)},At=async e=>{let t=[];L(!0);try{const c=`&isActive=true&name=${e.query.toLowerCase()}&loanUid=${g}&stage=${s==null?void 0:s.stage}`;await b.getExternalVendor(0,20,c).then(d=>{I(d)&&(t=[...d.data],L(!1))})}catch{Z("top-right"),H(ge.ERROR),K(!M),ee(Ne.QUATERNARY)}t.length===0&&t.push({name:void 0,code:void 0,uid:void 0}),J(t)},Pt=async e=>{let t=[];L(!0);try{const c=`&isActive=true&name=${e.query.toLowerCase()}&loanUid=${g}&stageName=${s==null?void 0:s.stage}`;await b.getInternalVendor(0,20,c).then(d=>{I(d)&&(t=[...d.data],L(!1))})}catch{Z("top-right"),H(ge.ERROR),K(!M),ee(Ne.QUATERNARY)}t.length===0&&t.push({name:void 0,code:void 0,uid:void 0}),J(t)},vt=()=>{var e,t;R(c=>({...c,stageType:"",assignee:{name:"",uid:""},autoComplete2:{name:"",uid:""},meetingDate:"",mobileNo:""})),U(c=>({selectedRowData:{},selectionObj:{}})),B({[a.RCU_REPORT]:[],[a.TECHNICAL_REPORT]:[],[a.LEGAL_REPORT]:[],[a.PD]:[]}),Ae((s==null?void 0:s.stage)===a.PD),Q(m.includes(s==null?void 0:s.stage)),k(c=>({...c,isUploaderVisible:!m.includes(s==null?void 0:s.stage),uploaderPosition:u.includes(s==null?void 0:s.stage)?ce.BOTTOM:ce.TOP})),Rt(),(s==null?void 0:s.stage)===a.RCU_REPORT&&fe(),((s==null?void 0:s.stage)===a.LEGAL_REPORT||(s==null?void 0:s.stage)===a.TECHNICAL_REPORT)&&(he(),(e=E==null?void 0:E.current)==null||e.search()),(s==null?void 0:s.stage)===a.PD&&(dt(),(t=$==null?void 0:$.current)==null||t.search())},Ve=e=>(e==null?void 0:e.name)===void 0?l.jsx("div",{className:"flex flex-col items-center justify-center h-39 pointer-events-none cursor-default",children:l.jsx(j,{className:"text-primary-labelColor mt-2",label:"label.noDataFound"})}):l.jsx("div",{className:"flex flex-col",children:l.jsx(j,{className:"text-primary-labelColor",label:e==null?void 0:e.name})}),Ue=e=>{var t;return l.jsx(cs,{hideLabel:!0,hideErrorRow:!0,name:`${e==null?void 0:e.uid}`,checked:(t=x==null?void 0:x.selectionObj)==null?void 0:t[e==null?void 0:e.uid],onChange:c=>mt(c,e)})},Lt=e=>{var t;return l.jsx("div",{className:"flex items-center",children:((t=st)==null?void 0:t[e==null?void 0:e.primaryAddressType])??"-"})},$e=e=>{var t;return l.jsx("div",{className:"flex items-center",children:lt[(t=e==null?void 0:e.applicant)==null?void 0:t.applicantType]??"-"})},_t=e=>{var t;return l.jsx("div",{className:"flex items-center",children:((t=st)==null?void 0:t[e==null?void 0:e.primaryAddressType])??"-"})},Fe=e=>l.jsx("div",{className:"flex items-center",children:(e==null?void 0:e.address)??"-"}),qe=e=>{var t;return l.jsx("div",{className:"flex items-center",children:((t=e==null?void 0:e.pincode)==null?void 0:t.pinCode)??"-"})},Xe=e=>{var t;return l.jsx("div",{className:"flex items-center",children:((t=e==null?void 0:e.city)==null?void 0:t.name)??"-"})},We=e=>{var t,c;return l.jsx("div",{className:"flex items-center",children:(c=(t=e==null?void 0:e.city)==null?void 0:t.state)==null?void 0:c.name})},St=e=>l.jsx("div",{className:"flex items-center",children:lt[e==null?void 0:e.applicantType]??"-"}),It=()=>l.jsx("div",{className:"flex justify-start items-center w-full",children:l.jsx(j,{label:"label.stages.initiate.customer.name",className:"w-1/2 truncate"})}),bt=e=>l.jsx("div",{className:"flex items-center justify-start w-full",children:l.jsx("div",{className:"w-1/2 truncate",children:e!=null&&e.firstName||e!=null&&e.middleName||e!=null&&e.lastName?` ${(e==null?void 0:e.firstName)??""} ${(e==null?void 0:e.middleName)??""} ${(e==null?void 0:e.lastName)??""}`:"-"})}),jt=()=>l.jsxs("div",{className:"flex justify-between items-start w-full",children:[l.jsx("div",{children:l.jsx(j,{className:"text-primary-primaryTextColor font-bold",label:"heading.stages.initiate.new.stage"})}),l.jsxs("div",{className:"flex gap-4",children:[l.jsx(q,{buttonType:F.CANCEL_OUTLINE,onClick:xt}),l.jsx(q,{buttonType:F.INITIATE,className:"create-button",onClickWithLoader:pt})]})]}),Qe=()=>l.jsx("div",{className:"flex w-full h-full",children:l.jsx(ms,{loanId:g,ref:Y,title:(s==null?void 0:s.stage)===a.PD?"label.stages.documents":"label.stages.documents.verification"})}),Ut=()=>l.jsxs("div",{className:"flex flex-col justify-start items-start space-y-2 mt-4",children:[l.jsx(j,{className:"text-xs text-primary-sideBarBgColor",label:"label.table.heading.stage.profile.check"}),l.jsx("div",{className:"flex flex-col justify-start items-start w-full",children:l.jsxs(Re,{standardDataFormatPromise:b.getPropertyDetails,dataKey:"id",search:`loan.uid=${g}&isActive=true&primaryAddressType:notnull=''`,ref:Ie,hidePaginator:!0,children:[l.jsx(o,{className:"text-primary-ptext-1000 text-xs p-1 h-12 px-3 flex justify-center items-center",header:h("label.stages.initiate.select"),body:Ue}),l.jsx(o,{className:"text-primary-ptext-1000 text-left text-xs  p-1 h-12 pl-6",header:h("label.stages.initiate.applicantType"),body:$e}),l.jsx(o,{className:"text-primary-ptext-1000 text-left text-xs  p-1 h-12 pl-6",header:h("label.stages.initiate.addressType"),body:_t}),l.jsx(o,{className:"text-primary-ptext-1000 text-left text-xs p-1 h-12 pl-6",header:h("label.stages.initiate.address"),body:Fe}),l.jsx(o,{className:"text-primary-ptext-1000 text-left text-xs  p-1 h-12 pl-6",header:h("label.stages.initiate.pincode"),body:qe}),l.jsx(o,{className:"text-primary-ptext-1000 text-left text-xs  p-1 h-12 pl-6",header:h("label.stages.initiate.city"),body:Xe}),l.jsx(o,{className:"text-primary-ptext-1000 text-left text-xs  p-1 h-12 pl-6",header:h("label.stages.initiate.state"),body:We})]})})]}),Mt=()=>{var e,t;return l.jsxs("div",{className:" flex flex-col justify-start items-start space-y-2 mt-4 mb-5",children:[l.jsx(j,{className:"text-xs text-primary-sideBarBgColor",label:(s==null?void 0:s.stage)===a.TECHNICAL_REPORT?"label.table.heading.stage.properties.evaluation":(s==null?void 0:s.stage)===a.LEGAL_REPORT?"label.table.heading.stage.property.details":""}),l.jsxs(Re,{standardDataFormatPromise:b.getPropertyDetails,dataKey:"id",search:`loan.uid=${g}&primaryAddressType=${Xt.COLLATERAL_PROPERTY}&isActive=true`,ref:E,hidePaginator:!0,className:"table-auto-height",children:[l.jsx(o,{className:"text-primary-ptext-1000 text-xs p-1 h-12 px-3 flex justify-center items-center",header:h("label.stages.initiate.select"),body:Ue}),l.jsx(o,{className:"text-primary-ptext-1000 text-left text-xs  p-1 h-12 pl-6",header:h("label.stages.initiate.propertyType"),body:Lt}),l.jsx(o,{className:"text-primary-ptext-1000 text-left text-xs  p-1 h-12 pl-6",header:h("label.stages.initiate.applicantType"),body:$e}),l.jsx(o,{className:"text-primary-ptext-1000 text-left text-xs p-1 h-12 pl-6",header:h("label.stages.initiate.address"),body:Fe}),l.jsx(o,{className:"text-primary-ptext-1000 text-left text-xs  p-1 h-12 pl-6",header:h("label.stages.initiate.pincode"),body:qe}),l.jsx(o,{className:"text-primary-ptext-1000 text-left text-xs  p-1 h-12 pl-6",header:h("label.stages.initiate.city"),body:Xe}),l.jsx(o,{className:"text-primary-ptext-1000 text-left text-xs  p-1 h-12 pl-6",header:h("label.stages.initiate.state"),body:We})]}),l.jsx("div",{className:"h-4 flex  items-start mb-1.5",children:l.jsx(tt,{validation:(t=i==null?void 0:i.current)==null?void 0:t.message("propertyForLegalOrTechnical",(e=Object.keys)==null?void 0:e.call(Object,x==null?void 0:x.selectionObj),"mandatoryElementInArray")})})]})},Yt=()=>{var e,t;return l.jsxs("div",{className:" flex flex-col justify-start items-start space-y-2 mt-4 mb-5",children:[l.jsx(j,{className:"text-xs text-primary-sideBarBgColor font-medium",label:"label.table.heading.stage.customer.selection"}),l.jsxs(Re,{standardDataFormatPromise:b.getCustomerDetails,dataKey:"id",search:`applicantType:in=['${Ye.PRIMARY}','${Ye.CO_APPLICANT}']&loan.uid=${g}&isActive=true`,ref:$,hidePaginator:!0,className:"table-auto-height",children:[l.jsx(o,{className:"text-primary-ptext-1000 text-xs p-1 h-12 px-3 flex justify-center items-center w-1/2",header:h("label.stages.initiate.select"),body:Ue}),l.jsx(o,{className:"text-primary-ptext-1000 text-left text-xs p-1 h-12 pl-6",header:h("label.stages.initiate.customer.type"),body:St}),l.jsx(o,{className:"text-primary-ptext-1000 text-left text-xs p-1 h-12 w-full flex justify-start stage-status-customer-name",header:It(),body:bt})]}),l.jsx("div",{className:"h-4 flex  items-start mb-1.5",children:l.jsx(tt,{validation:(t=i==null?void 0:i.current)==null?void 0:t.message("selectCustomerForPd",(e=Object.keys)==null?void 0:e.call(Object,x==null?void 0:x.selectionObj),"mandatoryElementInArray")})})]})},Ot=()=>l.jsxs("div",{className:"w-full",children:[(s==null?void 0:s.stage)===a.RCU_REPORT?Ut():null,(s==null?void 0:s.stage)===a.LEGAL_REPORT||(s==null?void 0:s.stage)===a.TECHNICAL_REPORT?Mt():null,(s==null?void 0:s.stage)===a.PD?Yt():null]}),Bt=()=>{var te,se,le,ne,ie;const{stage:e,stageType:t,assignee:c,autoComplete2:d,ccEmail:f,description:N}=s,{isUploaderVisible:_,uploaderPosition:S}=G;return l.jsxs("div",{className:"flex flex-col justify-start items-start space-y-2 w-full",children:[l.jsxs("div",{className:"w-1/2 flex flex-col justify-start items-start space-y-2",children:[l.jsxs("div",{className:"flex justify-between items-center space-x-2 w-full",children:[l.jsx("div",{className:"w-full",children:l.jsx(ct,{label:"label.text.stage.initiate.stage",placeholder:"Select Stage",value:e,name:"stage",onChange:je,onBlur:ye,validation:(te=i==null?void 0:i.current)==null?void 0:te.message("stage",e,"mandatory"),options:Ce,optionLabel:"label",optionValue:"value",className:"!w-full"})}),l.jsx("div",{className:"w-full",children:T?null:(se=v==null?void 0:v[e])!=null&&se.length?l.jsx(ct,{label:Tt(),placeholder:"Select type",value:t,name:"stageType",onChange:je,validation:(le=i==null?void 0:i.current)==null?void 0:le.message("stageType",t,"mandatory"),onBlur:ye,options:v==null?void 0:v[e],optionLabel:"name",optionValue:"code"}):l.jsx(as,{height:"1.563rem",width:"100%",borderRadius:"8px",animation:"wave"})})]}),l.jsxs("div",{className:"flex justify-between items-center space-x-2 w-full",children:[l.jsx("div",{className:"w-full",children:l.jsx(nt,{disabled:!e,variant:Ee.PRIMARY,label:Nt(),placeholder:"",name:"assignee",value:c==null?void 0:c.name,suggestions:de,completeMethod:Ke,onChange:He,itemTemplate:Ve,loader:y,validation:(ne=i==null?void 0:i.current)==null?void 0:ne.message("assignee",c==null?void 0:c.uid,"mandatory"),onBlur:ye})}),l.jsx("div",{className:"w-full",children:W?null:l.jsx(nt,{disabled:!e,variant:Ee.PRIMARY,label:Et(),placeholder:"",name:"autoComplete2",value:d==null?void 0:d.name,suggestions:de,completeMethod:Ct,onChange:He,itemTemplate:Ve,loader:Pe,onBlur:ye,validation:(ie=i==null?void 0:i.current)==null?void 0:ie.message("autoComplete2",d==null?void 0:d.uid,`${t===O.VENDOR_TYPE_EXTERNAL||t===Vt.RCU_TYPE_SAMPLING?"mandatory":"optional"}`)})})]}),l.jsx("div",{className:"w-full",children:l.jsx(ds,{className:"",name:"ccEmail",value:f,label:"CC",onChange:ut,placeholder:(f==null?void 0:f.length)!==0?"":"Enter email(s)",ref:be,setParentError:ue,setHasError:xe})})]}),_&&S===ce.TOP?Qe():null,Ot(),_&&S===ce.BOTTOM?Qe():null,l.jsx("div",{className:"w-1/2  pt-5",children:l.jsx(is,{name:"description",className:"!h-40 ",label:"input.text.title.description",placeholder:"",variant:Ee.SECONDARY,maxCount:200,onChange:je,value:N,autoResize:!0})})]})};return l.jsxs(at.Fragment,{children:[l.jsxs("div",{className:"bg-white rounded-xl py-5 px-6 flex flex-col justify-start items-start flex-1",children:[jt(),Bt()]}),l.jsx(Wt,{onHide:()=>{oe(!1),V("")},visible:Le,errorMessage:w}),l.jsx(rs,{position:ve,ref:P,toastText:D,variant:me,onRemove:()=>{if(_e){const e=$t+Ft+De+we+"/"+g+et;window.location.href=e}}})]})},el=kt(xs);export{el as default};
//# sourceMappingURL=PageInitiateStage-f9759816.js.map
