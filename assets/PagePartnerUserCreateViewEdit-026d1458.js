import{w as Me,r as o,aF as i,aG as h,ad as ee,ae,af as te,y as Ye,z as F,j as a,ax as se,T as M,J as A,o as T,al as Le,ct as Y,aH as S,ao as L,v as ke,av as Be,aI as re,aJ as ne,aK as j}from"./index-e8217573.js";import{A as We}from"./AutoComplete-0bca608a.js";import{B as y}from"./ButtonBox-9e46519a.js";import{E as Ve}from"./ErrorDialog-d5eef4d7.js";import{I as k}from"./InputBox-b9e88f52.js";import{I as oe}from"./InputTextArea-b90aad1d.js";import{T as Je}from"./Toast-ae99ea5b.js";import{P as ie}from"./PartnerMasterDataService-d9d86d95.js";import{S as qe}from"./StaticMasterTypeService-480bff1a.js";import"./search_icon-459d6871.js";import"./withAuth-6de36ebf.js";import"./virtualscroller.esm-9939945c.js";import"./kebab-menu-8835ad2e.js";import"./Dialog-adadaf64.js";import"./TransitionGroup-c8afe0ce.js";const Ge=C=>{var Q,$,z,X,Z;const[s,I]=o.useState({partnerName:"",name:"",lastName:"",email:"",password:"",reasons:"",description:"",isActive:""}),[c,U]=o.useState(i.CREATE),m=o.useRef(null),[,u]=o.useState(void 0),[He,ce]=o.useState([]),[le,b]=o.useState(!1),[v,P]=o.useState(""),[de,w]=o.useState("bottom-right"),[B,N]=o.useState(h.PRIMARY),[O,f]=o.useState(""),[g,R]=o.useState(!1),[me,_]=o.useState(!1),[E,pe]=o.useState(""),t=o.useRef(new ee({validators:{...ae()},...te(),autoForceUpdate:{forceUpdate:()=>u(e=>!e)}}));o.useEffect(()=>{const e=Ye.parse(C.location.search);e!=null&&e.mode&&(e==null?void 0:e.mode)!==void 0&&U(e.mode),console.log(e.mode,"hmm"),pe(e.uid),e!=null&&e.mode&&(e==null?void 0:e.mode)!==void 0&&U(e.mode),(e==null?void 0:e.mode)===i.CREATE&&I({partnerName:"",name:"",lastName:"",email:"",password:"",reasons:"",description:"",isActive:""}),ue()},[]),o.useEffect(()=>{var e;m!=null&&m.current&&O!==""&&((e=m==null?void 0:m.current)==null||e.showFunction())},[O,B,g]),o.useEffect(()=>{v&&b(!0)},[v]);const ue=()=>{ie.getAll().then(e=>{ce([...e.data.results])}).catch(e=>{console.log("err")})},p=e=>{const{name:r,value:n}=e.target;console.log(r,n),I(l=>({...l,[r]:n}))},ge=()=>{var e;t.current=new ee({validators:{...ae()},...te(),autoForceUpdate:{forceUpdate:()=>u(r=>!r)}}),(e=t==null?void 0:t.current)==null||e.hideMessages()},Ee=()=>({name:s.name,lastName:s.lastName,email:s.email,sahayyaUserType:"PARTNER_USER",reason:s.reasons,password:s.password,partner:s.partnerName,description:s.description}),he=()=>({uid:E,name:s.name,lastName:s.lastName,email:s.email,sahayyaUserType:"PARTNER_USER",reason:s.reasons,password:s.password,partner:s.partnerName,description:s.description}),Te=()=>{const e={uid:E,name:s.name,lastName:s.lastName,email:s.email,sahayyaUserType:"PARTNER_USER",reason:s.reasons,password:s.password,partner:s.partnerName,description:s.description};let r;const n=e,l=ve;return c===i.CREATE?r={name:s.name,operationType:re.CREATE,entity:ne.PARTNER_USER,initialStateJson:"",finalStateJson:j(n),reqPayload:j(n),reasonForChange:s.reasons}:r={name:s.name,operationType:re.UPDATE,entity:ne.PARTNER_USER,initialStateJson:j(l),finalStateJson:j(n),reqPayload:j(n),reasonForChange:s.reasons??"reason"},r};o.useEffect(()=>{v&&b(!0)},[v]),o.useEffect(()=>{E&&fe()},[E]);const[ve,Ne]=o.useState({partnerName:"",name:"",lastName:"",email:"",password:"",reasons:"",description:"",isActive:""}),fe=()=>{F.getPartnerUserByID(E).then(e=>{var r,n,l;I({...s,partnerName:(r=e.data)==null?void 0:r.partner,name:e.data.name,lastName:e.data.lastName,email:e.data.email,reasons:e.data.reason,description:e.data.description}),ge(),Ne({name:e.data.name,lastName:e.data.lastName,email:e.data.email,sahayyaUserType:"PARTNER_USER",reason:e.data.reason,partner:{uid:(l=(n=e.data)==null?void 0:n.partner)==null?void 0:l.uid},password:"",description:e.data.description})}).catch(e=>{console.log(e)})},W=async()=>{var r,n;let e=!1;return e=((r=t==null?void 0:t.current)==null?void 0:r.allValid())??!1,e||(u(l=>!l),(n=t==null?void 0:t.current)==null||n.showMessages(),u(l=>!l),!1)},x=e=>{var r,n;(n=t==null?void 0:t.current)==null||n.showMessageFor((r=e==null?void 0:e.target)==null?void 0:r.name)},Re=async()=>{var l,D;P("");let e=!1;if(e=await W(),!e){w("top-right"),N(h.QUATERNARY),f(S.ERROR),R(!g);return}const r=Ee(),n=he();if((l=t==null?void 0:t.current)!=null&&l.allValid())if(c!==i.CREATE)try{const d=await F.update(E,n);N(h.PRIMARY),f(S.SAVED),R(!g),w("bottom-right"),_(!0)}catch(d){P(L(d))}else{if(!be)return;try{const d=await F.save(r);N(h.PRIMARY),f(S.SAVED),R(!g),w("bottom-right"),_(!0)}catch(d){P(L(d))}}else w("top-right"),N(h.QUATERNARY),f(S.ERROR),R(!g),u(d=>!d),(D=t==null?void 0:t.current)==null||D.showMessages(),u(d=>!d)},xe=()=>{C.navigate(Y)},Ae=async()=>{let e=!1;if(e=await W(),!e)return;const r=Te();return qe.approve(r).then(n=>{N(h.PRIMARY),f(S.SENT_FOR_APPROVAL),R(!g),_(!0)}).catch(n=>{P(L(n))})},Se=()=>{C.navigate(Y)},je=()=>{U(i.EDIT)},ye=()=>{switch(c){case i.CREATE:return"heading.partnerUser.create";case i.VIEW:return"heading.partnerUser.view";case i.EDIT:return"heading.partnerUser.edit";default:return"heading.partnerUser.create"}},[Ce,V]=o.useState(!1),[Pe,we]=o.useState([]),Ie=async e=>{let r=[];V(!0),await ie.getAll(0,10,`&name:lk=${e.query}&isActive=true`).then(n=>{ke(n)&&(r=[...n.data.results],V(!1))}),we(r)},Ue=e=>e.name===void 0?a.jsxs("div",{className:"flex flex-col items-center justify-center h-39",children:[a.jsx("img",{src:Be,alt:"search-icon",className:" h-7 w-7"}),a.jsx(M,{className:"mt-2 text-primary-labelColor",label:"Loading..."})]}):a.jsx("div",{className:"flex flex-col",children:a.jsx(M,{className:"text-primary-labelColor",label:e.name})}),[be,Oe]=o.useState(!1),_e=e=>{Oe(e)},{partnerName:De,name:J,lastName:q,email:G,password:H,description:Fe,reasons:K,isActive:Ke}=s;return a.jsx(se,{children:a.jsxs("div",{className:"",children:[a.jsxs("div",{className:"flex items-center justify-between w-full",children:[a.jsx(M,{label:ye(),className:"flex font-bold text-primary-ptext-1000 text-h2 font-Roboto"}),a.jsx("div",{className:"flex mr-5",children:c===i.CREATE||c===i.EDIT?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"mr-5",children:a.jsx(y,{className:"reset-red",buttonType:A.CANCEL_OUTLINE,onClick:xe})}),a.jsx("div",{className:"mr-10",children:a.jsx(y,{buttonType:A.SAVE_OUTLINE,onClickWithLoader:Re})}),a.jsx("div",{children:a.jsx(y,{className:"approve-primary",buttonType:A.SEND_FOR_APPROVAL,onClickWithLoader:Ae})})]}):a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"mr-5",children:a.jsx(y,{buttonType:A.BACK_OUTLINE,onClick:Se})}),a.jsx("div",{className:"",children:a.jsx(y,{buttonType:A.EDIT_OUTLINE,className:"blue-primary",onClick:je})})]})})]}),a.jsxs(se,{override:{read:[i.VIEW,i.REVIEW].includes(c)},children:[a.jsxs("div",{className:"grid grid-cols-4 gap-3",children:[a.jsx("div",{className:"col-span-1",children:a.jsx(We,{label:"input.partnerUser.partnerName",name:"partnerName",placeholder:"Type to search",field:"name",value:De,variant:T.PRIMARY,suggestions:Pe,completeMethod:Ie,onChange:p,itemTemplate:Ue,disabled:c===i.EDIT,loader:Ce})}),a.jsx("div",{className:"col-span-1",children:a.jsx(k,{label:"input.partnerUser.name",name:"name",variant:T.SECONDARY,onChange:p,value:J,onBlur:x,validation:(Q=t==null?void 0:t.current)==null?void 0:Q.message("name",J,"mandatory"),disabled:c===i.VIEW})}),a.jsx("div",{className:"col-span-1",children:a.jsx(k,{label:"input.partnerUser.lastName",name:"lastName",variant:T.SECONDARY,onChange:p,value:q,onBlur:x,validation:($=t==null?void 0:t.current)==null?void 0:$.message("lastName",q,"mandatory"),disabled:c===i.VIEW})}),a.jsx("div",{className:"col-span-1",children:a.jsx(k,{label:"input.partnerUser.email",name:"email",variant:T.SECONDARY,onChange:p,value:G,onBlur:x,validation:(z=t==null?void 0:t.current)==null?void 0:z.message("email",G,"mandatory|email"),disabled:c===i.VIEW||c===i.EDIT})})]}),c===i.CREATE&&a.jsx("div",{className:"grid grid-cols-4 gap-3",children:a.jsx("div",{className:"col-span-1",children:a.jsx(Le,{label:"input.partnerUser.password",placeholder:"placeholder.partnerUser.password",name:"password",value:H,type:"password",onChange:p,toggleMask:!0,onBlur:x,validation:c!=="CREATE"?"":(X=t==null?void 0:t.current)==null?void 0:X.message("password",H,"mandatory"),showPasswordVerification:!0,onPasswordValidityChange:_e})})}),a.jsxs("div",{className:"grid grid-cols-4 gap-3",children:[a.jsx("div",{className:"col-span-2",children:a.jsx(oe,{label:"input.partnerUser.description",name:"description",variant:T.SECONDARY,maxCount:200,onChange:p,value:Fe,disabled:c===i.VIEW})}),c!==i.VIEW&&a.jsx("div",{className:"col-span-2",children:a.jsx(oe,{label:"input.partnerUser.reasons",name:"reasons",variant:T.SECONDARY,maxCount:200,onChange:p,value:K,onBlur:x,validation:(Z=t==null?void 0:t.current)==null?void 0:Z.message("reasons",K,"mandatory"),disabled:c===i.VIEW})})]})]}),a.jsx(Ve,{onHide:()=>b(!1),visible:le,errorMessage:v}),a.jsx(Je,{position:de,ref:m,toastText:O,variant:B,onRemove:()=>{me&&C.navigate(Y)}})]})})},da=Me(Ge);export{da as default};
//# sourceMappingURL=PagePartnerUserCreateViewEdit-026d1458.js.map
