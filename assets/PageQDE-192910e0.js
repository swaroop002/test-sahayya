var pn=Object.defineProperty;var fn=(a,i,y)=>i in a?pn(a,i,{enumerable:!0,configurable:!0,writable:!0,value:y}):a[i]=y;var De=(a,i,y)=>(fn(a,typeof i!="symbol"?i+"":i,y),y);import{R as ct,j as n,T,J as ee,at as yn,d3 as rt,d4 as Z,w as hn,r as l,aG as B,aF as I,ad as xn,ae as Sn,af as Nn,ax as An,o as J,b2 as ge,aj as Dn,ak as gn,b3 as Je,d5 as Tn,d6 as bn,aw as X,aH as w,ao as v,e as Te,d7 as se,s as In,L as vn,z as En,d8 as Xe,d9 as q,c8 as Cn,v as ce,da as re,b as jn,l as Rn,i as Pn,W as Bn,db as Mn,dc as z,dd as ze}from"./index-e8217573.js";import{A as Ln}from"./Address-75e58af3.js";import{A as be}from"./AutoComplete-0bca608a.js";import{i as _n,B as kn}from"./BasicInformation-f2687bb1.js";import{B as te}from"./ButtonBox-9e46519a.js";import{D as Un}from"./Dialog-adadaf64.js";import{D as On,a as Ze,d as wn}from"./DocumentUploader-e2ec1a13.js";import{E as Yn}from"./ErrorDialog-d5eef4d7.js";import{I as Ie}from"./InputBox-b9e88f52.js";import{K as Fn,a as G}from"./KYCV3-298daeeb.js";import{b as Kn}from"./MediaGallery-5884b284.js";import{S as ve}from"./SaveComponent-160c5b32.js";import{S as Ee}from"./Section-00ef9f2b.js";import{T as Ce}from"./TextData-06df331b.js";import{T as Wn}from"./Toast-ae99ea5b.js";import{A as et}from"./ACLService-e19daf7c.js";import{O as qn}from"./Branch-732bec0f.js";import{P as Gn}from"./ProductConfigProductService-51cfb6b7.js";import{B as je}from"./BasicInformation-dd84bcb0.js";import{R as tt}from"./Residential-74fb844b.js";import{S as nt}from"./SourcingService-387bf5b5.js";import{s as Vn,i as $n,u as Qn}from"./Helper-03e9d878.js";import"./InputTextArea-b90aad1d.js";import"./withAuth-6de36ebf.js";import"./esm-70d64670.js";import"./index-8739acfd.js";import"./SimpleDropDown-061a3470.js";import"./virtualscroller.esm-9939945c.js";import"./TextButton-41b4a67e.js";import"./loader-5f2cfb31.js";import"./City-7102c574.js";import"./Pincode-a7c9b067.js";import"./StaticMasterDataService-689a6eca.js";import"./search_icon-459d6871.js";import"./InputAddon-04f948e7.js";import"./Skeleton-7e12d019.js";import"./ProfilePictureUpload-60f86be0.js";import"./Loading-783a01c7.js";import"./FileUploadCustom-5ab7fd25.js";import"./FileUploadMenuBox-f47dc693.js";import"./kebab-menu-8835ad2e.js";import"./MenuBox-defc36b0.js";import"./FileUploadService-1aaf11f7.js";import"./SystemDatePicker-abe08a29.js";import"./DatePicker-b1c13861.js";import"./IconButton-36693dd9.js";import"./sortIcon-54357a29.js";import"./Download_Icon-51fc7f46.js";import"./eye_icon-081bddb3.js";import"./DocumentService-a293b5f4.js";import"./link-0172a3d4.js";import"./TransitionGroup-c8afe0ce.js";const Hn=a=>{const{visible:i,title:y,description:b,confirmActionTitle:S,closeActionTitle:u,onConfirm:E,onClose:D}=a,Y=()=>{E()},M=()=>{D()};return n.jsx("div",{children:n.jsx(Un,{className:"!w-77 !p-0 rounded-masterDataPageRadius",visible:i,closable:!1,children:n.jsxs("div",{className:"py-4 px-12 flex flex-col gap-4 items-center justify-center",children:[n.jsx(T,{className:"font-bold text-base text-center text-primary-primaryTextColor",label:y??""}),n.jsx(T,{className:"text-xs text-center text-primary-primaryTextColor",label:b??""}),n.jsxs("div",{className:"action-btn-container flex gap-9 justify-center items-center text-xs",children:[n.jsx("div",{className:"gap-1.5",children:n.jsx(te,{buttonType:ee.YES,onClick:Y,className:"w-8 h-8"})}),n.jsx("div",{className:"gap-1.5",children:n.jsx(te,{buttonType:ee.NO_OUTLINE,onClick:M,className:"w-8 h-8"})})]})]})})})},Jn=ct.memo(Hn),Xn=({label:a,score:i})=>{let S,u;return i<0?(S="label.component.text.poor",u="text-primary-deepForestGreen"):i>=0&&i<1e3*.25?(S="label.component.text.fair",u="text-primary-goldenSaffron"):i>=1e3*.25&&i<1e3*.75?(S="label.component.text.good",u="text-primary-emeraldEnvy"):(S="label.component.text.very.good",u="text-primary-mysticPine"),n.jsxs("div",{className:"flex flex-col justify-center items-center text-xs w-full text-primary-sideBarBgColor ",children:[n.jsx("div",{className:"text-base mb-4.25 font-medium",children:n.jsx(T,{className:"",label:a})}),n.jsx("div",{className:"font-medium",children:n.jsx(T,{className:"",label:"label.component.text.score"})}),n.jsx("div",{className:`text-body-copy1 font-medium ${u}`,children:n.jsx(T,{className:"",label:`${i}`})}),n.jsx("div",{className:"mb-7.5 text-sm text-primary-deepForestGreen",children:n.jsx(T,{className:"",label:S})}),n.jsxs("div",{className:"flex justify-between items-center w-full",children:[n.jsxs("div",{className:"flex flex-col justify-start items-center w-full gap-2",children:[n.jsx("div",{className:"h-2.5 bg-semantic-crimson-600 w-[96%] rounded-xl"}),n.jsx(T,{className:"",label:"label.component.text.poor"})]}),n.jsxs("div",{className:"flex flex-col justify-start items-center w-full gap-2",children:[n.jsx("div",{className:"h-2.5 bg-primary-goldenSaffron w-[96%] rounded-xl"}),n.jsx(T,{className:"",label:"label.component.text.fair"})]}),n.jsxs("div",{className:"flex flex-col justify-start items-center w-full gap-2",children:[n.jsx("div",{className:"h-2.5 bg-primary-emeraldEnvy w-[96%] rounded-xl"}),n.jsx(T,{className:"",label:"label.component.text.good"})]}),n.jsxs("div",{className:"flex flex-col justify-start items-center w-full gap-2",children:[n.jsx("div",{className:"h-2.5 bg-primary-mysticPine w-[96%] rounded-xl"}),n.jsx(T,{className:"",label:"label.component.text.very.good"})]})]})]})},st="/custom/api/login/qde/generatelan";class zn extends yn{constructor(){super(...arguments);De(this,"getAll",(y=0,b=10,S="")=>{const u=`${st}/search?${S}start=${y}&limit=${b}`;return this.makeGetRequestWithAuth(u)});De(this,"save",y=>{const b=`${st}/${y}`;return this.makePutRequestWithAuth(b)})}}const ot=new zn,it=a=>{const{documentUid:i,documentName:y,documentCode:b,documentCategory:S,documentSectionUrls:u,isActive:E,uid:D,primaryKeyAttributeName:Y,meta:M,...L}=a;return JSON.stringify(L)},lt=a=>a.map(y=>({uid:y.uid?y.uid:null,section:y.code,fileName:y.fileName,fileType:y.contentType,thumbUrl:y.thumbUrl,url:y.url,isActive:y.isActive})),Zn=(a,i,y,b)=>{var u,E,D,Y,M;return{loan:{uid:i},applicant:{uid:y,applicantType:b},address:a.address,smAddressType:a.smAddressType,pincode:{uid:(u=a==null?void 0:a.pincode)==null?void 0:u.uid},city:{uid:(E=a==null?void 0:a.city)==null?void 0:E.uid},latitude:parseFloat(a==null?void 0:a.latitude).toFixed(4),longitude:parseFloat(a==null?void 0:a.longitude).toFixed(4),loanDocuments:a.addressDocumentsInfo.documentUid?[{uid:((D=a.addressDocumentsInfo)==null?void 0:D.uid)??null,docType:{uid:a.addressDocumentsInfo.documentUid},docNo:a.addressDocumentsInfo[`${a.addressDocumentsInfo.primaryKeyAttributeName}`]??null,dob:(Y=a.addressDocumentsInfo)!=null&&Y.dob?(M=a.addressDocumentsInfo)==null?void 0:M.dob:null,loanSectionKey:rt.ADDRESS_PROOF,docCategory:a.addressDocumentsInfo.documentCategory,attributes:it(a.addressDocumentsInfo),documentSections:lt(a.addressDocumentsInfo.documentSectionUrls)}]:[]}},at={loanRequestDetails:{product:{name:"",uid:""},loanAmount:"",loanAmountInWords:"",loanTenure:"",loanTenureInWords:""},sourceAndBranch:{salesAgent:{name:"",uid:""},branch:{name:"",uid:""},salesManager:{name:"",uid:""}}},es=(a,i,y)=>{const{documents:b,loanDocumentsInfo:S,...u}=a,E={...u,uid:a.uid||y,loanDocuments:S.documentUid?[{uid:S.uid,docType:{uid:S.documentUid},docNo:S[`${S.primaryKeyAttributeName}`]??null,dob:S.dob?S.dob:null,loanSectionKey:rt.DOB,docCategory:S.documentCategory,attributes:it(S),documentSections:lt(S.documentSectionUrls)}]:[]};return{loan:{uid:i},applicantType:Z.PRIMARY,...E}},ts=a=>{var y,b,S,u,E,D;return{address:{address:a==null?void 0:a.address,pincode:{pinCode:(y=a==null?void 0:a.pincode)==null?void 0:y.pinCode,uid:(b=a==null?void 0:a.pincode)==null?void 0:b.uid},city:{name:(S=a==null?void 0:a.city)==null?void 0:S.name,uid:(u=a==null?void 0:a.city)==null?void 0:u.uid},state:(D=(E=a==null?void 0:a.city)==null?void 0:E.state)==null?void 0:D.name,smAddressType:a==null?void 0:a.smAddressType,latitude:a==null?void 0:a.latitude,longitude:a==null?void 0:a.longitude},loanDocuments:Vn(a==null?void 0:a.loanDocuments)}},ns={address:{address:"",city:{name:"",uid:""},pincode:{pinCode:"",uid:""},state:"",smAddressType:"",latitude:"",longitude:""},loanDocuments:[]},ss=a=>{var We,qe,Ge,Ve,$e;const[i,y]=l.useState(""),[b,S]=l.useState(!1),[u,E]=l.useState(""),[D,Y]=l.useState({}),[M,L]=l.useState([{listId:"kyc-card-1",uid:"",docName:"",docNo:"",maskedDocNo:"",dob:"",docSections:[]}]),[dt,ut]=l.useState(1),[mt,pt]=l.useState([]),[ie,le]=l.useState({uid:"",success:!1,failed:!1}),[de,ue]=l.useState({verified:!1,failedToVerify:!1}),[me,g]=l.useState(""),[ft,yt]=l.useState(!1),[ht,os]=l.useState("bottom-right"),F=l.useRef(null),[pe,_]=l.useState(""),[Re,k]=l.useState(B.PRIMARY),[R,U]=l.useState(!1),[xt,Pe]=l.useState(!1),[as,ne]=l.useState(!1),[St,Nt]=l.useState(!1),[fe,ye]=l.useState([]),[At,Be]=l.useState({..._n}),[Me,oe]=l.useState(I.VIEW),[Dt,gt]=l.useState(!1),[he,xe]=l.useState(I.VIEW),[O,Le]=l.useState({...ns});l.useState([$n]);const[Tt,bt]=l.useState(!1),[_e,Se]=l.useState(I.VIEW),[p,P]=l.useState({...at}),K=l.useRef(null),W=l.useRef(null),C=l.useRef(null),[,Ne]=l.useState(!1),N=l.useRef(new xn({validators:{...Sn()},...Nn(),autoForceUpdate:{forceUpdate:()=>Ne(e=>!e)}}));l.useEffect(()=>{me&&Pe(!0)},[me]),l.useEffect(()=>{var e;F!=null&&F.current&&pe!==""&&((e=F==null?void 0:F.current)==null||e.showFunction())},[pe,Re,R]),l.useEffect(()=>{Le(e=>{var t,s;return{...e,address:{...e.address,address:D==null?void 0:D.address,pincode:{...e.address.pincode,pinCode:(t=D==null?void 0:D.pincode)==null?void 0:t.pinCode,uid:(s=D==null?void 0:D.pincode)==null?void 0:s.uid}}}})},[Tt]);const It=async()=>{const e=await G.getKycDocument(i,u);if(ce(e)){const{data:t}=e;return t}},vt=async()=>{var e;try{const t=await nt.getDdeDetails(i);console.log("details ",t);const s=Je((e=t.data)==null?void 0:e.amount,"en-IN",0);P(o=>{var c,r,m,f,h,A,x,d,j;return{...o,loanRequestDetails:{...o.loanRequestDetails,product:(c=t.data)==null?void 0:c.product,loanAmount:s||"",loanAmountInWords:(r=t.data)==null?void 0:r.amountInWords,loanTenure:(m=t.data)==null?void 0:m.tenure,loanTenureInWords:(f=t.data)==null?void 0:f.tenureInWords},sourceAndBranch:{...o.sourceAndBranch,branch:(h=t.data)==null?void 0:h.branch,salesAgent:((A=t.data)==null?void 0:A.salesAgent)??{name:"",uid:""},salesManager:((j=(d=(x=t.data)==null?void 0:x.salesAgent)==null?void 0:d.parent)==null?void 0:j.name)??""}}})}catch(t){console.log(t),ne(!1),g(v(t))}},Et=()=>{je.getDde(u).then(e=>{ce(e)&&Be(Qn({...e.data,resetDocumentData:!1}))}).catch(e=>{console.log(e),g(v(e))})},Ct=async()=>{try{const e=await tt.findByUid(i,u);ce(e)&&Le(t=>({...t,...ts(e==null?void 0:e.data)}))}catch(e){g(v(e))}},jt=e=>{const{name:t,value:s}=e.target;P(typeof s=="object"?o=>({...o,loanRequestDetails:{...o.loanRequestDetails,[t]:s}}):o=>({...o,loanRequestDetails:{...o.loanRequestDetails,[t]:{name:s}}}))},Rt=e=>{const{name:t,value:s}=e.target,o=ge(s);P(c=>({...c,loanRequestDetails:{...c.loanRequestDetails,[t]:Je(o,"en-IN",0),loanAmountInWords:Tn(o)}}))},Pt=e=>{const{name:t,value:s}=e.target;P(o=>({...o,loanRequestDetails:{...o.loanRequestDetails,[t]:s,loanTenureInWords:bn(s)}}))},Ae=e=>{const{name:t,value:s}=e.target;typeof s=="object"?t==="salesAgent"?(console.log(s),P(o=>{var c,r;return{...o,sourceAndBranch:{...o.sourceAndBranch,[t]:s,salesManager:{name:((c=s==null?void 0:s.parent)==null?void 0:c.name)??"",uid:((r=s==null?void 0:s.parent)==null?void 0:r.uid)??""}}}})):P(o=>({...o,sourceAndBranch:{...o.sourceAndBranch,[t]:s}})):P(o=>({...o,sourceAndBranch:{...o.sourceAndBranch,[t]:{name:s}}}))},V=e=>{var t,s;(s=N==null?void 0:N.current)==null||s.showMessageFor((t=e==null?void 0:e.target)==null?void 0:t.name)},ke=async()=>{var t,s;let e=!1;return e=((t=N==null?void 0:N.current)==null?void 0:t.allValid())??!1,e||(Ne(o=>!o),(s=N==null?void 0:N.current)==null||s.showMessages(),Ne(o=>!o),!1)},Bt=()=>{var t,s,o,c,r,m,f,h,A,x,d,j,ae,Qe,He;return{product:{uid:(s=(t=p==null?void 0:p.loanRequestDetails)==null?void 0:t.product)==null?void 0:s.uid},branch:{uid:(c=(o=p==null?void 0:p.sourceAndBranch)==null?void 0:o.branch)==null?void 0:c.uid},amount:ge((r=p==null?void 0:p.loanRequestDetails)==null?void 0:r.loanAmount),amountInWords:(m=p==null?void 0:p.loanRequestDetails)==null?void 0:m.loanAmountInWords,tenure:parseInt((f=p==null?void 0:p.loanRequestDetails)==null?void 0:f.loanTenure),tenureInWords:(h=p==null?void 0:p.loanRequestDetails)==null?void 0:h.loanTenureInWords,salesAgent:(x=(A=p==null?void 0:p.sourceAndBranch)==null?void 0:A.salesAgent)!=null&&x.uid?{uid:(j=(d=p==null?void 0:p.sourceAndBranch)==null?void 0:d.salesAgent)==null?void 0:j.uid}:null,salesManager:(ae=p==null?void 0:p.sourceAndBranch)!=null&&ae.salesManager.uid?{uid:(He=(Qe=p==null?void 0:p.sourceAndBranch)==null?void 0:Qe.salesManager)==null?void 0:He.uid}:null}},Mt=async()=>{let e=!1;if(e=await ke(),!e)return;const t=Bt();return nt.saveQde(t).then(s=>{X(s)&&(y(s.data.uid),k(B.PRIMARY),_(w.SAVED),U(!R),Se(I.VIEW))}).catch(s=>{g(v(s))})},Lt=async()=>{var t;const e=(t=K==null?void 0:K.current)==null?void 0:t.save();if(!e)return Promise.resolve(!0);if(e){const s=es(e,i,u);u?je.updateQde(s).then(o=>{se(o)&&(k(B.PRIMARY),_(w.SAVED),U(!R),oe(I.VIEW))}).catch(o=>{g(v(o))}):je.saveQde(s).then(o=>{var c,r;X(o)&&(k(B.PRIMARY),_(w.SAVED),U(!R),Be({...e,uid:(c=o==null?void 0:o.data)==null?void 0:c.uid,isActive:(r=o==null?void 0:o.data)==null?void 0:r.isActive}),oe(I.VIEW))}).catch(o=>{g(v(o))})}},Ue=async e=>G.getPopulateDocumentByKyc(i,u).then(t=>{var s,o;if(ce(t)){const[c,r,m]=((s=t==null?void 0:t.data)==null?void 0:s.name.split(" "))??"";t.data={...t.data,address:((o=t==null?void 0:t.data)==null?void 0:o.address)??"",firstName:c,middleName:r,lastName:m},Y(t.data),e===re.ADDRESS&&bt(f=>!f),e===re.BASIC_INFO&&gt(f=>!f)}}).catch(t=>{g(v(t))}),_t=async()=>{var s,o;const e=(s=W==null?void 0:W.current)==null?void 0:s.save(),t=(o=C==null?void 0:C.current)==null?void 0:o.getUploadedData();if(!(!ke()||!t)&&e){const c=Zn({...e,addressDocumentsInfo:t||{}},i,u,Z.PRIMARY);tt.save(c).then(r=>{X(r)&&(k(B.PRIMARY),_(w.SAVED),U(!R),xe(I.VIEW))}).catch(r=>{g(v(r))})}},kt=()=>{var e,t,s;(e=W==null?void 0:W.current)==null||e.resetValidator(),(t=C==null?void 0:C.current)==null||t.resetValidator(),(s=C==null?void 0:C.current)==null||s.resetDocUpload(),xe(I.VIEW),u&&Ct()},Ut=()=>{const e={listId:`kyc-card-${dt+1}`,uid:"",docName:"",docNo:"",maskedDocNo:"",dob:"",docSections:[]};ut(t=>t+1),L(t=>[...t,e]),le(()=>({uid:"",success:!1,failed:!1}))},Ot=()=>{yt(!0)},wt=()=>{if(et.isFormDirty())return S(!0);a.navigate(Te)},Yt=async()=>ot.save(i).then(e=>{se(e)&&(k(B.PRIMARY),_(w.SAVED),U(!R),Nt(!0))}).catch(e=>{g(v(e))}),Ft=()=>{if(i)return ot.save(i).then(e=>{if(se(e)){const t=e.data.uid;In(vn.STAGE_DETAIL,JSON.stringify(e.data));const s=jn+Rn+Pn+Bn+"/"+i+"/"+t+Mn;window.location.href=s}}).catch(e=>{g(v(e))});g("Loan Id not created")},Kt=()=>{var e;(e=K==null?void 0:K.current)==null||e.cancel(),oe(I.VIEW),u&&Et()},Wt=()=>{S(!1),et.clearFormDirty(),a.navigate(Te)},qt=async e=>(await It())[e],Gt=async e=>{let t=[];ne(!0);try{await Gn.findByName(0,50,e.query).then(s=>{s.status===200&&(t=[...s.data.results],ne(!1))})}catch(s){console.log(s)}t.length===0&&t.push({name:"",uid:""}),ye(t)},Vt=async e=>{var s,o;let t=[];try{await En.getUserByBranchAndName(0,50,(o=(s=p==null?void 0:p.sourceAndBranch)==null?void 0:s.branch)==null?void 0:o.uid,e.query).then(c=>{c.status===200&&(t=[...c.data],ne(!1))})}catch(c){console.log(c)}t.length===0&&t.push({name:"",uid:""}),ye(t)},$t=async e=>{let t=[];try{await qn.getFilterByName(0,50,e.query).then(s=>{s.status===200&&(t=[...s.data],ne(!1))})}catch(s){console.log(s)}t.length===0&&t.push({name:"",code:"",uid:""}),ye(t)},Oe=e=>{L(()=>[...M.filter((s,o)=>o!==e)])},Qt=e=>{pt([...e])},Ht=async(e,t)=>{if(e.uid){const s=await we(e);try{const o=await G.updateKycDocument(s,q.QDE);if(se(o)){const{data:c}=o,r=c.meta?JSON.parse(c.meta):null,m=h=>{var A,x;return h===z.DOCUMENT_SECTIONS_FRONT_PAGE?((A=r==null?void 0:r.ocrResponse)==null?void 0:A.frontMaskedImageUrl)??"":h===z.DOCUMENT_SECTIONS_BACK_PAGE?((x=r==null?void 0:r.ocrResponse)==null?void 0:x.backMaskedImageUrl)??"":""},f=h=>{var A;return((A=c.docType)==null?void 0:A.code)===ze.AADHAR_CARD?h.map(d=>({sectionUid:d.uid??"",fileType:d.fileType??"",sectionType:d.smDocSectionType??"",url:r?m(d.smDocSectionType):d.url})):[]};L(h=>h.map(x=>{var d;return x.uid===c.uid?{...x,docName:((d=c.docType)==null?void 0:d.code)??"",docNo:c.docNo??"",maskedDocNo:c.maskedDocNo??"",docSections:f(c.kycDocuments),dob:c.dob??""}:x})),k(B.PRIMARY),_(w.SAVED),U(!R)}}catch(o){g(v(o))}}else{const s=zt(e);try{const o=await G.saveKycDocument(s,q.QDE);if(X(o)){const{data:c}=o,r=c.meta?JSON.parse(c.meta):null,m=h=>{var A,x;return h===z.DOCUMENT_SECTIONS_FRONT_PAGE?((A=r==null?void 0:r.ocrResponse)==null?void 0:A.frontMaskedImageUrl)??"":h===z.DOCUMENT_SECTIONS_BACK_PAGE?((x=r==null?void 0:r.ocrResponse)==null?void 0:x.backMaskedImageUrl)??"":""},f=h=>{var A;return((A=c.docType)==null?void 0:A.code)===ze.AADHAR_CARD?h.map(d=>({sectionUid:d.uid??"",fileType:d.fileType??"",sectionType:d.smDocSectionType??"",url:r?m(d.smDocSectionType):d.url})):[]};E(c.applicant.uid),L(h=>h.map((x,d)=>{var j;return d===t?{...x,uid:c.uid??"",docName:((j=c.docType)==null?void 0:j.code)??"",docNo:c.docNo??"",maskedDocNo:c.maskedDocNo??"",docSections:f(c.kycDocuments),dob:c.dob??""}:x})),k(B.PRIMARY),_(w.SAVED),U(!R)}}catch(o){g(v(o))}}},Jt=async(e,t)=>{if(e.uid){const s=await we(e);try{const o=await G.updateKycDocument(s,q.QDE);se(o)&&(t!==void 0&&Oe(t),k(B.QUATERNARY),_(w.REMOVED),U(!R))}catch(o){g(v(o))}}},Xt=async(e,t)=>{const s=Zt(e);try{const o=await G.populateKycDocument(s,q.QDE);if(X(o)){const{data:c}=o;E(c.applicant.uid),L(r=>r.map((f,h)=>{var A;return h===t?{...f,uid:c.uid,docName:((A=c.docType)==null?void 0:A.code)??"",docNo:c.docNo??"",dob:c.dob??""}:f})),le(r=>({...r,uid:c.uid??"",success:!0,failed:!1}))}}catch(o){le(c=>({...c,success:!1,failed:!0})),g(v(o))}},zt=e=>{const{documentUid:t,documentUrl:s,documentNumber:o,dob:c}=e,r=s.map(f=>({loan:{},kyc:{},smDocSectionType:f.code,fileName:f.fileName,fileType:f.contentType,thumbUrl:f.thumbUrl?f.thumbUrl:"",url:f.url,meta:""}));return{loan:{uid:i},applicant:{uid:u||"",applicantType:Z.PRIMARY},docType:{uid:t},dob:c||null,docNo:o,meta:"",kycDocuments:r}},we=async e=>{const{uid:t,documentUid:s,documentUrl:o,documentNumber:c,dob:r,isActive:m}=e,f=await qt(t),h=d=>f.find(ae=>ae.smDocSectionType===d).uid,A=o.map(d=>({uid:h(d.code),loan:{},kyc:{},smDocSectionType:d.code,fileName:d.fileName,fileType:d.contentType,thumbUrl:d.thumbUrl?d.thumbUrl:"",url:d.url,meta:""}));return{uid:t,loan:{uid:i},applicant:{uid:u||"",applicantType:Z.PRIMARY},docType:{uid:s},dob:r||null,docNo:c,meta:"",kycDocuments:A,isActive:m}},Zt=e=>{const{documentUid:t,documentUrl:s}=e,o=s.map(m=>({loan:{},kyc:{},smDocSectionType:m.code,fileName:m.fileName,fileType:m.contentType,thumbUrl:m.thumbUrl?m.thumbUrl:"",url:m.url,meta:""})),c=m=>{const f=s.find(h=>h.isOcrActive&&h.code===m);return f==null?void 0:f.signedUrl};return{uid:ie.uid?ie.uid:"",loan:{uid:i},applicant:{uid:u||"",applicantType:Z.PRIMARY},docType:{uid:t},dob:null,docNo:"0",meta:"",kycDocuments:o,backSignedUrl:c(z.DOCUMENT_SECTIONS_BACK_PAGE)??"",frontSignedUrl:c(z.DOCUMENT_SECTIONS_FRONT_PAGE)??""}},en=async(e,t,s,o)=>{const c=tn(e,t,o);try{const r=await G.validateAadhar(c,q.QDE);if(X(r)){const{data:m}=r;E(m.applicant.uid),ue({...de,verified:!0}),L(f=>f.map((A,x)=>{var d;return x===s?{...A,uid:m.uid??"",docName:((d=m.docType)==null?void 0:d.code)??"",docNo:m.docNo??"",maskedDocNo:m.maskedDocNo??"",dob:m.dob??""}:A}))}}catch(r){ue({...de,failedToVerify:!0}),g(v(r))}},tn=(e,t,s)=>{const{documentUid:o,documentUrl:c,documentNumber:r}=e,{otp:m,requestId:f}=t,h=c.map(x=>({loan:{},kyc:{},smDocSectionType:x.code,fileName:x.fileName,fileType:x.contentType,thumbUrl:x.thumbUrl?x.thumbUrl:"",url:x.url??"",meta:""}));return{uid:s||"",loan:{uid:i},applicant:{uid:u||"",applicantType:Z.PRIMARY},docType:{uid:o},docNo:r,meta:"",kycDocuments:h,otp:m,accessKey:f,aadhaarNo:r,consent:"Y"}},nn=()=>{var e;if((e=N==null?void 0:N.current)==null||e.hideMessages(),N.current.visibleFields=[],Se(I.VIEW),i){vt();return}i===""&&P({...at})},sn=e=>(console.log(e),(e==null?void 0:e.name)===void 0||e.name.length<1?n.jsx("div",{className:"flex flex-col items-center justify-center h-39 pointer-events-none cursor-default",children:n.jsx(T,{className:"text-primary-labelColor mt-2",label:"label.noDataFound"})}):n.jsxs("div",{className:"flex flex-col",children:[n.jsx(T,{className:"text-primary-labelColor",label:`${e==null?void 0:e.fullName} `}),n.jsx(T,{className:"text-secondary-gray-500 text-xxs",label:`${e==null?void 0:e.fullName} `})]})),Ye=e=>(e==null?void 0:e.name)===void 0||(e==null?void 0:e.name.length)<1?n.jsx("div",{className:"flex flex-col items-center justify-center h-39 pointer-events-none cursor-default",children:n.jsx(T,{className:"text-primary-labelColor mt-2",label:"label.noDataFound"})}):n.jsxs("div",{className:"flex flex-col",children:[n.jsx(T,{className:"text-primary-labelColor",label:e==null?void 0:e.name}),n.jsx(T,{className:"text-secondary-gray-500 text-xxs",label:`${e==null?void 0:e.name}`})]}),on=()=>n.jsx(n.Fragment,{children:M.map((e,t)=>n.jsx("div",{className:"",children:n.jsx(Fn,{mode:i?"EDIT":"READ",uid:e.uid,documentListIndex:t,docName:e.docName,docNo:e.docNo,dateOfBirth:e.dob,docSections:e.docSections,maskedDocNo:e.maskedDocNo,removeDocumentInList:Oe,cardNameList:mt,handlerCardNameList:Qt,ocrStatus:ie,onSave:Ht,onRemove:Jt,onPopulate:Xt,onVerifyAadhar:en,aadharVerificationStatus:de,handlerAadharVerificationStatus:()=>{ue({verified:!1,failedToVerify:!1})},placeOfUpload:Kn.LOGIN_QDE})},`document-${e.listId}`))}),an=l.useMemo(()=>D,[Dt]),cn=()=>n.jsx(ve,{title:"heading.kycDocuments.nameContact",pageMode:Me,onSave:Lt,onCancel:Kt,onEdit:()=>{oe(I.CREATE)},onPrePopulate:()=>Ue(re.BASIC_INFO),disabled:!i||!u,children:n.jsx(kn,{pageMode:Me,ref:K,data:At,prePopulated:an,type:"QDE",ocrRelatedData:{ocrStageName:Xe.LOGIN,ocrSubstageName:q.QDE,ocrPayloadData:{loanUid:i,applicant:{uid:u}}}})}),rn=l.useMemo(()=>{const{address:e,city:t,latitude:s,longitude:o,pincode:c,state:r,smAddressType:m}=O.address;return{address:e,city:{name:t==null?void 0:t.name,uid:t==null?void 0:t.uid},pincode:{pinCode:c.pinCode,uid:c==null?void 0:c.uid},state:r,smAddressType:m,latitude:s,longitude:o}},[O]),ln=()=>{var e,t;return n.jsxs(ve,{title:"label.cibilDetails.Address",pageMode:he,onSave:_t,onCancel:kt,onPrePopulate:()=>Ue(re.ADDRESS),disabled:!i||!u,onEdit:()=>{xe(I.CREATE)},children:[n.jsx(Ln,{pageMode:he,ref:W,data:rn,isLatLong:!0}),n.jsxs("div",{className:"flex flex-col gap-3",children:[n.jsx(Ce,{label:"label.text.address.proof*",value:"Attach Documents (PDF, JPG, JPEG or PNG)",titleClass:"text-primary-sideBarBgColor text-sm font-bold mb-1"}),n.jsx(On,{mandatoryDocUpload:!0,ref:C,mode:he===I.CREATE?Ze.EDIT:Ze.VIEW,savedDocument:(e=O==null?void 0:O.loanDocuments)!=null&&e[0]?(t=O==null?void 0:O.loanDocuments)==null?void 0:t[0]:wn,queryParamForDocList:Cn.DOCUMENT_CATEGORY_ADDRESS_PROOF,ocrStageName:Xe.LOGIN,ocrSubstageName:q.QDE,ocrPayloadData:{loanUid:i,applicant:{uid:u}}})]})]})},{loanRequestDetails:{product:$,loanAmount:Fe,loanAmountInWords:dn,loanTenure:Ke,loanTenureInWords:un},sourceAndBranch:{salesAgent:Q,branch:H,salesManager:mn}}=p;return n.jsxs("div",{className:"",children:[n.jsxs("div",{className:"flex flex-row justify-between items-center mb-4 px-5",children:[n.jsx("label",{className:"text-primary-ptext-1000 text-base font-bold",children:"New Application"}),n.jsxs("div",{className:"flex gap-10 ",children:[n.jsx("div",{children:n.jsx(te,{className:"reset-red",buttonType:ee.CANCEL_OUTLINE,onClick:wt})}),n.jsxs("div",{className:"flex gap-5",children:[n.jsx(te,{buttonType:ee.SAVE_OUTLINE,onClickWithLoader:Yt,disabled:!i}),n.jsx(te,{buttonType:ee.SAVE_AND_CONTINUE,onClickWithLoader:Ft,disabled:!i})]})]})]}),n.jsxs("div",{className:"flex flex-col gap-5 pb-3 screen-body-scroll-qde  h-screen",children:[n.jsx(Ee,{title:"heading.sourceDetails",children:n.jsx(ve,{title:"Loan Request Details",pageMode:_e,onEdit:()=>Se(I.CREATE),onSave:()=>Mt(),onCancel:nn,children:n.jsxs(An,{override:{read:_e===I.VIEW},children:[n.jsxs("div",{className:"grid grid-cols-4 gap-3",children:[n.jsx("div",{children:n.jsx(be,{label:"input.sourceDetails.product",name:"product",value:$==null?void 0:$.name,className:"rounded-r",variant:J.PRIMARY,suggestions:fe,completeMethod:Gt,onChange:jt,itemTemplate:Ye,onBlur:V,validation:(We=N==null?void 0:N.current)==null?void 0:We.message("product",$==null?void 0:$.uid,"mandatory"),emptyMessage:"no data",dropdown:!1})}),n.jsx("div",{children:n.jsx(Ie,{label:"input.sourceDetails.loanAmount",name:"loanAmount",variant:J.SECONDARY,onChange:Rt,onBlur:V,value:Fe,className:"text-right",validation:(qe=N==null?void 0:N.current)==null?void 0:qe.message("loanAmount",ge(Fe),"mandatory|onlyInteger|min:100000,num|max:50000000,num")})}),n.jsx("div",{className:"col-span-2",children:n.jsx(Ce,{label:"input.sourceDetails.loanAmountWords",value:dn})})]}),n.jsxs("div",{className:"grid grid-cols-4 gap-3",children:[n.jsx("div",{children:n.jsx(Ie,{label:"input.sourceDetails.loanTenure",name:"loanTenure",variant:J.SECONDARY,onChange:Pt,onBlur:V,value:Ke,className:"text-right",validation:(Ge=N==null?void 0:N.current)==null?void 0:Ge.message("loanTenure",Ke,"mandatory|checkNumber|onlyInteger|min:12,num|max:360,num")})}),n.jsx("div",{children:n.jsx(Ce,{label:"input.sourceDetails.loanTenureWords",value:un})})]}),n.jsxs("div",{className:"flex flex-col gap-4",children:[n.jsx(T,{label:"Source & Branch",className:"text-primary-sideBarBgColor text-sm font-bold mb-1"}),n.jsxs("div",{className:"grid grid-cols-4 gap-3",children:[n.jsx("div",{children:n.jsx(be,{label:"input.sourceDetails.branch",name:"branch",variant:J.PRIMARY,onBlur:V,suggestions:fe,completeMethod:$t,onChange:Ae,itemTemplate:Ye,value:H==null?void 0:H.name,validation:(Ve=N==null?void 0:N.current)==null?void 0:Ve.message("branch",H==null?void 0:H.uid,"mandatory")})}),n.jsx("div",{children:n.jsx(be,{label:"input.sourceDetails.salesAgent",name:"salesAgent",variant:J.PRIMARY,onBlur:V,value:Q==null?void 0:Q.fullName,suggestions:fe,completeMethod:Vt,onChange:Ae,itemTemplate:sn,validation:($e=N==null?void 0:N.current)==null?void 0:$e.message("salesAgent",Q==null?void 0:Q.uid,"mandatory")})}),n.jsx("div",{children:n.jsx(Ie,{label:"input.sourceDetails.salesManager",name:"salesManager",variant:J.SECONDARY,onChange:Ae,onBlur:V,value:mn.name,disabled:!0})}),n.jsx("div",{})]})]})]})})}),n.jsx(Ee,{title:"KYC Documents",alertText:"Either PAN or Form - 60 are mandatory",children:n.jsxs(ct.Fragment,{children:[n.jsx("div",{className:"grid grid-cols-2 gap-5",children:on()}),n.jsx("div",{className:"p-5 w-full rounded-xl bg-slate-100 ",children:n.jsx(te,{buttonType:ee.ICON_TEXT_ROW,customLabel:"Add Another Document",onClick:Ut})})]})}),n.jsx(Ee,{title:"heading.basicInformation",children:n.jsxs(n.Fragment,{children:[cn(),ln()]})}),ft?n.jsx("div",{className:"w-full flex justify-center items-center bg-white p-5",children:n.jsx(Xn,{score:750,label:"label.dde.crifHighmarks"})}):n.jsx("div",{className:"w-1/4",children:n.jsx(Dn,{label:"Request Highmark Score",variant:gn.PRIMARY,onClickWithLoader:Ot})})]}),n.jsx("div",{className:"",children:n.jsx(Wn,{position:ht,ref:F,toastText:pe,variant:Re,onRemove:()=>{if(St){const e=Te;a.navigate(e)}}})}),n.jsx(Jn,{visible:b,title:"label.loan.cancelCreation",description:"description.loan.cancelCreation",confirmActionTitle:"Sure",closeActionTitle:"Not Sure",onConfirm:Wt,onClose:()=>S(!1)}),n.jsx(Yn,{onHide:()=>{Pe(!1),g("")},visible:xt,errorMessage:me})]})},ao=hn(ss);export{ao as default};
//# sourceMappingURL=PageQDE-192910e0.js.map
