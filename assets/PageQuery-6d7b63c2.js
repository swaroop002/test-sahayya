import{q as pe,r as d,ad as q,ae as E,af as C,j as s,T as m,f as h,J as P,aG as ue,fp as U,aH as ye,ao as he,a8 as c,d$ as i,fq as _}from"./index-e8217573.js";import{B as L}from"./ButtonBox-9e46519a.js";import{D as je}from"./Dialog-adadaf64.js";import{I as F,B as M}from"./IconButton-36693dd9.js";import{I as $}from"./InputTextArea-b90aad1d.js";import{R as Ne}from"./ReadOnlyTable-86accb69.js";import{C as x}from"./column.esm-938bad7d.js";import{C as H}from"./CreditQueryService-75543be7.js";import{T as be}from"./Toast-ae99ea5b.js";import{E as ge}from"./ErrorDialog-d5eef4d7.js";import"./kebab-menu-8835ad2e.js";import"./sortIcon-54357a29.js";import"./Download_Icon-51fc7f46.js";import"./eye_icon-081bddb3.js";import"./withAuth-6de36ebf.js";import"./No_data-1720c54e.js";import"./SimpleDropDown-061a3470.js";import"./virtualscroller.esm-9939945c.js";import"./datatable.esm-f474a654.js";import"./paginator.esm-11c2c115.js";import"./TransitionGroup-c8afe0ce.js";const ve={uid:"",stage:"",query:"",raisedOn:"",raisedBy:"",updatedOn:"",updatedBy:"",status:"",action:"",reply:""},S={IN_PRINCIPAL_APPROVAL:"In Principal Approval",FINANCIAL_APPROVAL:"Financial Approval",FINAL_APPROVAL:"Final Approval",CAM_AND_RECOMMENDATION:"CAM and Recommendation"},p={IN_PROGRESS:"In Progress",CLOSED:"Closed"},fe=()=>{var R;const D=pe(),[Q,j]=d.useState(!1),[a,N]=d.useState({...ve}),[b,T]=d.useState(""),[A,Y]=d.useState(!1),[g,o]=d.useState(""),[f,O]=d.useState(!1),[,u]=d.useState(!1),y=d.useRef(null),n=d.useRef(null),l=d.useRef(new q({validators:{...E()},...C(),autoForceUpdate:{forceUpdate:()=>u(e=>!e)}}));d.useEffect(()=>{a.uid&&j(!0)},[a]),d.useEffect(()=>{var e;n!=null&&n.current&&b!==""&&((e=n==null?void 0:n.current)==null||e.showFunction(),T(""))},[b,A]),d.useEffect(()=>{g&&O(!0)},[g]);const k=e=>{var t,r;(r=l==null?void 0:l.current)==null||r.showMessageFor((t=e==null?void 0:e.target)==null?void 0:t.name)},V=()=>{var t,r;let e=!1;return e=(t=l==null?void 0:l.current)==null?void 0:t.allValid(),e||(u(v=>!v),(r=l==null?void 0:l.current)==null||r.showMessages(),u(v=>!v),!1)},z=e=>{N(t=>({...t,reply:e.target.value}))},G=e=>{var r;const t={uid:(e==null?void 0:e.uid)??null,stage:((r=e==null?void 0:e.stage)==null?void 0:r.stageName)??"",query:(e==null?void 0:e.queryMessage)??"",raisedOn:(e==null?void 0:e.createdAt)??new Date().toISOString(),raisedBy:(e==null?void 0:e.createdByUserName)??"",updatedOn:(e==null?void 0:e.updatedAt)??new Date().toISOString(),updatedBy:(e==null?void 0:e.updatedByUserName)??"",status:p[`${e==null?void 0:e.status}`]??"",reply:(e==null?void 0:e.queryResponse)??"",action:""};N(t)},W=e=>{var r;const t={uid:(e==null?void 0:e.uid)??null,stage:((r=e==null?void 0:e.stage)==null?void 0:r.stageName)??"",query:(e==null?void 0:e.queryMessage)??"",raisedOn:(e==null?void 0:e.createdAt)??new Date().toISOString(),raisedBy:(e==null?void 0:e.createdByUserName)??"",updatedOn:(e==null?void 0:e.updatedAt)??new Date().toISOString(),updatedBy:(e==null?void 0:e.updatedByUserName)??"",status:p[`${e==null?void 0:e.status}`]??"",reply:"",action:""};N(t)},J=()=>{j(!1),B()},K=async()=>{var t;if(!V())return;const e={uid:a.uid,status:U.CLOSED,queryResponse:a.reply};try{const r=await H.updateQueryResponse(e);(t=y==null?void 0:y.current)==null||t.search(),B(),T(ye.SAVED),Y(!A),j(!1)}catch(r){console.log(r),o(he(r))}},B=()=>{var e;l.current=new q({validators:{...E()},...C(),autoForceUpdate:{forceUpdate:()=>u(t=>!t)}}),(e=l==null?void 0:l.current)==null||e.hideMessages()},X=()=>s.jsx("div",{className:"flex",children:s.jsx(c,{label:`${i.t("label.cq.stage")}`,className:"mr-1"})}),Z=e=>{var t;return s.jsx(s.Fragment,{children:s.jsx("div",{className:"text-primary-ptext-1000 text-xs text-left w-30",children:(S==null?void 0:S[(t=e.stage)==null?void 0:t.stageName])??""})})},I=()=>s.jsx("div",{className:"flex",children:s.jsx(c,{label:`${i.t("label.cq.query")}`,className:"mr-1"})}),w=e=>s.jsx("div",{className:"text-primary-ptext-1000 text-xs text-left truncate w-40",title:_(e.queryMessage),children:_(e.queryMessage)}),ee=()=>s.jsx("div",{className:"flex",children:s.jsx(c,{label:`${i.t("label.cq.raisedOn")}`,className:"mr-1"})}),se=e=>s.jsx(s.Fragment,{children:s.jsx("div",{className:"text-primary-ptext-1000 text-xs text-left w-30",children:h(e==null?void 0:e.createdAt)})}),te=()=>s.jsx("div",{className:"flex",children:s.jsx(c,{label:`${i.t("label.cq.raisedBy")}`,className:"mr-1"})}),ae=e=>s.jsx(s.Fragment,{children:s.jsx("div",{className:"text-primary-ptext-1000 text-xs text-left w-30",children:e.createdByUserName})}),le=()=>s.jsx("div",{className:"flex",children:s.jsx(c,{label:`${i.t("label.cq.respondedOn")}`,className:"mr-1"})}),re=e=>s.jsx(s.Fragment,{children:s.jsx("div",{className:"text-primary-ptext-1000 text-xs text-left w-30",children:h(e.updatedAt)})}),de=()=>s.jsx("div",{className:"flex",children:s.jsx(c,{label:`${i.t("label.cq.respondedBy")}`,className:"mr-1"})}),ce=e=>s.jsx(s.Fragment,{children:s.jsx("div",{className:"text-primary-ptext-1000 text-xs text-left w-30",children:e.updatedByUserName})}),ie=()=>s.jsx("div",{className:"flex",children:s.jsx(c,{label:`${i.t("label.cq.status")}`,className:"mr-1"})}),xe=e=>s.jsx(s.Fragment,{children:s.jsx("div",{className:"text-primary-ptext-1000 text-xs text-left w-30",children:p[`${e==null?void 0:e.status}`]??""})}),ne=()=>(console.log("header aciton called"),s.jsx("div",{className:"flex",children:s.jsx(c,{label:`${i.t("label.cq.action")}`,className:"mr-1"})})),me=e=>s.jsx(s.Fragment,{children:s.jsx("div",{className:"flex justify-center items-center text-primary-ptext-1000 text-xs cursor-pointer",children:e.status===U.CLOSED?s.jsx(F,{className:"select-none",buttonType:M.VIEW,onClick:()=>{G(e)}}):s.jsx(F,{className:"select-none",buttonType:M.REPLY,onClick:()=>W(e)})})});return s.jsxs("div",{className:"flex flex-col",children:[s.jsxs("div",{className:"bg-white rounded-xl pt-6 px-7 pb-7",children:[s.jsx("div",{className:"mb-4 flex",children:s.jsx(m,{className:"text-xl font-bold text-primary-ptext-1000",label:"label.cam.recommendation.query"})}),s.jsx("div",{children:s.jsxs(Ne,{standardDataFormatPromise:H.getAll,dataKey:"uid",search:`&loan.uid=${D.loanUid}&isActive=${!0}`,ref:y,style:{width:"100%"},children:[s.jsx(x,{className:"text-primary-ptext-1000 text-left text-xs  p-1 h-12 pl-6",header:X,body:Z}),s.jsx(x,{className:"text-primary-ptext-1000 text-left text-xs  p-1 h-12 pl-6 min-w-80",header:I,body:w}),s.jsx(x,{className:"text-primary-ptext-1000 text-left text-xs  p-1 h-12 pl-6",header:ee,body:se}),s.jsx(x,{className:"text-primary-ptext-1000 text-left text-xs w-1/12  p-1 h-12 pl-6",header:te,body:ae}),s.jsx(x,{className:"text-primary-ptext-1000 text-left text-xs  p-1 h-12 pl-6",header:le,body:re}),s.jsx(x,{className:"text-primary-ptext-1000 text-left text-xs  p-1 h-12 pl-6",header:de,body:ce}),s.jsx(x,{className:"text-primary-ptext-1000 text-left text-xs  p-1 h-12 pl-6",header:ie,body:xe}),s.jsx(x,{className:"text-primary-ptext-1000 text-left text-xs  p-1 h-12 pl-6",header:ne,body:me})]})})]}),s.jsx(je,{className:"min-w-[780px] !p-0",visible:Q,closable:!1,children:s.jsxs("div",{className:"p-6",children:[s.jsxs("div",{className:"mb-6 flex justify-between",children:[s.jsxs("div",{className:"flex flex-col gap-2.5",children:[s.jsx("div",{className:"text-base font-bold text-primary-primaryTextColor",children:s.jsx(m,{label:"label.cq.responseToQuery"})}),s.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[s.jsxs("div",{children:[s.jsx("span",{className:"font-medium",children:s.jsx(m,{label:"label.cq.raisedOn"})}),s.jsx("span",{className:"ml-2",children:h(a.raisedOn)})]}),s.jsxs("div",{children:[s.jsx("span",{className:"font-medium",children:s.jsx(m,{label:"label.cq.raisedBy"})}),s.jsx("span",{className:"ml-2",children:a.raisedBy})]})]})]}),s.jsxs("div",{className:"self-start flex items-center gap-5 text-xs text-primary-ptext-1000",children:[s.jsx("div",{children:s.jsx(L,{buttonType:P.CANCEL_OUTLINE,onClick:J})}),a.status===p.IN_PROGRESS&&s.jsx("div",{children:s.jsx(L,{className:"",buttonType:P.SUBMIT_OUTLINE,onClickWithLoader:K})})]})]}),s.jsxs("div",{className:"flex flex-col",children:[s.jsx("div",{className:"h-40",children:s.jsx($,{name:"query",label:"label.cq.query",value:a==null?void 0:a.query,autoResize:!0,maxCount:200,disabled:!0})}),a.status==="completed"&&s.jsxs("div",{className:"mb-3 flex items-center gap-2 text-xs",children:[s.jsxs("div",{children:[s.jsx("span",{className:"font-medium",children:s.jsx(m,{label:"label.cq.updatedOn"})}),s.jsx("span",{className:"ml-2",children:h(a.updatedOn)})]}),s.jsxs("div",{children:[s.jsx("span",{className:"font-medium",children:s.jsx(m,{label:"label.cq.updatedBy"})}),s.jsx("span",{className:"ml-2",children:a.updatedBy})]})]}),s.jsx("div",{className:"h-40",children:s.jsx($,{name:"reply",label:"label.cq.reply",onBlur:k,validation:(R=l==null?void 0:l.current)==null?void 0:R.message("reply",a.reply,"mandatory"),value:a.reply,maxCount:200,onChange:z,autoResize:!0,disabled:a.status===p.CLOSED})})]})]})}),s.jsx(be,{position:"bottom-right",ref:n,toastText:b,variant:ue.PRIMARY}),s.jsx(ge,{onHide:()=>{O(!1),o("")},visible:f,errorMessage:g})]})};export{fe as default};
//# sourceMappingURL=PageQuery-6d7b63c2.js.map
