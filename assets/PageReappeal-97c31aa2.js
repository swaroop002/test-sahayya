import{w as ue,r as i,q as fe,g as je,v as Ne,j as e,T as m,J as p,o as V,c8 as ge,bh as F,f as ve,i as J,cZ as Y}from"./index-e8217573.js";import{c as he,M as be,C as Re}from"./MainMessageBody-e15b4437.js";import{B as x}from"./ButtonBox-9e46519a.js";import{D as ye,a as Ae}from"./DocumentUploader-e2ec1a13.js";import{I as v}from"./InputBox-b9e88f52.js";import{I as $}from"./InputTextArea-b90aad1d.js";import{S as we}from"./SimpleDropDown-061a3470.js";import{S as Se}from"./SimpleOverlayPanel-f23b2f6a.js";import{T as Te}from"./TextButton-41b4a67e.js";import{s as De}from"./Helper-03e9d878.js";import{D as w}from"./Dialog-adadaf64.js";import{S as u}from"./StageService-c1c03c89.js";import{S as Ee}from"./StaticMasterDataService-689a6eca.js";import{u as Oe}from"./useSelector-dc41929a.js";import"./Skeleton-7e12d019.js";import"./kebab-menu-8835ad2e.js";import"./loader-5f2cfb31.js";import"./AutoComplete-0bca608a.js";import"./search_icon-459d6871.js";import"./withAuth-6de36ebf.js";import"./virtualscroller.esm-9939945c.js";import"./DatePicker-b1c13861.js";import"./ErrorDialog-d5eef4d7.js";import"./FileUploadCustom-5ab7fd25.js";import"./Loading-783a01c7.js";import"./MediaGallery-5884b284.js";import"./Download_Icon-51fc7f46.js";import"./index-8739acfd.js";import"./FileUploadService-1aaf11f7.js";import"./FileUploadMenuBox-f47dc693.js";import"./MenuBox-defc36b0.js";import"./Toast-ae99ea5b.js";import"./TransitionGroup-c8afe0ce.js";import"./IconButton-36693dd9.js";import"./sortIcon-54357a29.js";import"./eye_icon-081bddb3.js";import"./DocumentService-a293b5f4.js";const G="/assets/notificationOnTop-5727a5fa.svg",S={INITIATED:"Initiated",COMPLETED:"Completed",CANCELLED:"Cancelled",RE_OPEN:"Re-open",IN_REVIEW:"In Review",PAUSED:"Paused",REJECTED:"Rejected",APPROVED:"Approved"},Ce=T=>{var _,L;const D=Oe(t=>t.UserProfileReducers.profileObj),[R,E]=i.useState(!1),W={reasonToReject:"",rejectRemark:"",remarks:"",savedDocuments:[],stageStatus:"",updatedByUserName:"",datForApprove:{}},y=i.useRef(null),[r,q]=i.useState({...W}),o=fe(),[z,K]=i.useState(!1),[O,A]=i.useState(!1),[C,h]=i.useState(!1),[d,I]=i.useState(""),[Z,H]=i.useState([]),Q=i.useRef(null),[b,X]=i.useState({assignedTo:"",delegateTo:"",initiation:"",status:""});i.useEffect(()=>{ee(),te()},[]);const ee=async()=>{var t,a,l,c,n,f,j,N,g,k,M,B;try{const s=await u.getReappealDetails(o==null?void 0:o.stageUid);console.log(s,"check"),q({reasonToReject:(a=(t=s==null?void 0:s.data)==null?void 0:t.loan)==null?void 0:a.reasonToReject,rejectRemark:(c=(l=s==null?void 0:s.data)==null?void 0:l.loan)==null?void 0:c.rejectRemark,remarks:(f=(n=s==null?void 0:s.data)==null?void 0:n.stage)==null?void 0:f.remarks,savedDocuments:De((j=s==null?void 0:s.data)==null?void 0:j.stage.loanDocuments),stageStatus:(g=(N=s==null?void 0:s.data)==null?void 0:N.stage)==null?void 0:g.status,updatedByUserName:(M=(k=s==null?void 0:s.data)==null?void 0:k.stage)==null?void 0:M.updatedByUserName,datForApprove:((B=s==null?void 0:s.data)==null?void 0:B.stage)??{}})}catch(s){console.log(s)}};i.useEffect(()=>{je("VITE_MESSAGE_CONVERSATION_TIMING");const t=async()=>{try{const l=await Re.checkNewMessageAvailability((o==null?void 0:o.stageUid)??"");K(l==null?void 0:l.data)}catch(l){console.log(l)}};t();const a=setInterval(t,1e6);return()=>{clearInterval(a)}},[]);const P=t=>{E(!R)},te=async()=>{Ee.getAll(0,1e3,"staticMasterType.code=LOAN_REJECTION_REASON&").then(t=>{var a,l;if(Ne(t)){const c=(l=(a=t==null?void 0:t.data)==null?void 0:a.results)==null?void 0:l.map(n=>({name:(n==null?void 0:n.name)??"",code:(n==null?void 0:n.code)??""}));H(c!=null&&c.length?c:[])}}).catch(t=>{console.log(t)})};function U(t){for(const a of t)if(a.stage&&typeof a.stage=="object"&&a.stage.stageName!=="LOGIN")return a.stage;return t[0].stage}const ae=()=>({uid:o.stageUid??"",status:S.REJECTED}),se=async()=>{var t;try{const a=await u.getReapealInitiationStage(`&loan.uid=${o.loanUid}`);console.log((t=a==null?void 0:a.data)==null?void 0:t.results,"for the api which has the stage ");const l=U(a.data.results);console.log(l),I(l)}catch(a){console.log(a)}h(!0)},le=()=>{h(!1)},oe=async()=>{const t=ae();try{const a=await u.acceptOrRejectReappealLoan("",t);console.log(a),T.navigate(`${J}/${Y}/${o.loanUid}`)}catch(a){console.log(a)}h(!0)},ne=async()=>{var t;try{const a=await u.getReapealInitiationStage(`&loan.uid=${o.loanUid}`);console.log((t=a==null?void 0:a.data)==null?void 0:t.results);const l=U(a.data.results);console.log(l),I(l)}catch(a){console.log(a)}A(!0)},ie=()=>{h(!1),A(!1)},ce=()=>{const t=r.datForApprove;return delete t.laonDocuments,delete t.stageDocuments,t.status=S.APPROVED,t},re=async()=>{const t=ce();try{const a=await u.acceptOrRejectReappealLoan("",t);console.log(a);const l=await u.initiateStageReapeal({status:S.RE_OPEN,uid:`${d.uid}`,stageInitiation:null});T.navigate(`${J}/${Y}/${o.loanUid}`)}catch(a){console.log(a)}A(!1)},me=t=>{var l,c,n,f,j,N,g;const a=localStorage.getItem("stageDetail");X({assignedTo:((c=(l=JSON.parse(a))==null?void 0:l.assignee)==null?void 0:c.name)??"NA",delegateTo:((f=(n=JSON.parse(a))==null?void 0:n.delegate)==null?void 0:f.name)??"NA",initiation:((j=JSON.parse(a))==null?void 0:j.createdAtSystemDate)??"NA",status:((N=JSON.parse(a))==null?void 0:N.status)??"NA"}),y.current&&((g=y.current)==null||g.toggle(t))},de=t=>e.jsx(w,{className:"w-84",visible:O,closable:!1,children:e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsx("div",{className:"m-auto",children:e.jsx("img",{src:G,alt:"notificationIcon"})}),e.jsx("div",{className:"m-auto text-center",children:e.jsx(m,{className:"text-xl  font-bold text-primary-ptext-1000 w-fit  ",label:"Approve Re-appeal of Loan Application "})}),e.jsx("div",{className:" m-auto w-48 mt-3 text-center text-xs",children:e.jsx(m,{label:"Are you sure want to re-open this loan application for further process",className:"font-normal text-xs"})}),e.jsxs("div",{className:"mt-3",children:[e.jsx(v,{label:"Re-Appeal Approved By",labelClassNames:"font-normal",className:"h-6",value:t.fullName===""?t.name:t.fullName}),e.jsx(v,{label:"Re-Open Stage",labelClassNames:"font-normal",value:d==null?void 0:d.stageName})]}),e.jsx("div",{className:"flex    margin-auto",children:e.jsxs("div",{className:" m-auto w-24 flex gap-3",children:[e.jsx(x,{className:" ",buttonType:p.NO,onClick:ie}),e.jsx(x,{className:"",buttonType:p.YES,color:F.red,onClickWithLoader:re,buttonIconClassName:"w-9 h-9  border-4  border-yellow-500"})]})})]})}),pe=t=>e.jsx(w,{className:"w-84",visible:C,closable:!1,children:e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsx("div",{className:"m-auto",children:e.jsx("img",{src:G,alt:"notificationIcon"})}),e.jsx("div",{className:"m-auto text-center",children:e.jsx(m,{className:"text-xl  font-bold text-primary-ptext-1000 w-fit  ",label:"Reject Re-appeal of Loan Application "})}),e.jsx("div",{className:" m-auto w-48 mt-3 text-center text-xs",children:e.jsx(m,{label:"Are you sure want to reject this loan application for further process",className:"font-normal text-xs"})}),e.jsxs("div",{className:"mt-3",children:[e.jsx(v,{label:"Re-Appeal Rejected By",labelClassNames:"font-normal",className:"h-6",value:t.fullName===""?t.name:t.fullName}),e.jsx(v,{label:"Re-Open Stage",labelClassNames:"font-normal",value:d==null?void 0:d.stageName})]}),e.jsx("div",{className:"flex    margin-auto",children:e.jsxs("div",{className:" m-auto w-24 flex gap-3",children:[e.jsx(x,{className:" ",buttonType:p.NO,onClick:le}),e.jsx(x,{className:"",buttonType:p.YES,color:F.red,onClickWithLoader:oe,buttonIconClassName:"  border-4  border-yellow-500"})]})})]})}),xe=()=>e.jsxs("div",{className:"flex flex-col gap-4 p-5 ",children:[e.jsxs("div",{className:"flex flex-row justify-between items-center",children:[e.jsx("div",{className:"text-sm text-secondary-stext-900",children:"Status :"}),e.jsx("div",{className:"text-sm text-secondary-stext-900  font-bold ml-2",children:b.status})]}),e.jsxs("div",{className:"flex flex-row justify-between items-center",children:[e.jsx("div",{className:"text-sm text-secondary-stext-900",children:"Assigned to :"}),e.jsx("div",{className:"text-sm text-secondary-stext-900  font-bold ml-2",children:b.assignedTo})]}),e.jsxs("div",{className:"flex flex-row justify-between items-center",children:[e.jsx("div",{className:"text-sm text-secondary-stext-900",children:"Delegated to :"}),e.jsx("div",{className:"text-sm text-secondary-stext-900  font-bold ml-2",children:b.delegateTo})]}),e.jsxs("div",{className:"flex flex-row justify-between items-center",children:[e.jsx("div",{className:"text-sm text-secondary-stext-900",children:"Date of Initiation :"}),e.jsx("div",{className:"text-sm text-secondary-stext-900  font-bold ml-2",children:ve(b.initiation)})]})]});return e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("div",{className:"flex justify-between items-center flex-wrap ",children:[e.jsxs("div",{className:"w-full flex gap-3  py-2 px-5 items-center justify-between sm:justify-normal sm:w-fit",children:[e.jsx(m,{className:"text-primary-ptext-1000 font-bold",label:"Reappeal"}),e.jsx(Te,{className:"underline text-xs  !text-black  ",label:"View Details",onClick:me})," ",e.jsxs("button",{onClick:P,className:" relative",children:[e.jsx("img",{src:he,alt:"ChatIcon",className:""})," ",z?e.jsx("div",{className:"absolute top-0 right-0 w-2 h-2 bg-red-500 rounded-full"}):e.jsx(e.Fragment,{})]})]}),e.jsxs("div",{className:"w-full my-2 px-5 flex items-center justify-end gap-5 text-xs text-primary-ptext-1000 sm:w-fit sm:justify-normal sm:my-0",children:[e.jsx(x,{className:"",size:"LOAN_DATA",buttonType:p.REJECT_APPLICATION,onClick:se}),e.jsx(x,{className:"",size:"LOAN_DATA",buttonType:p.APPROVE,onClick:ne})]})]}),e.jsxs("div",{className:"flex flex-col gap-5 dde-layout-body-content",children:[e.jsxs("div",{className:"bg-white p-5 flex flex-col rounded-xl gap-2 ",children:[e.jsx("div",{className:"flex items-center justify-between ",children:e.jsx("div",{children:e.jsx(m,{className:"text-xl font-bold text-primary-ptext-1000",label:"Reappeal"})})}),e.jsxs("div",{className:" py-6.5  w-122.5",children:[e.jsx(m,{label:"Reject Condition",className:"font-bold"}),e.jsxs("div",{className:" flex flex-col justify-between  mt-5.5",children:[e.jsx("div",{children:e.jsx("div",{className:"",children:e.jsx(we,{placeholder:"Select",label:"Reason to Reject*",options:Z,optionLabel:"name",optionValue:"code",value:r.reasonToReject,disabled:!0})})}),e.jsx("div",{children:e.jsx("div",{className:"col-span-2 md:col-span-2 lg:col-span-2 ",children:e.jsx($,{label:"Description",name:"description",variant:V.SECONDARY,hideMaxCount:!0,value:r.rejectRemark,disabled:!0})})})]})]})]}),e.jsxs("div",{className:"bg-white p-5 flex flex-col rounded-xl gap-2 ",children:[e.jsx("div",{className:"flex items-center justify-between ",children:e.jsx("div",{children:e.jsx(m,{className:"text-xl font-bold text-primary-ptext-1000",label:"Reappeal Condition"})})}),e.jsx("div",{className:" ",children:e.jsx($,{name:"description",variant:V.SECONDARY,maxCount:200,value:r.remarks,disabled:!0})}),e.jsx("div",{className:"",children:e.jsx(ye,{ref:Q,savedDocument:(_=r.savedDocuments)!=null&&_[0]?(L=r.savedDocuments)==null?void 0:L[0]:{},mode:Ae.VIEW,queryParamForDocList:ge.DOCUMENT_CATEGORY_REAPPEAL_DOCUMENTS,docUploadTypeTitle:"PDF/JPG/Excel/ZIP"})})]}),e.jsx("div",{className:"w-62.5 px-5",children:e.jsx(v,{label:"Approved/Rejected By",disabled:!0,value:r.stageStatus!=="Initiated"?r.updatedByUserName:""})}),R?e.jsx(w,{visible:R,closable:!1,model:"false",onHide:()=>E(!1),className:"rounded-lg shadow-lg !w-240 bg-blend-darken !p-0 !h-162",children:e.jsx(be,{params:o,handleCloseOverLay:P})}):null,O&&de(D),C&&pe(D),e.jsx(Se,{className:"rounded-lg shadow-lg !w-80 p-1.5 ",ref:y,content:xe()})]})]})},ft=ue(Ce);export{ft as default};
//# sourceMappingURL=PageReappeal-97c31aa2.js.map
