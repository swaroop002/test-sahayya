import{r as s,aF as S,ad as te,ae as se,af as ne,aH as ue,ao as J,j as e,ax as re,o as K,aG as fe,R as Ee,J as ze,d$ as ye,T as xe,aA as Re,fh as _e,fd as lt,cn as Ke,a7 as ct,aa as dt,fi as be,q as Xe,c8 as ut,S as ft,dl as Ue,v as ae}from"./index-e8217573.js";import{E as le}from"./ErrorDialog-d5eef4d7.js";import{I as pt}from"./Info-6f3aa97c.js";import{i as gt,S as je}from"./Section-00ef9f2b.js";import{S as de}from"./StaticMasterDataService-689a6eca.js";import{L as oe}from"./LegalService-c6087928.js";import{S as Ce}from"./StageService-c1c03c89.js";import{u as Pe,a as mt,b as ht,c as yt,d as xt,e as vt,f as Et,g as Tt,h as St,i as It,j as Ot,k as Rt}from"./Helper-fa7c957e.js";import{S as pe}from"./SaveComponent-160c5b32.js";import{I as ve}from"./InputTextArea-b90aad1d.js";import{T as ge}from"./Toast-ae99ea5b.js";import{S as he}from"./Skeleton-7e12d019.js";import{I as ie}from"./InputBox-b9e88f52.js";import{S as me}from"./SimpleDropDown-061a3470.js";import{E as Ge,C as ee}from"./EditableTableV2-6afcb42b.js";import{I as qe,B as Qe}from"./IconButton-36693dd9.js";import{S as bt}from"./SimpleToolTip-3cfbb0c5.js";import{C as We}from"./CheckBox-8a0c0e77.js";import{B as Je}from"./ButtonBox-9e46519a.js";import{S as Ne}from"./SystemDatePicker-abe08a29.js";import{a as Ct,i as Pt}from"./FinalOpinion-c6d0ce35.js";import{A as Ze}from"./Address-75e58af3.js";import{A as He}from"./AutoComplete-0bca608a.js";import{i as Nt,M as Ut}from"./MediaGallery-5884b284.js";import{R as we}from"./ReadOnlyTable-86accb69.js";import{C as jt}from"./BaseChips-c7cc0dee.js";import{a as At}from"./CustomHooks-0ce50620.js";import{R as De}from"./RadioButton-86c37166.js";import{R as Lt}from"./RichTextEditor-a03bd2fb.js";import{D as Mt,a as $e}from"./DocumentUploader-e2ec1a13.js";import{p as Bt,a as Yt}from"./Helper-03e9d878.js";import{u as Ft}from"./useSelector-dc41929a.js";import"./Dialog-adadaf64.js";import"./link-0172a3d4.js";import"./loader-5f2cfb31.js";import"./FileUploadMenuBox-f47dc693.js";import"./kebab-menu-8835ad2e.js";import"./MenuBox-defc36b0.js";import"./withAuth-6de36ebf.js";import"./TransitionGroup-c8afe0ce.js";import"./virtualscroller.esm-9939945c.js";import"./datatable.esm-f474a654.js";import"./paginator.esm-11c2c115.js";import"./sortIcon-54357a29.js";import"./Download_Icon-51fc7f46.js";import"./eye_icon-081bddb3.js";import"./DatePicker-b1c13861.js";import"./esm-70d64670.js";import"./index-8739acfd.js";import"./TextButton-41b4a67e.js";import"./City-7102c574.js";import"./Pincode-a7c9b067.js";import"./search_icon-459d6871.js";import"./FileUploadService-1aaf11f7.js";import"./No_data-1720c54e.js";import"./FileUploadCustom-5ab7fd25.js";import"./Loading-783a01c7.js";import"./DocumentService-a293b5f4.js";const et={legalUid:"",eastBy:"",westBy:"",northBy:"",southBy:""},_t=s.forwardRef((D,q)=>{var N,E,a,v;const{data:c,getDetailsCallback:U,isLoadingInitial:u,isLoading:n}=D,[l,T]=s.useState({...et}),[b,C]=s.useState(S.VIEW),[M,F]=s.useState(""),[_,$]=s.useState(!1),[W,j]=s.useState(""),[P,A]=s.useState(!1),h=s.useRef(null),[,y]=s.useState(!1),p=s.useRef(new te({validators:{...se()},...ne(),autoForceUpdate:{forceUpdate:()=>y(x=>!x)}}));s.useImperativeHandle(q,()=>({save:z,onCancel:R})),s.useEffect(()=>{c!=null&&c.legalUid&&T(x=>({...x,...c}))},[c]),s.useEffect(()=>{var x;h!=null&&h.current&&M!==""&&((x=h==null?void 0:h.current)==null||x.showFunction(),F(""))},[M,_]),s.useEffect(()=>{W&&A(!0)},[W]);const f=x=>{T(Y=>({...Y,[x.target.name]:x.target.value}))},B=x=>{var Y,o;(o=p==null?void 0:p.current)==null||o.showMessageFor((Y=x==null?void 0:x.target)==null?void 0:Y.name)},H=()=>{var Y,o;let x=!1;return x=((Y=p==null?void 0:p.current)==null?void 0:Y.allValid())??!1,x||(y(t=>!t),(o=p==null?void 0:p.current)==null||o.showMessages(),y(t=>!t),!1)},z=async()=>{if(console.log("save"),!H())return;const x=V();try{const Y=await oe.updateBoundaryDetails(x);F(ue.SAVED),$(!_),C(S.VIEW),U==null||U()}catch(Y){j(J(Y))}},k=()=>C(S.EDIT),R=()=>{C(S.VIEW),X(),U==null||U()},V=()=>({uid:l==null?void 0:l.legalUid,eastBy:l==null?void 0:l.eastBy,westBy:l==null?void 0:l.westBy,northBy:l==null?void 0:l.northBy,southBy:l==null?void 0:l.southBy}),X=()=>{var x;p.current=new te({validators:{...se()},...ne(),autoForceUpdate:{forceUpdate:()=>y(Y=>!Y)}}),(x=p==null?void 0:p.current)==null||x.hideMessages()},{eastBy:i,westBy:r,northBy:O,southBy:d}=l;return e.jsxs("div",{children:[e.jsx(pe,{title:"label.legal.boundaryDetails",pageMode:b,disabled:n,onSave:z,onCancel:R,onEdit:k,children:u?e.jsx(he,{height:"19.375rem",width:"100%",borderRadius:"8px",animation:"wave"}):e.jsx(re,{override:{read:b===S.VIEW},children:e.jsxs("div",{className:" grid grid-cols-4 gap-3  ",children:[e.jsx("div",{className:"col-span-2 h-32",children:e.jsx(ve,{name:"eastBy",className:"!h-full",label:"label.legal.eastBy*",placeholder:"placeholder.legal.description",variant:K.SECONDARY,onChange:f,value:i,onBlur:B,validation:(N=p==null?void 0:p.current)==null?void 0:N.message("eastBy",i,"mandatory")})}),e.jsx("div",{className:"col-span-2 h-32",children:e.jsx(ve,{name:"westBy",className:"!h-full",label:"label.legal.westBy*",placeholder:"placeholder.legal.description",variant:K.SECONDARY,onChange:f,value:r,onBlur:B,validation:(E=p==null?void 0:p.current)==null?void 0:E.message("westBy",r,"mandatory")})})," ",e.jsx("div",{className:"col-span-2 h-32",children:e.jsx(ve,{name:"northBy",className:"!h-full",label:"label.legal.northBy*",placeholder:"placeholder.legal.description",variant:K.SECONDARY,onChange:f,value:O,onBlur:B,validation:(a=p==null?void 0:p.current)==null?void 0:a.message("northBy",O,"mandatory")})})," ",e.jsx("div",{className:"col-span-2 h-32",children:e.jsx(ve,{name:"southBy",className:"!h-full",label:"label.legal.southBy*",placeholder:"placeholder.legal.description",variant:K.SECONDARY,onChange:f,value:d,onBlur:B,validation:(v=p==null?void 0:p.current)==null?void 0:v.message("southBy",d,"mandatory")})})]})})}),e.jsx(ge,{position:"bottom-right",ref:h,toastText:M,variant:fe.PRIMARY}),e.jsx(le,{onHide:()=>{A(!1),j("")},visible:P,errorMessage:W})]})}),Te={PRE_DISBURSEMENT:"PRE_DISBURSEMENT",POST_DISBURSEMENT:"POST_DISBURSEMENT"},w={PRE_DISBURSEMENT:{code:Te.PRE_DISBURSEMENT,componentLabel:"heading.legal.documentsPriorToDisbursement",searchParams:"&preDisbursementCollection=true",tableFlag:"preDisbursementCollection"},POST_DISBURSEMENT:{code:Te.POST_DISBURSEMENT,componentLabel:"heading.legal.documentsPostToDisbursement",searchParams:"&postDisbursementCollection=true",tableFlag:"postDisbursementCollection"}},Wt={applicantUid:"",loanUid:"",stageUid:""},Ht={uid:"",loan:{uid:""},stage:{uid:""},applicant:{uid:""},dateOfDoc:"",name:"",docCopyType:"",preDisbursementCollection:!1,postDisbursementCollection:!1,isActive:!0},Dt=s.forwardRef((D,q)=>{const{data:c,dropDownOptions:U,updatedRelatedTableCallback:u}=D,[n,l]=s.useState(S.VIEW),[T,b]=s.useState(""),[C,M]=s.useState(!1),[F,_]=s.useState(""),[$,W]=s.useState(!1),j=s.useRef(null),P=Ee.useRef(null),[,A]=s.useState(!1),h=s.useRef(new te({validators:{...se()},...ne(),autoForceUpdate:{forceUpdate:()=>A(t=>!t)}}));s.useImperativeHandle(q,()=>({refresh:O})),s.useEffect(()=>{var t;j!=null&&j.current&&T!==""&&((t=j==null?void 0:j.current)==null||t.showFunction(),b(""))},[T,C]),s.useEffect(()=>{F&&W(!0)},[F]);const y=(t,g)=>{var m;console.log("handle change");let I={...g.rowData};I={...I,[`${g.field}`]:t.target.value},(m=P.current)==null||m.reportDataChange(I)},p=(t,g)=>{var m;console.log("handle change");const I={...g};I.preDisbursementCollection=t.checked,t.checked&&(I.postDisbursementCollection=!1),(m=P.current)==null||m.reportDataChange(I)},f=(t,g)=>{var m;console.log("handle change");const I={...g};I.postDisbursementCollection=t.checked,t.checked&&(I.preDisbursementCollection=!1),(m=P.current)==null||m.reportDataChange(I)},B=t=>{var g,I;(I=h==null?void 0:h.current)==null||I.showMessageFor((g=t==null?void 0:t.target)==null?void 0:g.name)},H=()=>{var g,I;let t=!1;return t=((g=h==null?void 0:h.current)==null?void 0:g.allValid())??!1,t||(A(m=>!m),(I=h==null?void 0:h.current)==null||I.showMessages(),A(m=>!m),!1)},z=()=>{var t;(t=P.current)==null||t.addRow({...Ht})},k=async()=>{var g,I;if(console.log("save"),!H())return;const t=i();try{const m=await oe.updateDocumentsScrutinized(t);b(ue.SAVED),M(!C),l(S.VIEW),(g=P.current)==null||g.clearAll(),(I=P.current)==null||I.search(),u==null||u()}catch(m){_(J(m))}},R=()=>l(S.EDIT),V=()=>{var t,g;l(S.VIEW),r(),(t=P.current)==null||t.clearAll(),(g=P.current)==null||g.search()},X=t=>{var g;(g=P.current)==null||g.deleteRow(t),h.current=new te({validators:{...se()},...ne(),autoForceUpdate:{forceUpdate:()=>A(I=>!I)}})},i=()=>{var Z,L,Q;console.log("enrich for save");let t=((Z=P.current)==null?void 0:Z.getAddedRecords())??[],g=((L=P.current)==null?void 0:L.getDeletedRecords())??[],I=((Q=P.current)==null?void 0:Q.getUpdatedRecords())??[];return t=t.map(G=>({...G,loan:{uid:c==null?void 0:c.loanUid},applicant:{uid:c==null?void 0:c.applicantUid},stage:{uid:c==null?void 0:c.stageUid},dateOfDoc:(G==null?void 0:G.dateOfDoc)!==""?G==null?void 0:G.dateOfDoc:null})),g=g.map(G=>Pe(G)),I=I.map(G=>Pe(G)),[...t,...g,...I]},r=()=>{var t;h.current=new te({validators:{...se()},...ne(),autoForceUpdate:{forceUpdate:()=>A(g=>!g)}}),(t=h==null?void 0:h.current)==null||t.hideMessages()},O=()=>{var t;(t=P.current)==null||t.search()},d=t=>{var g;return e.jsxs("div",{className:"flex flex-row ",children:[e.jsxs("div",{className:" flex flex-row pr-5",children:[e.jsx(xe,{className:" whitespace-pre",label:`${t.label}`}),e.jsx("div",{className:` ml-1 info-${t.code} flex-shrink-0 `,children:e.jsx("img",{src:gt,alt:t.label})})]}),e.jsx(bt,{target:`.info-${t.code}`,position:"top",htmlContent:`${t.message}`,variant:(g=K)==null?void 0:g.PRIMARY,className:""})]})},N=t=>e.jsx("div",{className:"pt-4",children:e.jsx(Ne,{hideLabel:!0,name:`dateOfDocument${t.uid}`,onChange:g=>y(g,{rowData:t,field:"dateOfDoc"}),showMinMaxRange:!0,value:t!=null&&t.dateOfDoc?new Date(t==null?void 0:t.dateOfDoc):"",variant:K.SECONDARY,disabled:n===S.VIEW})}),E=t=>{var g;return e.jsx("div",{className:"pt-4",children:e.jsx(ie,{name:`nameOfDocument${t==null?void 0:t.uid}`,hideLabel:!0,variant:K.SECONDARY,value:t==null?void 0:t.name,onBlur:B,onChange:I=>y(I,{rowData:t,field:"name"}),validation:(g=h==null?void 0:h.current)==null?void 0:g.message(`nameOfDocument${t==null?void 0:t.uid}`,t==null?void 0:t.name,"mandatory"),disabled:n===S.VIEW})})},a=t=>{var g;return e.jsx("div",{className:"pt-4",children:e.jsx(me,{hideLabel:!0,placeholder:"placeholder.legal.documentCopyType",name:`docCopyType${t==null?void 0:t.uid}`,value:t==null?void 0:t.docCopyType,variant:K.PRIMARY,options:U.documentCopyType,optionLabel:"name",optionValue:"code",onChange:I=>y(I,{rowData:t,field:"docCopyType"}),onBlur:B,validation:(g=h==null?void 0:h.current)==null?void 0:g.message(`documentCopyType${t==null?void 0:t.uid}`,t.docCopyType,"mandatory")})})},v=t=>e.jsx("div",{className:"pt-4",children:e.jsx(We,{variant:Re.PRIMARY,value:t.preDisbursementCollection,checked:t.preDisbursementCollection,onChange:g=>p(g,t),hideLabel:!0})}),x=t=>e.jsx("div",{className:"pt-4",children:e.jsx(We,{variant:Re.PRIMARY,value:t.postDisbursementCollection,checked:t.postDisbursementCollection,onChange:g=>f(g,t),hideLabel:!0})}),Y=t=>e.jsx("div",{className:"",children:e.jsx(qe,{buttonType:Qe.DELETE,onClick:()=>X(t),disabled:n===S.VIEW,tooltipOptions:{position:"left",className:"text-xs font-Roboto bg-black text-white !p-1 rounded-md ",showDelay:"1000,",hideDelay:"300"}})}),o=()=>e.jsx("div",{className:"flex justify-between items-center flex-grow",children:e.jsx(xe,{className:"text-primary-sideBarBgColor text-sm font-bold mb-1",label:"heading.legal.descriptionOfDocument*"})});return e.jsxs("div",{children:[e.jsx(pe,{renderHeaderContent:o,pageMode:n,onSave:k,onCancel:V,onEdit:R,children:e.jsxs(re,{override:{read:n===S.VIEW},children:[e.jsx("div",{className:"flex justify-end",children:e.jsx("div",{className:" mr-3 self-center",children:e.jsx(Je,{buttonType:ze.ICON_TEXT_ROW,customLabel:"label.legal.addDocument",onClick:z})})}),c!=null&&c.stageUid?e.jsxs(Ge,{ref:P,uniqueKey:"uid",standardDataFormatPromise:Ce.getDocumentScrutinized,search:`&stage.uid=${c==null?void 0:c.stageUid}&isActive=${!0}&isSharedAtInitiation:nq=true`,mode:"UPDATE",children:[e.jsx(ee,{header:ye.t("label.legal.dateOfDocument"),className:"text-primary-ptext-1000 text-left text-xs h-12 pl-6",body:N}),e.jsx(ee,{header:ye.t("label.legal.nameOfDocument*"),className:"table-header-right text-primary-ptext-1000 text-xs h-12 pl-6",body:E}),e.jsx(ee,{header:ye.t("label.legal.documentCopyType*"),className:"table-header-right text-primary-ptext-1000 text-xs h-12 pl-6",body:a}),e.jsx(ee,{header:()=>d({label:"label.legal.preDisbursementCollection*",code:w.PRE_DISBURSEMENT.code,message:_e.PRE_DISBURSEMENT}),style:{minWidth:"200px",width:"200px"},className:"table-header-right text-primary-ptext-1000 text-xs h-12 pl-6",body:v}),e.jsx(ee,{header:()=>d({label:"label.legal.postDisbursementCollection*",code:w.POST_DISBURSEMENT.code,message:_e.POST_DISBURSEMENT}),style:{minWidth:"200px",width:"200px"},className:"table-header-right text-primary-ptext-1000 text-xs h-12 pl-6",body:x}),e.jsx(ee,{header:ye.t("label.investmentInfo.table.colTitle.action"),className:"text-primary-ptext-1000 text-right text-xs h-12 px-6",style:{minWidth:"50px",width:"50px"},body:Y})]}):null]})}),e.jsx(ge,{position:"bottom-right",ref:j,toastText:T,variant:fe.PRIMARY}),e.jsx(le,{onHide:()=>{W(!1),_("")},visible:$,errorMessage:F})]})}),$t={uid:"",loan:{uid:""},stage:{uid:""},applicant:{uid:""},dateOfDoc:"",name:"",docCopyType:"",preDisbursementCollection:!1,postDisbursementCollection:!1,isActive:!0},Ve=s.forwardRef((D,q)=>{var E;const{data:c,dropDownOptions:U,section:u,updatedRelatedTableCallback:n}=D,[l,T]=s.useState(S.VIEW),[b,C]=s.useState(""),[M,F]=s.useState(!1),[_,$]=s.useState(""),[W,j]=s.useState(!1),P=s.useRef(null),A=Ee.useRef(null),[,h]=s.useState(!1),y=s.useRef(new te({validators:{...se()},...ne(),autoForceUpdate:{forceUpdate:()=>h(a=>!a)}}));s.useImperativeHandle(q,()=>({refresh:V})),s.useEffect(()=>{var a;P!=null&&P.current&&b!==""&&((a=P==null?void 0:P.current)==null||a.showFunction(),C(""))},[b,M]),s.useEffect(()=>{_&&j(!0)},[_]);const p=(a,v)=>{var Y;let x={...v.rowData};x={...x,[`${v.field}`]:a.target.value},(Y=A.current)==null||Y.reportDataChange(x)},f=a=>{var v,x;(x=y==null?void 0:y.current)==null||x.showMessageFor((v=a==null?void 0:a.target)==null?void 0:v.name)},B=()=>{var v,x;let a=!1;return a=((v=y==null?void 0:y.current)==null?void 0:v.allValid())??!1,a||(h(Y=>!Y),(x=y==null?void 0:y.current)==null||x.showMessages(),h(Y=>!Y),!1)},H=()=>{var a;(a=A.current)==null||a.addRow({...$t})},z=async()=>{var x,Y;if(!B())return;const a=X();let v;u===Te.PRE_DISBURSEMENT?v=oe.updateDocumentsScrutinizedPreDisbursement:v=oe.updateDocumentsScrutinizedPostDisbursement;try{const o=await v(a);C(ue.SAVED),F(!M),T(S.VIEW),(x=A.current)==null||x.clearAll(),(Y=A.current)==null||Y.search(),n==null||n()}catch(o){$(J(o))}},k=()=>T(S.EDIT),R=()=>{var a,v;T(S.VIEW),i(),(a=A.current)==null||a.clearAll(),(v=A.current)==null||v.search()},V=()=>{var a;(a=A.current)==null||a.search()},X=()=>{var o,t,g;console.log("enrich for save");let a=((o=A.current)==null?void 0:o.getAddedRecords())??[],v=((t=A.current)==null?void 0:t.getDeletedRecords())??[],x=((g=A.current)==null?void 0:g.getUpdatedRecords())??[];return a=a.map(I=>{var m;return{...I,loan:{uid:c==null?void 0:c.loanUid},applicant:{uid:c==null?void 0:c.applicantUid},stage:{uid:c==null?void 0:c.stageUid},dateOfDoc:(I==null?void 0:I.dateOfDoc)!==""?I==null?void 0:I.dateOfDoc:null,[`${(m=w==null?void 0:w[u])==null?void 0:m.tableFlag}`]:!0}}),v=v.map(I=>{var m;return Pe(I,{[`${(m=w==null?void 0:w[u])==null?void 0:m.tableFlag}`]:!0})}),x=x.map(I=>{var m;return Pe(I,{[`${(m=w==null?void 0:w[u])==null?void 0:m.tableFlag}`]:!0})}),[...a,...v,...x]},i=()=>{var a;y.current=new te({validators:{...se()},...ne(),autoForceUpdate:{forceUpdate:()=>h(v=>!v)}}),(a=y==null?void 0:y.current)==null||a.hideMessages()},r=a=>e.jsx("div",{className:"pt-4",children:e.jsx(Ne,{hideLabel:!0,name:`dateOfDocument${a.uid}`,onChange:v=>p(v,{rowData:a,field:"dateOfDoc"}),showMinMaxRange:!0,value:a!=null&&a.dateOfDoc?new Date(a==null?void 0:a.dateOfDoc):"",variant:K.SECONDARY,disabled:l===S.VIEW})}),O=a=>{var v;return e.jsx("div",{className:"pt-4",children:e.jsx(ie,{name:`nameOfDocument${a==null?void 0:a.uid}`,hideLabel:!0,variant:K.SECONDARY,value:a==null?void 0:a.name,onBlur:f,onChange:x=>p(x,{rowData:a,field:"name"}),validation:(v=y==null?void 0:y.current)==null?void 0:v.message(`nameOfDocument${a==null?void 0:a.uid}`,a==null?void 0:a.name,"mandatory"),disabled:l===S.VIEW})})},d=a=>{var v;return e.jsx("div",{className:"pt-4",children:e.jsx(me,{hideLabel:!0,name:`docCopyType${a==null?void 0:a.uid}`,value:a==null?void 0:a.docCopyType,variant:K.PRIMARY,options:U.documentCopyType,optionLabel:"name",optionValue:"code",onChange:x=>p(x,{rowData:a,field:"docCopyType"}),onBlur:f,validation:(v=y==null?void 0:y.current)==null?void 0:v.message(`docCopyType${a==null?void 0:a.uid}`,a.docCopyType,"mandatory")})})},N=()=>{var a;return e.jsx("div",{className:"flex justify-between items-center flex-grow",children:e.jsx(xe,{className:"text-primary-sideBarBgColor text-sm font-bold mb-1",label:(a=w==null?void 0:w[u])==null?void 0:a.componentLabel})})};return e.jsxs("div",{children:[e.jsx(pe,{renderHeaderContent:N,pageMode:l,onSave:z,onCancel:R,onEdit:k,children:e.jsxs(re,{override:{read:l===S.VIEW},children:[e.jsx("div",{className:"flex justify-end",children:e.jsx("div",{className:" mr-3 self-center",children:e.jsx(Je,{buttonType:ze.ICON_TEXT_ROW,customLabel:"label.legal.addDocument",onClick:H})})}),c!=null&&c.stageUid?e.jsxs(Ge,{ref:A,uniqueKey:"uid",standardDataFormatPromise:Ce.getDocumentScrutinized,search:`&stage.uid=${c==null?void 0:c.stageUid}&isActive=${!0}${(E=w==null?void 0:w[u])==null?void 0:E.searchParams}`,mode:"UPDATE",children:[e.jsx(ee,{header:ye.t("label.legal.dateOfDocument"),className:"text-primary-ptext-1000 text-left text-xs h-12 pl-6",body:r}),e.jsx(ee,{header:ye.t("label.legal.nameOfDocument*"),className:"table-header-right text-primary-ptext-1000 text-xs h-12 pl-6",body:O}),e.jsx(ee,{header:ye.t("label.legal.documentCopyType*"),className:"table-header-right text-primary-ptext-1000 text-xs h-12 px-6",body:d})]}):null]})}),e.jsx(ge,{position:"bottom-right",ref:P,toastText:b,variant:fe.PRIMARY}),e.jsx(le,{onHide:()=>{j(!1),$("")},visible:W,errorMessage:_})]})}),tt={legalUid:"",showOnlyUploadReport:!0,dateOfInitiation:"",stage:"",vendorType:"",externalVendor:{name:""},internalAssignee:{name:""},CCEmails:[],description:"",propertyType:"",address:"",pincode:{pinCode:"",uid:""},city:{name:"",uid:""},state:"",latitude:"",longitude:"",stageDocuments:[]},Vt=D=>{const{isLoadingInitial:q,data:c,dropdownOptions:U}=D,[u,n]=s.useState({...tt}),[l,T]=s.useState(!1),[b,C]=s.useState({...Nt}),M=s.useRef(null),F=s.useRef(null),_=s.useRef(),$=At();s.useEffect(()=>{c.stage&&n(i=>({...i,...c}))},[c]);const W=(i,r)=>{var d,N,E,a,v,x,Y,o,t,g,I,m,Z,L,Q,G,ce,Le,Me,Be,Ye,Fe;let O={uid:"",placeOfUpload:"",name:"",fileName:"",fileType:"",download:"",category:"",type:"",sectionName:"",url:""};r!=null&&r.loanDocumentSection?O={uid:r==null?void 0:r.uid,placeOfUpload:"",name:((E=(N=(d=r==null?void 0:r.loanDocumentSection)==null?void 0:d.loanDocument)==null?void 0:N.applicant)==null?void 0:E.firstName)??"-",fileName:((a=r==null?void 0:r.loanDocumentSection)==null?void 0:a.fileName)??"-",fileType:((v=r==null?void 0:r.loanDocumentSection)==null?void 0:v.fileType)??"-",download:"",category:((Y=(x=r==null?void 0:r.loanDocumentSection)==null?void 0:x.loanDocument)==null?void 0:Y.docCategory)??"-",type:((g=(t=(o=r==null?void 0:r.loanDocumentSection)==null?void 0:o.loanDocument)==null?void 0:t.docType)==null?void 0:g.name)??"-",sectionName:((I=r==null?void 0:r.loanDocumentSection)==null?void 0:I.section)??"-",url:(m=r==null?void 0:r.loanDocumentSection)==null?void 0:m.url}:r!=null&&r.kycDocument&&(O={uid:r==null?void 0:r.uid,placeOfUpload:"",name:((Q=(L=(Z=r==null?void 0:r.kycDocument)==null?void 0:Z.kyc)==null?void 0:L.applicant)==null?void 0:Q.firstName)??"-",fileName:((G=r==null?void 0:r.kycDocument)==null?void 0:G.fileName)??"-",fileType:((ce=r==null?void 0:r.kycDocument)==null?void 0:ce.fileType)??"-",download:"",category:"KYC",type:((Be=(Me=(Le=r==null?void 0:r.kycDocument)==null?void 0:Le.kyc)==null?void 0:Me.docType)==null?void 0:Be.name)??"-",sectionName:((Ye=r==null?void 0:r.kycDocument)==null?void 0:Ye.smDocSectionType)??"-",url:(Fe=r==null?void 0:r.kycDocument)==null?void 0:Fe.url}),C(O),T(!0)},j=s.useMemo(()=>{const{address:i,pincode:r,city:O,state:d,propertyType:N,latitude:E,longitude:a}=u;return{address:i,pincode:r,city:O,state:d,propertyType:N,latitude:E,longitude:a}},[u==null?void 0:u.address,u==null?void 0:u.pincode,u==null?void 0:u.city,u==null?void 0:u.state,u==null?void 0:u.propertyType,u==null?void 0:u.latitude,u==null?void 0:u.longitude]),P=i=>{var r,O;return e.jsx("div",{className:"flex items-center",children:i!=null&&i.loanDocumentSection?((O=(r=i==null?void 0:i.loanDocumentSection)==null?void 0:r.loanDocument)==null?void 0:O.docCategory)??"-":"KYC"})},A=i=>e.jsx("div",{className:"flex items-center",children:(i==null?void 0:i.stageDocType)??"-"}),h=i=>{var r,O;return e.jsx("div",{className:"flex items-center",children:i!=null&&i.loanDocumentSection?((r=i==null?void 0:i.loanDocumentSection)==null?void 0:r.section)??"-":(O=i==null?void 0:i.kycDocument)==null?void 0:O.smDocSectionType})},y=i=>e.jsx("div",{className:"px-2 flex items-center space-x-4",children:e.jsx("div",{className:"flex items-center",children:e.jsx(qe,{buttonType:Qe.VIEW,onClick:r=>{W(r,i)},isIgnoreAccessLevel:!0})})}),p=()=>{var i;return e.jsxs(we,{dataKey:"id",ref:_,value:c==null?void 0:c.stageDocuments,className:` h-auto selected-existing-doc-read-table ${(i=c==null?void 0:c.stageDocuments)!=null&&i.length?"!min-h-auto":"!min-h-50"}`,children:[e.jsx(ee,{header:$("label.existing.document.category"),className:"text-primary-ptext-1000 text-left text-xs h-12 pl-6",body:P}),e.jsx(ee,{header:$("label.existing.document.type"),className:"text-primary-ptext-1000 text-left text-xs h-12 pl-6",body:A}),e.jsx(ee,{header:$("label.existing.document.section"),className:"text-primary-ptext-1000 text-left text-xs h-12 pl-6",body:h}),e.jsx(ee,{header:$("label.existing.document.action"),className:"text-primary-ptext-1000 text-center text-xs h-12 pr-2",body:y})]})},{dateOfInitiation:f,vendorType:B,stage:H,externalVendor:z,internalAssignee:k,CCEmails:R,description:V,propertyType:X}=u;return e.jsx(je,{title:"header.legal.initiationInfo",children:e.jsxs("div",{className:"w-full h-full border border-primary-ptext-500 rounded-xl p-5",children:[q?e.jsx(he,{height:"19.375rem",width:"100%",borderRadius:"8px",animation:"wave"}):e.jsxs(re,{override:{read:!0},children:[e.jsxs("div",{className:" grid grid-cols-4 gap-3",children:[e.jsx("div",{children:e.jsx(Ne,{label:"label.legal.dateOfInitiation",name:"dateOfInitiation",value:new Date(f),variant:K.SECONDARY,placeholder:"DD-MM-YYYY "})}),e.jsx("div",{children:e.jsx(me,{label:"label.cq.stage",name:"stage",value:H,options:lt})}),e.jsx("div",{children:e.jsx(me,{label:"label.legal.vendorType",name:"venderType",value:B,optionLabel:"name",optionValue:"code",options:(U==null?void 0:U.venderType)??[]})}),e.jsx("div",{}),e.jsx("div",{children:e.jsx(He,{label:"label.legal.externalVender",name:"externalVendor",value:z==null?void 0:z.name,variant:K.PRIMARY})}),e.jsx("div",{children:e.jsx(He,{label:"label.legal.internalAssignee",name:"internalAssignee",value:k==null?void 0:k.name,variant:K.PRIMARY})})]}),e.jsx("div",{className:"grid grid-cols-4 gap-x-4 gap-y-5 mt-4",children:e.jsx("div",{className:"col-span-2",children:e.jsx(jt,{className:"",name:"cc",value:R,label:"label.legal.cc",ref:M})})}),e.jsx("div",{className:"grid grid-cols-4 gap-x-4 gap-y-5 mt-7",children:e.jsx("div",{className:"col-span-2",children:e.jsx(ve,{name:"description",className:"!h-40",label:"input.masterData.staticMaster.description",placeholder:"placeholder.legal.description",variant:K.SECONDARY,maxCount:200,value:V,autoResize:!0})})}),e.jsx("div",{className:"mt-6",children:p()}),e.jsxs("div",{className:"flex flex-col justify-start items-start space-y-4 w-full mt-6",children:[e.jsx(xe,{label:"heading.dde.propertyDetails",className:"text-primary-sideBarBgColor font-bold text-xs"}),e.jsx("div",{className:"w-full",children:e.jsx(Ze,{pageMode:S.VIEW,variant:Ke.TERTIARY,ref:F,data:j,hideMarkUsingMap:!0})})]})]}),e.jsx(Ut,{visible:l,onToggleVisibility:()=>T(i=>!i),list:[],currentSection:b})]})})},st={dateOfInitiation:"",legalUid:"",loanNo:"",branchNo:"",agency:"",dateOfReport:""},kt=s.forwardRef((D,q)=>{var N;const{data:c,isLoading:U,isLoadingInitial:u,getDetailsCallback:n}=D,[l,T]=s.useState({...st}),[b,C]=s.useState(S.VIEW),[M,F]=s.useState(""),[_,$]=s.useState(!1),[W,j]=s.useState(""),[P,A]=s.useState(!1),h=s.useRef(null),[,y]=s.useState(!1),p=s.useRef(new te({validators:{...se()},...ne(),autoForceUpdate:{forceUpdate:()=>y(E=>!E)}}));s.useImperativeHandle(q,()=>({save:z,onCancel:R})),s.useEffect(()=>{c.loanNo&&T(E=>({...E,...c}))},[c]),s.useEffect(()=>{var E;h!=null&&h.current&&M!==""&&((E=h==null?void 0:h.current)==null||E.showFunction(),F(""))},[M,_]),s.useEffect(()=>{W&&A(!0)},[W]);const f=E=>{T(a=>({...a,[E.target.name]:E.target.value}))},B=E=>{var a,v;(v=p==null?void 0:p.current)==null||v.showMessageFor((a=E==null?void 0:E.target)==null?void 0:a.name)},H=()=>{var a,v;let E=!1;return E=((a=p==null?void 0:p.current)==null?void 0:a.allValid())??!1,E||(y(x=>!x),(v=p==null?void 0:p.current)==null||v.showMessages(),y(x=>!x),!1)},z=async()=>{if(!H())return;const E=V();try{const a=await oe.updateSummary(E);F(ue.SAVED),$(!_),C(S.VIEW),n==null||n()}catch(a){j(J(a))}},k=()=>C(S.EDIT),R=()=>{C(S.VIEW),X(),n==null||n()},V=()=>({uid:l.legalUid,dateOfReport:l.dateOfReport}),X=()=>{var E;p.current=new te({validators:{...se()},...ne(),autoForceUpdate:{forceUpdate:()=>y(a=>!a)}}),(E=p==null?void 0:p.current)==null||E.hideMessages()},{loanNo:i,branchNo:r,agency:O,dateOfReport:d}=l;return e.jsxs("div",{children:[e.jsx(pe,{title:"label.legal.loanSummary",pageMode:b,disabled:U,onSave:z,onCancel:R,onEdit:k,children:u?e.jsx(he,{height:"19.375rem",width:"100%",borderRadius:"8px",animation:"wave"}):e.jsx(re,{override:{read:b===S.VIEW},children:e.jsxs("div",{className:" grid grid-cols-4 gap-3  ",children:[e.jsx("div",{children:e.jsx(ie,{label:"label.legal.loanNoMandatory",name:"loanNo",variant:K.SECONDARY,value:i??"",disabled:!0})}),e.jsx("div",{children:e.jsx(ie,{label:"input.sourceDetails.branch",name:"Branch",variant:K.SECONDARY,value:r??"",disabled:!0})}),e.jsx("div",{children:e.jsx(ie,{label:"label.legal.agencyMandatory",name:"loanNo",variant:K.SECONDARY,value:O??"",disabled:!0})}),e.jsx("div",{children:e.jsx(Ne,{label:"label.legal.dateOfReporting",name:"dateOfReport",minDate:l!=null&&l.dateOfInitiation?new Date(l==null?void 0:l.dateOfInitiation):void 0,value:d,variant:K.SECONDARY,onChange:f,onBlur:B,validation:(N=p==null?void 0:p.current)==null?void 0:N.message("dateOfReport",d,"mandatory"),placeholder:"DD-MMM-YYYY "})})]})})}),e.jsx(ge,{position:"bottom-right",ref:h,toastText:M,variant:fe.PRIMARY}),e.jsx(le,{onHide:()=>{A(!1),j("")},visible:P,errorMessage:W})]})}),Se={YES:"YES",NO:"NO"},Ie={CHECKBOX:"CHECKBOX",TEXT_INPUT:"TEXT_INPUT"},nt={tableData:[],isTableLoaded:!1,loanUid:"",stageUid:"",isTableDataEmptyFromApi:!1},zt=s.forwardRef((D,q)=>{ct();const{data:c,isLoading:U,dropDownOptions:u,getDetailsCallback:n}=D,[l,T]=s.useState({...nt}),[b,C]=s.useState(S.VIEW),[M,F]=s.useState(""),[_,$]=s.useState(!1),[W,j]=s.useState(""),[P,A]=s.useState(!1),h=s.useRef(null),y=s.useRef(null),[,p]=s.useState(!1),f=s.useRef(new te({validators:{...se()},...ne(),autoForceUpdate:{forceUpdate:()=>p(d=>!d)}}));s.useImperativeHandle(q,()=>({save:k,onCancel:V})),s.useEffect(()=>{var d;((d=c==null?void 0:c.tableData)==null?void 0:d.length)>0&&T(N=>({...N,...c}))},[c]),s.useEffect(()=>{const d=u==null?void 0:u.otherProvisions;d&&(d==null?void 0:d.length)>0&&c.isTableLoaded&&c.isTableDataEmptyFromApi&&T(N=>{const E={...N},a=[];for(const v of d)a.push({smCode:(v==null?void 0:v.code)??"",name:(v==null?void 0:v.name)??"",value:null,comment:"",loan:{uid:c==null?void 0:c.loanUid},stage:{uid:c==null?void 0:c.stageUid}});return E.tableData=a,E})},[u==null?void 0:u.otherProvisions,c]),s.useEffect(()=>{var d;y!=null&&y.current&&M!==""&&((d=y==null?void 0:y.current)==null||d.showFunction(),F(""))},[M,_]),s.useEffect(()=>{W&&A(!0)},[W]);const B=(d,N,E)=>{const a=l.tableData.findIndex(v=>v.smCode===N.smCode);a>-1&&T(v=>{var Y;const x={...v};return E===Ie.CHECKBOX?x.tableData[a].value=d.value:x.tableData[a].comment=(Y=d.target)==null?void 0:Y.value,x})},H=d=>{var N,E;(E=f==null?void 0:f.current)==null||E.showMessageFor((N=d==null?void 0:d.target)==null?void 0:N.name)},z=()=>{var N,E;let d=!1;return d=((N=f==null?void 0:f.current)==null?void 0:N.allValid())??!1,d||(p(a=>!a),(E=f==null?void 0:f.current)==null||E.showMessages(),p(a=>!a),!1)},k=async()=>{var d;if(console.log("save"),!!z())try{const N=await oe.updateOtherProvisionDetails(l==null?void 0:l.tableData);F(ue.SAVED),$(!_),C(S.VIEW),(d=h.current)==null||d.search()}catch(N){j(J(N))}},R=()=>C(S.EDIT),V=()=>{C(S.VIEW),X(),n==null||n()},X=()=>{var d;f.current=new te({validators:{...se()},...ne(),autoForceUpdate:{forceUpdate:()=>p(N=>!N)}}),(d=f==null?void 0:f.current)==null||d.hideMessages()},i=d=>e.jsx(xe,{className:" text-xs text-secondary-labelColor ",label:d==null?void 0:d.name}),r=d=>{var N;return e.jsxs("div",{className:"mt-5 ",children:[e.jsxs("div",{className:"flex flex-shrink-0 ",children:[e.jsxs("div",{className:"mr-5 flex",children:[e.jsx(De,{hideLabel:!0,hideErrorRow:!0,variant:Re.PRIMARY,value:Se.YES,checked:d.value===Se.YES,onChange:E=>B(E,d,Ie.CHECKBOX),disabled:b===S.VIEW}),e.jsx(xe,{className:"ml-1.5 text-xs ",label:"label.dde.yes"})]}),e.jsxs("div",{className:"flex",children:[e.jsx(De,{hideLabel:!0,hideErrorRow:!0,variant:Re.PRIMARY,value:Se.NO,checked:d.value===Se.NO,onChange:E=>B(E,d,Ie.CHECKBOX),disabled:b===S.VIEW}),e.jsx(xe,{className:"ml-1.5 text-xs ",label:"label.dde.no"})]})]}),e.jsx("div",{className:"h-4 flex ml-6 items-start mb-1.5",children:e.jsx(dt,{validation:(N=f==null?void 0:f.current)==null?void 0:N.message(`value${d==null?void 0:d.smCode}`,d.value,"mandatory")})})]})},O=d=>e.jsx("div",{className:"flex items-start mt-1",children:e.jsx(ie,{name:`comment${d==null?void 0:d.smCode}`,variant:K.SECONDARY,onChange:N=>B(N,d,Ie.TEXT_INPUT),onBlur:H,value:d==null?void 0:d.comment})});return e.jsxs("div",{children:[e.jsx(pe,{title:"heading.legal.otherProvisions*",pageMode:b,onSave:k,onCancel:V,onEdit:R,children:U?e.jsx(he,{height:"19.375rem",width:"100%",borderRadius:"8px",animation:"wave"}):e.jsx(re,{override:{read:b===S.VIEW},children:e.jsxs(we,{value:l.tableData,className:" share-payment-details-table",ref:h,dataKey:"uid",children:[e.jsx(ee,{className:"text-primary-ptext-1000 text-left text-xs  p-1 h-12 pl-6",header:"Question",body:i}),e.jsx(ee,{className:"text-primary-ptext-1000 text-left text-xs  p-1 h-12 pl-6",header:"Yes/No*",body:r}),e.jsx(ee,{className:"text-primary-ptext-1000 text-left text-xs  p-1 h-12 pl-6",header:"Comment",body:O,style:{maxWidth:"168px"}})]})})}),e.jsx(ge,{position:"bottom-right",ref:y,toastText:M,variant:fe.PRIMARY}),e.jsx(le,{onHide:()=>{A(!1),j("")},visible:P,errorMessage:W})]})}),ot={addressUid:"",legalUid:"",stageUid:"",address:"",pincode:{pinCode:"",uid:""},city:{name:"",uid:""},state:"",latitude:"",longitude:""},Kt=s.forwardRef((D,q)=>{const{data:c,isLoading:U,isLoadingInitial:u,getDetailsCallback:n}=D,[l,T]=s.useState({...ot}),[b,C]=s.useState(S.VIEW),[M,F]=s.useState(""),[_,$]=s.useState(!1),[W,j]=s.useState(""),[P,A]=s.useState(!1),h=s.useRef(null),[,y]=s.useState(!1);s.useRef(new te({validators:{...se()},...ne(),autoForceUpdate:{forceUpdate:()=>y(R=>!R)}}));const p=s.useRef(null);s.useImperativeHandle(q,()=>({save:f,onCancel:H})),s.useEffect(()=>{c.addressUid&&T(R=>({...R,...c}))},[c]),s.useEffect(()=>{var R;h!=null&&h.current&&M!==""&&((R=h==null?void 0:h.current)==null||R.showFunction(),F(""))},[M,_]),s.useEffect(()=>{W&&A(!0)},[W]);const f=async()=>{var V;console.log("save");const R=(V=p.current)==null?void 0:V.save();if(R){const X=z(R);try{const i=await oe.updatePropertyAddressAsPerDoc(X);F(ue.SAVED),$(!_),C(S.VIEW),n==null||n()}catch(i){j(J(i))}}},B=()=>C(S.EDIT),H=()=>{var R;C(S.VIEW),(R=p.current)==null||R.resetValidator(),n==null||n()},z=R=>({stage:{uid:l==null?void 0:l.stageUid},address:{...R,uid:l==null?void 0:l.addressUid,latitude:R!=null&&R.latitude?parseFloat(R==null?void 0:R.latitude):void 0,longitude:R!=null&&R.longitude?parseFloat(R==null?void 0:R.longitude):void 0}}),k=s.useMemo(()=>{const{address:R,pincode:V,city:X,state:i,latitude:r,longitude:O}=l;return{address:R,pincode:V,city:X,state:i,latitude:r,longitude:O}},[l==null?void 0:l.address,l==null?void 0:l.pincode,l==null?void 0:l.city,l==null?void 0:l.state,l==null?void 0:l.latitude,l==null?void 0:l.longitude]);return e.jsxs(e.Fragment,{children:[e.jsx(pe,{title:"Heading.legal.PropertyAddressAsDocument",pageMode:b,disabled:U,onSave:f,onCancel:H,onEdit:B,children:u?e.jsx(he,{height:"19.375rem",width:"100%",borderRadius:"8px",animation:"wave"}):e.jsx("div",{className:" grid grid-cols-4 gap-3  ",children:e.jsx("div",{className:"col-span-4",children:e.jsx(Ze,{pageMode:b,ref:p,data:k,variant:Ke.SECONDARY,isLatLong:!0})})})}),e.jsx(ge,{position:"bottom-right",ref:h,toastText:M,variant:fe.PRIMARY}),e.jsx(le,{onHide:()=>{A(!1),j("")},visible:P,errorMessage:W})]})}),at={stageUid:"",legalUid:"",typeOfLoan:"LOAN_TYPE_SECURED",natureOfTransactions:"",subRegistrarOffice:"",nameOfPresentOwner:"",areaOfProperty:"",units:"",typeOfMortgage:"",natureOfLand:""},Xt=s.forwardRef((D,q)=>{var Y,o,t,g,I,m,Z;const{dropDownOptions:c,getDetailsCallback:U,data:u,isLoadingInitial:n}=D,l=s.useRef(null),[T,b]=s.useState({...at}),[C,M]=s.useState(S.VIEW),[F,_]=s.useState(""),[$,W]=s.useState(!1),[j,P]=s.useState(""),[A,h]=s.useState(!1),y=s.useRef(null),[,p]=s.useState(!1),f=s.useRef(new te({validators:{...se()},...ne(),autoForceUpdate:{forceUpdate:()=>p(L=>!L)}}));s.useImperativeHandle(q,()=>({save:k,onCancel:V})),s.useEffect(()=>{u!=null&&u.legalUid&&b(L=>({...L,...u}))},[u]),s.useEffect(()=>{var L;y!=null&&y.current&&F!==""&&((L=y==null?void 0:y.current)==null||L.showFunction(),_(""))},[F,$]),s.useEffect(()=>{j&&h(!0)},[j]);const B=L=>{b(Q=>({...Q,[L.target.name]:L.target.value}))},H=L=>{var Q,G;(G=f==null?void 0:f.current)==null||G.showMessageFor((Q=L==null?void 0:L.target)==null?void 0:Q.name)},z=()=>{var Q,G;let L=!1;return L=((Q=f==null?void 0:f.current)==null?void 0:Q.allValid())??!1,L||(p(ce=>!ce),(G=f==null?void 0:f.current)==null||G.showMessages(),p(ce=>!ce),!1)},k=async()=>{if(console.log("save"),!z())return;const L=X();try{const Q=await oe.updatePropertyDetails(L);_(ue.SAVED),W(!$),M(S.VIEW),U==null||U()}catch(Q){P(J(Q))}},R=()=>M(S.EDIT),V=()=>{M(S.VIEW),i(),U==null||U()},X=()=>({uid:T==null?void 0:T.legalUid,typeOfLoan:T==null?void 0:T.typeOfLoan,natureOfTransaction:T==null?void 0:T.natureOfTransactions,subRegistrarOffice:T==null?void 0:T.subRegistrarOffice,nameOfCurrentOwner:T==null?void 0:T.nameOfPresentOwner,areaOfPropertyAsPerDoc:T==null?void 0:T.areaOfProperty,areaUnit:T==null?void 0:T.units,typeOfMortgate:T==null?void 0:T.typeOfMortgage,natureOfLand:T==null?void 0:T.natureOfLand}),i=()=>{var L;f.current=new te({validators:{...se()},...ne(),autoForceUpdate:{forceUpdate:()=>p(Q=>!Q)}}),(L=f==null?void 0:f.current)==null||L.hideMessages()},{typeOfLoan:r,natureOfTransactions:O,subRegistrarOffice:d,nameOfPresentOwner:N,areaOfProperty:E,units:a,typeOfMortgage:v,natureOfLand:x}=T;return e.jsxs("div",{children:[e.jsx(pe,{title:"header.legal.propertyDetails",pageMode:C,onSave:k,onCancel:V,onEdit:R,children:n?e.jsx(he,{height:"19.375rem",width:"100%",borderRadius:"8px",animation:"wave"}):e.jsx(re,{override:{read:C===S.VIEW},children:e.jsxs("div",{className:" grid grid-cols-4 gap-3 ",children:[e.jsx("div",{className:"col-span-1",children:e.jsx(me,{label:"label.legal.typeOfLoanMandatory",placeholder:"placeholder.legal.typeOfLoanMandatory",name:"typeOfLoan",value:r,disabled:!0,options:c.typeOfLoan,optionLabel:"name",optionValue:"code"})}),e.jsx("div",{className:"col-span-1 ",ref:l,children:e.jsx(ie,{label:"label.legal.natureOfTransactionMandatory",name:"natureOfTransactions",variant:K.SECONDARY,value:O??"",onChange:B,validation:(Y=f==null?void 0:f.current)==null?void 0:Y.message("natureOfTransactions",O,"mandatory"),onBlur:H})}),e.jsx("div",{children:e.jsx(ie,{label:"label.legal.subRegistrarOffice",name:"subRegistrarOffice",variant:K.SECONDARY,value:d??"",onChange:B,validation:(o=f==null?void 0:f.current)==null?void 0:o.message("subRegistrarOffice",d,"mandatory"),onBlur:H})}),e.jsx("div",{children:e.jsx(ie,{label:"label.legal.nameOfPresentOwnerMandatory",name:"nameOfPresentOwner",variant:K.SECONDARY,value:N??"",onChange:B,validation:(t=f==null?void 0:f.current)==null?void 0:t.message("nameOfPresentOwner",N,"mandatory"),onBlur:H})}),e.jsx("div",{children:e.jsx(ie,{label:"label.legal.areaOfPropertyMandatory",name:"areaOfProperty",variant:K.SECONDARY,value:E??"",onChange:B,validation:(g=f==null?void 0:f.current)==null?void 0:g.message("areaOfProperty",E,"mandatory|checkNumber|onlyPositive|maxDecimal:2"),onBlur:H})}),e.jsx("div",{className:"col-span-1",children:e.jsx(me,{label:"label.legal.unitsMandatory",placeholder:"placeholder.legal.unitsMandatory",name:"units",value:a,onChange:B,validation:(I=f==null?void 0:f.current)==null?void 0:I.message("units",a,"mandatory"),onBlur:H,disabled:C===S.VIEW,options:c.units,optionLabel:"name",optionValue:"code"})}),e.jsx("div",{className:"col-span-1",children:e.jsx(me,{label:"label.legal.typeOfMortgage*",placeholder:"placeholder.legal.typeOfMortgage*",name:"typeOfMortgage",value:v,onChange:B,validation:(m=f==null?void 0:f.current)==null?void 0:m.message("typeOfMortgage",v,"mandatory"),onBlur:H,disabled:C===S.VIEW,options:c.typeOfMortgage,optionLabel:"name",optionValue:"code"})}),e.jsx("div",{className:"col-span-1",children:e.jsx(me,{label:"label.legal.natureOfPropertyMandatory",placeholder:"placeholder.legal.natureOfPropertyMandatory",name:"natureOfLand",value:x,onChange:B,validation:(Z=f==null?void 0:f.current)==null?void 0:Z.message("natureOfLand",x,"mandatory"),onBlur:H,disabled:C===S.VIEW,options:c.natureOfLand,optionLabel:"name",optionValue:"code"})})]})})}),e.jsx(ge,{position:"bottom-right",ref:y,toastText:F,variant:fe.PRIMARY}),e.jsx(le,{onHide:()=>{h(!1),P("")},visible:A,errorMessage:j})]})}),Ae={legalUid:"",richText:"",errorMessage:""},ke=s.forwardRef((D,q)=>{const{title:c,section:U,getDetailsCallback:u,isLoadingInitial:n,data:l,isLoading:T}=D,[b,C]=s.useState({...Ae}),[M,F]=s.useState(S.VIEW),[_,$]=s.useState(""),[W,j]=s.useState(!1),[P,A]=s.useState(""),[h,y]=s.useState(!1),p=s.useRef(null),[,f]=s.useState(!1);s.useRef(new te({validators:{...se()},...ne(),autoForceUpdate:{forceUpdate:()=>f(i=>!i)}}));const B=s.useRef(null);s.useImperativeHandle(q,()=>({save:k,onCancel:V})),s.useEffect(()=>{l!=null&&l.legalUid&&C(i=>({...i,...l}))},[l]),s.useEffect(()=>{var i;p!=null&&p.current&&_!==""&&((i=p==null?void 0:p.current)==null||i.showFunction(),$(""))},[_,W]),s.useEffect(()=>{P&&y(!0)},[P]);const H=i=>{z()&&b!=null&&b.errorMessage&&C(r=>({...r,errorMessage:""}))},z=()=>{var r,O,d,N;return console.log("editor ",B),((N=(d=(O=(r=B==null?void 0:B.current)==null?void 0:r.editor)==null?void 0:O.plugins)==null?void 0:d.wordcount)==null?void 0:N.body.getCharacterCount())<1?(C(E=>({...E,errorMessage:"Mandatory"})),!1):!0},k=async()=>{if(console.log("save"),!z())return;const i=X();let r;U===be.TITLE_OBSERVATION?r=oe.updateTitleObservation:r=oe.updateTitleSearch;try{const O=await r(i);$(ue.SAVED),j(!W),F(S.VIEW),u==null||u()}catch(O){A(J(O))}},R=()=>F(S.EDIT),V=()=>{F(S.VIEW),u==null||u()},X=()=>{var r,O;const i=(O=(r=B.current)==null?void 0:r.editor)==null?void 0:O.getContent();return U===be.TITLE_OBSERVATION?{uid:b==null?void 0:b.legalUid,propertyTitleObservations:i}:{uid:b==null?void 0:b.legalUid,titleSearch:i}};return e.jsxs("div",{children:[e.jsx(pe,{title:c,pageMode:M,disabled:T,onSave:k,onCancel:V,onEdit:R,children:n?e.jsx(he,{height:"19.375rem",width:"100%",borderRadius:"8px",animation:"wave"}):e.jsx(re,{override:{read:M===S.VIEW},children:e.jsx("div",{className:" grid grid-cols-4 gap-3  ",children:e.jsx("div",{className:"col-span-4 ",children:e.jsx(Lt,{ref:B,validation:{errorMessage:b.errorMessage},initialValue:b.richText,onChange:H,height:400,disabled:M===S.VIEW})})})})}),e.jsx(ge,{position:"bottom-right",ref:p,toastText:_,variant:fe.PRIMARY}),e.jsx(le,{onHide:()=>{y(!1),A("")},visible:h,errorMessage:P})]})}),it={legalUid:"",savedDocuments:[]},Gt=s.forwardRef((D,q)=>{var V,X;const c=Xe(),{data:U,getDetailsCallback:u,isLoading:n}=D,[l,T]=s.useState({...it}),[b,C]=s.useState(S.VIEW),[M,F]=s.useState(""),[_,$]=s.useState(!1),[W,j]=s.useState(""),[P,A]=s.useState(!1),h=s.useRef(null),y=s.useRef(null),[,p]=s.useState(!1),f=s.useRef(new te({validators:{...se()},...ne(),autoForceUpdate:{forceUpdate:()=>p(i=>!i)}}));s.useImperativeHandle(q,()=>({save:H,onCancel:k})),s.useEffect(()=>{U!=null&&U.legalUid&&T(i=>({...i,...U}))},[U]),s.useEffect(()=>{var i;h!=null&&h.current&&M!==""&&((i=h==null?void 0:h.current)==null||i.showFunction(),F(""))},[M,_]),s.useEffect(()=>{W&&A(!0)},[W]);const B=()=>{var r,O;let i=!1;return i=((r=f==null?void 0:f.current)==null?void 0:r.allValid())??!1,i||(p(d=>!d),(O=f==null?void 0:f.current)==null||O.showMessages(),p(d=>!d),!1)},H=async()=>{var O;if(console.log("save"),!B())return;const i=(O=y.current)==null?void 0:O.getUploadedData();if(!i)return;const r=R(i);try{const d=await oe.uploadDocument(r);F(ue.SAVED),$(!_),C(S.VIEW),u==null||u()}catch(d){j(J(d))}},z=()=>C(S.EDIT),k=()=>{var i;C(S.VIEW),(i=y==null?void 0:y.current)==null||i.resetDocUpload(),u==null||u()},R=i=>({uid:l.legalUid,loan:{uid:c==null?void 0:c.loanUid},loanDocuments:i!=null&&i.documentUid?[{uid:i==null?void 0:i.uid,docType:{uid:i==null?void 0:i.documentUid},docNo:(i==null?void 0:i[`${i.primaryKeyAttributeName}`])??null,dob:i.dob?i.dob:null,docCategory:i==null?void 0:i.documentCategory,attributes:Bt(i),documentSections:Yt(i==null?void 0:i.documentSectionUrls)}]:[]});return e.jsxs("div",{children:[e.jsx(pe,{title:"heading.legal.uploadLegalReport",pageMode:b,disabled:n,onSave:H,onCancel:k,onEdit:z,children:n?e.jsx(he,{height:"19.375rem",width:"100%",borderRadius:"8px",animation:"wave"}):e.jsx(re,{override:{read:b===S.VIEW},children:e.jsx("div",{className:" grid grid-cols-4 gap-3 ",children:e.jsx("div",{className:"col-span-4",children:e.jsx(Mt,{ref:y,savedDocument:(V=U.savedDocuments)!=null&&V[0]?(X=U.savedDocuments)==null?void 0:X[0]:{},mode:b===S.VIEW?$e.VIEW:$e.EDIT,mandatoryDocUpload:!0,queryParamForDocList:ut.DOCUMENT_CATEGORY_LEGAL_DOCUMENT})})})})}),e.jsx(ge,{position:"bottom-right",ref:h,toastText:M,variant:fe.PRIMARY}),e.jsx(le,{onHide:()=>{A(!1),j("")},visible:P,errorMessage:W})]})}),rt={loanSummary:!1,propertyAddress:!1,boundaryDetails:!1,finalOpinion:!1,titleObservations:!1,titleSearch:!1,propertyDetails:!1},Oe={showInfo:!0,stageInfo:{},dropdownOptions:{addressType:[],venderType:[],stage:[],typeOfLoan:[],natureOfTransactions:[],typeOfMortgage:[],natureOfLand:[],units:[],status:[],documentCopyType:[],otherProvisions:[]},initiationInfo:{...tt},loanSummary:{...st},propertyDetails:{...at},propertyAddress:{...ot},boundaryDetails:{...et},finalOpinion:{...Pt},titleObservations:{...Ae},titleSearch:{...Ae},documentScrutinized:{...Wt},otherProvisions:{...nt},isLoading:{...rt,otherProvisions:!1,uploadReport:!1},isStageDetailsInitialLoad:!0,stageUid:"",uploadReport:{...it}},ws=()=>{var E,a,v,x,Y;const D=Xe(),[q,c]=s.useState(!1),[U,u]=s.useState(""),[n,l]=s.useState({...Oe}),[T,b]=s.useState(!1),C=Ee.useRef(null),M=Ee.useRef(null),F=Ee.useRef(null),_=Ft(o=>o.UserProfileReducers.profileObj),$=(_==null?void 0:_.sahayyaUserType)===ft.PARTNER_USER;s.useEffect(()=>{W()},[]),s.useEffect(()=>{D.stageUid&&W()},[D.stageUid]),s.useEffect(()=>{n.stageUid&&(j(),P())},[n.stageUid]),s.useEffect(()=>{n.initiationInfo.legalUid&&!n.uploadReport.legalUid&&A()},[n.initiationInfo.legalUid]),s.useEffect(()=>{U&&c(!0)},[U]),s.useEffect(()=>{var o,t,g;((o=n.stageInfo)==null?void 0:o.status)===Ue.IN_REVIEW?b(!0):$?((t=n.stageInfo)==null?void 0:t.status)===Ue.COMPLETED||((g=n.stageInfo)==null?void 0:g.status)===Ue.CANCELLED?b(!0):b(!1):b(!0)},[(E=n.stageInfo)==null?void 0:E.status,$]);const W=()=>{l(o=>({...o,stageUid:(D==null?void 0:D.stageUid)??""})),h(),y(),p(),f(),B(),z(),k(),H(),R()},j=async o=>{var t,g,I;l(m=>({...m,isLoading:{...m.isLoading,loanSummary:!0,propertyAddress:!0,boundaryDetails:!0,finalOpinion:!0,titleObservations:!0,titleSearch:!0,propertyDetails:!0}}));try{const m=await Ce.getStageDetails(n.stageUid);let Z;o||(Z=await Ce.getPropertyDetails(0,10,`uid=${((I=(g=(t=m==null?void 0:m.data)==null?void 0:t.stage)==null?void 0:g.address)==null?void 0:I.uid)??""}`)),ae(m)&&l(L=>{var Q,G,ce;return{...L,stageInfo:(Q=m==null?void 0:m.data)==null?void 0:Q.stage,initiationInfo:{...L.initiationInfo,...mt(m==null?void 0:m.data,(ce=(G=Z==null?void 0:Z.data)==null?void 0:G.results)==null?void 0:ce[0])},loanSummary:{...L.loanSummary,...ht(m==null?void 0:m.data)},propertyDetails:{...L.propertyAddress,...yt(m==null?void 0:m.data)},propertyAddress:{...L.propertyAddress,...xt(m==null?void 0:m.data)},boundaryDetails:{...L.boundaryDetails,...vt(m==null?void 0:m.data)},finalOpinion:{...L.finalOpinion,...Et(m==null?void 0:m.data)},titleObservations:{...L.titleObservations,...Tt(m==null?void 0:m.data)},titleSearch:{...L.titleSearch,...St(m==null?void 0:m.data)},documentScrutinized:{...L.documentScrutinized,...It(m==null?void 0:m.data)},isLoading:{...L.isLoading,...rt},isStageDetailsInitialLoad:!1}})}catch(m){u(J(m)),l(Z=>({...Z,isLoading:{...Z.isLoading,...Oe.isLoading},isStageDetailsInitialLoad:!1}))}},P=async o=>{o||l(t=>({...t,isLoading:{...t.isLoading,otherProvisions:!0}}));try{const t=await oe.getOtherProvisionDetails(n.stageUid);ae(t)&&l(g=>{var I,m,Z;return{...g,otherProvisions:{...g.otherProvisions,isTableLoaded:!0,isTableDataEmptyFromApi:((m=(I=t==null?void 0:t.data)==null?void 0:I.results)==null?void 0:m.length)===0,tableData:Ot((Z=t==null?void 0:t.data)==null?void 0:Z.results),loanUid:(D==null?void 0:D.loanUid)??"",stageUid:n.stageUid},isLoading:{...g.isLoading,...Oe.isLoading}}})}catch(t){u(J(t)),l(g=>({...g,isLoading:{...g.isLoading,otherProvisions:!1}}))}},A=async o=>{o||l(t=>({...t,isLoading:{...t.isLoading,uploadReport:!0}}));try{const t=await oe.getSavedDocuments(n.initiationInfo.legalUid??"");ae(t)&&l(g=>({...g,uploadReport:{...g.uploadReport,...Rt(t==null?void 0:t.data)},isLoading:{...g.isLoading,...Oe.isLoading}}))}catch(t){u(J(t)),l(g=>({...g,isLoading:{...g.isLoading,uploadReport:!1}}))}},h=()=>{de.getAll(0,1e3,"staticMasterType.code=VENDOR_TYPE&").then(o=>{var t;ae(o)&&O("venderType",(t=o==null?void 0:o.data)==null?void 0:t.results)}).catch(o=>{console.log(o),u(J(o))})},y=()=>{de.getAll(0,1e3,"staticMasterType.code=LOAN_TYPE&").then(o=>{var t;ae(o)&&O("typeOfLoan",(t=o==null?void 0:o.data)==null?void 0:t.results)}).catch(o=>{console.log(o),u(J(o))})},p=()=>{de.getAll(0,1e3,"staticMasterType.code=LAND_USE").then(o=>{var t;ae(o)&&O("natureOfLand",(t=o==null?void 0:o.data)==null?void 0:t.results)}).catch(o=>{console.log(o),u(J(o))})},f=()=>{de.getAll(0,1e3,"staticMasterType.code=ADDRESS_TYPE&").then(o=>{var t;ae(o)&&O("addressType",(t=o==null?void 0:o.data)==null?void 0:t.results)}).catch(o=>{console.log(o),u(J(o))})},B=()=>{de.getAll(0,1e3,"staticMasterType.code=DOCUMENT_COPY_TYPE").then(o=>{var t;ae(o)&&O("documentCopyType",(t=o==null?void 0:o.data)==null?void 0:t.results)}).catch(o=>{console.log(o),u(J(o))})},H=()=>{de.getAll(0,1e3,"staticMasterType.code=LOAN_PURPOSE").then(o=>{var t;ae(o)&&O("natureOfTransactions",(t=o==null?void 0:o.data)==null?void 0:t.results)}).catch(o=>{console.log(o),u(J(o))})},z=()=>{de.getAll(0,1e3,"staticMasterType.code=UNIT").then(o=>{var t;ae(o)&&O("units",(t=o==null?void 0:o.data)==null?void 0:t.results)}).catch(o=>{console.log(o),u(J(o))})},k=()=>{de.getAll(0,1e3,"staticMasterType.code=TYPE_OF_MORTGAGE").then(o=>{var t;ae(o)&&O("typeOfMortgage",(t=o==null?void 0:o.data)==null?void 0:t.results)}).catch(o=>{console.log(o),u(J(o))})},R=()=>{de.getAll(0,1e3,"staticMasterType.code=OTHER_PROVISION_QUESTIONS").then(o=>{var t;ae(o)&&O("otherProvisions",(t=o==null?void 0:o.data)==null?void 0:t.results)}).catch(o=>{console.log(o),u(J(o))})},V=()=>{l(o=>({...o,showInfo:!1}))},X=()=>{var o,t;(o=M==null?void 0:M.current)==null||o.refresh(),(t=F==null?void 0:F.current)==null||t.refresh()},i=()=>{var o;(o=C==null?void 0:C.current)==null||o.refresh()},r=()=>{var o;(o=C==null?void 0:C.current)==null||o.refresh()},O=(o,t)=>{l(g=>({...g,dropdownOptions:{...g==null?void 0:g.dropdownOptions,[o]:t??[]}}))},d=()=>{var o,t;return{venderType:(o=n.dropdownOptions)==null?void 0:o.venderType,addressType:(t=n.dropdownOptions)==null?void 0:t.addressType}},N=()=>({typeOfLoan:n.dropdownOptions.typeOfLoan,natureOfTransactions:n.dropdownOptions.natureOfTransactions,units:n.dropdownOptions.units,typeOfMortgage:n.dropdownOptions.typeOfMortgage,natureOfLand:n.dropdownOptions.natureOfLand});return e.jsxs("div",{className:"grid gap-5 mb-5",children:[n!=null&&n.showInfo?e.jsx(pt,{description:"description.legal.info",onClose:V}):null,e.jsx(Vt,{isLoadingInitial:n.isStageDetailsInitialLoad,data:n==null?void 0:n.initiationInfo,dropdownOptions:d()}),e.jsxs(re,{override:{read:T},children:[n.initiationInfo.showOnlyUploadReport?null:e.jsx(je,{title:"heading.legal.legalReport",className:"",children:e.jsxs(e.Fragment,{children:[e.jsx(kt,{isLoading:n.isLoading.loanSummary,isLoadingInitial:n.isStageDetailsInitialLoad,data:n==null?void 0:n.loanSummary,getDetailsCallback:()=>j(!0)}),e.jsx(Xt,{dropDownOptions:N(),isLoading:n.isLoading.propertyDetails,isLoadingInitial:n.isStageDetailsInitialLoad,data:n==null?void 0:n.propertyDetails,getDetailsCallback:()=>j(!0)}),e.jsx(Kt,{isLoading:n.isLoading.propertyAddress,isLoadingInitial:n.isStageDetailsInitialLoad,data:n==null?void 0:n.propertyAddress,getDetailsCallback:j}),e.jsx(_t,{isLoading:n.isLoading.propertyAddress,isLoadingInitial:n.isStageDetailsInitialLoad,data:n==null?void 0:n.boundaryDetails,getDetailsCallback:()=>j(!0)}),e.jsx(Dt,{dropDownOptions:{documentCopyType:((a=n==null?void 0:n.dropdownOptions)==null?void 0:a.documentCopyType)??[]},data:{stageUid:n.stageUid,applicantUid:n==null?void 0:n.documentScrutinized.applicantUid,loanUid:n==null?void 0:n.documentScrutinized.loanUid},ref:C,updatedRelatedTableCallback:X}),e.jsx(ke,{title:"heading.legal.flowOfProperty",section:be.TITLE_OBSERVATION,isLoading:n.isLoading.titleObservations,isLoadingInitial:n.isStageDetailsInitialLoad,data:n==null?void 0:n.titleObservations,getDetailsCallback:()=>j(!0)}),e.jsx(ke,{title:"heading.legal.titleSearch*",section:be.TITLE_SEARCH,isLoading:n.isLoading.titleSearch,isLoadingInitial:n.isStageDetailsInitialLoad,data:n==null?void 0:n.titleSearch,getDetailsCallback:()=>j(!0)}),e.jsx(Ct,{isLoading:n.isLoading.propertyAddress,isLoadingInitial:n.isStageDetailsInitialLoad,data:n==null?void 0:n.finalOpinion,getDetailsCallback:()=>j(!0)}),e.jsx(zt,{isLoading:n.isLoading.otherProvisions,dropDownOptions:{otherProvisions:((v=n==null?void 0:n.dropdownOptions)==null?void 0:v.otherProvisions)??[]},data:(n==null?void 0:n.otherProvisions)??[],getDetailsCallback:()=>P(!0)}),e.jsx(Ve,{dropDownOptions:{documentCopyType:((x=n==null?void 0:n.dropdownOptions)==null?void 0:x.documentCopyType)??[]},data:{stageUid:n.stageUid,applicantUid:n==null?void 0:n.documentScrutinized.applicantUid,loanUid:n==null?void 0:n.documentScrutinized.loanUid},section:Te.PRE_DISBURSEMENT,ref:M,updatedRelatedTableCallback:i}),e.jsx(Ve,{dropDownOptions:{documentCopyType:((Y=n==null?void 0:n.dropdownOptions)==null?void 0:Y.documentCopyType)??[]},data:{stageUid:n.stageUid,applicantUid:n==null?void 0:n.documentScrutinized.applicantUid,loanUid:n==null?void 0:n.documentScrutinized.loanUid},section:Te.POST_DISBURSEMENT,ref:F,updatedRelatedTableCallback:r})]})}),e.jsx(je,{title:"heading.legal.legalReport",children:e.jsx(Gt,{isLoading:n.isLoading.uploadReport,data:n.uploadReport,getDetailsCallback:()=>A(!0)})})]}),e.jsx(le,{onHide:()=>{c(!1),u("")},visible:q,errorMessage:U})]})};export{ws as default};
//# sourceMappingURL=PageReport-ad7bd11b.js.map
