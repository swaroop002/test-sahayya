import{b3 as Ee,r as i,aF as E,ad as ge,ae as fe,af as xe,j as e,ax as je,T as ie,aA as Ce,aa as Ze,o as F,aG as Ie,d7 as ke,aH as Me,ao as oe,cn as Mt,b2 as Ae,R as He,f5 as wt,eD as pe,c8 as Yt,eW as vt,v as Ne,J as Nt,q as en,S as tn,dl as lt,ey as nn,fl as sn}from"./index-e8217573.js";import{E as Le}from"./ErrorDialog-d5eef4d7.js";import{I as on}from"./Info-6f3aa97c.js";import{S as at}from"./Section-00ef9f2b.js";import{S as Fe}from"./StaticMasterDataService-689a6eca.js";import{S as Pt}from"./StageService-c1c03c89.js";import{T as ye}from"./TechnicalService-8f4efd87.js";import{I as V}from"./InputBox-b9e88f52.js";import{R as Oe}from"./RadioButton-86c37166.js";import{S as Ye}from"./SaveComponent-160c5b32.js";import{S as Re}from"./SimpleDropDown-061a3470.js";import{S as Ue}from"./Skeleton-7e12d019.js";import{T as Be}from"./Toast-ae99ea5b.js";import{A as Bt}from"./Address-75e58af3.js";import{S as Wt}from"./SystemDatePicker-abe08a29.js";import{I as we}from"./InputTextArea-b90aad1d.js";import{A as bt}from"./AutoComplete-0bca608a.js";import{C as me,E as At}from"./EditableTableV2-6afcb42b.js";import{I as ut,B as dt}from"./IconButton-36693dd9.js";import{i as rn,M as cn}from"./MediaGallery-5884b284.js";import{R as mt}from"./ReadOnlyTable-86accb69.js";import{C as ln}from"./BaseChips-c7cc0dee.js";import{a as _t}from"./CustomHooks-0ce50620.js";import{T as et}from"./TextData-06df331b.js";import{D as Dt,a as ct}from"./DocumentUploader-e2ec1a13.js";import{B as St}from"./ButtonBox-9e46519a.js";import{C as an}from"./CheckBox-8a0c0e77.js";import{R as un}from"./RichTextEditor-a03bd2fb.js";import{u as dn}from"./useSelector-dc41929a.js";import"./Dialog-adadaf64.js";import"./withAuth-6de36ebf.js";import"./link-0172a3d4.js";import"./loader-5f2cfb31.js";import"./FileUploadMenuBox-f47dc693.js";import"./kebab-menu-8835ad2e.js";import"./MenuBox-defc36b0.js";import"./virtualscroller.esm-9939945c.js";import"./TransitionGroup-c8afe0ce.js";import"./esm-70d64670.js";import"./index-8739acfd.js";import"./TextButton-41b4a67e.js";import"./City-7102c574.js";import"./Pincode-a7c9b067.js";import"./DatePicker-b1c13861.js";import"./search_icon-459d6871.js";import"./datatable.esm-f474a654.js";import"./paginator.esm-11c2c115.js";import"./sortIcon-54357a29.js";import"./Download_Icon-51fc7f46.js";import"./eye_icon-081bddb3.js";import"./FileUploadService-1aaf11f7.js";import"./No_data-1720c54e.js";import"./FileUploadCustom-5ab7fd25.js";import"./Loading-783a01c7.js";import"./DocumentService-a293b5f4.js";const mn=(t,o)=>{var x,a,s,C,O,_,T,J,M,H,Q,Z,L,j,h,u,G,X;const p={PERMANENT:"Permanent",RESIDENTIAL:"Residential",EMPLOYEMENT_ADDRESS:"Employment Address",COLLATERAL_PROPERTY:"Collateral Property"},A=JSON.parse(t!=null&&t.ccEmail?t==null?void 0:t.ccEmail:"{}");return{dateOfInitiation:(x=t==null?void 0:t.stage)==null?void 0:x.createdAtSystemDate,vendorType:((a=t==null?void 0:t.stage)==null?void 0:a.smStageType)??"",internalAssignee:{name:((C=(s=t==null?void 0:t.stage)==null?void 0:s.assignee)==null?void 0:C.name)??""},externalVendor:{name:((_=(O=t==null?void 0:t.stage)==null?void 0:O.partner)==null?void 0:_.name)??""},addressType:p[`${(J=(T=t==null?void 0:t.stage)==null?void 0:T.address)==null?void 0:J.primaryAddressType}`]??"",CCEmails:Array.isArray(A)?A:[],description:(M=t==null?void 0:t.stage)==null?void 0:M.remarks,address:(o==null?void 0:o.address)??"",propertyType:(o==null?void 0:o.propertyType)??"",pincode:{pinCode:(H=o==null?void 0:o.pincode)==null?void 0:H.pinCode,uid:(Q=o==null?void 0:o.pincode)==null?void 0:Q.uid},city:{name:(Z=o==null?void 0:o.city)==null?void 0:Z.name,uid:(L=o==null?void 0:o.city)==null?void 0:L.uid},state:(h=(j=o==null?void 0:o.city)==null?void 0:j.state)==null?void 0:h.name,latitude:o!=null&&o.latitude?`${parseFloat(o.latitude).toFixed(4)}`:"",longitude:o!=null&&o.longitude?`${parseFloat(o==null?void 0:o.longitude).toFixed(4)}`:"",stageDocuments:(u=t==null?void 0:t.stage)!=null&&u.stageDocuments?(X=(G=t==null?void 0:t.stage)==null?void 0:G.stageDocuments)==null?void 0:X.filter($=>($==null?void 0:$.isSharedAtInitiation)===!0):[]}},Ct=t=>{var p,A,d,x,a,s,C,O,_,T,J,M,H,Q,Z,L,j,h,u,G,X,$;return{dateOfVisit:t!=null&&t.dateOfVisit?new Date(t==null?void 0:t.dateOfVisit):"",customerName:((A=(p=t==null?void 0:t.stage)==null?void 0:p.applicant)==null?void 0:A.firstName)??"",ownershipName:(t==null?void 0:t.ownerName)??"",typeOfCase:((x=(d=t==null?void 0:t.loan)==null?void 0:d.product)==null?void 0:x.name)??"",address:{address:((a=t==null?void 0:t.address)==null?void 0:a.address)??"",smAddressType:((s=t==null?void 0:t.address)==null?void 0:s.smAddressType)??"",propertyType:((C=t==null?void 0:t.address)==null?void 0:C.propertyType)??"",pincode:{pinCode:(_=(O=t==null?void 0:t.address)==null?void 0:O.pincode)==null?void 0:_.pinCode,uid:(J=(T=t==null?void 0:t.address)==null?void 0:T.pincode)==null?void 0:J.uid},city:{name:(H=(M=t==null?void 0:t.address)==null?void 0:M.city)==null?void 0:H.name,uid:(Z=(Q=t==null?void 0:t.address)==null?void 0:Q.city)==null?void 0:Z.uid},state:((h=(j=(L=t==null?void 0:t.address)==null?void 0:L.city)==null?void 0:j.state)==null?void 0:h.name)??"",latitude:(u=t==null?void 0:t.address)!=null&&u.latitude?`${parseFloat((G=t==null?void 0:t.address)==null?void 0:G.latitude).toFixed(4)}`:"",longitude:(X=t==null?void 0:t.address)!=null&&X.longitude?`${parseFloat(($=t==null?void 0:t.address)==null?void 0:$.longitude).toFixed(4)}`:""}}},Ot=t=>{var p,A,d,x,a,s,C,O,_,T,J,M,H,Q,Z,L;return{layoutPlanProvided:((A=(p=t==null?void 0:t.stage)==null?void 0:p.technical)==null?void 0:A.isLayoutPlanProvided)??"",approvingAuthority:((x=(d=t==null?void 0:t.stage)==null?void 0:d.technical)==null?void 0:x.approvingAuthority)??"",approvalNo:((s=(a=t==null?void 0:t.stage)==null?void 0:a.technical)==null?void 0:s.approvalNo)??"",constructionAsPerPlanned:((O=(C=t==null?void 0:t.stage)==null?void 0:C.technical)==null?void 0:O.buildingConstructionAsPerPlan)??"",planProvided:((T=(_=t==null?void 0:t.stage)==null?void 0:_.technical)==null?void 0:T.isPlanProvided)??"",areaOfProperty:((M=(J=t==null?void 0:t.stage)==null?void 0:J.technical)==null?void 0:M.areaOfPropertyAsPerDoc)??"",units:((Q=(H=t==null?void 0:t.stage)==null?void 0:H.technical)==null?void 0:Q.areaUnit)??"",holdingType:((L=(Z=t==null?void 0:t.stage)==null?void 0:Z.technical)==null?void 0:L.smHoldingType)??""}},Et=t=>{var p,A,d,x,a,s,C,O;return{classOfLocality:((A=(p=t==null?void 0:t.stage)==null?void 0:p.technical)==null?void 0:A.smClassOfLocality)??"",distanceFromCity:((x=(d=t==null?void 0:t.stage)==null?void 0:d.technical)==null?void 0:x.distanceFromCityCenter)??"",nearbyBusStop:((s=(a=t==null?void 0:t.stage)==null?void 0:a.technical)==null?void 0:s.distanceFromNearByBusstop)??"",developmentInVicinity:((O=(C=t==null?void 0:t.stage)==null?void 0:C.technical)==null?void 0:O.vicinityDevelopmentPct)??""}},jt=t=>{var A;return{boundariesOnSiteTable:(()=>[{direction:"North",uid:"1",actualOnSite:(t==null?void 0:t.boundaryNorthAsActual)??"",asPerDoc:(t==null?void 0:t.boundaryNorthAsPerDoc)??""},{direction:"South",uid:"2",actualOnSite:(t==null?void 0:t.boundarySouthAsActual)??"",asPerDoc:(t==null?void 0:t.boundarySouthAsPerDoc)??""},{direction:"East",uid:"3",actualOnSite:(t==null?void 0:t.boundaryEastAsActual)??"",asPerDoc:(t==null?void 0:t.boundaryEastAsPerDoc)??""},{direction:"West",uid:"4",actualOnSite:(t==null?void 0:t.boundaryWestAsActual)??"",asPerDoc:(t==null?void 0:t.boundaryWestAsPerDoc)??""}])(),boundariesMatching:(t==null?void 0:t.isPropertyBoundaryMatching)??"",landUse:(t==null?void 0:t.smLandUse)??"",propertyDescription:(t==null?void 0:t.propertyDescription)??"",noOfFloors:(t==null?void 0:t.noOfFloors)??"",noOfLifts:(t==null?void 0:t.noOfLift)??"",noOfFlatsPerFloor:(t==null?void 0:t.noOfFlatsPerFloor)??"",noOfWings:(t==null?void 0:t.noOfWings)??"",structureDescription:(t==null?void 0:t.structureDescription)??"",conditionOfProperty:(t==null?void 0:t.smConditionOfProperty)??"",yearOfConstruction:(t==null?void 0:t.yearOfConstruction)??"",ageOfProperty:(t==null?void 0:t.ageOfProperty)??"",approachRoadType:(t==null?void 0:t.smApproachRoadType)??"",approachRoadWidth:(t==null?void 0:t.approachRoadWidth)??"",propertyNearHighTensionLine:(t==null?void 0:t.isPropertyNearHighTensionLine)??"",distanceFromHighTensionLine:(t==null?void 0:t.distanceFromHighTensionLine)??"",marketFeedback:(t==null?void 0:t.marketFeedback)??"",marketability:(t==null?void 0:t.smMarketability)??"",planAsPerDcrNorms:(t==null?void 0:t.isPlanAsPerDcrNorms)??"",noOfFloorsPermitted:(t==null?void 0:t.noOfFloorsPermiteed)??"",numberOfFloorConstructed:(t==null?void 0:t.noOfFloorsConstructed)??"",fsiAchieved:(t==null?void 0:t.fsiAchieved)??"",riskOfDemolition:(t==null?void 0:t.smRiskOfDemolition)??"",setbackDeviation:(t==null?void 0:t.setbackDeviationPct)??"",horizontalDeviation:(t==null?void 0:t.horizontalDeviationPct)??"",stageChecklists:(t==null?void 0:t.stageChecklists)??[],isQuestionsTableDataEmptyFromApi:!(((A=t==null?void 0:t.stageChecklists)==null?void 0:A.length)>0)}},Tt=t=>{const o=`${Ee(t==null?void 0:t.fairMarketValue,"en-IN",0)}`,p=`${Ee(t==null?void 0:t.totalMarketValueOnCompletion,"en-IN",0)}`,A=`${Ee(t==null?void 0:t.forcedSaleValue,"en-IN",0)}`;return{fairMarketValue:o,totalPropertyValueOnCompletion:p==="0"?"":p,forcedSaleValue:A==="0"?"":A,stagePropertyValuations:[...(t==null?void 0:t.stagePropertyValuations)??[]],stagePropertyAmenities:[...(t==null?void 0:t.stagePropertyAmenities)??[]]}},Rt=t=>{var p,A,d,x,a;return{uid:((p=t==null?void 0:t.stageConstructionDetail)==null?void 0:p.uid)??"",structureDescription:((A=t==null?void 0:t.stageConstructionDetail)==null?void 0:A.constructionStructureDescription)??"",descriptionOfStage:((d=t==null?void 0:t.stageConstructionDetail)==null?void 0:d.constructionStageDescription)??"",technicalPct:((x=t==null?void 0:t.stageConstructionDetail)==null?void 0:x.technicalPct)??"",recommendedPct:((a=t==null?void 0:t.stageConstructionDetail)==null?void 0:a.recommendedPct)??""}},It=t=>{var s,C,O,_,T,J,M,H,Q,Z,L,j,h,u;const o=Ee((C=(s=t==null?void 0:t.stage)==null?void 0:s.technical)==null?void 0:C.govtCircleRateOfLand,"en-IN",0),p=Ee((_=(O=t==null?void 0:t.stage)==null?void 0:O.technical)==null?void 0:_.govtCircleRateOfBuilding,"en-IN",0),A=Ee((J=(T=t==null?void 0:t.stage)==null?void 0:T.technical)==null?void 0:J.govtLandValue,"en-IN",0),d=Ee((H=(M=t==null?void 0:t.stage)==null?void 0:M.technical)==null?void 0:H.govtTotalValuationOfProperty,"en-IN",0),x=Ee((Z=(Q=t==null?void 0:t.stage)==null?void 0:Q.technical)==null?void 0:Z.govtFlatAptValue,"en-IN",0);return{uid:((j=(L=t==null?void 0:t.stage)==null?void 0:L.technical)==null?void 0:j.uid)??"",circleRateOfLand:`${o||""}`,circleRateOfBuilding:`${p||""}`,landValue:`${A||""}`,totalValuationOfProperty:`${d||""}`,flatOrAptValue:`${x||""}`,remarks:((u=(h=t==null?void 0:t.stage)==null?void 0:h.technical)==null?void 0:u.govtGuidelineRemarks)??""}},Lt=t=>{var p,A,d,x,a,s,C,O,_,T;return{uid:((A=(p=t==null?void 0:t.stage)==null?void 0:p.technical)==null?void 0:A.uid)??"",stateOfOccupancy:((x=(d=t==null?void 0:t.stage)==null?void 0:d.technical)==null?void 0:x.smStatusOccupancy)??"",occupiedBy:((s=(a=t==null?void 0:t.stage)==null?void 0:a.technical)==null?void 0:s.occupiedByRelationshipWithCustomer)??"",occupiedSince:((O=(C=t==null?void 0:t.stage)==null?void 0:C.technical)==null?void 0:O.occupiedSinceYear)??"",personAtSite:((T=(_=t==null?void 0:t.stage)==null?void 0:_.technical)==null?void 0:T.personAvailableAtSite)??""}},Ut=t=>{const o=d=>{const x=d.map(a=>({uid:a.uid,fileName:a.fileName,fileType:a.fileType,section:a.section,sectionName:a.sectionName,thumbUrl:a.thumbUrl,url:a.url,isActive:a.isActive}));return x.length?x:[{uid:"",fileName:"",fileType:"",section:"",sectionName:"",thumbUrl:"",url:"",isActive:!1}]};return{savedDocuments:[...(d=>d==null?void 0:d.map(a=>({uid:a.uid,attributes:{...a.attributes},docCategory:a.docCategory,docFor:a.docFor,docType:{...a.docType},documentSections:o(a.documentSections),loanSectionKey:a.loanSectionKey??"",isActive:a.isActive})))((t==null?void 0:t.loanDocuments)??[])]}},Ft=t=>{var p,A,d,x,a,s,C,O;return{status:((A=(p=t==null?void 0:t.stage)==null?void 0:p.technical)==null?void 0:A.smTechnicalStatus)??"",remarks:((x=(d=t==null?void 0:t.stage)==null?void 0:d.technical)==null?void 0:x.overallTechnicalRemarks)??"",engineerName:((s=(a=t==null?void 0:t.stage)==null?void 0:a.technical)==null?void 0:s.inspectionEngineerName)??"",declaration:((O=(C=t==null?void 0:t.stage)==null?void 0:C.technical)==null?void 0:O.isDeclarationChecked)??!1}},kt=t=>{const o=d=>{const x=d.map(a=>({uid:a.uid,fileName:a.fileName,fileType:a.fileType,section:a.section,sectionName:a.sectionName,thumbUrl:a.thumbUrl,url:a.url,isActive:a.isActive}));return x.length?x:[{uid:"",fileName:"",fileType:"",section:"",sectionName:"",thumbUrl:"",url:"",isActive:!1}]};return{savedDocuments:[...(d=>d==null?void 0:d.map(a=>({uid:a.uid,attributes:{...a.attributes},docCategory:a.docCategory,docFor:a.docFor,docType:{...a.docType},documentSections:o(a.documentSections),loanSectionKey:a.loanSectionKey??"",isActive:a.isActive})))(t.loanDocuments)]}},Gt={layoutPlanProvided:"",planProvided:"",approvalNo:"",approvingAuthority:"",constructionAsPerPlanned:"",areaOfProperty:"",holdingType:"",units:""},Ge={YES:"YES",NO:"NO"},hn=t=>{var Y,b,U,ee,ce,de;const{data:o,isLoading:p,getDataOnCancel:A,payloadInfo:d,dropDownOptions:x}=t,[a,s]=i.useState({...Gt}),[C,O]=i.useState(E.VIEW),[_,T]=i.useState(""),[J,M]=i.useState(!1),[H,Q]=i.useState(""),[Z,L]=i.useState(!1),j=i.useRef(null),[,h]=i.useState(!1),u=i.useRef(new ge({validators:{...fe()},...xe(),autoForceUpdate:{forceUpdate:()=>h(z=>!z)}}));i.useEffect(()=>{o&&Object.keys(o).length>0&&s(()=>({...o}))},[o]),i.useEffect(()=>{var z;j!=null&&j.current&&_!==""&&((z=j==null?void 0:j.current)==null||z.showFunction(),T(""))},[_,J]),i.useEffect(()=>{H&&L(!0)},[H]);const G=z=>{s(le=>({...le,[z.target.name]:z.target.value}))},X=z=>{var le,ve;(ve=u==null?void 0:u.current)==null||ve.showMessageFor((le=z==null?void 0:z.target)==null?void 0:le.name)},$=()=>{var le,ve;let z=!1;return z=((le=u==null?void 0:u.current)==null?void 0:le.allValid())??!1,z||(h(be=>!be),(ve=u==null?void 0:u.current)==null||ve.showMessages(),h(be=>!be),!1)},c=async()=>{if(!$())return;const z=R();try{const le=await ye.updateDocumentDetails(z);ke(le)&&(T(Me.SAVED),M(!J),O(E.VIEW))}catch(le){console.log(le),Q(oe(le))}},D=()=>O(E.EDIT),S=()=>{A==null||A(),N(),O(E.VIEW)},R=()=>({uid:d.technicalUid,loan:{uid:d.loanUid},stage:{uid:d.stageUid},isLayoutPlanProvided:a.layoutPlanProvided==Ge.YES,isPlanProvided:a.planProvided==Ge.YES,approvingAuthority:a.approvingAuthority,approvalNo:a.approvalNo,buildingConstructionAsPerPlan:a.constructionAsPerPlanned,areaOfPropertyAsPerDoc:a.areaOfProperty,areaUnit:a.units,smHoldingType:a.holdingType}),N=()=>{var z;u.current=new ge({validators:{...fe()},...xe(),autoForceUpdate:{forceUpdate:()=>h(le=>!le)}}),(z=u==null?void 0:u.current)==null||z.hideMessages()},{approvingAuthority:m,approvalNo:g,areaOfProperty:v,constructionAsPerPlanned:y,holdingType:k,layoutPlanProvided:re,planProvided:ue,units:I}=a;return e.jsxs("div",{children:[e.jsx(Ye,{title:"heading.technical.documentDetails",pageMode:C,disabled:p,onSave:c,onCancel:S,onEdit:D,children:p?e.jsx(Ue,{height:"19.375rem",width:"100%",borderRadius:"8px",animation:"wave"}):e.jsx(je,{override:{read:C===E.VIEW},children:e.jsxs("div",{className:"grid grid-cols-4 gap-3  ",children:[e.jsxs("div",{className:"col-span-1 flex flex-col justify-center items-start space-y-1",children:[e.jsx(ie,{className:"text-xs text-primary-ptext-1000",label:"label.technical.layoutPlanProvided*"}),e.jsxs("div",{className:"flex gap-5",children:[e.jsxs("div",{className:"mr-5 flex",children:[e.jsx(Oe,{hideLabel:!0,hideErrorRow:!0,name:"layoutPlanProvided",variant:Ce.PRIMARY,value:Ge.YES,checked:re===Ge.YES,onChange:G,disabled:C===E.VIEW}),e.jsx(ie,{className:"ml-1.5 text-xs ",label:"label.dde.yes"})]}),e.jsxs("div",{className:"flex",children:[e.jsx(Oe,{hideLabel:!0,hideErrorRow:!0,name:"layoutPlanProvided",variant:Ce.PRIMARY,value:Ge.NO,checked:re===Ge.NO,onChange:G,disabled:C===E.VIEW}),e.jsx(ie,{className:"ml-1.5 text-xs ",label:"label.dde.no"})]})]}),e.jsx("div",{className:"h-4 flex justify-start  items-center",children:e.jsx(Ze,{validation:(Y=u==null?void 0:u.current)==null?void 0:Y.message("layoutPlanProvided",re,"mandatory")})})]}),e.jsx("div",{children:e.jsx(V,{label:"label.technical.approvingAuthority",name:"approvingAuthority",variant:F.SECONDARY,value:m??"",onChange:G})}),e.jsx("div",{children:e.jsx(V,{label:"label.technical.approvalNo.",name:"approvalNo",className:"text-right",variant:F.SECONDARY,value:g??"",onChange:G})}),e.jsx("div",{children:e.jsx(V,{label:"label.technical.buildingConstructionAsPerPlanned*",name:"constructionAsPerPlanned",variant:F.SECONDARY,value:y??"",onChange:G,onBlur:X,validation:(b=u==null?void 0:u.current)==null?void 0:b.message("constructionAsPerPlanned",y,"mandatory")})}),e.jsxs("div",{className:"col-span-1 flex flex-col justify-center items-start space-y-1",children:[e.jsxs("div",{children:[e.jsx(ie,{className:"text-xs text-primary-ptext-1000",label:"label.technical.planProvided*"}),e.jsxs("div",{className:"flex gap-5",children:[e.jsxs("div",{className:"mr-5 flex",children:[e.jsx(Oe,{hideLabel:!0,hideErrorRow:!0,name:"planProvided",variant:Ce.PRIMARY,value:Ge.YES,checked:ue===Ge.YES,onChange:G,disabled:C===E.VIEW}),e.jsx(ie,{className:"ml-1.5 text-xs ",label:"label.dde.yes"})]}),e.jsxs("div",{className:"flex",children:[e.jsx(Oe,{hideLabel:!0,hideErrorRow:!0,name:"planProvided",variant:Ce.PRIMARY,value:Ge.NO,checked:ue===Ge.NO,onChange:G,disabled:C===E.VIEW}),e.jsx(ie,{className:"ml-1.5 text-xs ",label:"label.dde.no"})]})]})]}),e.jsx("div",{className:"h-4 flex justify-start  items-center",children:e.jsx(Ze,{validation:(U=u==null?void 0:u.current)==null?void 0:U.message("planProvided",ue,"mandatory")})})]}),e.jsx("div",{children:e.jsx(V,{label:"label.legal.areaOfPropertyMandatory",name:"areaOfProperty",className:"text-right",variant:F.SECONDARY,value:v??"",onChange:G,onBlur:X,validation:(ee=u==null?void 0:u.current)==null?void 0:ee.message("areaOfProperty",v,"mandatory|checkNumber|onlyPositive|maxDecimal:2")})}),e.jsx("div",{children:e.jsx(Re,{label:"label.legal.unitsMandatory",placeholder:"placeholder.legal.unitsMandatory",name:"units",value:I,onChange:G,onBlur:X,options:x.units,optionLabel:"name",optionValue:"code",validation:(ce=u==null?void 0:u.current)==null?void 0:ce.message("units",I,"mandatory")})}),e.jsx("div",{children:e.jsx(Re,{label:"label.technical.holdingType*",placeholder:"placeholder.technical.holdingType",name:"holdingType",value:k,onChange:G,onBlur:X,options:x.holdingType,optionLabel:"name",optionValue:"code",validation:(de=u==null?void 0:u.current)==null?void 0:de.message("holdingType",k,"mandatory")})})]})})}),e.jsx(Be,{position:"bottom-right",ref:j,toastText:_,variant:Ie.PRIMARY}),e.jsx(Le,{onHide:()=>{L(!1),Q("")},visible:Z,errorMessage:H})]})},Vt={dateOfVisit:"",customerName:"",ownershipName:"",typeOfCase:"",address:{address:"",pincode:{pinCode:"",uid:""},city:{name:"",uid:""},state:"",latitude:"",longitude:"",smAddressType:"",propertyType:""}},pn=t=>{var re,ue;const{data:o,isLoading:p,getDataOnCancel:A,payloadInfo:d}=t,[x,a]=i.useState({...Vt}),[s,C]=i.useState(E.VIEW),[O,_]=i.useState(""),[T,J]=i.useState(!1),[M,H]=i.useState(""),[Q,Z]=i.useState(!1),L=i.useRef(null),j=i.useRef(null),[,h]=i.useState(!1),u=i.useRef(new ge({validators:{...fe()},...xe(),autoForceUpdate:{forceUpdate:()=>h(I=>!I)}}));i.useEffect(()=>{o&&Object.keys(o).length>0&&a(()=>({...o}))},[o]),i.useEffect(()=>{var I;L!=null&&L.current&&O!==""&&((I=L==null?void 0:L.current)==null||I.showFunction(),_(""))},[O,T]),i.useEffect(()=>{M&&Z(!0)},[M]);const G=I=>{a(Y=>({...Y,[I.target.name]:I.target.value}))},X=I=>{var Y,b;(b=u==null?void 0:u.current)==null||b.showMessageFor((Y=I==null?void 0:I.target)==null?void 0:Y.name)},$=()=>{var Y,b;let I=!1;return I=((Y=u==null?void 0:u.current)==null?void 0:Y.allValid())??!1,I||(h(U=>!U),(b=u==null?void 0:u.current)==null||b.showMessages(),h(U=>!U),!1)},c=async()=>{var b;const I=(b=j==null?void 0:j.current)==null?void 0:b.save();if(!$()||!I)return;const Y=R(I);try{const U=await ye.updateGeneralDetails(Y);ke(U)&&(_(Me.SAVED),J(!T),C(E.VIEW))}catch(U){console.log(U),H(oe(U))}},D=()=>C(E.EDIT),S=()=>{var I;A==null||A(),N(),(I=j.current)==null||I.resetValidator(),C(E.VIEW)},R=I=>({uid:d.technicalUid,loan:{uid:d.loanUid},stage:{uid:d.stageUid},dateOfVisit:x.dateOfVisit,typeOfCase:x.typeOfCase,customerName:x.customerName,ownerName:x.ownershipName,address:{uid:I.uid??null,address:I.address,pincode:{uid:I.pincode.uid},city:{uid:I.city.uid},latitude:Number(parseFloat(I.latitude).toFixed(4)),longitude:Number(parseFloat(I.longitude).toFixed(4))}}),N=()=>{var I;u.current=new ge({validators:{...fe()},...xe(),autoForceUpdate:{forceUpdate:()=>h(Y=>!Y)}}),(I=u==null?void 0:u.current)==null||I.hideMessages()},m=i.useMemo(()=>{const{address:I,city:Y,state:b,latitude:U,longitude:ee,pincode:ce,propertyType:de}=x.address;return{address:I,pincode:ce,city:Y,state:b,latitude:U,longitude:ee,propertyType:de}},[x==null?void 0:x.address]),{dateOfVisit:g,typeOfCase:v,customerName:y,ownershipName:k}=x;return e.jsxs("div",{children:[e.jsx(Ye,{title:"heading.technical.generalDetails",pageMode:s,disabled:p,onSave:c,onCancel:S,onEdit:D,children:p?e.jsx(Ue,{height:"19.375rem",width:"100%",borderRadius:"8px",animation:"wave"}):e.jsx(je,{override:{read:s===E.VIEW},children:e.jsxs("div",{className:"grid grid-cols-4 gap-3  ",children:[e.jsx("div",{children:e.jsx(Wt,{label:"label.technical.dateOfVisit*",name:"dateOfVisit",value:g,variant:F.SECONDARY,onChange:G,onBlur:X,validation:(re=u==null?void 0:u.current)==null?void 0:re.message("dateOfVisit",g,"mandatory")})}),e.jsx("div",{children:e.jsx(V,{label:"label.technical.typeOfCase*",name:"typeOfCase",variant:F.SECONDARY,value:v??"",disabled:!0})}),e.jsx("div",{children:e.jsx(V,{label:"label.pd.customer.name.mandatory",name:"customerName",variant:F.SECONDARY,value:y??"",disabled:!0})}),e.jsx("div",{children:e.jsx(V,{label:"label.technical.ownershipName*",name:"ownershipName",variant:F.SECONDARY,onChange:G,value:k??"",onBlur:X,validation:(ue=u==null?void 0:u.current)==null?void 0:ue.message("ownershipName",k,"mandatory")})}),e.jsx("div",{className:"col-span-4",children:e.jsx(Bt,{pageMode:s,ref:j,data:m,variant:Mt.SECONDARY,addressLabel:"label.technical.addressAsPerActualSite",addressMaxCount:2e3,isLatLong:!0})})]})})}),e.jsx(Be,{position:"bottom-right",ref:L,toastText:O,variant:Ie.PRIMARY}),e.jsx(Le,{onHide:()=>{Z(!1),H("")},visible:Q,errorMessage:M})]})},$t={uid:"",circleRateOfLand:"",circleRateOfBuilding:"",landValue:"",totalValuationOfProperty:"",flatOrAptValue:"",remarks:""},gn=t=>{const{data:o=$t,isLoading:p,payloadInfo:A,getDataOnCancel:d}=t,[x,a]=i.useState(o),[s,C]=i.useState(E.VIEW),[O,_]=i.useState(""),[T,J]=i.useState(!1),[M,H]=i.useState(""),[Q,Z]=i.useState(!1),L=i.useRef(null),[,j]=i.useState(!1),h=i.useRef(new ge({validators:{...fe()},...xe(),autoForceUpdate:{forceUpdate:()=>j(g=>!g)}}));i.useEffect(()=>{o&&Object.keys(o).length>0&&a(()=>({...o}))},[o]),i.useEffect(()=>{var g;L!=null&&L.current&&O!==""&&((g=L==null?void 0:L.current)==null||g.showFunction(),_(""))},[O,T]),i.useEffect(()=>{M&&Z(!0)},[M]);const u=g=>{var v,y;(y=h==null?void 0:h.current)==null||y.showMessageFor((v=g==null?void 0:g.target)==null?void 0:v.name)},G=()=>{var v,y;let g=!1;return g=(v=h==null?void 0:h.current)==null?void 0:v.allValid(),g||(j(k=>!k),(y=h==null?void 0:h.current)==null||y.showMessages(),j(k=>!k),!1)},X=()=>{var g;h.current=new ge({validators:{...fe()},...xe(),autoForceUpdate:{forceUpdate:()=>j(v=>!v)}}),(g=h==null?void 0:h.current)==null||g.hideMessages()},$=g=>{const v=Ae(g.target.value);a(y=>({...y,[g.target.name]:Ee(v,"en-IN",0)}))},c=g=>{a(v=>({...v,[g.target.name]:g.target.value}))},D=async()=>{if(!G())return;const g=N();try{const v=await ye.updateGovtGuidelines(g);ke(v)&&(_(Me.SAVED),J(!T),C(E.VIEW))}catch(v){console.log(v),H(oe(v))}},S=()=>C(E.EDIT),R=()=>{d==null||d(),X(),C(E.VIEW)},N=()=>({uid:A.technicalUid,loan:{uid:A.loanUid},stage:{uid:A.stageUid},govtCircleRateOfLand:Ae(x.circleRateOfLand),govtCircleRateOfBuilding:Ae(x.circleRateOfBuilding),govtLandValue:Ae(x.landValue),govtTotalValuationOfProperty:Ae(x.totalValuationOfProperty),govtFlatAptValue:Ae(x.flatOrAptValue),govtGuidelineRemarks:x.remarks}),m=()=>{var I,Y,b,U,ee;const{circleRateOfLand:g,circleRateOfBuilding:v,landValue:y,totalValuationOfProperty:k,flatOrAptValue:re,remarks:ue}=x;return e.jsxs(He.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-4 gap-x-4 gap-y-5 mt-5",children:[e.jsx("div",{className:"col-span-1",children:e.jsx(V,{variant:F.SECONDARY,label:"label.technical.governmentGuideLines.circleRateOfLand*",name:"circleRateOfLand",className:"text-right",value:g,onChange:$,onBlur:u,validation:(I=h==null?void 0:h.current)==null?void 0:I.message("circleRateOfLand",g,"mandatory")})}),e.jsx("div",{className:"col-span-1",children:e.jsx(V,{variant:F.SECONDARY,label:"label.technical.governmentGuideLines.circleRateOfBuilding*",name:"circleRateOfBuilding",className:"text-right",value:v,onChange:$,onBlur:u,validation:(Y=h==null?void 0:h.current)==null?void 0:Y.message("circleRateOfBuilding",v,"mandatory")})}),e.jsx("div",{className:"col-span-1",children:e.jsx(V,{variant:F.SECONDARY,label:"label.technical.governmentGuideLines.landValue*",name:"landValue",className:"text-right",value:y,onChange:$,onBlur:u,validation:(b=h==null?void 0:h.current)==null?void 0:b.message("landValue",y,"mandatory")})}),e.jsx("div",{className:"col-span-1",children:e.jsx(V,{variant:F.SECONDARY,label:"label.technical.governmentGuideLines.totalValuationOfProperty*",name:"totalValuationOfProperty",className:"text-right",value:k,onChange:$,onBlur:u,validation:(U=h==null?void 0:h.current)==null?void 0:U.message("totalValuationOfProperty",k,"mandatory")})}),e.jsx("div",{className:"col-span-1",children:e.jsx(V,{variant:F.SECONDARY,label:"label.technical.governmentGuideLines.flatOrAptValue*",name:"flatOrAptValue",className:"text-right",value:re,onChange:$,onBlur:u,validation:(ee=h==null?void 0:h.current)==null?void 0:ee.message("flatOrAptValue",re,"mandatory")})})]}),e.jsx("div",{className:"grid grid-cols-4 gap-x-4 gap-y-5 mt-2",children:e.jsx("div",{className:"col-span-2",children:e.jsx(we,{name:"remarks",className:"!h-40",label:"label.technical.governmentGuideLines.remark*",placeholder:"placeholder.governmentGuideLines.description",variant:F.SECONDARY,maxCount:200,onChange:c,value:ue,autoResize:!0})})})]})};return e.jsxs("div",{children:[e.jsx(Ye,{title:"heading.technical.governmentGuideLines",pageMode:s,disabled:p,onSave:D,onCancel:R,onEdit:S,children:p?e.jsx(Ue,{height:"6.375rem",width:"100%",borderRadius:"8px",animation:"wave"}):e.jsx(je,{override:{read:s===E.VIEW},children:m()})}),e.jsx(Be,{position:"bottom-right",ref:L,toastText:O,variant:Ie.PRIMARY}),e.jsx(Le,{onHide:()=>{Z(!1),H("")},visible:Q,errorMessage:M})]})},Ht={dateOfInitiation:"",vendorType:"",internalAssignee:{name:""},externalVendor:{name:""},CCEmails:[],description:"",addressType:"",address:"",pincode:{pinCode:"",uid:""},city:{name:"",uid:""},latitude:"",longitude:"",propertyType:"",state:""},fn=t=>{const{isLoadingInitial:o,data:p,dropdownOptions:A}=t,[d,x]=i.useState({...Ht}),[a,s]=i.useState(!1),[C,O]=i.useState({...rn}),_=i.useRef(null),T=i.useRef(null),J=i.useRef(),M=_t();i.useEffect(()=>{p.vendorType&&x(N=>({...N,...p}))},[p]);const H=(N,m)=>{var v,y,k,re,ue,I,Y,b,U,ee,ce,de,z,le,ve,be,We,Ve,$e,_e,l,r;let g={uid:"",placeOfUpload:"",name:"",fileName:"",fileType:"",download:"",category:"",type:"",sectionName:"",url:""};m!=null&&m.loanDocumentSection?g={uid:m==null?void 0:m.uid,placeOfUpload:"",name:((k=(y=(v=m==null?void 0:m.loanDocumentSection)==null?void 0:v.loanDocument)==null?void 0:y.applicant)==null?void 0:k.firstName)??"-",fileName:((re=m==null?void 0:m.loanDocumentSection)==null?void 0:re.fileName)??"-",fileType:((ue=m==null?void 0:m.loanDocumentSection)==null?void 0:ue.fileType)??"-",download:"",category:((Y=(I=m==null?void 0:m.loanDocumentSection)==null?void 0:I.loanDocument)==null?void 0:Y.docCategory)??"-",type:((ee=(U=(b=m==null?void 0:m.loanDocumentSection)==null?void 0:b.loanDocument)==null?void 0:U.docType)==null?void 0:ee.name)??"-",sectionName:((ce=m==null?void 0:m.loanDocumentSection)==null?void 0:ce.section)??"-",url:(de=m==null?void 0:m.loanDocumentSection)==null?void 0:de.url}:m!=null&&m.kycDocument&&(g={uid:m==null?void 0:m.uid,placeOfUpload:"",name:((ve=(le=(z=m==null?void 0:m.kycDocument)==null?void 0:z.kyc)==null?void 0:le.applicant)==null?void 0:ve.firstName)??"-",fileName:((be=m==null?void 0:m.kycDocument)==null?void 0:be.fileName)??"-",fileType:((We=m==null?void 0:m.kycDocument)==null?void 0:We.fileType)??"-",download:"",category:"KYC",type:((_e=($e=(Ve=m==null?void 0:m.kycDocument)==null?void 0:Ve.kyc)==null?void 0:$e.docType)==null?void 0:_e.name)??"-",sectionName:((l=m==null?void 0:m.kycDocument)==null?void 0:l.smDocSectionType)??"-",url:(r=m==null?void 0:m.kycDocument)==null?void 0:r.url}),O(g),s(!0)},Q=i.useMemo(()=>{const{address:N,pincode:m,city:g,state:v,propertyType:y,latitude:k,longitude:re}=d;return{address:N,pincode:m,city:g,state:v,propertyType:y,latitude:k,longitude:re}},[d==null?void 0:d.address,d==null?void 0:d.pincode,d==null?void 0:d.city,d==null?void 0:d.state,d==null?void 0:d.propertyType,d==null?void 0:d.latitude,d==null?void 0:d.longitude]),Z=N=>{var m,g;return e.jsx("div",{className:"flex items-center",children:N!=null&&N.loanDocumentSection?((g=(m=N==null?void 0:N.loanDocumentSection)==null?void 0:m.loanDocument)==null?void 0:g.docCategory)??"-":"KYC"})},L=N=>e.jsx("div",{className:"flex items-center",children:(N==null?void 0:N.stageDocType)??"-"}),j=N=>{var m,g;return e.jsx("div",{className:"flex items-center",children:N!=null&&N.loanDocumentSection?((m=N==null?void 0:N.loanDocumentSection)==null?void 0:m.section)??"-":(g=N==null?void 0:N.kycDocument)==null?void 0:g.smDocSectionType})},h=N=>e.jsx("div",{className:"px-2 flex items-center space-x-4",children:e.jsx("div",{className:"flex items-center",children:e.jsx(ut,{buttonType:dt.VIEW,onClick:m=>{H(m,N)},isIgnoreAccessLevel:!0})})}),u=()=>{var N;return e.jsxs(mt,{dataKey:"id",ref:J,value:p==null?void 0:p.stageDocuments,className:` h-auto selected-existing-doc-read-table ${(N=p==null?void 0:p.stageDocuments)!=null&&N.length?"!min-h-auto":"!min-h-50"}`,children:[e.jsx(me,{header:M("label.existing.document.category"),className:"text-primary-ptext-1000 text-left text-xs h-12 pl-6",body:Z}),e.jsx(me,{header:M("label.existing.document.type"),className:"text-primary-ptext-1000 text-left text-xs h-12 pl-6",body:L}),e.jsx(me,{header:M("label.existing.document.section"),className:"text-primary-ptext-1000 text-left text-xs h-12 pl-6",body:j}),e.jsx(me,{header:M("label.existing.document.action"),className:"text-primary-ptext-1000 text-center text-xs h-12 pr-2",body:h})]})},{dateOfInitiation:G,vendorType:X,internalAssignee:$,externalVendor:c,CCEmails:D,description:S,addressType:R}=d;return e.jsx("div",{children:e.jsx(at,{title:"heading.rcu.initiationInfo",children:e.jsxs("div",{className:"w-full h-full border border-primary-ptext-500 rounded-xl p-5",children:[o?e.jsx(Ue,{height:"19.375rem",width:"100%",borderRadius:"8px",animation:"wave"}):e.jsx(je,{override:{read:!0},children:e.jsxs("div",{className:"grid grid-cols-4 gap-3",children:[e.jsx("div",{className:"",children:e.jsx(Wt,{label:"label.rcu.dateOfInitiation",name:"dateOfInitiation",value:new Date(G),variant:F.SECONDARY,placeholder:"DD-MM-YYYY "})}),e.jsx("div",{className:"",children:e.jsx(Re,{label:"label.legal.vendorType",name:"vendorType",value:X,optionLabel:"name",optionValue:"code",options:(A==null?void 0:A.vendorType)??[]})}),e.jsx("div",{className:"",children:e.jsx(bt,{label:"label.initiationInfo.internal.assignee",name:"internalAssignee",value:$==null?void 0:$.name,variant:F.PRIMARY})}),X===wt.VENDOR_TYPE_EXTERNAL?e.jsx("div",{className:"",children:e.jsx(bt,{label:"label.text.stage.initiate.external.vendor",name:"externalVendor",value:c==null?void 0:c.name,variant:F.PRIMARY})}):e.jsx("div",{}),e.jsx("div",{className:"col-span-2",children:e.jsx(ln,{className:"",name:"cc",value:D,label:"label.rcu.cc",ref:_})}),e.jsx("div",{}),e.jsx("div",{}),e.jsx("div",{className:"col-span-2",children:e.jsx(we,{name:"description",className:"!h-40",label:"input.masterData.staticMaster.description",placeholder:"placeholder.legal.description",variant:F.SECONDARY,value:S,autoResize:!0})}),e.jsx("div",{className:"col-span-4",children:u()}),e.jsx("div",{className:"col-span-4",children:e.jsx(ie,{label:"heading.technical.propertyDetails",className:"text-primary-sideBarBgColor font-bold text-xs"})}),e.jsx("div",{className:"",children:e.jsx(V,{className:"!h-6",label:"label.technical.addressType",name:"addressType",value:R,disabled:!0})}),e.jsx("div",{className:"col-span-4",children:e.jsx(Bt,{pageMode:E.VIEW,variant:Mt.TERTIARY,ref:T,data:Q,hideMarkUsingMap:!0})})]})}),e.jsx(cn,{visible:a,onToggleVisibility:()=>s(N=>!N),list:[],currentSection:C})]})})})},zt={classOfLocality:"",distanceFromCity:"",nearbyBusStop:"",developmentInVicinity:""},xn=t=>{var k,re,ue,I;const{data:o,isLoading:p,payloadInfo:A,getDataOnCancel:d,dropDownOptions:x}=t,[a,s]=i.useState({...zt}),[C,O]=i.useState(E.VIEW),[_,T]=i.useState(""),[J,M]=i.useState(!1),[H,Q]=i.useState(""),[Z,L]=i.useState(!1),j=i.useRef(null),[,h]=i.useState(!1),u=i.useRef(new ge({validators:{...fe()},...xe(),autoForceUpdate:{forceUpdate:()=>h(Y=>!Y)}}));i.useEffect(()=>{o&&Object.keys(o).length>0&&s(()=>({...o}))},[o]),i.useEffect(()=>{var Y;j!=null&&j.current&&_!==""&&((Y=j==null?void 0:j.current)==null||Y.showFunction(),T(""))},[_,J]),i.useEffect(()=>{H&&L(!0)},[H]);const G=Y=>{s(b=>({...b,[Y.target.name]:Y.target.value}))},X=Y=>{var b,U;(U=u==null?void 0:u.current)==null||U.showMessageFor((b=Y==null?void 0:Y.target)==null?void 0:b.name)},$=()=>{var b,U;let Y=!1;return Y=((b=u==null?void 0:u.current)==null?void 0:b.allValid())??!1,Y||(h(ee=>!ee),(U=u==null?void 0:u.current)==null||U.showMessages(),h(ee=>!ee),!1)},c=()=>{var Y;u.current=new ge({validators:{...fe()},...xe(),autoForceUpdate:{forceUpdate:()=>h(b=>!b)}}),(Y=u==null?void 0:u.current)==null||Y.hideMessages()},D=async()=>{if(!$())return;const Y=N();try{const b=await ye.updateSurroundingLocalityDetails(Y);ke(b)&&(T(Me.SAVED),M(!J),O(E.VIEW))}catch(b){console.log(b),Q(oe(b))}},S=()=>O(E.EDIT),R=()=>{d==null||d(),c(),O(E.VIEW)},N=()=>({uid:A.technicalUid,loan:{uid:A.loanUid},stage:{uid:A.stageUid},smClassOfLocality:a.classOfLocality,distanceFromCityCenter:Number(a.distanceFromCity),distanceFromNearByBusstop:Number(a.nearbyBusStop),vicinityDevelopmentPct:Number(a.developmentInVicinity)}),{classOfLocality:m,developmentInVicinity:g,distanceFromCity:v,nearbyBusStop:y}=a;return e.jsxs(He.Fragment,{children:[e.jsx(Ye,{title:"heading.technical.surroundingLocalityDetails",pageMode:C,onSave:D,onCancel:R,onEdit:S,disabled:p,children:p?e.jsx(Ue,{height:"19.375rem",width:"100%",borderRadius:"8px",animation:"wave"}):e.jsx(je,{override:{read:C===E.VIEW},children:e.jsxs("div",{className:"grid grid-cols-4 gap-3  ",children:[e.jsx("div",{children:e.jsx(Re,{label:"label.technical.classOfLocality*",placeholder:"placeholder.technical.classOfLocality",name:"classOfLocality",value:m??"",onChange:G,validation:(k=u==null?void 0:u.current)==null?void 0:k.message("classOfLocality",m,"mandatory"),onBlur:X,options:x.classOfLocality,optionLabel:"name",optionValue:"code"})}),e.jsx("div",{children:e.jsx(V,{label:"label.technical.distanceFromCityCenter*",name:"distanceFromCity",className:"text-right",variant:F.SECONDARY,onChange:G,value:v??"",validation:(re=u==null?void 0:u.current)==null?void 0:re.message("distanceFromCity",v,"mandatory|checkNumber|onlyPositive|maxDecimal:2"),onBlur:X})}),e.jsx("div",{children:e.jsx(V,{label:"label.technical.nearbyBusStop*",name:"nearbyBusStop",className:"text-right",variant:F.SECONDARY,onChange:G,value:y??"",validation:(ue=u==null?void 0:u.current)==null?void 0:ue.message("nearbyBusStop",y,"mandatory|checkNumber|onlyPositive|maxDecimal:2"),onBlur:X})}),e.jsx("div",{children:e.jsx(V,{label:"label.technical.developmentInTheVicinity",name:"developmentInVicinity",className:"text-right",variant:F.SECONDARY,onChange:G,value:g??"",validation:(I=u==null?void 0:u.current)==null?void 0:I.message("developmentInVicinity",g,"mandatory|checkNumber|min:1,num|max:100,num|maxDecimal:2"),onBlur:X})})]})})}),e.jsx(Be,{position:"bottom-right",ref:j,toastText:_,variant:Ie.PRIMARY}),e.jsx(Le,{onHide:()=>{L(!1),Q("")},visible:Z,errorMessage:H})]})},yn={uid:"",stateOfOccupancy:"",occupiedBy:"",occupiedSince:"",personAtSite:""},vn=t=>{const{data:o,isLoading:p,dropDownOptions:A,getDataOnCancel:d,payloadInfo:x}=t,[a,s]=i.useState(o),[C,O]=i.useState(E.VIEW),[_,T]=i.useState(""),[J,M]=i.useState(!1),[H,Q]=i.useState(""),[Z,L]=i.useState(!1),j=i.useRef(null),[,h]=i.useState(!1),u=i.useRef(new ge({validators:{...fe()},...xe(),autoForceUpdate:{forceUpdate:()=>h(g=>!g)}}));i.useEffect(()=>{o&&Object.keys(o).length>0&&s(()=>({...o}))},[o]),i.useEffect(()=>{var g;j!=null&&j.current&&_!==""&&((g=j==null?void 0:j.current)==null||g.showFunction(),T(""))},[_,J]),i.useEffect(()=>{H&&L(!0)},[H]);const G=g=>{var v,y;(y=u==null?void 0:u.current)==null||y.showMessageFor((v=g==null?void 0:g.target)==null?void 0:v.name)},X=()=>{var v,y;let g=!1;return g=(v=u==null?void 0:u.current)==null?void 0:v.allValid(),g||(h(k=>!k),(y=u==null?void 0:u.current)==null||y.showMessages(),h(k=>!k),!1)},$=()=>{var g;u.current=new ge({validators:{...fe()},...xe(),autoForceUpdate:{forceUpdate:()=>h(v=>!v)}}),(g=u==null?void 0:u.current)==null||g.hideMessages()},c=g=>{s(v=>({...v,[g.target.name]:g.target.value}))},D=async()=>{if(!X())return;const g=N();try{const v=await ye.updateOccupancyDetails(g);ke(v)&&(T(Me.SAVED),M(!J),O(E.VIEW))}catch(v){console.log(v),Q(oe(v))}},S=()=>O(E.EDIT),R=()=>{d==null||d(),$(),O(E.VIEW)},N=()=>({uid:x.technicalUid,loan:{uid:x.loanUid},stage:{uid:x.stageUid},smStatusOccupancy:a.stateOfOccupancy,occupiedByRelationshipWithCustomer:a.occupiedBy,occupiedSinceYear:a.occupiedSince,personAvailableAtSite:a.personAtSite}),m=()=>{var re,ue,I,Y;const{stateOfOccupancy:g,occupiedBy:v,occupiedSince:y,personAtSite:k}=a;return e.jsxs("div",{className:"mt-5 flex flex-wrap gap-x-4 gap-y-5 ",children:[e.jsx("div",{className:"!w-64",children:e.jsx(Re,{label:"label.technical.OccupancyDetails.stateOfOccupancy*",name:"stateOfOccupancy",value:g,onChange:c,onBlur:G,options:A==null?void 0:A.occupancyStatus,optionLabel:"name",optionValue:"code",validation:(re=u==null?void 0:u.current)==null?void 0:re.message("stateOfOccupancy",g,"mandatory")})}),e.jsx("div",{className:"",children:e.jsx(V,{variant:F.SECONDARY,label:"label.technical.OccupancyDetails.occupiedBy*",name:"occupiedBy",className:"!w-64",value:v,onChange:c,onBlur:G,validation:(ue=u==null?void 0:u.current)==null?void 0:ue.message("occupiedBy",v,"mandatory")})}),e.jsx("div",{className:"",children:e.jsx(V,{variant:F.SECONDARY,label:"label.technical.OccupancyDetails.occupiedSince*",name:"occupiedSince",className:"!w-64 text-right",value:y,onChange:c,onBlur:G,validation:(I=u==null?void 0:u.current)==null?void 0:I.message("occupiedSince",y,"mandatory|checkNumber|onlyPositive|maxDecimal:2")})}),e.jsx("div",{className:"",children:e.jsx(V,{variant:F.SECONDARY,label:"label.technical.OccupancyDetails.personAtSite*",name:"personAtSite",className:"!w-64",value:k,onChange:c,onBlur:G,validation:(Y=u==null?void 0:u.current)==null?void 0:Y.message("personAtSite",k,"mandatory")})})]})};return e.jsxs("div",{children:[e.jsx(Ye,{title:"heading.technical.OccupancyDetails",pageMode:C,disabled:p,onSave:D,onCancel:R,onEdit:S,children:p?e.jsx(Ue,{height:"6.375rem",width:"100%",borderRadius:"8px",animation:"wave"}):e.jsx(je,{override:{read:C===E.VIEW},children:m()})}),e.jsx(Be,{position:"bottom-right",ref:j,toastText:_,variant:Ie.PRIMARY}),e.jsx(Le,{onHide:()=>{L(!1),Q("")},visible:Z,errorMessage:H})]})},rt={YES:"YES",NO:"NO"},ze={BOUNDARY_DIRECTION_NORTH:"North",BOUNDARY_DIRECTION_SOUTH:"South",BOUNDARY_DIRECTION_EAST:"East",BOUNDARY_DIRECTION_WEST:"West"},ht={boundariesOnSiteTable:[{direction:ze.BOUNDARY_DIRECTION_NORTH,uid:"1",actualOnSite:"",asPerDoc:""},{direction:ze.BOUNDARY_DIRECTION_SOUTH,uid:"2",actualOnSite:"",asPerDoc:""},{direction:ze.BOUNDARY_DIRECTION_EAST,uid:"3",actualOnSite:"",asPerDoc:""},{direction:ze.BOUNDARY_DIRECTION_WEST,uid:"4",actualOnSite:"",asPerDoc:""}],boundariesMatching:"",landUse:"",propertyDescription:"",noOfFloors:"",noOfLifts:"",noOfFlatsPerFloor:"",noOfWings:"",structureDescription:"",conditionOfProperty:"",yearOfConstruction:"",ageOfProperty:"",approachRoadType:"",approachRoadWidth:"",propertyNearHighTensionLine:"",distanceFromHighTensionLine:"",marketFeedback:"",marketability:"",planAsPerDcrNorms:"",noOfFloorsPermitted:"",numberOfFloorConstructed:"",fsiAchieved:"",riskOfDemolition:"",setbackDeviation:"",horizontalDeviation:"",stageChecklists:[],isQuestionsTableDataEmptyFromApi:!1},Nn=i.forwardRef((t,o)=>{var de,z,le,ve,be,We,Ve,$e,_e,l,r,K,he,q,De,Te,Ke,qe,Qe,Je,Xe,tt,nt,st;const{data:p,isLoading:A,getDataOnCancel:d,payloadInfo:x,dropDownOptions:a}=t,[s,C]=i.useState({...ht}),[O,_]=i.useState(E.VIEW),[T,J]=i.useState(""),[M,H]=i.useState(!1),[Q,Z]=i.useState(""),[L,j]=i.useState(!1),h=i.useRef(null),u=i.useRef(null),G=i.useRef(null),X=i.useRef(null),[,$]=i.useState(!1),c=i.useRef(new ge({validators:{...fe()},...xe(),autoForceUpdate:{forceUpdate:()=>$(P=>!P)}}));i.useImperativeHandle(o,()=>({save:g,onCancel:y})),i.useEffect(()=>{p&&Object.keys(p).length>0&&C(()=>({...p}))},[p]),i.useEffect(()=>{const P=a==null?void 0:a.questions;P&&(P==null?void 0:P.length)>0&&p.isQuestionsTableDataEmptyFromApi&&C(ne=>{const se={...ne},ae=[];for(const Pe of P)ae.push({smCode:(Pe==null?void 0:Pe.code)??"",name:(Pe==null?void 0:Pe.name)??"",value:null});return se.stageChecklists=ae,se})},[a==null?void 0:a.questions,p]),i.useEffect(()=>{var P;h!=null&&h.current&&T!==""&&((P=h==null?void 0:h.current)==null||P.showFunction(),J(""))},[T,M]),i.useEffect(()=>{Q&&j(!0)},[Q]);const D=P=>{C(ne=>({...ne,[P.target.name]:P.target.value}))},S=(P,ne)=>{const se=s.stageChecklists.findIndex(ae=>ae.smCode===ne.smCode);se>-1&&C(ae=>{const Pe={...ae};return Pe.stageChecklists[se].value=P.value,Pe})},R=(P,ne,se)=>{const ae=s.boundariesOnSiteTable.findIndex(Pe=>(Pe==null?void 0:Pe.uid)===ne.uid);ae>-1&&C(Pe=>{const it={...Pe};return it.boundariesOnSiteTable[ae][se]=P.target.value,it})},N=P=>{var ne,se;(se=c==null?void 0:c.current)==null||se.showMessageFor((ne=P==null?void 0:P.target)==null?void 0:ne.name)},m=()=>{var ne,se;let P=!1;return P=((ne=c==null?void 0:c.current)==null?void 0:ne.allValid())??!1,P||($(ae=>!ae),(se=c==null?void 0:c.current)==null||se.showMessages(),$(ae=>!ae),!1)},g=async()=>{if(m()){const P=k();try{const ne=await ye.updatePropertyDetails(P);ke(ne)&&(J(Me.SAVED),H(!M),_(E.VIEW))}catch(ne){Z(oe(ne))}}},v=()=>_(E.EDIT),y=()=>{var P;d==null||d(),re(),(P=u.current)==null||P.resetValidator(),_(E.VIEW),C(ne=>({...ne,...ht}))},k=()=>{const P=()=>{const se={boundaryNorthAsPerDoc:"",boundaryNorthAsActual:"",boundarySouthAsPerDoc:"",boundarySouthAsActual:"",boundaryEastAsPerDoc:"",boundaryEastAsActual:"",boundaryWestAsPerDoc:"",boundaryWestAsActual:""};return s.boundariesOnSiteTable.forEach(ae=>{ae.direction===ze.BOUNDARY_DIRECTION_NORTH?(se.boundaryNorthAsPerDoc=ae.asPerDoc,se.boundaryNorthAsActual=ae.actualOnSite):ae.direction===ze.BOUNDARY_DIRECTION_SOUTH?(se.boundarySouthAsPerDoc=ae.asPerDoc,se.boundarySouthAsActual=ae.actualOnSite):ae.direction===ze.BOUNDARY_DIRECTION_EAST?(se.boundaryEastAsPerDoc=ae.asPerDoc,se.boundaryEastAsActual=ae.actualOnSite):ae.direction===ze.BOUNDARY_DIRECTION_WEST&&(se.boundaryWestAsPerDoc=ae.asPerDoc,se.boundaryWestAsActual=ae.actualOnSite)}),se};return{uid:x.technicalUid,loan:{uid:x.loanUid},stage:{uid:x.stageUid},isPropertyBoundaryMatching:s.boundariesMatching===pe.YES,...P(),smLandUse:s.landUse,propertyDescription:s.propertyDescription,noOfFloors:s.noOfFloors,noOfLift:Number(s.noOfLifts),noOfFlatsPerFloor:s.noOfFlatsPerFloor,noOfWings:Number(s.noOfWings),structureDescription:s.structureDescription,smConditionOfProperty:s.conditionOfProperty,yearOfConstruction:s.yearOfConstruction,ageOfProperty:s.ageOfProperty,smApproachRoadType:s.approachRoadType,approachRoadWidth:Number(s.approachRoadWidth),isWithinCorpUrbanGpLimit:!1,isBasicAmenityAvailable:!1,isStructureAsPerNbcGuidelines:!1,isPropertyNearNaalaCanal:!1,isNegativeArea:!1,isAnyRecentDemolition:!1,distanceFromNaalaCanal:2,residualAgeOfPropertyInYear:2,isPropertyNearHighTensionLine:s.propertyNearHighTensionLine===pe.YES,distanceFromHighTensionLine:Number(s.distanceFromHighTensionLine),smMarketability:s.marketability,isCalamityHazardAsPerNdma:!1,marketFeedback:s.marketFeedback,recentDemolitionSinceYears:2,isPlanAsPerDcrNorms:s.planAsPerDcrNorms===pe.YES,noOfFloorsPermiteed:2,noOfFloorsConstructed:2,fsiAchieved:s.fsiAchieved,smRiskOfDemolition:s.riskOfDemolition,setbackDeviationPct:Number(s.setbackDeviation),horizontalDeviationPct:Number(s.horizontalDeviation),stageChecklists:s.stageChecklists}},re=()=>{var P;c.current=new ge({validators:{...fe()},...xe(),autoForceUpdate:{forceUpdate:()=>$(ne=>!ne)}}),(P=c==null?void 0:c.current)==null||P.hideMessages()},ue=P=>e.jsx(ie,{className:" text-xs text-secondary-labelColor ",label:P==null?void 0:P.name}),I=P=>{var ne;return e.jsxs("div",{className:"mt-5 ",children:[e.jsxs("div",{className:"flex flex-shrink-0 ",children:[e.jsxs("div",{className:"mr-5 flex",children:[e.jsx(Oe,{hideLabel:!0,hideErrorRow:!0,variant:Ce.PRIMARY,value:rt.YES,checked:P.value===rt.YES,onChange:se=>S(se,P),disabled:O===E.VIEW}),e.jsx(ie,{className:"ml-1.5 text-xs ",label:"label.dde.yes"})]}),e.jsxs("div",{className:"flex",children:[e.jsx(Oe,{hideLabel:!0,hideErrorRow:!0,variant:Ce.PRIMARY,value:rt.NO,checked:(P==null?void 0:P.value)===rt.NO,onChange:se=>S(se,P),disabled:O===E.VIEW}),e.jsx(ie,{className:"ml-1.5 text-xs ",label:"label.dde.no"})]})]}),e.jsx("div",{className:"h-4 flex ml-6 items-start mb-1.5",children:e.jsx(Ze,{validation:(ne=c==null?void 0:c.current)==null?void 0:ne.message(`value${P==null?void 0:P.smCode}`,P.value,"mandatory")})})]})},Y=P=>e.jsx(ie,{className:" text-xs text-secondary-labelColor ",label:P==null?void 0:P.direction}),b=P=>{var ne;return e.jsx(we,{autoResize:!0,hideMaxCount:!0,name:`asPerDoc${P==null?void 0:P.uid}`,className:"!h-30",variant:F.SECONDARY,onChange:se=>R(se,P,"asPerDoc"),value:(P==null?void 0:P.asPerDoc)??"",onBlur:N,validation:(ne=c==null?void 0:c.current)==null?void 0:ne.message(`asPerDoc${P==null?void 0:P.uid}`,P==null?void 0:P.asPerDoc,"mandatory")})},U=P=>{var ne;return e.jsx(we,{autoResize:!0,hideMaxCount:!0,name:`actualOnSite${P==null?void 0:P.uid}`,className:"!h-30",variant:F.SECONDARY,onChange:se=>R(se,P,"actualOnSite"),value:(P==null?void 0:P.actualOnSite)??"",validation:(ne=c==null?void 0:c.current)==null?void 0:ne.message(`actualOnSite${P==null?void 0:P.uid}`,P==null?void 0:P.actualOnSite,"mandatory"),onBlur:N})},ee=()=>e.jsxs(mt,{value:s==null?void 0:s.stageChecklists,className:"selected-existing-doc-read-table !min-h-auto",ref:G,dataKey:"uid",children:[e.jsx(me,{className:"text-primary-ptext-1000 text-left text-xs  p-1 h-12 pl-6",header:"Question",body:ue}),e.jsx(me,{className:"text-primary-ptext-1000 text-left text-xs  p-1 h-12 pl-6",header:"Yes/No*",body:I})]}),ce=()=>e.jsxs(mt,{value:s==null?void 0:s.boundariesOnSiteTable,className:"selected-existing-doc-read-table !min-h-auto",ref:X,dataKey:"uid",children:[e.jsx(me,{className:"text-primary-ptext-1000 text-left text-xs  p-1 h-12 pl-6",header:"Direction",body:Y}),e.jsx(me,{className:"text-primary-ptext-1000 text-left text-xs  p-1 h-12 pl-6",header:"As Per Doc",body:b}),e.jsx(me,{className:"text-primary-ptext-1000 text-left text-xs  p-1 h-12 pl-6",header:"Actual On Site",body:U})]});return e.jsxs(He.Fragment,{children:[e.jsx(Ye,{title:"heading.technical.propertyDetails",pageMode:O,disabled:A,onSave:g,onCancel:y,onEdit:v,children:A?e.jsx(Ue,{height:"19.375rem",width:"100%",borderRadius:"8px",animation:"wave"}):e.jsx(je,{override:{read:O===E.VIEW},children:e.jsxs(He.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-4 gap-x-4 gap-y-5 mt-5 w-full",children:[e.jsx("div",{className:"col-span-4",children:e.jsx(ie,{className:"text-primary-sideBarBgColor text-xs font-bold mb-1",label:"label.section.propertyDetails.boundariesOnSite*"})}),e.jsx("div",{className:"col-span-4",children:ce()}),e.jsxs("div",{className:"col-span-1 flex flex-col justify-start items-start space-y-1",children:[e.jsx("div",{className:"flex items-top",children:e.jsx(ie,{label:"label.section.propertyDetails.boundariesMatching*",className:"text-xs"})}),e.jsxs("div",{className:"flex justify-start items-center space-x-8",children:[e.jsxs("div",{className:"flex",children:[e.jsx(Oe,{hideLabel:!0,hideErrorRow:!0,name:"boundariesMatching",variant:Ce.PRIMARY,className:"flex items-center",onChange:D,value:pe.YES,checked:(s==null?void 0:s.boundariesMatching)===pe.YES,disabled:O===E.VIEW}),e.jsx("div",{className:"ml-2 flex items-top",children:e.jsx(ie,{label:"label.radioButton.yes",className:"text-xs"})})]}),e.jsxs("div",{className:"flex",children:[e.jsx(Oe,{hideLabel:!0,hideErrorRow:!0,variant:Ce.PRIMARY,name:"boundariesMatching",className:"flex items-center",onChange:D,value:pe.NO,checked:(s==null?void 0:s.boundariesMatching)===pe.NO,disabled:O===E.VIEW}),e.jsx("div",{className:"ml-2 flex items-top",children:e.jsx(ie,{label:"label.radioButton.no",className:"text-xs"})})]})]}),e.jsx("div",{className:"h-4 flex justify-start  items-center",children:e.jsx(Ze,{validation:(de=c==null?void 0:c.current)==null?void 0:de.message("boundariesMatching",s==null?void 0:s.boundariesMatching,"mandatory")})})]}),e.jsx("div",{className:"col-span-1",children:e.jsx(Re,{label:"label.section.propertyDetails.landUse*",name:"landUse",value:s==null?void 0:s.landUse,onChange:D,onBlur:N,options:a==null?void 0:a.landOfUse,optionLabel:"name",optionValue:"code",validation:(z=c==null?void 0:c.current)==null?void 0:z.message("landUse",s==null?void 0:s.landUse,"mandatory")})}),e.jsx("div",{}),e.jsx("div",{}),e.jsx("div",{className:"col-span-2 row-span-2",children:e.jsx(we,{name:"propertyDescription",className:"!h-40",label:"label.section.propertyDetails.propertyDescription*",placeholder:"",variant:F.SECONDARY,maxCount:300,onChange:D,value:s==null?void 0:s.propertyDescription,autoResize:!0,validation:(le=c==null?void 0:c.current)==null?void 0:le.message("propertyDescription",s==null?void 0:s.propertyDescription,"mandatory"),onBlur:N})}),e.jsx("div",{className:"col-span-1",children:e.jsx(V,{variant:F.SECONDARY,label:"label.section.propertyDetails.noOfFloors*",name:"noOfFloors",className:"text-right",value:s==null?void 0:s.noOfFloors,onChange:D,onBlur:N,validation:(ve=c==null?void 0:c.current)==null?void 0:ve.message("noOfFloors",s==null?void 0:s.noOfFloors,"mandatory|alpha_num")})}),e.jsx("div",{className:"col-span-1",children:e.jsx(V,{variant:F.SECONDARY,label:"label.section.propertyDetails.noOfLifts*",name:"noOfLifts",className:"text-right",value:s==null?void 0:s.noOfLifts,onChange:D,onBlur:N,validation:(be=c==null?void 0:c.current)==null?void 0:be.message("noOfLifts",s==null?void 0:s.noOfLifts,"mandatory|checkNumber|onlyPositive|onlyInteger")})}),e.jsx("div",{className:"col-span-1",children:e.jsx(V,{variant:F.SECONDARY,label:"label.section.propertyDetails.noOfFloor*",name:"noOfFlatsPerFloor",className:"text-right",value:s==null?void 0:s.noOfFlatsPerFloor,onChange:D,onBlur:N,validation:(We=c==null?void 0:c.current)==null?void 0:We.message("noOfFlatsPerFloor",s==null?void 0:s.noOfFlatsPerFloor,"mandatory|alpha_num")})}),e.jsx("div",{className:"col-span-1",children:e.jsx(V,{variant:F.SECONDARY,label:"label.section.propertyDetails.noOfWings*",name:"noOfWings",className:"text-right",value:s==null?void 0:s.noOfWings,onChange:D,onBlur:N,validation:(Ve=c==null?void 0:c.current)==null?void 0:Ve.message("noOfWings",s==null?void 0:s.noOfWings,"mandatory|checkNumber|onlyPositive|onlyInteger")})}),e.jsx("div",{className:"col-span-1",children:e.jsx(V,{variant:F.SECONDARY,label:"label.section.propertyDetails.structureDescription*",name:"structureDescription",value:s==null?void 0:s.structureDescription,onChange:D,onBlur:N,validation:($e=c==null?void 0:c.current)==null?void 0:$e.message("structureDescription",s==null?void 0:s.structureDescription,"mandatory")})}),e.jsx("div",{className:"col-span-1",children:e.jsx(Re,{label:"label.section.propertyDetails.conditionOfProperty*",name:"conditionOfProperty",value:s==null?void 0:s.conditionOfProperty,onChange:D,onBlur:N,options:a==null?void 0:a.conditionOfProperty,optionLabel:"name",optionValue:"code",validation:(_e=c==null?void 0:c.current)==null?void 0:_e.message("conditionOfProperty",s==null?void 0:s.conditionOfProperty,"mandatory")})}),e.jsx("div",{className:"col-span-1",children:e.jsx(V,{variant:F.SECONDARY,label:"label.section.propertyDetails.yearOfConstruction*",name:"yearOfConstruction",className:"text-right",value:s==null?void 0:s.yearOfConstruction,onChange:D,onBlur:N,validation:(l=c==null?void 0:c.current)==null?void 0:l.message("yearOfConstruction",s==null?void 0:s.yearOfConstruction,"mandatory|checkNumber|onlyPositive|onlyInteger")})}),e.jsx("div",{className:"col-span-1",children:e.jsx(V,{variant:F.SECONDARY,label:"label.section.propertyDetails.ageOfTheProperty*",name:"ageOfProperty",className:"text-right",value:s==null?void 0:s.ageOfProperty,onChange:D,onBlur:N,validation:(r=c==null?void 0:c.current)==null?void 0:r.message("ageOfProperty",s==null?void 0:s.ageOfProperty,"mandatory|checkNumber|onlyPositive|onlyInteger")})}),e.jsx("div",{className:"col-span-4",children:ee()}),e.jsxs("div",{className:"col-span-1 flex flex-col justify-start items-start space-y-1",children:[e.jsx("div",{className:"flex items-top",children:e.jsx(ie,{label:"label.section.propertyDetails.approachRoadType*",className:"text-xs"})}),e.jsxs("div",{className:"flex justify-start items-center space-x-8",children:[e.jsxs("div",{className:"flex",children:[e.jsx(Oe,{hideLabel:!0,hideErrorRow:!0,variant:Ce.PRIMARY,name:"approachRoadType",className:"flex items-center",onChange:D,value:pe.YES,checked:(s==null?void 0:s.approachRoadType)===pe.YES,disabled:O===E.VIEW}),e.jsx("div",{className:"ml-2 flex items-top",children:e.jsx(ie,{label:"label.section.propertyDetails.kachha",className:"text-xs"})})]}),e.jsxs("div",{className:"flex",children:[e.jsx(Oe,{hideLabel:!0,hideErrorRow:!0,variant:Ce.PRIMARY,name:"approachRoadType",className:"flex items-center",onChange:D,value:pe.NO,checked:(s==null?void 0:s.approachRoadType)===pe.NO,disabled:O===E.VIEW}),e.jsx("div",{className:"ml-2 flex items-top",children:e.jsx(ie,{label:"label.section.propertyDetails.pakka",className:"text-xs"})})]})]}),e.jsx("div",{className:"h-4 flex justify-start  items-center",children:e.jsx(Ze,{validation:(K=c==null?void 0:c.current)==null?void 0:K.message("approachRoadType",s==null?void 0:s.approachRoadType,"mandatory")})})]}),e.jsx("div",{}),e.jsx("div",{className:"col-span-1",children:e.jsx(V,{variant:F.SECONDARY,label:"label.section.propertyDetails.approachRoadWidth*",name:"approachRoadWidth",className:"text-right",value:s==null?void 0:s.approachRoadWidth,onChange:D,onBlur:N,validation:(he=c==null?void 0:c.current)==null?void 0:he.message("approachRoadWidth",s==null?void 0:s.approachRoadWidth,"mandatory|checkNumber|onlyPositive|maxDecimal:2")})}),e.jsx("div",{}),e.jsxs("div",{className:"col-span-1 flex flex-col justify-start items-start space-y-1",children:[e.jsx("div",{className:"flex items-top",children:e.jsx(ie,{label:"label.section.propertyDetails.propertySituatedNearHighTensionLine*",className:"text-xs"})}),e.jsxs("div",{className:"flex justify-start items-center space-x-8",children:[e.jsxs("div",{className:"flex",children:[e.jsx(Oe,{hideLabel:!0,hideErrorRow:!0,variant:Ce.PRIMARY,name:"propertyNearHighTensionLine",className:"flex items-center",onChange:D,value:pe.YES,checked:(s==null?void 0:s.propertyNearHighTensionLine)===pe.YES,disabled:O===E.VIEW}),e.jsx("div",{className:"ml-2 flex items-top",children:e.jsx(ie,{label:"label.radioButton.yes",className:"text-xs"})})]}),e.jsxs("div",{className:"flex",children:[e.jsx(Oe,{hideLabel:!0,hideErrorRow:!0,variant:Ce.PRIMARY,name:"propertyNearHighTensionLine",className:"flex items-center",onChange:D,value:pe.NO,checked:(s==null?void 0:s.propertyNearHighTensionLine)===pe.NO,disabled:O===E.VIEW}),e.jsx("div",{className:"ml-2 flex items-top",children:e.jsx(ie,{label:"label.radioButton.no",className:"text-xs"})})]})]}),e.jsx("div",{className:"h-4 flex justify-start  items-center",children:e.jsx(Ze,{validation:(q=c==null?void 0:c.current)==null?void 0:q.message("propertyNearHighTensionLine",s==null?void 0:s.propertyNearHighTensionLine,"mandatory")})})]}),e.jsx("div",{}),s.propertyNearHighTensionLine===pe.YES?e.jsx("div",{className:"col-span-1",children:e.jsx(V,{variant:F.SECONDARY,label:"label.section.propertyDetails.distance*",name:"distanceFromHighTensionLine",className:"text-right",value:s==null?void 0:s.distanceFromHighTensionLine,onChange:D,onBlur:N,validation:(De=c==null?void 0:c.current)==null?void 0:De.message("distanceFromHighTensionLine",s==null?void 0:s.distanceFromHighTensionLine,"mandatory|checkNumber|onlyPositive|maxDecimal:2")})}):e.jsx("div",{}),e.jsx("div",{className:"col-span-2",children:e.jsx(we,{name:"marketFeedback",className:"!h-40",label:"label.section.propertyDetails.marketFeedback*",placeholder:"",variant:F.SECONDARY,maxCount:300,onChange:D,value:s==null?void 0:s.marketFeedback,autoResize:!0,validation:(Te=c==null?void 0:c.current)==null?void 0:Te.message("marketFeedback",s==null?void 0:s.marketFeedback,"mandatory"),onBlur:N})}),e.jsx("div",{className:"col-span-1",children:e.jsx(Re,{label:"label.section.propertyDetails.marketability*",name:"marketability",value:s==null?void 0:s.marketability,onChange:D,onBlur:N,options:a==null?void 0:a.marketability,optionLabel:"label",optionValue:"value",validation:(Ke=c==null?void 0:c.current)==null?void 0:Ke.message("marketability",s==null?void 0:s.marketability,"mandatory")})})]}),e.jsxs("div",{className:"flex flex-col justify-center items-start",children:[e.jsx("div",{className:"flex justify-between items-center",children:e.jsx(et,{label:"label.section.propertyDetails.buildingParameters",titleClass:"text-primary-sideBarBgColor text-xs font-bold "})}),e.jsxs("div",{className:"grid grid-cols-4 gap-x-4 gap-y-5 mt-5 w-full",children:[e.jsxs("div",{className:"col-span-1 flex flex-col justify-start items-start space-y-1",children:[e.jsx("div",{className:"flex items-top",children:e.jsx(ie,{label:"label.section.propertyDetails.planAsPerDCRNorms*",className:"text-xs"})}),e.jsxs("div",{className:"flex justify-start items-center space-x-8",children:[e.jsxs("div",{className:"flex",children:[e.jsx(Oe,{hideLabel:!0,hideErrorRow:!0,variant:Ce.PRIMARY,name:"planAsPerDcrNorms",className:"flex items-center",onChange:D,value:pe.YES,checked:(s==null?void 0:s.planAsPerDcrNorms)===pe.YES,disabled:O===E.VIEW}),e.jsx("div",{className:"ml-2 flex items-top",children:e.jsx(ie,{label:"label.radioButton.yes",className:"text-xs"})})]}),e.jsxs("div",{className:"flex",children:[e.jsx(Oe,{hideLabel:!0,variant:Ce.PRIMARY,hideErrorRow:!0,name:"planAsPerDcrNorms",className:"flex items-center",onChange:D,value:pe.NO,checked:(s==null?void 0:s.planAsPerDcrNorms)===pe.NO,disabled:O===E.VIEW}),e.jsx("div",{className:"ml-2 flex items-top",children:e.jsx(ie,{label:"label.radioButton.no",className:"text-xs"})})]})]}),e.jsx("div",{className:"h-4 flex justify-start  items-center",children:e.jsx(Ze,{validation:(qe=c==null?void 0:c.current)==null?void 0:qe.message("planAsPerDcrNorms",s==null?void 0:s.planAsPerDcrNorms,"mandatory")})}),e.jsx("div",{})]}),e.jsx("div",{className:"col-span-1",children:e.jsx(V,{variant:F.SECONDARY,label:"label.section.propertyDetails.numberOfFloorsPermitted*",name:"noOfFloorsPermitted",className:"text-right",value:s==null?void 0:s.noOfFloorsPermitted,onChange:D,onBlur:N,validation:(Qe=c==null?void 0:c.current)==null?void 0:Qe.message("noOfFloorsPermitted",s==null?void 0:s.noOfFloorsPermitted,"mandatory|checkNumber|onlyPositive|onlyInteger")})}),e.jsx("div",{className:"col-span-1",children:e.jsx(V,{variant:F.SECONDARY,label:"label.section.propertyDetails.numberOfFloorsConstructed*",name:"numberOfFloorConstructed",className:"text-right",value:s==null?void 0:s.numberOfFloorConstructed,onChange:D,onBlur:N,validation:(Je=c==null?void 0:c.current)==null?void 0:Je.message("numberOfFloorConstructed",s==null?void 0:s.numberOfFloorConstructed,"mandatory|checkNumber|onlyPositive|onlyInteger")})}),e.jsx("div",{className:"col-span-1",children:e.jsx(V,{variant:F.SECONDARY,label:"label.section.propertyDetails.FSIAchieved*",name:"fsiAchieved",value:s==null?void 0:s.fsiAchieved,onChange:D,onBlur:N,validation:(Xe=c==null?void 0:c.current)==null?void 0:Xe.message("fsiAchieved",s==null?void 0:s.fsiAchieved,"mandatory")})}),e.jsx("div",{className:"col-span-1",children:e.jsx(Re,{label:"label.section.propertyDetails.riskOfDemolition*",name:"riskOfDemolition",value:s==null?void 0:s.riskOfDemolition,onChange:D,onBlur:N,options:a==null?void 0:a.riskOfDemolition,optionLabel:"name",optionValue:"code",validation:(tt=c==null?void 0:c.current)==null?void 0:tt.message("riskOfDemolition",s==null?void 0:s.riskOfDemolition,"mandatory")})}),e.jsx("div",{className:"col-span-1",children:e.jsx(V,{variant:F.SECONDARY,label:"label.section.propertyDetails.setbackDeviation*",name:"setbackDeviation",className:"text-right",value:s==null?void 0:s.setbackDeviation,onChange:D,onBlur:N,validation:(nt=c==null?void 0:c.current)==null?void 0:nt.message("setbackDeviation",s==null?void 0:s.setbackDeviation,"mandatory|checkNumber|min:0,num|max:100,num|maxDecimal:2")})}),e.jsx("div",{className:"col-span-1",children:e.jsx(V,{variant:F.SECONDARY,label:"label.section.propertyDetails.horizontalDeviation*",name:"horizontalDeviation",className:"text-right",value:s==null?void 0:s.horizontalDeviation,onChange:D,onBlur:N,validation:(st=c==null?void 0:c.current)==null?void 0:st.message("horizontalDeviation",s==null?void 0:s.horizontalDeviation,"mandatory|checkNumber|min:0,num|max:100,num|maxDecimal:2")})})]})]})]})})}),e.jsx(Be,{position:"bottom-right",ref:h,toastText:T,variant:Ie.PRIMARY}),e.jsx(Le,{onHide:()=>{j(!1),Z("")},visible:L,errorMessage:Q})]})}),Pn={savedDocuments:[]},bn=t=>{const{isLoading:o,payloadInfo:p,getDataOnCancel:A,data:d}=t,[x,a]=i.useState(d),[s,C]=i.useState(E.VIEW),[O,_]=i.useState("1"),[T,J]=i.useState(""),[M,H]=i.useState(!1),[Q,Z]=i.useState(""),[L,j]=i.useState(!1),h=i.useRef(null),u=i.useRef(null);i.useEffect(()=>{d&&Object.keys(d).length>0&&(a(()=>({...d})),_(Math.random().toString()))},[d]),i.useEffect(()=>{var S;h!=null&&h.current&&T!==""&&((S=h==null?void 0:h.current)==null||S.showFunction(),J(""))},[T,M]),i.useEffect(()=>{Q&&j(!0)},[Q]);const G=async()=>{var N;const S=(N=u.current)==null?void 0:N.getUploadedData();if(!S)return;const R=c(S);try{const m=await ye.updatePropertyPhotos(R);ke(m)&&(J(Me.SAVED),H(!M),C(E.VIEW))}catch(m){console.log(m),Z(oe(m))}},X=()=>C(E.EDIT),$=()=>{A==null||A(),C(E.VIEW)},c=S=>{const R=m=>m.map(v=>({uid:v.uid?v.uid:null,section:v.code,fileName:v.fileName,fileType:v.contentType,thumbUrl:v.thumbUrl,url:v.url,isActive:v.isActive}));return{uid:p.technicalUid,loan:{uid:p.loanUid},stage:{uid:p.stageUid},loanDocuments:[{docType:{uid:S.documentUid},docCategory:S.documentCategory,documentSections:R(S.documentSectionUrls)}]}},D=()=>{var S,R;return e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsx(et,{label:"",value:"Attach Documents (PDF, JPG, JPEG or PNG)",titleClass:"text-primary-sideBarBgColor text-sm font-bold mb-1"}),e.jsx(Dt,{ref:u,savedDocument:(S=d.savedDocuments)!=null&&S[0]?(R=d.savedDocuments)==null?void 0:R[0]:{},mode:s===E.VIEW?ct.VIEW:ct.EDIT,queryParamForDocList:Yt.DOCUMENT_CATEGORY_PROPERTY_PICTURES,mandatoryDocUpload:!0},O)]})};return e.jsxs("div",{children:[e.jsx(Ye,{pageMode:s,title:"",onSave:G,onEdit:X,onCancel:$,disabled:o,children:o?e.jsx(Ue,{height:"19.375rem",width:"100%",borderRadius:"8px",animation:"wave"}):e.jsx(je,{override:{read:s===E.VIEW},children:D()})}),e.jsx(Be,{position:"bottom-right",ref:h,toastText:T,variant:Ie.PRIMARY}),e.jsx(Le,{onHide:()=>{j(!1),Z("")},visible:L,errorMessage:Q})]})},An=He.memo(bn),Sn={uid:"",smAreaType:"",smConstructionType:"",valuationAsPerPlan:"",valuationAsPerSite:"",deviationPct:"",rate:"",completedPct:"",recommendedPct:"",totalValuation:"",isActive:!0},Cn={uid:"",smAmenityType:"",rate:"",completedPct:"",recommendedPct:"",totalValuation:"",isActive:!0},On={fairMarketValue:"0",totalPropertyValueOnCompletion:"",forcedSaleValue:"",stagePropertyValuations:[],stagePropertyAmenities:[]},En=i.forwardRef((t,o)=>{const{data:p,isLoading:A,payloadInfo:d,getDataOnCancel:x}=t,[a,s]=i.useState(p),[C,O]=i.useState(E.VIEW),[_,T]=i.useState([]),[J,M]=i.useState([]),[H,Q]=i.useState("bottom-right"),[Z,L]=i.useState(Ie.PRIMARY),[j,h]=i.useState(""),[u,G]=i.useState(!1),[X,$]=i.useState(""),[c,D]=i.useState(!1),S=He.useRef(null),R=He.useRef(null),N=i.useRef(null),m=_t(),[,g]=i.useState(!1),[,v]=i.useState(!1),y=i.useRef(new ge({validators:{...fe()},...xe(),autoForceUpdate:{forceUpdate:()=>g(n=>!n)}})),k=i.useRef(new ge({validators:{...fe()},...xe(),autoForceUpdate:{forceUpdate:()=>v(n=>!n)}}));i.useEffect(()=>{p&&Object.keys(p).length>0&&s(()=>({...p}))},[p]),i.useEffect(()=>{K(),r()},[]),i.useEffect(()=>{var n;N!=null&&N.current&&j!==""&&((n=N==null?void 0:N.current)==null||n.showFunction(),h(""))},[j,u]),i.useEffect(()=>{X&&D(!0)},[X]),i.useImperativeHandle(o,()=>({props:t,save:We,editableTableRef:r}));const re=async()=>{var n;try{const f=await Fe.getAll(0,1e3,`staticMasterType.code=${vt.AREA_TYPE}&`);Ne(f)&&((n=f.data)!=null&&n.totalRecords)&&T([...f.data.results])}catch(f){$(oe(f))}},ue=async()=>{var n;try{const f=await Fe.getAll(0,1e3,`staticMasterType.code=${vt.CONSTRUCTION_TYPE}&`);Ne(f)&&((n=f.data)!=null&&n.totalRecords)&&M([...f.data.results])}catch(f){$(oe(f))}},I=n=>{var f,B;(B=y==null?void 0:y.current)==null||B.showMessageFor((f=n==null?void 0:n.target)==null?void 0:f.name)},Y=()=>{var f,B;let n=!1;return n=(f=y==null?void 0:y.current)==null?void 0:f.allValid(),n||(g(W=>!W),(B=y==null?void 0:y.current)==null||B.showMessages(),g(W=>!W),!1)},b=()=>{var n;y.current=new ge({validators:{...fe()},...xe(),autoForceUpdate:{forceUpdate:()=>g(f=>!f)}}),(n=y==null?void 0:y.current)==null||n.hideMessages()},U=n=>{var f,B;(B=k==null?void 0:k.current)==null||B.showMessageFor((f=n==null?void 0:n.target)==null?void 0:f.name)},ee=()=>{var f,B;let n=!1;return n=(f=k==null?void 0:k.current)==null?void 0:f.allValid(),n||(v(W=>!W),(B=k==null?void 0:k.current)==null||B.showMessages(),v(W=>!W),!1)},ce=()=>{var n;k.current=new ge({validators:{...fe()},...xe(),autoForceUpdate:{forceUpdate:()=>v(f=>!f)}}),(n=k==null?void 0:k.current)==null||n.hideMessages()},de=(n,f)=>{var W;const B={...f};B.smAreaType=n.target.value,(W=S.current)==null||W.reportDataChange(B)},z=(n,f)=>{var W;const B={...f};B.smConstructionType=n.target.value,(W=S.current)==null||W.reportDataChange(B)},le=n=>{const f=Ae(n.target.value);s(B=>({...B,[n.target.name]:f?Ee(f,"en-IN",0):""}))},ve=()=>O(E.EDIT),be=()=>{var n,f,B,W;x==null||x(),b(),O(E.VIEW),(n=S==null?void 0:S.current)==null||n.clearAll(),(f=R==null?void 0:R.current)==null||f.clearAll(),(B=S==null?void 0:S.current)==null||B.search(),(W=R==null?void 0:R.current)==null||W.search()},We=async()=>{var B,W,te,Se,w,pt,gt,ft,xt,yt;if(!Y()||!ee())return;const n={...a,propertyValuations:[...((B=S.current)==null?void 0:B.getAddedRecords())??[],...((W=S.current)==null?void 0:W.getDeletedRecords())??[],...((te=S.current)==null?void 0:te.getUpdatedRecords())??[]],propertyAmenities:[...((Se=R.current)==null?void 0:Se.getAddedRecords())??[],...((w=R.current)==null?void 0:w.getDeletedRecords())??[],...((pt=R.current)==null?void 0:pt.getUpdatedRecords())??[]]};n.propertyValuations.length===0&&(n.propertyValuations=[...p.stagePropertyValuations]),n.propertyAmenities.length===0&&(n.propertyAmenities=[...p.stagePropertyAmenities]);const f=De(n);try{const ot=await ye.updatePropertyValuationAndAmenities(f);ke(ot)&&(L(Ie.PRIMARY),h(Me.SAVED),G(!u),O(E.VIEW),(gt=S==null?void 0:S.current)==null||gt.clearAll(),(ft=R==null?void 0:R.current)==null||ft.clearAll(),(xt=S==null?void 0:S.current)==null||xt.search(),(yt=R==null?void 0:R.current)==null||yt.search(),x==null||x())}catch(ot){console.log(ot),$(oe(ot))}},Ve=()=>{var n;(n=S==null?void 0:S.current)==null||n.addRow(Sn),b()},$e=n=>{var f;(f=S.current)==null||f.deleteRow(n),b()},_e=()=>{var n,f;((n=R==null?void 0:R.current)==null?void 0:n.getCurrentRecords().length)===0&&((f=R==null?void 0:R.current)==null||f.addRow(Cn),b())},l=n=>{var f;(f=R.current)==null||f.deleteRow(n),b()},r=()=>{var n,f;(n=S.current)==null||n.search(),(f=R.current)==null||f.search()},K=async()=>{re(),ue()},he=n=>Ee(n,"en-IN",0),q=n=>{const f=typeof(n==null?void 0:n.totalValuations)=="number"?n==null?void 0:n.totalValuations:Ae(n==null?void 0:n.totalValuation),W=(typeof(n==null?void 0:n.rate)=="number"?n==null?void 0:n.rate:Ae(n==null?void 0:n.rate))||(n==null?void 0:n.completedPct)||(n==null?void 0:n.recommendedPct)||Number(f)>0;return W===!1&&ce(),W},De=n=>{const f=()=>{var Se;return(Se=n.propertyValuations)==null?void 0:Se.map(w=>({uid:w.uid??null,smAreaType:w.smAreaType,smConstructionType:w.smConstructionType,valuationAsPerPlan:w.valuationAsPerPlan,valuationAsPerSite:w.valuationAsPerSite,deviationPct:Number(w.deviationPct??0),rate:Number(w.rate??0),completedPct:Number((w==null?void 0:w.completedPct)??0),recommendedPct:Number(w.recommendedPct??0),totalValuation:Number(Ae(w.totalValuation)??0),isActive:w.isActive}))},B=()=>{var Se;return(Se=n.propertyAmenities)==null?void 0:Se.map(w=>({uid:(w==null?void 0:w.uid)??null,smAmenityType:"AREA_TYPE_AMENITIES",rate:(w==null?void 0:w.rate)===""?null:Number((w==null?void 0:w.rate)??0),completedPct:(w==null?void 0:w.completedPct)===""?null:Number((w==null?void 0:w.completedPct)??0),recommendedPct:(w==null?void 0:w.recommendedPct)===""?null:Number((w==null?void 0:w.recommendedPct)??0),totalValuation:Number(Ae(w==null?void 0:w.totalValuation)??0),isActive:w==null?void 0:w.isActive}))};return{uid:d.technicalUid,loan:{uid:d.loanUid},stage:{uid:d.stageUid},fairMarketValue:Number(Ae(a.fairMarketValue)),totalMarketValueOnCompletion:Number(Ae(a.totalPropertyValueOnCompletion)),forcedSaleValue:Number(Ae(a.forcedSaleValue)),stagePropertyAmenities:B(),stagePropertyValuations:f()}},Te=n=>{var f;return e.jsx(Re,{name:`smAreaType${n==null?void 0:n.uid}`,className:"!w-32",options:_,optionLabel:"name",optionValue:"code",value:n.smAreaType??"",onChange:B=>{de(B,n)},onBlur:I,validation:(f=y==null?void 0:y.current)==null?void 0:f.message(`smAreaType${n==null?void 0:n.uid}`,n==null?void 0:n.smAreaType,"mandatory")})},Ke=n=>{var f;return e.jsx(Re,{name:`smConstructionType${n.uid}`,className:"!w-32",options:J,optionLabel:"name",optionValue:"code",value:n.smConstructionType??"",onChange:B=>{z(B,n)},onBlur:I,validation:(f=y==null?void 0:y.current)==null?void 0:f.message(`smConstructionType${n.uid}`,n==null?void 0:n.smConstructionType,"mandatory")})},qe=n=>{var f;return e.jsx(V,{name:`valuationAsPerPlan${n.uid}`,className:"!w-44 text-right",variant:F.SECONDARY,value:typeof(n==null?void 0:n.valuationAsPerPlan)=="number"?he(n==null?void 0:n.valuationAsPerPlan):n==null?void 0:n.valuationAsPerPlan,onBlur:I,onChange:B=>{var te;const W={...n};W.valuationAsPerPlan=B.target.value,(te=S.current)==null||te.reportDataChange(W)},validation:(f=y==null?void 0:y.current)==null?void 0:f.message(`valuationAsPerPlan${n.uid}`,n==null?void 0:n.valuationAsPerPlan,"mandatory|checkNumber|maxDecimal:2")})},Qe=n=>{var f;return e.jsx(V,{name:`valuationAsPerSite${n.uid}`,className:"!w-44 text-right",variant:F.SECONDARY,value:typeof(n==null?void 0:n.valuationAsPerSite)=="number"?he(n==null?void 0:n.valuationAsPerSite):n==null?void 0:n.valuationAsPerSite,onBlur:I,onChange:B=>{var te;const W={...n};W.valuationAsPerSite=B.target.value,(te=S.current)==null||te.reportDataChange(W)},validation:(f=y==null?void 0:y.current)==null?void 0:f.message(`valuationAsPerSite${n.uid}`,n==null?void 0:n.valuationAsPerSite,"mandatory|checkNumber|maxDecimal:2")})},Je=n=>{var f;return e.jsx(V,{name:`deviationPct${n.uid}`,className:"!w-44 text-right",variant:F.SECONDARY,value:typeof(n==null?void 0:n.deviationPct)=="number"?he(n==null?void 0:n.deviationPct):n==null?void 0:n.deviationPct,onBlur:I,onChange:B=>{var te;const W={...n};W.deviationPct=B.target.value,(te=S.current)==null||te.reportDataChange(W)},validation:(f=y==null?void 0:y.current)==null?void 0:f.message(`deviationPct${n.uid}`,n==null?void 0:n.deviationPct,"mandatory|checkNumber|min:0,num|max:100,num|maxDecimal:2")})},Xe=n=>{var f;return e.jsx(V,{name:`rate${n.uid}`,className:"!w-44 text-right",variant:F.SECONDARY,value:typeof(n==null?void 0:n.rate)=="number"?he(n==null?void 0:n.rate):n==null?void 0:n.rate,onBlur:I,onChange:B=>{var te;const W={...n};W.rate=B.target.value,(te=S.current)==null||te.reportDataChange(W)},validation:(f=y==null?void 0:y.current)==null?void 0:f.message(`rate${n.uid}`,n==null?void 0:n.rate,"mandatory|checkNumber|onlyPositive|maxDecimal:2")})},tt=n=>{var f;return e.jsx(V,{name:`completedPct${n.uid}`,className:"!w-44 text-right",variant:F.SECONDARY,value:typeof(n==null?void 0:n.completedPct)=="number"?he(n==null?void 0:n.completedPct):n==null?void 0:n.completedPct,onBlur:I,onChange:B=>{var te;const W={...n};W.completedPct=B.target.value,(te=S.current)==null||te.reportDataChange(W)},validation:(f=y==null?void 0:y.current)==null?void 0:f.message(`completedPct${n.uid}`,n==null?void 0:n.completedPct,"mandatory|checkNumber|min:0,num|max:100,num|maxDecimal:2")})},nt=n=>{var f;return e.jsx(V,{name:`recommendedPct${n.uid}`,className:"!w-44 text-right",variant:F.SECONDARY,value:typeof(n==null?void 0:n.recommendedPct)=="number"?he(n==null?void 0:n.recommendedPct):n==null?void 0:n.recommendedPct,onBlur:I,onChange:B=>{var te;const W={...n};W.recommendedPct=B.target.value,(te=S.current)==null||te.reportDataChange(W)},validation:(f=y==null?void 0:y.current)==null?void 0:f.message(`recommendedPct${n.uid}`,n==null?void 0:n.recommendedPct,"mandatory|checkNumber|min:0,num|max:100,num|maxDecimal:2")})},st=n=>{var f;return e.jsx(V,{name:`totalValuation${n.uid}`,className:"!w-44 text-right",variant:F.SECONDARY,value:typeof(n==null?void 0:n.totalValuation)=="number"?he(n==null?void 0:n.totalValuation):n==null?void 0:n.totalValuation,onBlur:I,onChange:B=>{var Se;const W={...n},te=Ae(B.target.value);W.totalValuation=te<0?"":Ee(te,"en-IN",0),(Se=S.current)==null||Se.reportDataChange(W)},validation:(f=y==null?void 0:y.current)==null?void 0:f.message(`totalValuation${n.uid}`,n==null?void 0:n.totalValuation,"mandatory|onlyInteger")})},P=n=>e.jsx(ut,{buttonType:dt.DELETE,onClick:()=>$e(n),disabled:C===E.VIEW}),ne=n=>e.jsx(ie,{className:"",label:"Amenities"}),se=n=>{var f;return e.jsx(V,{name:`rate${n.uid}`,className:"!w-44 text-right",variant:F.SECONDARY,value:typeof(n==null?void 0:n.rate)=="number"?he(n==null?void 0:n.rate):n==null?void 0:n.rate,onBlur:q(n)?U:void 0,onChange:B=>{var te;const W={...n};W.rate=B.target.value,(te=R.current)==null||te.reportDataChange(W)},validation:q(n)?(f=k==null?void 0:k.current)==null?void 0:f.message(`rate${n.uid}`,n==null?void 0:n.rate,"mandatory|checkNumber|onlyPositive|maxDecimal:2"):void 0})},ae=n=>{var f;return e.jsx(V,{name:`completedPct${n.uid}`,className:"!w-44 text-right",variant:F.SECONDARY,value:typeof(n==null?void 0:n.completedPct)=="number"?he(n==null?void 0:n.completedPct):n==null?void 0:n.completedPct,onBlur:q(n)?U:void 0,onChange:B=>{var te;const W={...n};W.completedPct=B.target.value,(te=R.current)==null||te.reportDataChange(W)},validation:q(n)?(f=k==null?void 0:k.current)==null?void 0:f.message(`completedPct${n.uid}`,n==null?void 0:n.completedPct,"mandatory|checkNumber|min:0,num|max:100,num|maxDecimal:2"):void 0})},Pe=n=>{var f;return e.jsx(V,{name:`recommendedPct${n.uid}`,className:"!w-44 text-right",variant:F.SECONDARY,value:typeof(n==null?void 0:n.recommendedPct)=="number"?he(n==null?void 0:n.recommendedPct):n==null?void 0:n.recommendedPct,onBlur:q(n)?U:void 0,onChange:B=>{var te;const W={...n};W.recommendedPct=B.target.value,(te=R.current)==null||te.reportDataChange(W)},validation:q(n)?(f=k==null?void 0:k.current)==null?void 0:f.message(`recommendedPct${n.uid}`,n==null?void 0:n.recommendedPct,"mandatory|checkNumber|min:0,num|max:100,num|maxDecimal:2"):void 0})},it=n=>{var f;return e.jsx(V,{name:`totalValuation${n.uid}`,className:"!w-44 text-right",variant:F.SECONDARY,value:typeof(n==null?void 0:n.totalValuation)=="number"?he(n==null?void 0:n.totalValuation):n==null?void 0:n.totalValuation,onBlur:q(n)?U:void 0,onChange:B=>{var Se;const W={...n},te=Ae(B.target.value);W.totalValuation=te<0?"":Ee(te,"en-IN",0),(Se=R.current)==null||Se.reportDataChange(W)},validation:q(n)?(f=k==null?void 0:k.current)==null?void 0:f.message(`totalValuation${n.uid}`,n==null?void 0:n.totalValuation,"mandatory|onlyInteger"):void 0})},Qt=n=>e.jsx(ut,{buttonType:dt.DELETE,onClick:()=>l(n),disabled:!0}),Jt=()=>e.jsxs("div",{className:"mt-3 flex flex-col gap-5 w-full",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx(et,{label:"label.section.propertyValuation*",titleClass:"text-primary-sideBarBgColor text-xs font-bold "}),e.jsx("div",{className:"self-end",children:e.jsx(St,{buttonType:Nt.ADD_ASSET,onClick:Ve})})]}),d.loanUid&&d.stageUid&&e.jsx("div",{children:e.jsxs(At,{ref:S,uniqueKey:"uid",mode:"UPDATE",standardDataFormatPromise:ye.getPropertyValuation,search:`&loan.uid=${d.loanUid}&stage.uid=${d.stageUid}&isActive=${!0}`,className:"selected-existing-doc-read-table",children:[e.jsx(me,{header:m("label.section.propertyValuation.areaType"),className:"text-primary-ptext-1000 text-right text-xs h-12 pl-6",body:Te}),e.jsx(me,{header:m("label.section.propertyValuation.constructionType"),className:"text-right text-primary-ptext-1000 text-xs h-12 pl-6",body:Ke}),e.jsx(me,{header:m("label.section.propertyValuation.asPerPlan"),className:"text-primary-ptext-1000 text-right text-xs h-12 pl-6",body:qe}),e.jsx(me,{header:m("label.section.propertyValuation.asPerSite"),className:"text-right text-primary-ptext-1000 text-xs h-12 pl-6",body:Qe}),e.jsx(me,{header:m("label.section.propertyValuation.deviationIn"),className:"text-primary-ptext-1000 text-right text-xs h-12 pl-6",body:Je}),e.jsx(me,{header:m("label.section.propertyValuation.rate"),className:"text-right text-primary-ptext-1000 text-xs h-12 pl-6",body:Xe}),e.jsx(me,{header:m("label.section.propertyValuation.completed"),className:"text-primary-ptext-1000 text-right text-xs h-12 pl-6",body:tt}),e.jsx(me,{header:m("label.section.propertyValuation.recommended"),className:"text-right text-primary-ptext-1000 text-xs h-12 pl-6",body:nt}),e.jsx(me,{header:m("label.section.propertyValuation.valuation"),className:"text-primary-ptext-1000 text-right text-xs h-12 pl-6",body:st}),e.jsx(me,{header:m("label.investmentInfo.table.colTitle.action"),className:"text-primary-ptext-1000 text-center text-xs h-12 px-6",style:{minWidth:"50px",width:"50px"},body:P})]})})]}),Xt=()=>{var n,f;return e.jsxs("div",{className:"mt-3 flex flex-col gap-5 w-full",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx(et,{label:"label.section.amenities*",titleClass:"text-primary-sideBarBgColor text-xs font-bold "}),e.jsx("div",{className:"self-end",children:e.jsx(St,{buttonType:Nt.ADD_ASSET,onClick:_e,disabled:!!((f=(n=R==null?void 0:R.current)==null?void 0:n.getCurrentRecords())!=null&&f.length)})})]}),d.loanUid&&d.stageUid&&e.jsx("div",{children:e.jsxs(At,{ref:R,uniqueKey:"uid",mode:"UPDATE",standardDataFormatPromise:ye.getPropertyAmenities,search:`&loan.uid=${d.loanUid}&stage.uid=${d.stageUid}&isActive=${!0}`,className:" selected-existing-doc-read-table ",onUpdateCallback:()=>{g(B=>!B)},children:[e.jsx(me,{header:m("label.section.amenities.areaType"),className:"text-primary-ptext-1000 text-right text-xs h-12 pl-6",body:ne}),e.jsx(me,{header:m("label.section.amenities.rate"),className:"text-right text-primary-ptext-1000 text-xs h-12 pl-6",body:se}),e.jsx(me,{header:m("label.section.amenities.completed"),className:"text-primary-ptext-1000 text-right text-xs h-12 pl-6",body:ae}),e.jsx(me,{header:m("label.section.amenities.recommended"),className:"text-right text-primary-ptext-1000 text-xs h-12 pl-6",body:Pe}),e.jsx(me,{header:m("label.section.amenities.valuation"),className:"text-primary-ptext-1000 text-right text-xs h-12 pl-6",body:it}),e.jsx(me,{header:m("label.investmentInfo.table.colTitle.action"),className:"text-primary-ptext-1000 text-center text-xs h-12 px-6",style:{minWidth:"50px",width:"50px"},body:Qt})]})})]})},Zt=()=>{var n,f;return e.jsxs("div",{className:"flex flex-col justify-center items-center space-y-6 w-full",children:[Jt(),Xt(),e.jsxs("div",{className:"mt-5 w-full flex flex-wrap items-center gap-x-4 gap-y-5",children:[e.jsx("div",{className:"",children:e.jsx(V,{label:"label.section.amenities.fairMarketValue",name:"fairMarketValue",className:"!w-64 text-right",variant:F.SECONDARY,value:a==null?void 0:a.fairMarketValue,disabled:!0})}),e.jsx("div",{className:"",children:e.jsx(V,{label:"label.section.amenities.totalPropertyCompletion*",name:"totalPropertyValueOnCompletion",className:"!w-64 text-right",variant:F.SECONDARY,value:a==null?void 0:a.totalPropertyValueOnCompletion,onChange:le,onBlur:I,validation:(n=y==null?void 0:y.current)==null?void 0:n.message("totalPropertyValueOnCompletion",a==null?void 0:a.totalPropertyValueOnCompletion,"mandatory")})}),e.jsx("div",{className:"",children:e.jsx(V,{label:"label.section.amenities.forcedSaleValue*",name:"forcedSaleValue",className:"!w-64 text-right",variant:F.SECONDARY,value:a==null?void 0:a.forcedSaleValue,onChange:le,onBlur:I,validation:(f=y==null?void 0:y.current)==null?void 0:f.message("forcedSaleValue",a==null?void 0:a.forcedSaleValue,"mandatory")})})]})]})};return e.jsxs(e.Fragment,{children:[e.jsx(Ye,{title:"heading.section.valuation*",pageMode:C,disabled:A,onSave:We,onCancel:be,onEdit:ve,children:A?e.jsx(Ue,{height:"19.375rem",width:"100%",borderRadius:"8px",animation:"wave"}):e.jsx(je,{override:{read:C===E.VIEW},children:Zt()})}),e.jsx(Be,{position:H,ref:N,toastText:j,variant:Z}),e.jsx(Le,{onHide:()=>{D(!1),$("")},visible:c,errorMessage:X})]})}),Kt={uid:"",structureDescription:"",descriptionOfStage:"",technicalPct:"",recommendedPct:""},jn=t=>{const{isLoading:o,payloadInfo:p,getDataOnCancel:A,data:d}=t,[x,a]=i.useState({...Kt}),[s,C]=i.useState(E.VIEW),[O,_]=i.useState(""),[T,J]=i.useState(!1),[M,H]=i.useState(""),[Q,Z]=i.useState(!1),L=i.useRef(null),[,j]=i.useState(!1),h=i.useRef(new ge({validators:{...fe()},...xe(),autoForceUpdate:{forceUpdate:()=>j(m=>!m)}}));i.useEffect(()=>{d&&Object.keys(d).length>0&&a(()=>({...d}))},[d]),i.useEffect(()=>{var m;L!=null&&L.current&&O!==""&&((m=L==null?void 0:L.current)==null||m.showFunction(),_(""))},[O,T]),i.useEffect(()=>{M&&Z(!0)},[M]);const u=m=>{var g,v;(v=h==null?void 0:h.current)==null||v.showMessageFor((g=m==null?void 0:m.target)==null?void 0:g.name)},G=()=>{var g,v;let m=!1;return m=(g=h==null?void 0:h.current)==null?void 0:g.allValid(),m||(j(y=>!y),(v=h==null?void 0:h.current)==null||v.showMessages(),j(y=>!y),!1)},X=()=>{var m;h.current=new ge({validators:{...fe()},...xe(),autoForceUpdate:{forceUpdate:()=>j(g=>!g)}}),(m=h==null?void 0:h.current)==null||m.hideMessages()},$=m=>{a(g=>({...g,[m.target.name]:m.target.value}))},c=()=>C(E.EDIT),D=()=>{A==null||A(),X(),C(E.VIEW)},S=async()=>{if(!G())return;const m=R();try{const g=await ye.updateStageOfConstruction(m);ke(g)&&(_(Me.SAVED),J(!T),C(E.VIEW))}catch(g){console.log(g),H(oe(g))}},R=()=>({uid:p.technicalUid,loan:{uid:p.loanUid},stage:{uid:p.stageUid},stageConstructionDetail:{uid:x.uid?x.uid:null,constructionStructureDescription:x.structureDescription,constructionStageDescription:x.descriptionOfStage,technicalPct:Number(x.technicalPct),recommendedPct:Number(x.recommendedPct)}}),N=()=>{var m,g,v,y;return e.jsxs("div",{className:" w-full grid grid-cols-4 gap-x-4 gap-y-5",children:[e.jsx("div",{className:"col-span-1",children:e.jsx(V,{label:"label.technical.stageOfConstruction.structureDescription*",name:"structureDescription",className:"",variant:F.SECONDARY,value:x.structureDescription,onChange:$,onBlur:u,validation:(m=h==null?void 0:h.current)==null?void 0:m.message("structureDescription",x.structureDescription,"mandatory")})}),e.jsx("div",{className:"col-span-1",children:e.jsx(V,{label:"label.technical.stageOfConstruction.descriptionOfStage*",name:"descriptionOfStage",className:"",variant:F.SECONDARY,value:x.descriptionOfStage,onChange:$,onBlur:u,validation:(g=h==null?void 0:h.current)==null?void 0:g.message("descriptionOfStage",x.descriptionOfStage,"mandatory")})}),e.jsx("div",{className:"col-span-1",children:e.jsx(V,{label:"label.technical.stageOfConstruction.technical*",name:"technicalPct",className:"text-right",variant:F.SECONDARY,value:x.technicalPct,onChange:$,onBlur:u,validation:(v=h==null?void 0:h.current)==null?void 0:v.message("technicalPct",x.technicalPct,"mandatory|checkNumber|min:1,num|max:100,num|maxDecimal:2")})}),e.jsx("div",{className:"col-span-1",children:e.jsx(V,{label:"label.technical.stageOfConstruction.recommended*",name:"recommendedPct",className:"text-right",variant:F.SECONDARY,value:x.recommendedPct,onChange:$,onBlur:u,validation:(y=h==null?void 0:h.current)==null?void 0:y.message("recommendedPct",x.recommendedPct,"mandatory|checkNumber|min:1,num|max:100,num|maxDecimal:2")})})]})};return e.jsxs(e.Fragment,{children:[e.jsx(Ye,{title:"heading.technical.stageOfConstruction",pageMode:s,onSave:S,onCancel:D,onEdit:c,disabled:o,children:o?e.jsx(Ue,{height:"19.375rem",width:"100%",borderRadius:"8px",animation:"wave"}):e.jsx(je,{override:{read:s===E.VIEW},children:N()})}),e.jsx(Be,{position:"bottom-right",ref:L,toastText:O,variant:Ie.PRIMARY}),e.jsx(Le,{onHide:()=>{Z(!1),H("")},visible:Q,errorMessage:M})]})},qt={status:"",remarks:"",declaration:!1,engineerName:""},Tn=t=>{const{data:o=qt,isLoading:p,className:A,dropdownOptions:d,payloadInfo:x,getDataOnCancel:a}=t,[s,C]=i.useState(o),[O,_]=i.useState(E.VIEW),[T,J]=i.useState({remarkValidation:{errorMessage:""}}),[M,H]=i.useState(""),[Q,Z]=i.useState(!1),[L,j]=i.useState(""),[h,u]=i.useState(!1),G=i.useRef(null),X=i.useRef(null),[,$]=i.useState(!1),c=i.useRef(new ge({validators:{...fe()},...xe(),autoForceUpdate:{forceUpdate:()=>$(b=>!b)}}));i.useEffect(()=>{o&&Object.keys(o).length>0&&C(()=>({...o}))},[o]),i.useEffect(()=>{var b;G!=null&&G.current&&M!==""&&((b=G==null?void 0:G.current)==null||b.showFunction(),H(""))},[M,Q]),i.useEffect(()=>{L&&u(!0)},[L]);const D=b=>{var U,ee;(ee=c==null?void 0:c.current)==null||ee.showMessageFor((U=b==null?void 0:b.target)==null?void 0:U.name)},S=()=>{var U,ee;let b=!1;return b=(U=c==null?void 0:c.current)==null?void 0:U.allValid(),b||($(ce=>!ce),(ee=c==null?void 0:c.current)==null||ee.showMessages(),$(ce=>!ce),!1)},R=(b,U,ee)=>{var de,z,le,ve;const ce=(ve=(le=(z=(de=b==null?void 0:b.current)==null?void 0:de.editor)==null?void 0:z.plugins)==null?void 0:le.wordcount)==null?void 0:ve.body.getCharacterCount();return ee.includes("Mandatory")&&ce<1?(J(be=>({...be,[U]:{...be[U],errorMessage:"Mandatory"}})),!1):!0},N=()=>{var b;c.current=new ge({validators:{...fe()},...xe(),autoForceUpdate:{forceUpdate:()=>$(U=>!U)}}),(b=c==null?void 0:c.current)==null||b.hideMessages(),J(U=>({...U,remarkValidation:{errorMessage:""}}))},m=b=>{C(U=>({...U,[b.target.name]:b.target.value}))},g=b=>{C(U=>({...U,[b.target.name]:b.checked}))},v=(b,U)=>{var ee;R(U,"remarkValidation",["Mandatory"])&&(ee=T==null?void 0:T.remarkValidation)!=null&&ee.errorMessage&&J(ce=>({...ce,remarkValidation:{...ce.remarkValidation,errorMessage:""}}))},y=async()=>{var ee,ce;const b=S(),U=R(X,"remarkValidation",["Mandatory"]);if(!(!b||!U))try{if((ce=(ee=X.current)==null?void 0:ee.editor)!=null&&ce.getContent()){const de=ue(),z=await ye.updateTechnicalStatus(de);ke(z)&&(H(Me.SAVED),Z(!Q),_(E.VIEW))}}catch(de){console.log(de),j(oe(de))}},k=()=>_(E.EDIT),re=()=>{a==null||a(),N(),_(E.VIEW)},ue=()=>{var U,ee;return{uid:x.technicalUid??"",loan:{uid:x.loanUid??""},stage:{uid:x.stageUid??""},smTechnicalStatus:s.status,overallTechnicalRemarks:(ee=(U=X.current)==null?void 0:U.editor)==null?void 0:ee.getContent(),inspectionEngineerName:s.engineerName,isDeclarationChecked:s.declaration}},I=()=>{var b;return e.jsx(He.Fragment,{children:e.jsxs("ol",{className:"text-xs list-decimal flex flex-col gap-3",children:[e.jsx("li",{className:"",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx(ie,{className:"inline mr-2",label:"label.technical.declaration.content1"}),e.jsx("div",{className:"!w-62.5 inline-input",children:e.jsx(V,{className:"!h-6",name:"engineerName",value:s==null?void 0:s.engineerName,onChange:m,onBlur:D,validation:(b=c==null?void 0:c.current)==null?void 0:b.message("engineerName",s==null?void 0:s.engineerName,"mandatory"),hideLabel:!0})}),e.jsx(ie,{className:"inline ml-2",label:"label.technical.declaration.content2"})]})}),e.jsx("li",{children:e.jsx(ie,{className:"",label:"label.technical.declaration.content3"})}),e.jsx("li",{children:e.jsx(ie,{className:"",label:"label.technical.declaration.content4"})}),e.jsx("li",{children:e.jsx(ie,{className:"",label:"label.technical.declaration.content5"})})]})})},Y=()=>{var ce,de;const{status:b,remarks:U,declaration:ee}=s;return e.jsxs("div",{className:"flex flex-col justify-center items-start w-full gap-y-3 mt-3",children:[e.jsx("div",{className:"w-62.5 ",children:e.jsx(Re,{label:"label.technical.status.mandatory",placeholder:"placeholder.legal.status*",name:"status",value:b,onChange:m,onBlur:D,validation:(ce=c==null?void 0:c.current)==null?void 0:ce.message("status",b,"mandatory"),options:d==null?void 0:d.status,optionLabel:"label",optionValue:"value",disabled:O===E.VIEW})}),e.jsxs("div",{className:"w-full flex flex-col justify-center items-start space-y-2",children:[e.jsx(ie,{label:"label.technical.overall.remarks*",className:"text-primary-sideBarBgColor text-xs font-bold mb-1"}),e.jsx(un,{disabled:O===E.VIEW,ref:X,initialValue:U,onChange:z=>v(z,X),validation:T==null?void 0:T.remarkValidation})]}),e.jsxs("div",{className:"w-full flex flex-col justify-center items-start space-y-2",children:[e.jsx(ie,{label:"label.technical.declaration",className:"text-primary-sideBarBgColor text-xs font-bold mb-1"}),e.jsxs("div",{className:"w-full flex justify-start items-start space-x-6",children:[e.jsx(an,{name:"declaration",value:ee,checked:ee,onChange:g,validation:(de=c==null?void 0:c.current)==null?void 0:de.message("declaration",ee,"checked"),hideLabel:!0,hideErrorRow:!0}),e.jsx("div",{children:I()})]})]})]})};return e.jsxs("div",{children:[e.jsx(Ye,{pageMode:O,title:"heading.technical.status",onCancel:re,onEdit:k,onSave:y,disabled:p,children:p?e.jsx(Ue,{height:"19.375rem",width:"100%",borderRadius:"8px",animation:"wave"}):e.jsx(je,{override:{read:O===E.VIEW},children:Y()})}),e.jsx(Be,{position:"bottom-right",ref:G,toastText:M,variant:Ie.PRIMARY}),e.jsx(Le,{onHide:()=>{u(!1),j("")},visible:h,errorMessage:L})]})},Rn={savedDocuments:[]},In=t=>{const{isLoading:o,payloadInfo:p,getDataOnCancel:A,data:d}=t,[x,a]=i.useState(d),[s,C]=i.useState(E.VIEW),[O,_]=i.useState("1"),[T,J]=i.useState(""),[M,H]=i.useState(!1),[Q,Z]=i.useState(""),[L,j]=i.useState(!1),h=i.useRef(null),u=i.useRef(null);i.useEffect(()=>{d&&Object.keys(d).length>0&&(a(()=>({...d})),_(Math.random().toString()))},[d]),i.useEffect(()=>{var S;h!=null&&h.current&&T!==""&&((S=h==null?void 0:h.current)==null||S.showFunction(),J(""))},[T,M]),i.useEffect(()=>{Q&&j(!0)},[Q]);const G=async()=>{var N;const S=(N=u.current)==null?void 0:N.getUploadedData();if(!S)return;const R=c(S);try{const m=await ye.updateUploadReport(R);ke(m)&&(J(Me.SAVED),H(!M),C(E.VIEW))}catch(m){console.log(m),Z(oe(m))}},X=()=>C(E.EDIT),$=()=>{A==null||A(),C(E.VIEW)},c=S=>{const R=m=>m.map(v=>({uid:v.uid?v.uid:null,section:v.code,fileName:v.fileName,fileType:v.contentType,thumbUrl:v.thumbUrl,url:v.url,isActive:v.isActive}));return{uid:p.technicalUid,loan:{uid:p.loanUid},stage:{uid:p.stageUid},loanDocuments:[{docType:{uid:S.documentUid},docCategory:S.documentCategory,documentSections:R(S.documentSectionUrls)}]}},D=()=>{var S,R;return e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsx(et,{label:"",value:"Attach Documents (PDF, JPG, JPEG or PNG)",titleClass:"text-primary-sideBarBgColor text-sm font-bold mb-1"}),e.jsx(Dt,{mandatoryDocUpload:!0,ref:u,savedDocument:(S=d.savedDocuments)!=null&&S[0]?(R=d.savedDocuments)==null?void 0:R[0]:{},mode:s===E.VIEW?ct.VIEW:ct.EDIT,queryParamForDocList:Yt.DOCUMENT_CATEGORY_TECHNICAL_DOCUMENT},O)]})};return e.jsxs("div",{children:[e.jsx(Ye,{pageMode:s,title:"heading.technical.upload.technical.report",onSave:G,onEdit:X,onCancel:$,disabled:o,children:o?e.jsx(Ue,{height:"19.375rem",width:"100%",borderRadius:"8px",animation:"wave"}):e.jsx(je,{override:{read:s===E.VIEW},children:D()})}),e.jsx(Be,{position:"bottom-right",ref:h,toastText:T,variant:Ie.PRIMARY}),e.jsx(Le,{onHide:()=>{j(!1),Z("")},visible:L,errorMessage:Q})]})},Ln=He.memo(In),Un={showInfo:!0,loanUid:"",stageUid:"",stageInfo:{},technicalUid:"",dropdownOptions:{verificationStatus:[],vendorType:[],questions:[],marketability:[],riskOfDemolition:[],landOfUse:[],conditionOfProperty:[],units:[],holdingType:[],occupancyStatus:[],status:[]},initiationInfo:{...Ht},generalDetails:{...Vt},documentDetails:{...Gt},localityDetails:{...zt},propertyDetails:{...ht},propertyValuationAndAmenities:{...On},stageOfConstruction:{...Kt},governmentGuideLine:{...$t},occupancyDetails:{...yn},propertyPhotos:{...Pn},technicalStatus:{...qt},uploadedTechnicalReport:{...Rn},isLoadingInitiationInfo:!0,isLoadingGeneralDetails:!0,isLoadingDocumentDetails:!0,isLoadingLocalityDetails:!0,isLoadingApplicantDetails:!1,isLoadingPropertyDetails:!0,isLoadingPropertyValuationAndAmenities:!0,isLoadingStageOfConstruction:!0,isLoadingGovernmentGuideLines:!0,isLoadingOccupancyDetails:!0,isLoadingPropertyPhotos:!0,isLoadingTechnicalStatus:!0,isLoadingUploadedTechnicalReport:!0},ks=()=>{var _e;const t=en(),[o,p]=i.useState({...Un}),[A,d]=i.useState(""),[x,a]=i.useState(!1),[s,C]=i.useState(!1),O=dn(l=>l.UserProfileReducers.profileObj),_=(O==null?void 0:O.sahayyaUserType)===tn.PARTNER_USER,T={technicalUid:o.technicalUid,loanUid:o.loanUid,stageUid:o.stageUid};i.useEffect(()=>{t.stageUid&&J()},[t.stageUid]),i.useEffect(()=>{o.stageUid&&M()},[o.stageUid]),i.useEffect(()=>{o.technicalUid&&(H(),Q(),Z(),L(),j(),h())},[o.technicalUid]),i.useEffect(()=>{A&&a(!0)},[A]),i.useEffect(()=>{var l,r,K;((l=o.stageInfo)==null?void 0:l.status)===lt.IN_REVIEW?C(!0):_?((r=o.stageInfo)==null?void 0:r.status)===lt.COMPLETED||((K=o.stageInfo)==null?void 0:K.status)===lt.CANCELLED?C(!0):C(!1):C(!0)},[(_e=o.stageInfo)==null?void 0:_e.status,_]);const J=async()=>{p(l=>({...l,loanUid:t.loanUid??"",stageUid:(t==null?void 0:t.stageUid)??""})),u(),G(),D(),c(),X(),$(),S(),R(),N(),m(),g()},M=async l=>{var r,K,he;try{const q=await Pt.getStageDetails(o.stageUid);if(Ne(q)){if(l)return q==null?void 0:q.data;const De=await Pt.getPropertyDetails(0,10,`uid=${((he=(K=(r=q==null?void 0:q.data)==null?void 0:r.stage)==null?void 0:K.address)==null?void 0:he.uid)??""}`);p(Te=>{var Ke,qe,Qe,Je,Xe;return{...Te,stageInfo:q==null?void 0:q.data.stage,technicalUid:(Qe=(qe=(Ke=q==null?void 0:q.data)==null?void 0:Ke.stage)==null?void 0:qe.technical)==null?void 0:Qe.uid,initiationInfo:{...Te.initiationInfo,...mn(q==null?void 0:q.data,(Xe=(Je=De==null?void 0:De.data)==null?void 0:Je.results)==null?void 0:Xe[0])},isLoadingInitiationInfo:!1,documentDetails:{...Te.documentDetails,...Ot(q==null?void 0:q.data)},isLoadingDocumentDetails:!1,localityDetails:{...Te.localityDetails,...Et(q==null?void 0:q.data)},isLoadingLocalityDetails:!1,governmentGuideLine:{...Te.governmentGuideLine,...It(q==null?void 0:q.data)},isLoadingGovernmentGuideLines:!1,occupancyDetails:{...Te.occupancyDetails,...Lt(q==null?void 0:q.data)},isLoadingOccupancyDetails:!1,technicalStatus:{...Te.technicalStatus,...Ft(q==null?void 0:q.data)},isLoadingTechnicalStatus:!1}})}}catch(q){d(oe(q)),p(De=>({...De,isLoadingInitiationInfo:!1,isLoadingDocumentDetails:!1,isLoadingLocalityDetails:!1,isLoadingGovernmentGuideLines:!1,isLoadingOccupancyDetails:!1,isLoadingTechnicalStatus:!1}))}},H=async l=>{try{const r=await ye.getGeneralDetails(o.technicalUid);if(Ne(r)){if(l)return r==null?void 0:r.data;p(K=>({...K,generalDetails:{...K.generalDetails,...Ct(r==null?void 0:r.data)},isLoadingGeneralDetails:!1}))}}catch(r){console.log(r),d(oe(r)),p(K=>({...K,isLoadingGeneralDetails:!1}))}},Q=async l=>{try{const r=await ye.getPropertyDetails(o.technicalUid);if(Ne(r)){if(l)return r==null?void 0:r.data;p(K=>({...K,propertyDetails:{...K.propertyDetails,...jt(r==null?void 0:r.data)},isLoadingPropertyDetails:!1}))}}catch(r){console.log(r),d(oe(r)),p(K=>({...K,isLoadingPropertyDetails:!1}))}},Z=async l=>{try{const r=await ye.getValuationAndAmenities(o.technicalUid);if(Ne(r)){if(l)return r==null?void 0:r.data;p(K=>({...K,propertyValuationAndAmenities:{...K.propertyValuationAndAmenities,...Tt(r==null?void 0:r.data)},isLoadingPropertyValuationAndAmenities:!1}))}}catch(r){console.log(r),d(oe(r)),p(K=>({...K,isLoadingPropertyValuationAndAmenities:!1}))}},L=async l=>{try{const r=await ye.getStageOfConstruction(o.technicalUid);if(Ne(r)){if(l)return r==null?void 0:r.data;p(K=>({...K,stageOfConstruction:{...K.stageOfConstruction,...Rt(r==null?void 0:r.data)},isLoadingStageOfConstruction:!1}))}}catch(r){console.log(r),d(oe(r)),p(K=>({...K,isLoadingStageOfConstruction:!1}))}},j=async l=>{try{const r=await ye.getPropertyPhotos(o.technicalUid);if(Ne(r)){if(l)return r==null?void 0:r.data;p(K=>({...K,propertyPhotos:{...K.propertyPhotos,...Ut(r==null?void 0:r.data)},isLoadingPropertyPhotos:!1}))}}catch(r){console.log(r),d(oe(r)),p(K=>({...K,isLoadingPropertyPhotos:!1}))}},h=async l=>{try{const r=await ye.getUploadReport(o.technicalUid);if(Ne(r)){if(l)return r==null?void 0:r.data;p(K=>({...K,uploadedTechnicalReport:{...K.uploadedTechnicalReport,...kt(r==null?void 0:r.data)},isLoadingUploadedTechnicalReport:!1}))}}catch(r){console.log(r),d(oe(r)),p(K=>({...K,isLoadingUploadedTechnicalReport:!1}))}},u=()=>{Fe.getAll(0,1e3,"staticMasterType.code=VENDOR_TYPE&").then(l=>{var r;Ne(l)&&z("vendorType",(r=l==null?void 0:l.data)==null?void 0:r.results)}).catch(l=>{console.log(l),d(oe(l))})},G=()=>{Fe.getAll(0,1e3,"staticMasterType.code=PROPERTY_DETAIL_QUESTIONS").then(l=>{var r;Ne(l)&&z("questions",(r=l==null?void 0:l.data)==null?void 0:r.results)}).catch(l=>{console.log(l),d(oe(l))})},X=()=>{z("marketability",[...nn])},$=()=>{Fe.getAll(0,1e3,"staticMasterType.code=RISK_OF_DEMOLITION&").then(l=>{var r;Ne(l)&&z("riskOfDemolition",(r=l==null?void 0:l.data)==null?void 0:r.results)}).catch(l=>{console.log(l),d(oe(l))})},c=()=>{Fe.getAll(0,1e3,"staticMasterType.code=TECHNICAL_LAND_USE&").then(l=>{var r;Ne(l)&&z("landOfUse",(r=l==null?void 0:l.data)==null?void 0:r.results)}).catch(l=>{console.log(l),d(oe(l))})},D=()=>{Fe.getAll(0,1e3,"staticMasterType.code=CONDITION_OF_PROPERTY&").then(l=>{var r;Ne(l)&&z("conditionOfProperty",(r=l==null?void 0:l.data)==null?void 0:r.results)}).catch(l=>{console.log(l),d(oe(l))})},S=()=>{Fe.getAll(0,1e3,"staticMasterType.code=UNIT&").then(l=>{var r;Ne(l)&&z("units",(r=l==null?void 0:l.data)==null?void 0:r.results)}).catch(l=>{console.log(l),d(oe(l))})},R=()=>{Fe.getAll(0,1e3,"staticMasterType.code=HOLDING_TYPE&").then(l=>{var r;Ne(l)&&z("holdingType",(r=l==null?void 0:l.data)==null?void 0:r.results)}).catch(l=>{console.log(l),d(oe(l))})},N=()=>{Fe.getAll(0,1e3,"staticMasterType.code=CLASS_OF_LOCALITY&").then(l=>{var r;Ne(l)&&z("classOfLocality",(r=l==null?void 0:l.data)==null?void 0:r.results)}).catch(l=>{console.log(l),d(oe(l))})},m=()=>{Fe.getAll(0,1e3,"staticMasterType.code=STATUS_OF_OCCUPANCY").then(l=>{var r;Ne(l)&&z("occupancyStatus",(r=l==null?void 0:l.data)==null?void 0:r.results)}).catch(l=>{console.log(l),d(oe(l))})},g=()=>{z("status",[...sn])},v=()=>{p(l=>({...l,showInfo:!1}))},y=async()=>{const l=await H(!0);p(r=>({...r,generalDetails:{...r.generalDetails,...Ct(l)}}))},k=async()=>{const l=await M(!0);p(r=>({...r,documentDetails:{...r.documentDetails,...Ot(l)}}))},re=async()=>{const l=await M(!0);p(r=>({...r,localityDetails:{...r.localityDetails,...Et(l)}}))},ue=async()=>{const l=await Q(!0);p(r=>({...r,propertyDetails:{...r.propertyDetails,...jt(l)}}))},I=async()=>{const l=await Z(!0);p(r=>({...r,propertyValuationAndAmenities:{...r.propertyValuationAndAmenities,...Tt(l)}}))},Y=async()=>{const l=await L(!0);p(r=>({...r,stageOfConstruction:{...r.stageOfConstruction,...Rt(l)}}))},b=async()=>{const l=await M(!0);p(r=>({...r,governmentGuideLine:{...r.governmentGuideLine,...It(l)}}))},U=async()=>{const l=await M(!0);p(r=>({...r,occupancyDetails:{...r.occupancyDetails,...Lt(l)}}))},ee=async()=>{const l=await j(!0);p(r=>({...r,propertyPhotos:{...r.propertyPhotos,...Ut(l)}}))},ce=async()=>{const l=await M(!0);p(r=>({...r,technicalStatus:{...r.technicalStatus,...Ft(l)}}))},de=async()=>{const l=await h(!0);p(r=>({...r,uploadedTechnicalReport:{...r.uploadedTechnicalReport,...kt(l)}}))},z=(l,r)=>{p(K=>({...K,dropdownOptions:{...K==null?void 0:K.dropdownOptions,[l]:r??[]}}))},le=()=>{var l;return{vendorType:(l=o.dropdownOptions)==null?void 0:l.vendorType}},ve=()=>{var l,r;return{units:(l=o.dropdownOptions)==null?void 0:l.units,holdingType:(r=o.dropdownOptions)==null?void 0:r.holdingType}},be=()=>{var l,r,K,he,q;return{questions:(l=o.dropdownOptions)==null?void 0:l.questions,marketability:(r=o.dropdownOptions)==null?void 0:r.marketability,landOfUse:(K=o.dropdownOptions)==null?void 0:K.landOfUse,riskOfDemolition:(he=o.dropdownOptions)==null?void 0:he.riskOfDemolition,conditionOfProperty:(q=o.dropdownOptions)==null?void 0:q.conditionOfProperty}},We=()=>{var l;return{classOfLocality:(l=o.dropdownOptions)==null?void 0:l.classOfLocality}},Ve=()=>{var l;return{occupancyStatus:(l=o.dropdownOptions)==null?void 0:l.occupancyStatus}},$e=()=>{var l;return{status:(l=o.dropdownOptions)==null?void 0:l.status}};return e.jsxs("div",{className:"flex flex-col gap-4",children:[o!=null&&o.showInfo?e.jsx(on,{description:"description.rcu.info",onClose:v}):null,e.jsx(fn,{isLoadingInitial:o.isLoadingInitiationInfo,data:o.initiationInfo,dropdownOptions:le()}),e.jsxs(je,{override:{read:s},children:[e.jsx(at,{title:"heading.technical.technicalReport",children:e.jsxs(e.Fragment,{children:[e.jsx(pn,{isLoading:o.isLoadingGeneralDetails,data:o.generalDetails,payloadInfo:T,getDataOnCancel:y}),e.jsx(hn,{isLoading:o.isLoadingDocumentDetails,data:o==null?void 0:o.documentDetails,payloadInfo:T,getDataOnCancel:k,dropDownOptions:ve()}),e.jsx(xn,{isLoading:o.isLoadingLocalityDetails,data:o.localityDetails,payloadInfo:T,getDataOnCancel:re,dropDownOptions:We()}),e.jsx(Nn,{isLoading:o.isLoadingPropertyValuationAndAmenities,data:o.propertyDetails,payloadInfo:T,getDataOnCancel:ue,dropDownOptions:be()}),e.jsx(En,{isLoading:o.isLoadingPropertyValuationAndAmenities,data:o.propertyValuationAndAmenities,payloadInfo:T,getDataOnCancel:I}),e.jsx(jn,{isLoading:o.isLoadingStageOfConstruction,data:o.stageOfConstruction,payloadInfo:T,getDataOnCancel:Y})," ",e.jsx(gn,{isLoading:o.isLoadingGovernmentGuideLines,data:o.governmentGuideLine,payloadInfo:T,getDataOnCancel:b})," ",e.jsx(vn,{isLoading:o.isLoadingOccupancyDetails,data:o.occupancyDetails,payloadInfo:T,getDataOnCancel:U,dropDownOptions:Ve()})]})}),e.jsx(at,{title:"heading.technical.property.photos",children:e.jsxs(e.Fragment,{children:[e.jsx(An,{isLoading:o.isLoadingPropertyPhotos,data:o.propertyPhotos,payloadInfo:T,getDataOnCancel:ee}),e.jsx(Tn,{isLoading:o.isLoadingTechnicalStatus,data:o.technicalStatus,dropdownOptions:$e(),payloadInfo:T,getDataOnCancel:ce}),e.jsx(Ln,{isLoading:o.isLoadingUploadedTechnicalReport,data:o.uploadedTechnicalReport,payloadInfo:T,getDataOnCancel:de})]})})]}),e.jsx(Le,{onHide:()=>{a(!1),d("")},visible:x,errorMessage:A})]})};export{ks as default};
//# sourceMappingURL=PageReport-ffa239fd.js.map
