import{w as fe,r as s,aF as r,aG as y,ad as he,ae as Se,af as Ne,y as z,v as xe,j as t,ax as Z,J as C,o as E,aA as Ae,a$ as P,aH as x,ao as _,aI as ee,aJ as ae,aK as T}from"./index-e8217573.js";import{B as f}from"./ButtonBox-9e46519a.js";import{C as Ie}from"./CheckBox-8a0c0e77.js";import{I as te}from"./InputBox-b9e88f52.js";import{I as Y}from"./InputTextArea-b90aad1d.js";import{P as je}from"./PageTitle-b3bba3d4.js";import{T as Re}from"./Toast-ae99ea5b.js";import{S as k}from"./SystemConfig-ceba820c.js";import{S as Oe}from"./StaticMasterTypeService-480bff1a.js";import"./kebab-menu-8835ad2e.js";import"./withAuth-6de36ebf.js";import"./TransitionGroup-c8afe0ce.js";const be=u=>{var J,G,q,K;const[i,A]=s.useState({masterType:{uid:""},displayName:"",systemCode:"",encrypted:!1,value:"",description:"",reasons:"",isActive:""}),[d,I]=s.useState(r.CREATE),[se,ne]=s.useState({}),[ie,Pe]=s.useState(!1),[oe,_e]=s.useState(!1);s.useState(!1);const[ce,D]=s.useState("bottom-right"),[Ye,m]=s.useState(""),[j,h]=s.useState(""),[M,S]=s.useState(y.PRIMARY),[p,N]=s.useState(!1),[re,R]=s.useState(!1);s.useState(!1);const[O,de]=s.useState(void 0),l=s.useRef(null),[,b]=s.useState(void 0),c=s.useRef(new he({validators:{...Se()},...Ne(),autoForceUpdate:{forceUpdate:()=>b(e=>!e)}}));s.useEffect(()=>{const e=z.parse(u.location.search);e!=null&&e.mode&&(e==null?void 0:e.mode)!==void 0&&I(e.mode)},[]),s.useEffect(()=>{const e=z.parse(u.location.search);e!=null&&e.mode&&(e==null?void 0:e.mode)!==void 0&&I(e.mode),e!=null&&e.uid&&(e==null?void 0:e.uid)!==void 0&&(de(e.uid),console.log(e.uid),k.findById(e.uid).then(a=>{var n,o,g,H,X,Q,$;xe(a)&&(console.log(a),a.data&&(A({masterType:{uid:""},displayName:((n=a==null?void 0:a.data)==null?void 0:n.name)??"",systemCode:((o=a==null?void 0:a.data)==null?void 0:o.code)??"",value:((g=a==null?void 0:a.data)==null?void 0:g.value)??"",encrypted:((H=a==null?void 0:a.data)==null?void 0:H.isEncrypted)??"",description:((X=a==null?void 0:a.data)==null?void 0:X.description)??"",reasons:((Q=a==null?void 0:a.data)==null?void 0:Q.reason)??"",isActive:($=a==null?void 0:a.data)!=null&&$.isActive?"ACTIVE":"IN_ACTIVE"}),ne({...a==null?void 0:a.data})))}).catch(a=>{console.log(a)}))},[]);const v=e=>{const{name:a,value:n}=e.target;A(o=>({...o,[a]:n}))};s.useEffect(()=>{var e;l!=null&&l.current&&j!==""&&((e=l==null?void 0:l.current)==null||e.showFunction())},[j,M,p]);const F=async()=>{var a,n;let e=!1;return e=((a=c==null?void 0:c.current)==null?void 0:a.allValid())&&!oe&&!ie,e||(b(o=>!o),(n=c==null?void 0:c.current)==null||n.showMessages(),b(o=>!o),!1)},le=()=>{var g;const e={uid:O,staticMasterType:{uid:(g=i.masterType)==null?void 0:g.uid},name:i.displayName,code:i.systemCode,value:i.value,isEncrypted:i.encrypted,description:i.description,reason:i.reasons};let a;const n=e,o=se;return d===r.CREATE?a={name:i.displayName,operationType:ee.CREATE,entity:ae.SYSTEM_CONFIGURATION,initialStateJson:"",finalStateJson:T(n),reqPayload:T(n),reasonForChange:i.reasons}:a={name:i.displayName,operationType:ee.UPDATE,entity:ae.SYSTEM_CONFIGURATION,initialStateJson:T(o),finalStateJson:T(n),reqPayload:T(n),reasonForChange:i.reasons},a},ue=async()=>{m("");let e=!1;if(e=await F(),!e){D("top-right"),S(y.QUATERNARY),h(x.ERROR),N(!p);return}const a=()=>{var o;return{staticMasterType:{uid:(o=i.masterType)==null?void 0:o.uid},name:i.displayName,code:i.systemCode,value:i.value,isEncrypted:i.encrypted,description:i.description,reason:i.reasons}};if(d===r.EDIT&&O!==void 0){const n=a();return k.update(n,O).then(o=>{D("bottom-right"),S(y.PRIMARY),h(x.SAVED),N(!p),R(!0)}).catch(o=>{m(_(o))})}else{const n=a();return k.save(n).then(o=>{S(y.PRIMARY),h(x.SAVED),N(!p),R(!0)}).catch(o=>{m(_(o))})}},[V,me]=s.useState(!1),pe=()=>{const e=!V;me(e),A(a=>({...a,encrypted:e}))};s.useEffect(()=>{"this is to check"},[V]);const ve=()=>{u.navigate(P)},ge=async()=>{m("");let e=!1;if(e=await F(),!e)return;const a=le();return Oe.approve(a).then(n=>{S(y.PRIMARY),h(x.SENT_FOR_APPROVAL),N(!p),R(!0)}).catch(n=>{m(_(n))})},ye=()=>{u.navigate(P)},Ce=()=>{I(r.EDIT)},Ee=()=>{switch(d){case r.CREATE:return"heading.systemConfiguration.create";case r.VIEW:return"heading.systemConfiguration.view";case r.EDIT:return"heading.systemConfiguration.edit";default:return"heading.systemConfiguration.create"}},{displayName:w,systemCode:U,value:B,encrypted:L,description:Te,reasons:W,isActive:ke}=i;return t.jsx(Z,{children:t.jsxs("div",{className:"flex flex-col gap-3",children:[t.jsxs("div",{className:"flex items-center justify-between w-full",children:[t.jsx(je,{title:Ee()}),t.jsx("div",{className:"flex",children:d===r.CREATE||d===r.EDIT?t.jsxs("div",{className:"flex gap-10",children:[t.jsxs("div",{className:"flex gap-5",children:[t.jsx(f,{className:"reset-red",buttonType:C.CANCEL_OUTLINE,onClick:ve}),t.jsx(f,{buttonType:C.SAVE_OUTLINE,onClickWithLoader:ue})]}),t.jsx("div",{children:t.jsx(f,{className:"approve-primary",buttonType:C.SEND_FOR_APPROVAL,onClickWithLoader:ge})})]}):t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"mr-5",children:t.jsx(f,{buttonType:C.BACK_OUTLINE,onClick:ye})}),t.jsx("div",{className:"",children:t.jsx(f,{buttonType:C.EDIT_OUTLINE,className:"blue-primary",onClick:Ce})})]})})]}),t.jsxs(Z,{override:{read:[r.VIEW,r.REVIEW].includes(d)},children:[t.jsxs("div",{className:"grid grid-cols-4 gap-3 mt-3",children:[t.jsx("div",{className:"col-span-1",children:t.jsx(te,{label:"input.systemConfiguration.displayName",name:"displayName",variant:E.SECONDARY,onChange:v,value:w,disabled:d===r.VIEW,validation:(J=c==null?void 0:c.current)==null?void 0:J.message("displayName",w,"mandatory")})}),t.jsx("div",{className:"col-span-1",children:t.jsx(te,{label:"input.systemConfiguration.systemCode",name:"systemCode",variant:E.SECONDARY,onChange:v,value:U,disabled:d===r.VIEW,validation:(G=c==null?void 0:c.current)==null?void 0:G.message("systemCode",U,"mandatory")})}),t.jsx("div",{className:"col-span-1",children:t.jsx(Ie,{checked:L,label:"input.systemConfiguration.encrypted",name:"encrypted",variant:Ae.PRIMARY,onChange:pe,value:L,disabled:d===r.VIEW})})]}),t.jsxs("div",{className:"grid grid-cols-4 gap-3",children:[t.jsx("div",{className:"col-span-2",children:t.jsx(Y,{label:"input.systemConfiguration.value",name:"value",variant:E.SECONDARY,maxCount:200,onChange:v,value:B,disabled:d===r.VIEW,validation:(q=c==null?void 0:c.current)==null?void 0:q.message("value",B,"mandatory")})}),t.jsx("div",{className:"col-span-2",children:t.jsx(Y,{label:"input.systemConfiguration.description",name:"description",variant:E.SECONDARY,maxCount:200,onChange:v,value:Te,disabled:d===r.VIEW})})]}),t.jsx("div",{className:"grid grid-cols-4 gap-3",children:t.jsx("div",{className:"col-span-2",children:t.jsx(Y,{label:"input.systemConfiguration.reasons",name:"reasons",variant:E.SECONDARY,maxCount:200,onChange:v,value:W,disabled:d===r.VIEW,validation:(K=c==null?void 0:c.current)==null?void 0:K.message("reasons",W,"mandatory")})})})]}),t.jsx(Re,{position:ce,ref:l,toastText:j,variant:M,onRemove:()=>{re&&u.navigate(P)}})]})})},Ke=fe(be);export{Ke as default};
//# sourceMappingURL=PageSystemConfigurationCreateViewEdit-12024319.js.map
