import{w as ne,r as s,aF as i,aG as g,ad as oe,ae as ie,af as re,y as ce,v as le,j as a,ax as L,J as E,o as I,aH as N,ao as W,cr as w,b as de,l as ue}from"./index-e8217573.js";import{B as h}from"./ButtonBox-9e46519a.js";import{D as me}from"./DatePicker-b1c13861.js";import{E as ge}from"./ErrorDialog-d5eef4d7.js";import{I as G}from"./InputTextArea-b90aad1d.js";import{P as Ee}from"./PageTitle-b3bba3d4.js";import{T as he}from"./Toast-ae99ea5b.js";import{S as D}from"./SystemDate-aca727a8.js";import"./kebab-menu-8835ad2e.js";import"./withAuth-6de36ebf.js";import"./Dialog-adadaf64.js";import"./TransitionGroup-c8afe0ce.js";const De=T=>{var U,V;const[d,f]=s.useState({systemDate:"",sequence:"",description:"",reasons:"",isActive:""}),[c,R]=s.useState(i.CREATE),[Te,$]=s.useState({}),[q,b]=s.useState("bottom-right"),[v,x]=s.useState(""),[p,S]=s.useState(""),[P,y]=s.useState(g.PRIMARY),[u,j]=s.useState(!1),[H,O]=s.useState(!1),[M,J]=s.useState(void 0),[K,Y]=s.useState(!1),l=s.useRef(null),[,A]=s.useState(void 0),o=s.useRef(new oe({validators:{...ie()},...re(),autoForceUpdate:{forceUpdate:()=>A(e=>!e)}}));s.useEffect(()=>{const e=ce.parse(T.location.search);e!=null&&e.mode&&(e==null?void 0:e.mode)!==void 0&&(R(e.mode),Q()),e!=null&&e.uid&&(e==null?void 0:e.uid)!==void 0&&(J(e.uid),console.log(e.uid),D.findById(e.uid).then(t=>{var n,r,m,F;le(t)&&(console.log(t),t.data&&(f({systemDate:new Date((n=t==null?void 0:t.data)==null?void 0:n.date)??"",description:((r=t==null?void 0:t.data)==null?void 0:r.description)??"",reasons:((m=t==null?void 0:t.data)==null?void 0:m.reason)??"",isActive:(F=t==null?void 0:t.data)!=null&&F.isActive?"ACTIVE":"IN_ACTIVE"}),$({...t==null?void 0:t.data})))}).catch(t=>{console.log(t)}))},[]),s.useEffect(()=>{var e;l!=null&&l.current&&p!==""&&((e=l==null?void 0:l.current)==null||e.showFunction())},[p,P,u]),s.useEffect(()=>{v&&Y(!0)},[v]);const C=e=>{const{name:t,value:n}=e.target;console.log(e.target.value),f(r=>({...r,[t]:n}))},Q=async()=>{var e;try{const t=await D.getCurrentDate(),n=new Date((e=t.data)==null?void 0:e.date),r=new Date(n);f(m=>({...m,systemDate:new Date(r.setDate(n.getDate()+1))}))}catch(t){console.log(t)}},X=async()=>{var t,n;let e=!1;return e=(t=o==null?void 0:o.current)==null?void 0:t.allValid(),e||(A(r=>!r),(n=o==null?void 0:o.current)==null||n.showMessages(),A(r=>!r),!1)},k=()=>({date:d.systemDate,reason:d.reasons,description:d.description}),z=async()=>{x("");let e=!1;if(e=await X(),!e){b("top-right"),y(g.QUATERNARY),S(N.ERROR),j(!u);return}if(c===i.EDIT&&M!==void 0){const t=k();return D.update(t,M).then(n=>{b("bottom-right"),y(g.PRIMARY),S(N.SAVED),j(!u),O(!0)}).catch(n=>{x(W(n))})}else{const t=k();return D.save(t).then(n=>{y(g.PRIMARY),S(N.SAVED),j(!u),O(!0)}).catch(n=>{x(W(n))})}},Z=()=>{T.navigate(w)},ee=()=>{T.navigate(w)},te=()=>{R(i.EDIT)},ae=()=>{switch(c){case i.CREATE:return"heading.systemDate.create";case i.VIEW:return"heading.systemDate.view";case i.EDIT:return"heading.systemDate.edit";default:return"heading.systemDate.create"}},{systemDate:_,description:se,reasons:B}=d;return a.jsxs(a.Fragment,{children:[a.jsx(L,{children:a.jsxs("div",{className:"flex flex-col gap-3",children:[a.jsxs("div",{className:"flex w-full justify-between  items-center",children:[a.jsx(Ee,{title:ae()}),a.jsx("div",{className:"flex",children:c===i.CREATE||c===i.EDIT?a.jsx("div",{className:"flex gap-10",children:a.jsxs("div",{className:"flex gap-5",children:[a.jsx(h,{className:"reset-red",buttonType:E.CANCEL_OUTLINE,onClick:Z}),a.jsx(h,{buttonType:E.SAVE_OUTLINE,onClickWithLoader:z})]})}):a.jsxs("div",{className:"flex gap-5",children:[a.jsx(h,{buttonType:E.BACK_OUTLINE,onClick:ee}),a.jsx(h,{buttonType:E.EDIT_OUTLINE,className:"blue-primary",onClick:te})]})})]}),a.jsx(L,{override:{read:i.VIEW===c},children:a.jsxs("div",{className:"grid grid-cols-4 gap-3 mt-3",children:[a.jsx("div",{className:"col-span-1",children:a.jsx(me,{label:"input.systemDate.systemDate",name:"systemDate",placeholder:"DD-MMM-YYYY",variant:I.SECONDARY,value:_,disabled:!0,onChange:C,onBlur:()=>o.current.showMessageFor("systemDate"),validation:(U=o==null?void 0:o.current)==null?void 0:U.message("systemDate",_,"mandatory")})}),a.jsx("div",{className:"col-span-2 md:block sm:hidden"}),a.jsx("div",{className:"col-span-2",children:a.jsx(G,{label:"input.systemDate.description",name:"description",variant:I.SECONDARY,maxCount:200,onChange:C,value:se,disabled:c===i.VIEW})}),a.jsx("div",{className:"col-span-2",children:a.jsx(G,{label:"input.systemDate.reasons",name:"reasons",variant:I.SECONDARY,maxCount:200,onChange:C,value:B,disabled:c===i.VIEW,onBlur:()=>o.current.showMessageFor("reasons"),validation:(V=o==null?void 0:o.current)==null?void 0:V.message("reasons",B,"mandatory")})})]})}),a.jsx(he,{position:q,ref:l,toastText:p,variant:P,onRemove:()=>{if(H){const e=`${window.location.origin}${de}${ue}${w}`;window.location.href=e}}})]})}),a.jsx(ge,{onHide:()=>Y(!1),visible:K,errorMessage:v})]})},Re=ne(De);export{Re as default};
//# sourceMappingURL=PageSystemDateCreateViewEdit-39f3be57.js.map
