import{w as Tt,r,aG as C,j as e,T as P,J as B,aH as ee,ao as te,aI as ve,aJ as he,aK as k,be as fe,aF as Ae,o as _,az as ge,aM as St,av as je,p as Ne,z as Et,aN as se}from"./index-e8217573.js";import{s as T,a as S,b as E}from"./sortIcon-54357a29.js";import{e as bt}from"./eye_icon-081bddb3.js";import{A as oe}from"./AutoComplete-0bca608a.js";import{B as O}from"./ButtonBox-9e46519a.js";import{D as ae}from"./DatePicker-b1c13861.js";import{D as It}from"./Dialog-adadaf64.js";import{I as Rt}from"./InputBox-b9e88f52.js";import{M as Pt}from"./MenuBox-defc36b0.js";import{R as Bt}from"./ReadOnlyTable-86accb69.js";import{S as Ot}from"./SectionTitle-9f9277ec.js";import{S as ye}from"./SimpleDropDown-061a3470.js";import{B as Mt}from"./BusinessRuleService-e622f5ea.js";import{T as Yt}from"./Toast-ae99ea5b.js";import{C as N}from"./column.esm-938bad7d.js";import{T as ie}from"./TransactionApproval-6206dfb9.js";import{S as Ce}from"./StaticMasterTypeService-480bff1a.js";import"./search_icon-459d6871.js";import"./withAuth-6de36ebf.js";import"./virtualscroller.esm-9939945c.js";import"./kebab-menu-8835ad2e.js";import"./No_data-1720c54e.js";import"./datatable.esm-f474a654.js";import"./paginator.esm-11c2c115.js";import"./TransitionGroup-c8afe0ce.js";const Dt=[{label:"PRODUCT",value:"productConfigType=PRODUCT"},{label:"PRODUCT_INCOME_SCHEME",value:"productConfigType=PRODUCT_INCOME_SCHEME"}];function Ft(ne){const[ce,Te]=r.useState(!1),[Se,M]=r.useState(!1),[Ee,Y]=r.useState(!1),[l,le]=r.useState({}),[w,u]=r.useState(void 0),[V,p]=r.useState(void 0),[H,x]=r.useState(void 0),[z,v]=r.useState(void 0),[J,h]=r.useState(void 0),[G,f]=r.useState(void 0),[q,A]=r.useState(void 0),[Q,g]=r.useState(void 0),[K,j]=r.useState(void 0),D=r.useRef(null),[re,b]=r.useState(""),[de,I]=r.useState(C.PRIMARY),[y,R]=r.useState(!1),[F,me]=r.useState(!1),[o,U]=r.useState({rule:"",name:"",ruleApplied:"",createdFrom:"",createdTo:"",updatedFrom:"",updatedTo:"",isActive:"",createdBy:{name:"",id:""},updatedBy:{name:"",id:""}}),[c,d]=r.useState({limit:10,loading:!1,totalRecords:0,start:0,search:"",runCustomQuery:!1,records:[]}),W=r.useRef(null),[be,Ie]=r.useState([{items:[{label:"Activate",className:""},{label:"Deactivate",className:""}]}]),Re=(t,s)=>{var Z;console.log("rowData=",t);const a={label:"label.common.deactivate",command:()=>{De(t)}},i={label:"label.common.active",command:()=>{Ye(t)}},L=[{items:[t.isActive?a:i]}];Ie(L),(Z=W==null?void 0:W.current)==null||Z.toggle(s)},[X,Pe]=r.useState([]),[Be,Oe]=r.useState(),n=r.useRef(null);r.useEffect(()=>{var t;(t=n==null?void 0:n.current)==null||t.search()},[c==null?void 0:c.search]),r.useEffect(()=>{var t;D!=null&&D.current&&re!==""&&((t=D==null?void 0:D.current)==null||t.showFunction())},[re,de,y]);const ue=t=>{const{name:s,value:a}=t.target;U(typeof a=="object"?i=>({...i,[s]:{name:`${a==null?void 0:a.name} ${a!=null&&a.lastName?a==null?void 0:a.lastName:""}`.trim(),id:a.userId}}):i=>({...i,[s]:a}))},Me=t=>{const{name:s,value:a}=t.target;U(typeof a=="object"?i=>({...i,[s]:a.name}):i=>({...i,[s]:a}))},$=t=>{const{name:s,value:a}=t.target;U(i=>({...i,[s]:a}))},Ye=t=>{le({...t}),Y(!0),me(!0)},De=t=>{le({...t}),M(!0),me(!1)},Fe=()=>({...l},ie.Inactivate(l==null?void 0:l.uid).then(t=>{var s;I(C.PRIMARY),b(ee.DEACTIVATED),R(!y),M(!1),Y(!1),(s=n==null?void 0:n.current)==null||s.search()}).catch(t=>{I(C.QUATERNARY),b(te(t)),R(!y)})),$e=()=>ie.activate(l==null?void 0:l.uid).then(t=>{var s;I(C.PRIMARY),b(ee.ACTIVATED),R(!y),M(!1),Y(!1),(s=n==null?void 0:n.current)==null||s.search()}).catch(t=>{I(C.QUATERNARY),b(te(t)),R(!y)}),Le=()=>{const t={...l},s={...t,isActive:!0},a={uid:l.uid,name:l.name,operationType:ve.ACTIVE,entity:he.TRANSACTION_APPROVAL_RULE,initialStateJson:k(t),finalStateJson:k(s),reasonForChange:"Activate",reqPayload:k(s)};return Ce.approve(a).then(i=>{var m;I(C.PRIMARY),b(ee.SENT_FOR_APPROVAL),R(!y),M(!1),Y(!1),(m=n==null?void 0:n.current)==null||m.search()}).catch(i=>{I(C.QUATERNARY),b(te(i)),R(!y)})},_e=()=>{const t={...l},s={...t,isActive:!1},a={uid:l.uid,name:l.name,operationType:ve.INACTIVE,entity:he.TRANSACTION_APPROVAL_RULE,initialStateJson:k(t),finalStateJson:k(s),reasonForChange:"Deactivate",reqPayload:k(s)};return Ce.approve(a).then(i=>{var m;I(C.PRIMARY),b(ee.SENT_FOR_APPROVAL),R(!y),M(!1),Y(!1),(m=n==null?void 0:n.current)==null||m.search()}).catch(i=>{I(C.QUATERNARY),b(te(i)),R(!y)})},Ue=async t=>{let s=[];t.query.trim().length?(await Mt.getAll().then(a=>{a.status===200&&(s=[...a.data.results])}),s.length===0&&s.push({name:void 0,designation:void 0,emailId:void 0})):s=X,Oe(s)},pe=async t=>{let s=[];t.query.trim().length?(await Et.getAll(0,10,`name=${t.query}&`).then(a=>{a.status===200&&(s=[...a.data])}),s.length===0&&s.push({name:void 0,id:void 0})):s=X,Pe(s)},ke=()=>{var s,a,i,m;let t="";if(o.rule&&(t=`${t}rule.name:lk=${o.rule}&`),o.name&&(t=`${t}name:lk=${o.name}&`),o.ruleApplied&&(t=`${t}ruleApplied:lk=${o.ruleApplied}&`),o.createdFrom&&(console.log(o.createdFrom),t=`${t}createdAt:gt=${se(o.createdFrom)}&`),o.createdTo&&(t=`${t}createdAt:lt=${se(o.createdTo)}&`),o.updatedFrom&&(t=`${t}updatedAt:gt=${se(o.updatedFrom)}&`),o.updatedTo&&(t=`${t}updatedAt:lt=${se(o.updatedTo)}&`),o.isActive){let L=!0;o.isActive==="YES"?L=!0:o.isActive==="NO"&&(L=!1),t=`${t}isActive:lk=${L}&`}(s=o.createdBy)!=null&&s.id&&(t=`${t}&createdBy=${(a=o.createdBy)==null?void 0:a.id}&`),(i=o.updatedBy)!=null&&i.id&&(t=`${t}&updatedBy=${(m=o.updatedBy)==null?void 0:m.id}&`),d({...c,search:t})},we=()=>{U({rule:"",name:"",ruleApplied:"",createdFrom:"",createdTo:"",updatedFrom:"",updatedTo:"",isActive:"",createdBy:{name:"",id:""},updatedBy:{name:"",id:""}}),d({...c,search:""})},Ve=()=>{Te(!ce)},He=()=>{ne.navigate(`${fe}?mode=${Ae.CREATE}`)},Je=()=>{const{rule:t,name:s,ruleApplied:a,createdFrom:i,createdTo:m,updatedFrom:L,updatedTo:Z,isActive:Nt,createdBy:yt,updatedBy:Ct}=o;return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"p-3 flex flex-col gap-6 bg-primary-sapphireBlue-100 rounded-lg",children:[e.jsx("div",{className:"flex ",children:e.jsx(Ot,{title:"text.masterData.types.search"})}),e.jsxs("div",{className:" grid grid-cols-1 md:grid-cols-4 gap-3",children:[e.jsx(oe,{label:"input.productConfiguration.transaction.ruleName",name:"rule",field:"name",value:t,variant:_.PRIMARY,suggestions:Be,completeMethod:Ue,onChange:Me,itemTemplate:qe}),e.jsx(ye,{label:"input.productConfiguration.transaction.ruleApplied",name:"ruleApplied",variant:ge.SECONDARY,options:Dt,onChange:$,value:a}),e.jsx(Rt,{label:"input.productConfiguration.transaction.name",name:"name",variant:_.SECONDARY,onChange:$,value:s}),e.jsx(ye,{label:"input.productConfiguration.transaction.isActive",name:"isActive",variant:ge.SECONDARY,options:St,onChange:$,value:Nt}),e.jsx(ae,{label:"input.productConfiguration.transaction.createdFrom",name:"createdFrom",showTime:!0,value:i,placeholder:"DD-MMM-YYYY",onChange:$}),e.jsx(ae,{showTime:!0,label:"input.productConfiguration.transaction.createdTo",name:"createdTo",variant:_.PRIMARY,value:m,placeholder:"DD-MMM-YYYY",onChange:$}),e.jsx(oe,{label:"input.productConfiguration.transaction.createdBy",name:"createdBy",field:"name",value:yt,variant:_.PRIMARY,suggestions:X,completeMethod:pe,onChange:ue,itemTemplate:xe}),e.jsx(ae,{showTime:!0,label:"input.productConfiguration.transaction.updatedFrom",name:"updatedFrom",variant:_.PRIMARY,value:L,placeholder:"DD-MMM-YYYY",onChange:$}),e.jsx(ae,{showTime:!0,label:"input.productConfiguration.transaction.updatedTo",name:"updatedTo",variant:_.PRIMARY,value:Z,placeholder:"DD-MMM-YYYY",onChange:$}),e.jsx(oe,{field:"name",label:"input.productConfiguration.transaction.updatedBy",name:"updatedBy",variant:_.PRIMARY,value:Ct,suggestions:X,completeMethod:pe,onChange:ue,itemTemplate:xe}),e.jsxs("div",{className:"flex gap-5",children:[e.jsx(O,{buttonType:B.RESET_OUTLINE,onClick:we}),e.jsx(O,{buttonType:B.SEARCH_OUTLINE,onClick:ke})]})]})]})})},qe=t=>t.name===void 0?e.jsxs("div",{className:"flex flex-col items-center justify-center h-39",children:[e.jsx("img",{src:je,alt:"search-icon",className:" h-7 w-7"}),e.jsx(P,{className:"text-primary-labelColor mt-2",label:"Loading..."})]}):e.jsxs("div",{className:"flex flex-col",children:[e.jsx(P,{className:"text-primary-labelColor",label:`${t.name}`}),e.jsx(P,{className:"text-secondary-gray-500 text-xxs",label:t.name})]}),xe=t=>t.name===void 0?e.jsxs("div",{className:"flex flex-col items-center justify-center h-39",children:[e.jsx("img",{src:je,alt:"search-icon",className:" h-7 w-7"}),e.jsx(P,{className:"text-primary-labelColor mt-2",label:"Loading..."})]}):e.jsx("div",{className:"flex flex-col",children:e.jsx(P,{className:"text-primary-labelColor",label:`${t.name}`})}),Qe=t=>{let s="";w||w==null?(s='sort={"name":"DESC"}&',u(!1)):(s='sort={"name":"ASC"}&',u(!w)),p(void 0),h(void 0),f(void 0),j(void 0),A(void 0),g(void 0),x(void 0),v(void 0),d({...c,search:s})},ze=t=>{let s="";V||V==null?(s='sort={"rule.name" : "DESC"}&',p(!1)):(s='sort={"rule.name" : "ASC"}&',p(!V)),u(void 0),h(void 0),f(void 0),j(void 0),A(void 0),g(void 0),x(void 0),v(void 0),d({...c,search:s})},Ge=t=>{let s="";H||H==null?(s='sort={"product.name" : "DESC"}&',x(!1)):(s='sort={"product.name" : "ASC"}&',x(!H)),u(void 0),p(void 0),h(void 0),f(void 0),j(void 0),A(void 0),g(void 0),v(void 0),d({...c,search:s})},Ke=t=>{let s="";z||z==null?(s='sort={"incomeSchemeProduct.name" : "DESC"}&',v(!1)):(s='sort={"incomeSchemeProduct.name" : "ASC"}&',v(!0)),u(void 0),p(void 0),h(void 0),f(void 0),j(void 0),A(void 0),g(void 0),x(void 0),d({...c,search:s})},We=t=>{let s="";J||J==null?(s='sort={"createdAt":"DESC"}&',h(!1)):(s='sort={"createdAt":"ASC"}&',h(!J)),u(void 0),p(void 0),f(void 0),j(void 0),A(void 0),g(void 0),x(void 0),v(void 0),d({...c,search:s})},Xe=t=>{let s="";G||G==null?(s='sort={"createdBy":"DESC"}&',f(!1)):(s='sort={"createdBy":"ASC"}&',f(!0)),u(void 0),p(void 0),h(void 0),j(void 0),A(void 0),g(void 0),x(void 0),v(void 0),d({...c,search:s})},Ze=t=>{let s="";q||q==null?(s='sort={"updatedAt":"DESC"}&',A(!1)):(s='sort={"updatedAt":"ASC"}&',A(!q)),u(void 0),p(void 0),h(void 0),f(void 0),j(void 0),g(void 0),x(void 0),v(void 0),d({...c,search:s})},et=t=>{let s="";Q||Q==null?(s='sort={"updatedBy":"DESC"}&',g(!1)):(s='sort={"updatedBy":"ASC"}&',g(!Q)),u(void 0),p(void 0),h(void 0),f(void 0),j(void 0),A(void 0),x(void 0),v(void 0),d({...c,search:s})},tt=t=>{let s="";K||K==null?(s='sort={"isActive":"DESC"}&',j(!1)):(s='sort={"isActive":"ASC"}&',j(!0)),u(void 0),p(void 0),h(void 0),f(void 0),A(void 0),g(void 0),x(void 0),v(void 0),d({...c,search:s})},st=()=>e.jsxs("div",{className:"flex",children:[e.jsx("p",{className:"mr-1",children:"Display Name"}),e.jsx("img",{src:w==null?T:w==!0?S:E,alt:"Sort Icon",onClick:Qe,className:"cursor-pointer"})]}),at=()=>e.jsxs("div",{className:"flex",children:[e.jsx("p",{className:"mr-1",children:"Rule"}),e.jsx("img",{src:V==null?T:V==!0?S:E,alt:"Sort Icon",onClick:ze,className:"cursor-pointer"})]}),rt=()=>e.jsxs("div",{className:"flex",children:[e.jsx("p",{className:"mr-1",children:"Product"}),e.jsx("img",{src:H==null?T:H==!0?S:E,alt:"Sort Icon",onClick:Ge,className:"cursor-pointer"})]}),ot=()=>e.jsxs("div",{className:"flex",children:[e.jsx("p",{className:"mr-1",children:"Product Income"}),e.jsx("img",{src:z==null?T:z==!0?S:E,alt:"Sort Icon",onClick:Ke,className:"cursor-pointer"})]}),it=()=>e.jsxs("div",{className:"flex",children:[e.jsx("p",{className:"mr-1",children:"Created On"}),e.jsx("img",{src:J==null?T:J==!0?S:E,alt:"Sort Icon",onClick:We,className:"cursor-pointer"})]}),nt=()=>e.jsxs("div",{className:"flex",children:[e.jsx("p",{className:"mr-1",children:"Created By"}),e.jsx("img",{src:G==null?T:G==!0?S:E,alt:"Sort Icon",onClick:Xe,className:"cursor-pointer"})]}),ct=()=>e.jsxs("div",{className:"flex",children:[e.jsx("p",{className:"mr-1",children:"Updated On"}),e.jsx("img",{src:q==null?T:q==!0?S:E,alt:"Sort Icon",onClick:Ze,className:"cursor-pointer"})]}),lt=()=>e.jsxs("div",{className:"flex",children:[e.jsx("p",{className:"mr-1",children:"Updated By"}),e.jsx("img",{src:Q==null?T:Q==!0?S:E,alt:"Sort Icon",onClick:et,className:"cursor-pointer"})]}),dt=()=>e.jsxs("div",{className:"flex",children:[e.jsx("p",{className:"mr-1",children:"Is Active"}),e.jsx("img",{src:K==null?T:K==!0?S:E,alt:"Sort Icon",onClick:tt,className:"cursor-pointer"})]}),mt=t=>e.jsx(e.Fragment,{children:e.jsx("div",{className:"text-primary-ptext-900 font-BrownLight text-left",children:t.name})}),ut=t=>{var s;return e.jsx(e.Fragment,{children:e.jsx("div",{className:"text-primary-ptext-900 font-BrownLight text-left",children:(s=t==null?void 0:t.rule)==null?void 0:s.name})})},pt=t=>{var s;return e.jsx(e.Fragment,{children:e.jsx("div",{className:"text-primary-ptext-900 font-BrownLight text-left",children:(s=t==null?void 0:t.product)==null?void 0:s.name})})},xt=t=>{var s;return e.jsx(e.Fragment,{children:e.jsx("div",{className:"text-primary-ptext-900 font-BrownLight text-left",children:(s=t==null?void 0:t.incomeSchemeProduct)==null?void 0:s.name})})},vt=t=>e.jsx(e.Fragment,{children:e.jsx("div",{className:"text-primary-ptext-900 font-BrownLight text-left",children:`${Ne(t.createdAt)}`})}),ht=t=>e.jsx(e.Fragment,{children:e.jsx("div",{className:"text-primary-ptext-900 font-BrownLight text-left",children:t.createdByUserName})}),ft=t=>e.jsx("div",{className:"text-primary-ptext-900 font-BrownLight text-left",children:`${Ne(t.updatedAt)}`}),At=t=>e.jsx(e.Fragment,{children:e.jsx("div",{className:"text-primary-ptext-900 font-BrownLight text-left",children:t.updatedByUserName})}),gt=t=>e.jsx(e.Fragment,{children:t.isActive?e.jsxs("div",{className:"flex items-center ",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-primary-primaryBlue border-none"}),e.jsx("div",{className:"ml-2 ",children:"YES"})]}):e.jsxs("div",{className:"flex items-center ",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-secondary-gray-300 border-none"}),e.jsx("div",{className:"ml-2 ",children:"NO"})]})}),jt=t=>e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex items-center ",children:[e.jsx("div",{className:"w-4 h-4 flex items-center",children:e.jsx("img",{src:bt,alt:"Sahayya Logo",className:"cursor-pointer",onClick:s=>{ne.navigate(`${fe}?mode=${Ae.VIEW}&uid=${t.uid}`)}})}),e.jsx("div",{className:"ml ",children:e.jsx(O,{buttonType:B.MENU,onClick:s=>{Re(t,s)},className:"!rounded-none bg-transparent !hover:bg-primary-gray-300"})})]})});return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsxs("div",{className:"flex w-full justify-between items-center",children:[e.jsx(P,{label:"heading.productConfiguration.transaction",className:"text-primary-ptext-1000 text-h2 font-bold flex"}),e.jsxs("div",{className:"flex gap-10",children:[e.jsx(O,{buttonType:B.FILTER_OUTLINE,onClick:Ve}),e.jsx(O,{buttonType:B.CREATE,className:"create-button",onClick:He})]})]}),ce&&Je(),e.jsxs(Bt,{standardDataFormatPromise:ie.getAll,dataKey:"id",search:`&${c.search}`,ref:n,children:[e.jsx(N,{className:"text-primary-ptext-1000 text-left text-xs  p-1 h-12 pl-6",header:st,body:mt}),e.jsx(N,{className:"text-primary-ptext-1000 text-left text-xs  p-1 h-12 pl-6",header:at,body:ut}),e.jsx(N,{className:"text-primary-ptext-1000 text-left text-xs  p-1 h-12 pl-6",header:rt,body:pt}),e.jsx(N,{className:"text-primary-ptext-1000 text-left text-xs  p-1 h-12 pl-6",header:ot,body:xt}),e.jsx(N,{className:"text-primary-ptext-1000 text-left text-xs  p-1 h-12 pl-6",header:it,body:vt}),e.jsx(N,{className:"text-primary-ptext-1000 text-left text-xs  p-1 h-12 pl-6",header:nt,body:ht}),e.jsx(N,{className:"text-primary-ptext-1000 text-left text-xs  p-1 h-12 pl-6",header:ct,body:ft}),e.jsx(N,{className:"text-primary-ptext-1000 text-left text-xs  p-1 h-12 pl-6",header:lt,body:At}),e.jsx(N,{className:"text-primary-ptext-1000 text-left text-xs p-1 h-12 pl-6",header:dt,body:gt}),e.jsx(N,{className:"text-primary-ptext-1000 text-left text-xs p-1 h-12 pl-6",header:"Actions",body:jt})]})]}),e.jsxs(It,{onHide:F?()=>Y(!1):()=>M(!1),visible:F?Ee:Se,modal:!0,closable:!1,dismissableMask:!0,children:[e.jsx(P,{label:F?"dialog.staticMaster.activate":"dialog.staticMaster.deactivate",className:"text-primary-ptext-1000 text-base font-Roboto font-bold flex items-center justify-center"}),e.jsx(P,{label:F?"dialog.staticMaster.message.activate":"dialog.staticMaster.message",className:"text-primary-ptext-1000 text-xs font-Roboto flex mt text-center justify-center mx-2 mt-4"}),e.jsxs("div",{className:"flex justify-center mt-4",children:[e.jsx("div",{className:"mr-3",children:e.jsx(O,{buttonType:B.CANCEL_OUTLINE,onClick:F?()=>Y(!1):()=>M(!1)})}),e.jsx("div",{className:"mr-3 ",children:e.jsx(O,{buttonType:B.SAVE_OUTLINE,onClick:F?()=>$e():()=>Fe()})}),e.jsx("div",{className:"",children:e.jsx(O,{buttonType:B.SEND_FOR_APPROVAL,className:"approve-primary",onClick:F?()=>Le():()=>_e()})})]})]}),e.jsx(Pt,{className:"w-20 bg-white font-Roboto text-xs text-primary-pText-1300 pt-2 rounded-lg mt-0.5 flex justify-center align-center shadow-autoCompletePanel",model:be,ref:W}),e.jsx("div",{className:"",children:e.jsx(Yt,{position:"bottom-right",ref:D,toastText:re,variant:de})})]})}const cs=Tt(Ft);export{Dt as RULETYPE,cs as default};
//# sourceMappingURL=PageTransactionApprovalListingScreen-342feec7.js.map
