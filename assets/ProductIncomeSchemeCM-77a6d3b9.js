import{w as Pn,r as c,aF as m,aG as O,y as Yn,ad as tt,ae as nt,af as at,f as pe,j as a,ax as st,J as k,o as x,T as Y,cm as xe,aH as he,ao as ge,v as fe,av as ye,cn as Fn,b2 as S,aI as rt,aJ as it,aK as Z,b3 as ve,aA as se,b5 as ot}from"./index-e8217573.js";import{A as Ae}from"./AutoComplete-0bca608a.js";import{B as L}from"./ButtonBox-9e46519a.js";import{C as re}from"./CheckBox-8a0c0e77.js";import{D as ct}from"./DatePicker-b1c13861.js";import{E as lt}from"./EditableTableV2-6afcb42b.js";import{I as E}from"./InputBox-b9e88f52.js";import{I as ie}from"./InputTextArea-b90aad1d.js";import{M as mt}from"./MenuBox-defc36b0.js";import{P as Bn}from"./PageTitle-b3bba3d4.js";import{S as dt}from"./SimpleDropDown-061a3470.js";import{T as Dn}from"./Toast-ae99ea5b.js";import{C as h}from"./column.esm-938bad7d.js";import{I as V}from"./IncomeSchemeService-d239ebaf.js";import{E as $n}from"./ErrorDialog-d5eef4d7.js";import{F as On}from"./FileUploadBox-d8087723.js";import{S as Un}from"./SimpleTab-27fa8860.js";import{u as oe}from"./CustomHooks-0ce50620.js";import{F as _n}from"./FileUploadService-1aaf11f7.js";import{B as Wn}from"./BankMasterDataService-185c821e.js";import{P as ut}from"./ProductConfigProductService-51cfb6b7.js";import{S as be}from"./StaticMasterDataService-689a6eca.js";import{S as Jn}from"./StaticMasterTypeService-480bff1a.js";import{S as Gn}from"./SystemDate-aca727a8.js";import{A as qn}from"./ApprovalRequestService-f8cdf7f8.js";import"./search_icon-459d6871.js";import"./withAuth-6de36ebf.js";import"./virtualscroller.esm-9939945c.js";import"./kebab-menu-8835ad2e.js";import"./datatable.esm-f474a654.js";import"./paginator.esm-11c2c115.js";import"./TransitionGroup-c8afe0ce.js";import"./Dialog-adadaf64.js";import"./SimpleToolTip-3cfbb0c5.js";import"./FileUploadMenuBox-f47dc693.js";const Hn=w=>{var Oe,Ue,_e,We,Je;const[r,ee]=c.useState({product:"",incomeScheme:"",name:"",bank:"",lendingType:"",reason:"",notes:"",salientFeatures:"",description:"",attachments:[]}),pt={minLoanAmount:"",maxLoanAmount:"",minYearlyIncome:"",minTenor:"",maxTenor:"",minAge:"",maxAge:"",minRoi:"",maxRoi:"",isCoapplicant:!1,isGuarantor:!1,isBanking:!1,abb:{uid:""},isLtvApplicable:!1,maxLtv:"",maxFoir:"",applicableFrom:"",applicableTo:"",product:{uid:""},bank:{uid:""},lendingType:{uid:""}},[F,xt]=c.useState(0),[u,Te]=c.useState(m.CREATE),[ht,gt]=c.useState(""),[U,ft]=c.useState(""),[Kn,yt]=c.useState([]),[Ce,vt]=c.useState({product:"",incomeScheme:"",name:"",bank:"",lendingType:"",reason:"",notes:"",salientFeatures:"",description:""}),At=c.useRef(null),[bt,Se]=c.useState("bottom-right"),[Ee,_]=c.useState(O.PRIMARY),[ce,W]=c.useState(""),[B,J]=c.useState(!1),[le,G]=c.useState(""),[Tt,q]=c.useState(!1),[Ct,St]=c.useState([]),[Et,Nt]=c.useState([]),[me,de]=c.useState([]),[Ne,D]=c.useState(!1),[Rt,Re]=c.useState(!1),P=c.useRef(null),l=c.useRef(null),[ue,te]=c.useState(!1),Ie=c.useRef(!0);c.useState(!0),c.useState([]),c.useState({name:"",createdAt:"",isUploaded:!1,isAdded:!0,url:""}),c.useState([]);const g=c.useRef(null);c.useState([]),c.useRef(null);const[,$]=c.useState(!1),ne=c.useRef(null),[b,It]=c.useState(""),[I,jt]=c.useState(""),[je,Mt]=c.useState([]),[Me,kt]=c.useState([]),[Xn,Lt]=c.useState({}),[Pt,Qn]=c.useState([{items:[{label:"Delete",className:""}]}]),[Yt,Ft]=c.useState([{items:[{label:"Delete",className:""}]}]);c.useEffect(()=>{gn(),fn(),Qt();const e=Yn.parse(w.location.search);e!=null&&e.mode&&(e==null?void 0:e.mode)!==void 0&&Te(e.mode),Lt(e.finalData??e.initialData),ft(e.uid),e.uid&&Dt(e.uid),e.approvalUid&&$t(e.approvalUid),console.log(e,"hars")},[]),c.useEffect(()=>{var e;P!=null&&P.current&&ce!==""&&((e=P==null?void 0:P.current)==null||e.showFunction())},[ce,Ee,B]),c.useEffect(()=>{le&&Re(!0)},[le]),c.useEffect(()=>{var e;u!=="CREATE"&&Ie.current&&(Ie.current=!1,(e=l==null?void 0:l.current)==null||e.search())},[u]),c.useEffect(()=>{Ut()},[r.product,r.incomeScheme,r.bank,r.lendingType]),c.useEffect(()=>{var e,t;F===0?(e=l.current)==null||e.search():F===1&&((t=g.current)==null||t.search())},[F]);const H=e=>{const{name:t,value:n}=e.target;if(!(n.length<(b==null?void 0:b.length)&&t==="name"))if(t==="name"){let s=n;s=n.split(b),s=s[s.length-1],jt(s)}else ee(s=>({...s,[t]:n}))},ae=e=>{const{name:t,value:n}=e.target;ee(s=>({...s,[t]:n}))},Bt=()=>{o.current=new tt({validators:{...nt()},...at(),autoForceUpdate:{forceUpdate:()=>$(e=>!e)}})},o=c.useRef(new tt({validators:{...nt()},...at(),autoForceUpdate:{forceUpdate:()=>$(e=>!e)}})),A=e=>{var t,n;(n=o==null?void 0:o.current)==null||n.showMessageFor((t=e==null?void 0:e.target)==null?void 0:t.name)},ke=async()=>{var t,n;let e=!1;return e=((t=o==null?void 0:o.current)==null?void 0:t.allValid())??!1,e||($(s=>!s),(n=o==null?void 0:o.current)==null||n.showMessages(),$(s=>!s),!1)},Dt=e=>{V.getPrimaryData(e).then(t=>{var n,s,i,d,y,v,T,f,C,j,M,p,N,R,K,X,Q,z,Ge,qe,He,Ke,Xe,Qe,ze,Ze,Ve,we,et;console.log(t),ee({...r,product:(s=(n=t==null?void 0:t.data)==null?void 0:n.product)==null?void 0:s.uid,incomeScheme:{uid:(d=(i=t==null?void 0:t.data)==null?void 0:i.incomeSchemeName)==null?void 0:d.uid,name:(v=(y=t==null?void 0:t.data)==null?void 0:y.incomeSchemeName)==null?void 0:v.name},name:t.data.name,lendingType:{uid:(f=(T=t==null?void 0:t.data)==null?void 0:T.lendingType)==null?void 0:f.uid,name:(j=(C=t==null?void 0:t.data)==null?void 0:C.lendingType)==null?void 0:j.name},bank:{uid:(p=(M=t==null?void 0:t.data)==null?void 0:M.bank)==null?void 0:p.uid,name:(R=(N=t==null?void 0:t.data)==null?void 0:N.bank)==null?void 0:R.name},reason:(K=t.data)==null?void 0:K.reason,notes:(X=t.data)==null?void 0:X.notes,salientFeatures:(Q=t.data)==null?void 0:Q.salientFeatures,description:(z=t.data)==null?void 0:z.description}),vt({product:(qe=(Ge=t.data)==null?void 0:Ge.product)==null?void 0:qe.uid,incomeScheme:{uid:(He=t.data)==null?void 0:He.incomeSchemeName.uid,name:(Ke=t.data)==null?void 0:Ke.incomeSchemeName.name},name:(Xe=t.data)==null?void 0:Xe.name,lendingType:{uid:(Qe=t.data)==null?void 0:Qe.lendingType.uid,name:t.data.lendingType.name},bank:{uid:(ze=t.data)==null?void 0:ze.bank.uid,name:t==null?void 0:t.data.bank.name},reason:(Ze=t.data)==null?void 0:Ze.reason,notes:(Ve=t.data)==null?void 0:Ve.notes,salientFeatures:(we=t.data)==null?void 0:we.salientFeatures,description:(et=t.data)==null?void 0:et.description})}).catch(t=>{console.log(t)})},$t=e=>{qn.getAllForApprovalRequestSummary(0,10,`/uid/${e}`).then(t=>{var s,i,d,y,v;console.log(t);const n=JSON.parse(t.data.finalStateJson);ee({...r,product:(s=n==null?void 0:n.product)==null?void 0:s.uid,incomeScheme:{uid:(i=n==null?void 0:n.incomeSchemeName)==null?void 0:i.uid},name:n.name,lendingType:{uid:(d=n==null?void 0:n.lendingType)==null?void 0:d.uid},bank:{uid:(y=n==null?void 0:n.bank)==null?void 0:y.uid,name:(v=n==null?void 0:n.bank)==null?void 0:v.name},reason:n==null?void 0:n.reason,notes:n==null?void 0:n.notes,salientFeatures:n==null?void 0:n.salientFeatures,description:n==null?void 0:n.description})}).catch(t=>{console.log(t)})};async function Ot(e){return(await(await(await ut.getAll()).data.results).find(i=>i.uid===e)).name}const Ut=async()=>{var t,n,s,i;let e="";if(r!=null&&r.product){const d=await Ot(r==null?void 0:r.product);e=e+d}(t=r==null?void 0:r.incomeScheme)!=null&&t.name&&(e=e+"-"+((n=r==null?void 0:r.incomeScheme)==null?void 0:n.name)),r!=null&&r.bank&&(e=e+"-"+((s=r==null?void 0:r.bank)==null?void 0:s.name)),r!=null&&r.lendingType&&(e=e+"-"+((i=r==null?void 0:r.lendingType)==null?void 0:i.name)),It(e)},Le=()=>{var i,d,y,v,T,f,C,j,M;const e=[...((i=l==null?void 0:l.current)==null?void 0:i.getAddedRecords())??[],...((d=l==null?void 0:l.current)==null?void 0:d.getDeletedRecords())??[],...((y=l==null?void 0:l.current)==null?void 0:y.getUpdatedRecords())??[]],t=g.current?[...((v=g==null?void 0:g.current)==null?void 0:v.getAddedRecords())??[],...((T=g==null?void 0:g.current)==null?void 0:T.getDeletedRecords())??[],...((f=g==null?void 0:g.current)==null?void 0:f.getUpdatedRecords())??[]]:Me,n={uid:U,product:{uid:r==null?void 0:r.product},incomeSchemeName:{uid:(C=r==null?void 0:r.incomeScheme)==null?void 0:C.uid},name:I.length>0?`${b}${I}`:b,bank:{uid:(j=r==null?void 0:r.bank)==null?void 0:j.uid},lendingType:{uid:(M=r==null?void 0:r.lendingType)==null?void 0:M.uid},reason:r==null?void 0:r.reason,notes:r==null?void 0:r.notes,salientFeatures:r==null?void 0:r.salientFeatures,description:r==null?void 0:r.description,details:e.length>0?e:je,attachments:t.map(p=>({uid:p.uid,attachment:p.isActive===!1?null:{url:p.url,name:p.name},isActive:p.isInactive?!1:p.isActive}))},s=n.details.map(p=>{var N,R,K,X,Q,z;return{...p,minLoanAmount:(R=S((N=p.minLoanAmount)==null?void 0:N.toString()))==null?void 0:R.toString(),maxLoanAmount:(X=S((K=p.maxLoanAmount)==null?void 0:K.toString()))==null?void 0:X.toString(),minYearlyIncome:(z=S((Q=p.minYearlyIncome)==null?void 0:Q.toString()))==null?void 0:z.toString()}});return n.details=s,Ce.length!==0&&(n==null||n.details.forEach(p=>{var N,R;r!=null&&r.product&&(p.product={uid:r==null?void 0:r.product}),p.lendingType={uid:(N=r==null?void 0:r.lendingType)==null?void 0:N.uid},p.bank={uid:(R=r==null?void 0:r.bank)==null?void 0:R.uid},(p==null?void 0:p.isBanking)===!1&&(p.abb=null),(p==null?void 0:p.isLtvApplicable)===!1&&(p.maxLtv=null),(p==null?void 0:p.applicableTo)===""&&(p.applicableTo=null)})),n};console.log(l.current,"sachin");const _t=()=>{var d,y,v,T;const e={uid:U,product:{uid:r.product},incomeSchemeName:{uid:r.incomeScheme.uid},name:I.length>0?`${b}${I}`:b,bank:{uid:r.bank.uid},lendingType:{uid:r.lendingType.uid},reason:r.reason,notes:r.notes,salientFeatures:r.salientFeatures,description:r.description,details:[...((d=l.current)==null?void 0:d.getAddedRecords())??[],...((y=l.current)==null?void 0:y.getDeletedRecords())??[],...((v=l.current)==null?void 0:v.getUpdatedRecords())??[]],attachments:[...((T=g==null?void 0:g.current)==null?void 0:T.getAddedRecords())??[]]},t=e.details.map(f=>{var C,j,M,p,N,R;return{...f,minLoanAmount:(j=S((C=f.minLoanAmount)==null?void 0:C.toString()))==null?void 0:j.toString(),maxLoanAmount:(p=S((M=f.maxLoanAmount)==null?void 0:M.toString()))==null?void 0:p.toString(),minYearlyIncome:(R=S((N=f.minYearlyIncome)==null?void 0:N.toString()))==null?void 0:R.toString()}});e.details=t,e.details.forEach(f=>{r.product&&(f.product={uid:r.product}),f.lendingType={uid:r.lendingType.uid},f.bank={uid:r.bank.uid},r.isBanking||(f.abb=null),r.isLtvApplicable||(f.maxLtv=null)});let n;const s=Le(),i=Ce;return u===m.CREATE?n={name:I.length>0?`${b}${I}`:b,operationType:rt.CREATE,entity:it.INCOME_SCHEME,initialStateJson:"",finalStateJson:Z(s),reqPayload:Z(s),reasonForChange:(r==null?void 0:r.reason)??""}:n={name:I.length>0?`${b}${I}`:b,operationType:rt.UPDATE,entity:it.INCOME_SCHEME,initialStateJson:Z(i),finalStateJson:Z(s),reqPayload:Z(s),reasonForChange:(r==null?void 0:r.reason)??""},n},Wt=async()=>{var t,n;G("");let e=!1;if(e=await ke(),!e){Se("top-right"),_(O.QUATERNARY),W(he.ERROR),J(!B);return}if((t=o==null?void 0:o.current)!=null&&t.allValid()){const s=Le();return u===m.CREATE?V.save(s).then(i=>{_(O.PRIMARY),W("Saved Successfully"),J(!B),q(!0)}).catch(i=>{G(ge(i)),q(!1)}):V.update(U,s).then(i=>{_(O.PRIMARY),W("Saved Successfully"),J(!B),q(!0)}).catch(i=>{G(ge(i)),q(!1)})}else Se("top-right"),_(O.QUATERNARY),W(he.ERROR),J(!B),$(s=>!s),(n=o==null?void 0:o.current)==null||n.showMessages(),$(s=>!s)},Jt=()=>{w.navigate(xe)},Gt=async()=>{G("");let e=!1;if(e=await ke(),!e)return;const t=_t();return Jn.approve(t).then(n=>{_(O.PRIMARY),W(he.SENT_FOR_APPROVAL),J(!B),q(!0)}).catch(n=>{G(ge(n))})},qt=()=>{w.navigate(xe)},Ht=()=>{Te(m.EDIT)},Kt=()=>{var e;(e=l==null?void 0:l.current)==null||e.addRow(pt),yt(l.current.getCurrentRecords())},Xt=()=>{switch(u){case m.CREATE:return"Product Income Scheme - Create";case m.VIEW:return"Product Income Scheme - View";case m.EDIT:return"Product Income Scheme - Edit";default:return"Product Income Scheme - Create"}},Qt=async()=>{var e;try{const t=await Gn.getCurrentDate();gt(pe((e=t.data)==null?void 0:e.date))}catch(t){console.log(t)}},zt=e=>{var t;return a.jsx(E,{className:"text-right",name:`minLoanAmount${e.uid}`,variant:x.SECONDARY,onChange:n=>{var d;const s={...e},i=S(n.target.value);s.minLoanAmount=ve(i,"en-IN",0),(d=l.current)==null||d.reportDataChange(s)},onBlur:A,value:e.minLoanAmount,disabled:!e.temp&&u===m.EDIT,validation:(t=o==null?void 0:o.current)==null?void 0:t.message(`minLoanAmount${e.uid}`,e.minLoanAmount,"mandatory|onlyInteger")})},Zt=e=>{var t;return console.log(e.minLoanAmount,"minLoanAmount"),a.jsx(E,{className:"text-right",name:`maxLoanAmount${e.uid}`,variant:x.SECONDARY,onChange:n=>{var d;const s={...e},i=S(n.target.value);s.maxLoanAmount=ve(i,"en-IN",0),(d=l.current)==null||d.reportDataChange(s)},onBlur:A,validation:(t=o==null?void 0:o.current)==null?void 0:t.message(`maxLoanAmount${e.uid}`,S(e.maxLoanAmount),`mandatory:num|onlyPositive|min:${S(e.minLoanAmount)},num`),value:e.maxLoanAmount,disabled:!e.temp&&u===m.EDIT})},Vt=e=>{var t;return a.jsx(E,{className:"text-right",name:`minYearlyIncome${e.uid}`,onBlur:A,variant:x.SECONDARY,onChange:n=>{var d;const s={...e},i=S(n.target.value);s.minYearlyIncome=ve(i,"en-IN",0),(d=l.current)==null||d.reportDataChange(s)},validation:(t=o==null?void 0:o.current)==null?void 0:t.message(`minYearlyIncome${e.uid}`,S(e.minYearlyIncome),`mandatory:num|onlyPositive|min:${S(e.minYearlyIncome)},num`),value:e.minYearlyIncome,disabled:!e.temp&&u===m.EDIT})},wt=e=>{var t;return a.jsx(E,{className:"text-right",name:`minAge${e.uid}`,onBlur:A,variant:x.SECONDARY,onChange:n=>{var i;const s={...e};s.minAge=n.target.value,(i=l.current)==null||i.reportDataChange(s)},validation:(t=o==null?void 0:o.current)==null?void 0:t.message(`minAge${e.uid}`,e.minAge,"mandatory|onlyInteger|min:0,num"),value:e.minAge,disabled:!e.temp&&u===m.EDIT})},en=e=>{var t;return a.jsx(E,{className:"text-right",name:`maxAge${e.uid}`,variant:x.SECONDARY,onChange:n=>{var i;const s={...e};s.maxAge=n.target.value,(i=l.current)==null||i.reportDataChange(s)},onBlur:A,validation:parseInt(e.maxAge)<parseInt(e.minAge)?"Max age  cannot be less than Min age ":(t=o==null?void 0:o.current)==null?void 0:t.message(`maxAge${e.uid}`,e.maxAge,"mandatory|checkNumber|onlyPositive|maxDecimal:2|maxDigits:9"),value:e.maxAge,disabled:!e.temp&&u===m.EDIT})},tn=e=>{var t;return a.jsx(E,{className:"text-right",name:`minTenor${e.uid}`,variant:x.SECONDARY,onChange:n=>{var i;const s={...e};s.minTenor=n.target.value,(i=l.current)==null||i.reportDataChange(s)},onBlur:A,validation:(t=o==null?void 0:o.current)==null?void 0:t.message(`minTenor${e.uid}`,e.minTenor,"mandatory|onlyInteger|min:0,num"),value:e.minTenor,disabled:!e.temp&&u===m.EDIT})},nn=e=>{var t;return a.jsx(E,{className:"text-right",name:`maxTenor${e.uid}`,variant:x.SECONDARY,onChange:n=>{var i;const s={...e};s.maxTenor=n.target.value,(i=l.current)==null||i.reportDataChange(s)},onBlur:A,validation:parseInt(e.maxTenor)<parseInt(e.minTenor)?"Max Tenure  cannot be less than Min Tenure ":(t=o==null?void 0:o.current)==null?void 0:t.message(`maxTenor${e.uid}`,e.maxTenor,"mandatory|checkNumber|onlyPositive|maxDecimal:2|maxDigits:9"),value:e.maxTenor,disabled:!e.temp&&u===m.EDIT})},an=e=>{var t;return a.jsx(E,{className:"text-right",name:`minRoi${e.uid}`,variant:x.SECONDARY,onChange:n=>{var i;const s={...e};s.minRoi=n.target.value,(i=l.current)==null||i.reportDataChange(s)},onBlur:A,validation:(t=o==null?void 0:o.current)==null?void 0:t.message(`minRoi${e.uid}`,e.minRoi,"mandatory|min:0,num|maxDecimal:2"),value:e.minRoi,disabled:!e.temp&&u===m.EDIT})},sn=e=>{var t;return a.jsx(E,{className:"text-right",name:`maxRoi${e.uid}`,variant:x.SECONDARY,onChange:n=>{var i;const s={...e};s.maxRoi=n.target.value,(i=l.current)==null||i.reportDataChange(s)},onBlur:A,validation:parseInt(e.maxRoi)<parseInt(e.minRoi)?"Max ROI  cannot be less than Min ROI":(t=o==null?void 0:o.current)==null?void 0:t.message(`maxRoi${e.uid}`,e.maxRoi,"mandatory|checkNumber|onlyPositive|maxDecimal:2|maxDigits:9"),value:e.maxRoi,disabled:!e.temp&&u===m.EDIT})},rn=e=>a.jsx(E,{className:"text-right",name:`maxLtv${e.uid}`,variant:x.SECONDARY,onChange:t=>{var s;const n={...e};n.maxLtv=t.target.value,(s=l.current)==null||s.reportDataChange(n)},value:e.maxLtv,disabled:!e.temp||!e.isLtvApplicable}),on=e=>{var t;return a.jsx(E,{className:"text-right",name:`maxFoir${e.uid}`,variant:x.SECONDARY,onChange:n=>{var i;const s={...e};s.maxFoir=n.target.value,(i=l.current)==null||i.reportDataChange(s)},onBlur:A,validation:(t=o==null?void 0:o.current)==null?void 0:t.message(`maxFoir${e.uid}`,e.maxFoir,"mandatory|onlyInteger|min:0,num|maxDecimal:2"),value:e.maxFoir,disabled:!e.temp&&u===m.EDIT})},cn=e=>a.jsx(re,{name:"isCoapplicant",variant:se.PRIMARY,onChange:t=>{var s;const n={...e};n.isCoapplicant=t.target.checked,(s=l.current)==null||s.reportDataChange(n)},checked:e.isCoapplicant,disabled:!e.temp&&u===m.EDIT}),ln=e=>a.jsx(re,{name:"isGuarantor",variant:se.PRIMARY,onChange:t=>{var s;const n={...e};n.isGuarantor=t.target.checked,(s=l.current)==null||s.reportDataChange(n)},checked:e.isGuarantor,disabled:!e.temp&&u===m.EDIT}),mn=e=>a.jsx(re,{name:"isBanking",variant:se.PRIMARY,onChange:t=>{var s;const n={...e};t.target.checked||(n.abb.uid=""),n.isBanking=t.target.checked,(s=l.current)==null||s.reportDataChange(n)},checked:e.isBanking,disabled:!e.temp&&u===m.EDIT}),dn=e=>{var t;return a.jsx(dt,{name:"abb",variant:x.SECONDARY,onChange:n=>{var i;const s={...e};s.abb.uid=n.target.value,(i=l.current)==null||i.reportDataChange(s)},value:(t=e==null?void 0:e.abb)==null?void 0:t.uid,options:Et,optionLabel:"name",optionValue:"uid",disabled:!e.temp||!e.isBanking})},un=e=>a.jsx(re,{name:"isLtvApplicable",variant:se.PRIMARY,onChange:t=>{var s;const n={...e};t.target.checked||(n.maxLtv=""),n.isLtvApplicable=t.target.checked,(s=l.current)==null||s.reportDataChange(n)},checked:e.isLtvApplicable,disabled:!e.temp}),pn=(e,t)=>a.jsx("div",{className:"flex items-center justify-center w-20 ml-2",children:a.jsx(L,{buttonType:k.MENU,onClick:n=>Pe(e,l,n),className:"!rounded-none bg-transparent !hover:bg-primary-gray-300"})}),xn=e=>{var y;const t=new Date(e.applicableFrom),n=t.getFullYear(),s=t.getMonth(),i=t.getDate(),d=new Date(n,s,i);return a.jsx(ct,{disabled:!e.temp&&u===m.EDIT,name:`applicableFrom${e.uid}`,value:e.applicableFrom!=""?d:"",variant:x.SECONDARY,onChange:v=>{var f;const T={...e};T.applicableFrom=v.target.value,(f=l.current)==null||f.reportDataChange(T)},onBlur:A,validation:new Date(e.expiryDate)<new Date(ht)?"Applicable from Date should not be less than System Date":(y=o==null?void 0:o.current)==null?void 0:y.message(`applicableFrom${e.uid}`,e.applicableFrom,"mandatory"),placeholder:"DD-MMM-YYYY"})},hn=e=>a.jsx(ct,{name:`applicableTo${e.uid}`,value:e.applicableTo!=null?ot(e.applicableTo):"",variant:x.SECONDARY,onChange:t=>{var s;const n={...e};n.applicableTo=t.target.value??"",(s=l.current)==null||s.reportDataChange(n)},minDate:ot(e.applicableFrom),placeholder:"DD-MMM-YYYY"}),gn=()=>{ut.getAll().then(e=>{St([...e.data.results])}).catch(e=>{console.log("err")})},fn=()=>{be.getAll(0,10,"&staticMasterType.code=ABB_MONTHS").then(e=>{Nt([...e.data.results])}).catch(e=>{console.log("err")})},yn=async e=>{let t=[];D(!0),await be.getAll(0,10,`&staticMasterType.code=INCOME_SCHEME_NAME&name:lk=${e.query}`).then(n=>{fe(n)&&(t=[...n.data.results],D(!1))}),de(t)},vn=e=>e.code===void 0?a.jsxs("div",{className:"flex flex-col items-center justify-center h-39",children:[a.jsx("img",{src:ye,alt:"search-icon",className:" h-7 w-7"}),a.jsx(Y,{className:"mt-2 text-primary-labelColor",label:"Loading..."})]}):a.jsx("div",{className:"flex flex-col",children:a.jsx(Y,{className:"text-primary-labelColor",label:e.name})}),An=async e=>{let t=[];D(!0),await be.getAll(0,10,`&staticMasterType.code=PRODUCT_LENDING_TYPE&name:lk=${e.query}`).then(n=>{fe(n)&&(t=[...n.data.results],D(!1))}),de(t)},bn=async e=>{let t=[];D(!0),await Wn.getAll(0,10,`&isActive=true&name:lk=${e.query}&`).then(n=>{fe(n)&&(t=[...n.data.results],D(!1))}),de(t)},Tn=e=>e.code===void 0?a.jsxs("div",{className:"flex flex-col items-center justify-center h-39",children:[a.jsx("img",{src:ye,alt:"search-icon",className:" h-7 w-7"}),a.jsx(Y,{className:"mt-2 text-primary-labelColor",label:"Loading..."})]}):a.jsx("div",{className:"flex flex-col",children:a.jsx(Y,{className:"text-primary-labelColor",label:e.name})}),Cn=e=>e.name===void 0?a.jsxs("div",{className:"flex flex-col items-center justify-center h-39",children:[a.jsx("img",{src:ye,alt:"search-icon",className:" h-7 w-7"}),a.jsx(Y,{className:"mt-2 text-primary-labelColor",label:"Loading..."})]}):a.jsx("div",{className:"flex flex-col",children:a.jsx(Y,{className:"text-primary-labelColor",label:e.name})}),Sn=e=>a.jsx("div",{className:"flex items-center justify-center w-20",children:a.jsx(L,{buttonType:k.MENU,onClick:t=>Pe(e,g,t),className:"!rounded-none bg-transparent !hover:bg-primary-gray-300"})}),Pe=(e,t,n)=>{var s;Ft(i=>[{...i[0],items:[{...i[0].items[0],command:()=>{var d;(d=t==null?void 0:t.current)==null||d.deleteRow(e),console.log("Delete Row")}}]}]),(s=ne==null?void 0:ne.current)==null||s.toggle(n)},En=(e,t)=>{switch(e.key){case"Tab1":return a.jsxs("div",{className:"w-full",children:[a.jsxs("div",{className:"flex justify-between w-full mt-3 mb-2",children:[a.jsx("div",{}),a.jsx(L,{buttonType:k.ICON_TEXT_ROW,onClick:Kt})]}),a.jsx("div",{className:"w-full",children:a.jsxs(lt,{ref:l,uniqueKey:"uid",standardDataFormatPromise:V.getAllForTable,search:`&incomeSchemeProduct.uid=${U}&isActive=true`,mode:u===m.CREATE?"CREATE":"UPDATE",allRecords:je,children:[a.jsx(h,{className:"h-12 p-1 pl-6 text-xs text-left text-primary-ptext-1000",header:"Min Loan amount*(₹)",body:zt,style:{minWidth:"150px"}}),a.jsx(h,{className:"h-12 p-1 pl-6 text-xs text-left text-primary-ptext-1000",header:"Max Loan amount*(₹)",body:Zt,style:{minWidth:"150px"}}),a.jsx(h,{className:"h-12 p-1 pl-6 text-xs text-left text-primary-ptext-1000",header:"Min Yearly Income*(₹)",body:Vt,style:{minWidth:"150px",width:"150px"}}),a.jsx(h,{className:"h-12 p-1 pl-6 text-xs text-left text-primary-ptext-1000",header:"Min age*",body:wt,style:{minWidth:"150px"}}),a.jsx(h,{className:"h-12 p-1 pl-6 text-xs text-left text-primary-ptext-1000",header:"Max age*",body:en,style:{minWidth:"150px"}}),a.jsx(h,{className:"h-12 p-1 pl-6 text-xs text-left text-primary-ptext-1000",header:"Min. tenure (Month)*",body:tn,style:{minWidth:"150px"}}),a.jsx(h,{className:"h-12 p-1 pl-6 text-xs text-left text-primary-ptext-1000",header:"Max tenure (Month)*",body:nn,style:{minWidth:"150px"}}),a.jsx(h,{className:"h-12 p-1 pl-6 text-xs text-left text-primary-ptext-1000",header:"Min. ROI (%)*",body:an,style:{minWidth:"150px"}}),a.jsx(h,{className:"h-12 p-1 pl-6 text-xs text-left text-primary-ptext-1000",header:"Max ROI (%)*",body:sn,style:{minWidth:"150px"}}),a.jsx(h,{className:"h-12 p-1 pl-6 text-xs text-left text-primary-ptext-1000",header:"Coapplicant",body:cn,style:{minWidth:"150px"}}),a.jsx(h,{className:"h-12 p-1 pl-6 text-xs text-left text-primary-ptext-1000",header:"Guarantor",body:ln,style:{minWidth:"150px"}}),a.jsx(h,{className:"h-12 p-1 pl-6 text-xs text-left text-primary-ptext-1000",header:"Banking",body:mn,style:{minWidth:"150px"}}),a.jsx(h,{className:"h-12 p-1 pl-6 text-xs text-left text-primary-ptext-1000",header:"ABB (Months)",body:dn,style:{minWidth:"150px"}}),a.jsx(h,{className:"h-12 p-1 pl-6 text-xs text-left text-primary-ptext-1000",header:"LTV Applicable",body:un,style:{minWidth:"150px"}}),a.jsx(h,{className:"h-12 p-1 pl-6 text-xs text-left text-primary-ptext-1000",header:"Max. LTV(%)",body:rn,style:{minWidth:"150px"}}),a.jsx(h,{className:"h-12 p-1 pl-6 text-xs text-left text-primary-ptext-1000",header:"Max. FOIR(%)*",body:on,style:{minWidth:"150px"}}),a.jsx(h,{className:"h-12 p-1 pt-2 pl-6 text-xs text-left text-primary-ptext-1000",header:"From*",body:xn,style:{minWidth:"150px"}}),a.jsx(h,{className:"h-12 p-1 pt-2 pl-6 text-xs text-left text-primary-ptext-1000",header:"To",body:hn,style:{minWidth:"150px"}}),a.jsx(h,{className:"h-12 text-xs text-primary-ptext-1000 ",header:"Actions",style:{minWidth:"200px",width:"200px"},body:pn})]})})]});case"Tab2":return a.jsxs("div",{className:"w-full",children:[a.jsxs("div",{className:"flex justify-between w-full mt-2 mb-1",children:[a.jsx("div",{}),a.jsx("div",{children:a.jsx(On,{onSelect:jn,variant:Fn.PRIMARY})})]}),a.jsx("div",{className:"w-full",children:a.jsxs(lt,{standardDataFormatPromise:V.getAllAttachmentDataForIncomeScheme,style:{width:"100%"},breakpoint:"767px",className:"border border-secondary-concrete px-0 overflow-x-auto mt-4 rounded-lg read-only-table !min-h-111 w-full",dataKey:"id",search:`incomeSchemeProduct.uid=${U}&isActive=true&`,ref:g,paginator:m.CREATE===u,mode:u===m.CREATE?"CREATE":"UPDATE",uniqueKey:"uid",allRecords:Me,children:[a.jsx(h,{className:"w-2/12 h-12 pt-3 pl-6 text-xs text-left text-primary-ptext-1000",header:oe("table.header.productConfiguration.productDetails.attachment"),body:s=>{var i,d;return(i=s==null?void 0:s.attachment)!=null&&i.name?(d=s==null?void 0:s.attachment)==null?void 0:d.name:s==null?void 0:s.name}}),a.jsx(h,{className:"w-2/12 h-12 pt-3 pl-6 text-xs text-left text-primary-ptext-1000",header:oe("table.header.productConfiguration.productDetails.uploadedDate"),body:s=>{var i;return(i=s==null?void 0:s.attachment)!=null&&i.createdAt?pe(s.attachment.createdAt):s.createdAt}}),a.jsx(h,{className:"w-2/12 h-12 pt-3 pl-6 text-xs text-left text-primary-ptext-1000",header:oe("table.header.productConfiguration.productDetails.status"),body:s=>ue?"Uploading":"Uploaded"}),a.jsx(h,{className:"flex items-baseline w-2/12 h-12 pt-4 pl-6 text-xs text-left text-primary-ptext-1000",header:oe("table.header.productConfiguration.productDetails.actions"),body:Sn})]})})]});default:return a.jsx(a.Fragment,{})}},Nn=e=>{Bt(),xt(e.index)},Rn=e=>{var t,n,s,i,d,y;if(F===0){const v=[...((t=l.current)==null?void 0:t.getAddedRecords())??[],...((n=l.current)==null?void 0:n.getUpdatedRecords())??[],...((s=l.current)==null?void 0:s.getDeletedRecords())??[]];Mt(v)}else if(F===1){const v=[...((i=g.current)==null?void 0:i.getAddedRecords())??[],...((d=g.current)==null?void 0:d.getUpdatedRecords())??[],...((y=g.current)==null?void 0:y.getDeletedRecords())??[]];kt(v)}},In=JSON.parse(JSON.stringify({name:"",createdAt:"",isUploaded:!1,isAdded:!0,url:""})),jn=async e=>{var y,v,T,f;te(!0),console.log("Upload Attachment");const t=e.files[0],n=new Date,s=new Date().getTime(),i=Math.random().toString(36).substring(2,8),d=`${t.name}_${s}_${i}`;(y=g.current)==null||y.addRow({...In,name:t.name,isUploading:!1}),te(!0);try{const C=await _n.saveFile(t,d);console.log(C);const j=(v=g.current)==null?void 0:v.getLastAddedRecord();(f=g.current)==null||f.reportDataChange({...j,name:t.name,url:(T=C.data)==null?void 0:T.url,isUploaded:!0,createdAt:pe(n),isUploading:!1}),te(!1)}catch(C){console.log(C),te(!0)}},{product:Ye,incomeScheme:Fe,name:zn,bank:Be,lendingType:De,reason:$e,notes:Mn,salientFeatures:kn,description:Ln}=r;return a.jsx(st,{children:a.jsxs("div",{className:"flex flex-col gap-3",children:[a.jsxs("div",{className:"flex items-center justify-between w-full",children:[a.jsx("div",{className:" h-7.5",children:a.jsx(Bn,{title:Xt()})}),a.jsx("div",{className:"flex mr-5",children:u===m.CREATE||u===m.EDIT?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"mr-5",children:a.jsx(L,{buttonType:k.CANCEL_OUTLINE,onClick:Jt})}),a.jsx("div",{className:"mr-10",children:a.jsx(L,{buttonType:k.SAVE_OUTLINE,onClickWithLoader:Wt})}),a.jsx("div",{children:a.jsx(L,{className:"approve-primary",buttonType:k.SEND_FOR_APPROVAL,onClickWithLoader:Gt})})]}):a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"mr-5",children:a.jsx(L,{buttonType:k.BACK_OUTLINE,onClick:qt})}),a.jsx("div",{className:"",children:a.jsx(L,{buttonType:k.EDIT_OUTLINE,className:"blue-primary",onClick:Ht})})]})})]}),a.jsxs(st,{override:{read:[m.VIEW,m.REVIEW].includes(u)},children:[a.jsxs("div",{className:"grid grid-cols-1 gap-3 sm:grid-cols-1 md:grid-cols-2 lg:grid-cols-4",children:[a.jsx("div",{className:"col-span-1 sm:col-span-1 md:col-span-1 lg:col-span-1",children:a.jsx(dt,{label:"input.productConfiguration.incomeScheme.product",name:"product",variant:x.SECONDARY,onChange:H,value:Ye,options:Ct,optionLabel:"name",optionValue:"uid",onBlur:A,disabled:u!==m.CREATE,validation:(Oe=o==null?void 0:o.current)==null?void 0:Oe.message("product",Ye,"mandatory")})}),a.jsx("div",{className:"col-span-1 sm:col-span-1 md:col-span-1 lg:col-span-1",children:a.jsx(Ae,{label:"input.productConfiguration.incomeScheme.incomeScheme",name:"incomeScheme",field:"name",value:Fe,variant:x.PRIMARY,suggestions:me,completeMethod:yn,onChange:H,itemTemplate:vn,onBlur:A,disabled:u!==m.CREATE,validation:(Ue=o==null?void 0:o.current)==null?void 0:Ue.message("incomeScheme",Fe,"mandatory|max:100"),loader:Ne})}),a.jsx("div",{className:"col-span-1 sm:col-span-1 md:col-span-1 lg:col-span-1",children:a.jsx(Ae,{label:"label.productConfiguration.incomeScheme.bankOrFinancier",name:"bank",field:"name",value:Be,variant:x.PRIMARY,suggestions:me,completeMethod:bn,onChange:H,itemTemplate:Cn,onBlur:A,validation:(_e=o==null?void 0:o.current)==null?void 0:_e.message("bank",Be,"mandatory"),disabled:u!==m.CREATE,loader:Ne})}),a.jsx("div",{className:"col-span-1 sm:col-span-1 md:col-span-1 lg:col-span-1",children:a.jsx(Ae,{label:"label.productConfiguration.incomeScheme.lendingType",name:"lendingType",field:"name",value:De,variant:x.PRIMARY,suggestions:me,completeMethod:An,onChange:H,itemTemplate:Tn,onBlur:A,validation:(We=o==null?void 0:o.current)==null?void 0:We.message("lendingType",De,"mandatory"),disabled:u!==m.CREATE})}),a.jsx("div",{className:"col-span-1 sm:col-span-3 md:col-span-3 lg:col-span-3",children:a.jsx(E,{label:"label.productConfiguration.incomeScheme.name",name:"name",variant:x.SECONDARY,onChange:H,value:I?`${b}${I}`:b,disabled:!0})}),a.jsx("div",{className:"hidden  md:col-span-1"}),a.jsx("div",{className:"col-span-2 md:col-span-2 lg:col-span-2",children:a.jsx(ie,{label:"input.productConfiguration.incomeScheme.salientFeatures",name:"salientFeatures",variant:x.SECONDARY,maxCount:200,onChange:ae,value:kn,disabled:u!==m.CREATE})}),a.jsx("div",{className:"col-span-2 md:col-span-2 lg:col-span-2",children:a.jsx(ie,{label:"input.productConfiguration.incomeScheme.note",name:"notes",variant:x.SECONDARY,maxCount:200,onChange:ae,value:Mn,disabled:u!==m.CREATE})}),a.jsx("div",{className:"col-span-2 md:col-span-2 lg:col-span-2",children:a.jsx(ie,{label:"input.systemConfiguration.description",name:"description",variant:x.SECONDARY,maxCount:200,onChange:ae,value:Ln,disabled:u!==m.CREATE})}),u!==m.VIEW&&a.jsx("div",{className:"col-span-2 md:col-span-2 lg:col-span-2",children:a.jsx(ie,{label:"input.systemConfiguration.reasons",name:"reason",variant:x.SECONDARY,maxCount:200,onChange:ae,value:$e,onBlur:A,validation:(Je=o==null?void 0:o.current)==null?void 0:Je.message("reason",$e,"mandatory|onlyInteger|min:0,num")})})]}),a.jsx("div",{className:"flex justify-between w-full mt-3",children:a.jsx(Y,{label:"Income Scheme Details",className:"flex text-base font-bold text-primary-ptext-1000 font-Roboto"})}),a.jsx("div",{className:"mt-6",children:a.jsx(Un,{onTabChange:Nn,onBeforeTabChange:Rn,activeIndex:F,tabs:[{name:"Income Scheme*",key:"Tab1",disabled:ue},{name:"Attachment",key:"Tab2",disabled:ue}],renderContent:(e,t)=>En(e)})})," "]}),a.jsx(mt,{className:"w-20 bg-white  font-Roboto text-xs text-primary-pText-1300 pt-2 rounded-lg mt-0.5 flex justify-center align-center shadow-autoCompletePanel",model:Pt,ref:At}),a.jsx($n,{onHide:()=>Re(!1),visible:Rt,errorMessage:le}),a.jsx(Dn,{position:bt,ref:P,toastText:ce,variant:Ee,onRemove:()=>{Tt&&w.navigate(xe)}}),a.jsx(mt,{className:"w-20 bg-white font-Roboto text-xs text-primary-pText-1300 rounded-lg mt-0.5 flex justify-center align-center shadow-autoCompletePanel",model:Yt,ref:ne})]})})},La=Pn(Hn);export{La as default};
//# sourceMappingURL=ProductIncomeSchemeCM-77a6d3b9.js.map
