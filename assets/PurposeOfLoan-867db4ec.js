import{r as e,aF as i,j as s,ax as W,aG as L,d7 as R,aH as U,ao as _}from"./index-e8217573.js";import{E as F}from"./ErrorDialog-d5eef4d7.js";import{R as Y}from"./RichTextEditor-a03bd2fb.js";import{S as N}from"./SaveComponent-160c5b32.js";import{S as G}from"./Skeleton-7e12d019.js";import{T as H}from"./Toast-ae99ea5b.js";import{C as k}from"./CamService-5ccef840.js";const X={camUid:"",editorText:"",errorMessage:""},ee=j=>{const{data:h,payloadInfo:p,isLoading:x,getDataOnCancel:l}=j,[d,u]=e.useState({...X}),[g,f]=e.useState(i.VIEW),[E,T]=e.useState(""),[S,C]=e.useState(!1),[m,v]=e.useState(""),[w,M]=e.useState(!1),a=e.useRef(null),n=e.useRef(null);e.useEffect(()=>{u(t=>({...t,...h}))},[h]),e.useEffect(()=>{var t;a!=null&&a.current&&E!==""&&((t=a==null?void 0:a.current)==null||t.showFunction(),T(""))},[E,S]),e.useEffect(()=>{m&&M(!0)},[m]);const y=t=>{I()&&d!=null&&d.errorMessage&&u(r=>({...r,errorMessage:""}))},I=()=>{var r,o,c,P;return((P=(c=(o=(r=n==null?void 0:n.current)==null?void 0:r.editor)==null?void 0:o.plugins)==null?void 0:c.wordcount)==null?void 0:P.body.getCharacterCount())<1?(u(D=>({...D,errorMessage:"Mandatory"})),!1):!0},A=async()=>{var t,r;if(I())try{if((r=(t=n.current)==null?void 0:t.editor)!=null&&r.getContent()){const o=O(),c=await k.updateOverallComments(o);R(c)&&(T(U.SAVED),C(!S),f(i.VIEW))}}catch(o){console.log(o),v(_(o))}},V=()=>f(i.EDIT),b=()=>{l==null||l(),f(i.VIEW)},O=()=>{var r,o;return{loan:{uid:p.loanUid},stage:{uid:p.stageUid},remarksOverall:((o=(r=n.current)==null?void 0:r.editor)==null?void 0:o.getContent())??""}};return s.jsxs("div",{children:[s.jsx(N,{title:"",pageMode:g,onSave:A,onCancel:b,onEdit:V,disabled:x,children:x?s.jsx(G,{height:"19.375rem",width:"100%",borderRadius:"8px",animation:"wave"}):s.jsx(W,{override:{read:g===i.VIEW},children:s.jsx("div",{className:"grid grid-cols-4 gap-3 ",children:s.jsx("div",{className:"col-span-4",children:s.jsx(Y,{ref:n,validation:{errorMessage:d.errorMessage},initialValue:d.editorText,onChange:y,height:"400x",disabled:g===i.VIEW})})})})}),s.jsx(H,{position:"bottom-right",ref:a,toastText:E,variant:L.PRIMARY}),s.jsx(F,{onHide:()=>{M(!1),v("")},visible:w,errorMessage:m})]})},q={camUid:"",editorText:"",errorMessage:""},te=j=>{const{data:h,payloadInfo:p,isLoading:x,getDataOnCancel:l}=j,[d,u]=e.useState({...q}),[g,f]=e.useState(i.VIEW),[E,T]=e.useState(""),[S,C]=e.useState(!1),[m,v]=e.useState(""),[w,M]=e.useState(!1),a=e.useRef(null),n=e.useRef(null);e.useEffect(()=>{u(t=>({...t,...h}))},[h]),e.useEffect(()=>{var t;a!=null&&a.current&&E!==""&&((t=a==null?void 0:a.current)==null||t.showFunction(),T(""))},[E,S]),e.useEffect(()=>{m&&M(!0)},[m]);const y=t=>{I()&&d!=null&&d.errorMessage&&u(r=>({...r,errorMessage:""}))},I=()=>{var r,o,c,P;return((P=(c=(o=(r=n==null?void 0:n.current)==null?void 0:r.editor)==null?void 0:o.plugins)==null?void 0:c.wordcount)==null?void 0:P.body.getCharacterCount())<1?(u(D=>({...D,errorMessage:"Mandatory"})),!1):!0},A=async()=>{var t,r;if(I())try{if((r=(t=n.current)==null?void 0:t.editor)!=null&&r.getContent()){const o=O(),c=await k.updateLoanPurpose(o);R(c)&&(T(U.SAVED),C(!S),f(i.VIEW))}}catch(o){console.log(o),v(_(o))}},V=()=>f(i.EDIT),b=()=>{l==null||l(),f(i.VIEW)},O=()=>{var r,o;return{loan:{uid:p.loanUid},stage:{uid:p.stageUid},purposeOfLoanEndUse:((o=(r=n.current)==null?void 0:r.editor)==null?void 0:o.getContent())??""}};return s.jsxs("div",{children:[s.jsx(N,{title:"",pageMode:g,onSave:A,onCancel:b,onEdit:V,disabled:x,children:x?s.jsx(G,{height:"19.375rem",width:"100%",borderRadius:"8px",animation:"wave"}):s.jsx(W,{override:{read:g===i.VIEW},children:s.jsx("div",{className:"grid grid-cols-4 gap-3 ",children:s.jsx("div",{className:"col-span-4",children:s.jsx(Y,{ref:n,validation:{errorMessage:d.errorMessage},initialValue:d.editorText,onChange:y,height:"400x",disabled:g===i.VIEW})})})})}),s.jsx(H,{position:"bottom-right",ref:a,toastText:E,variant:L.PRIMARY}),s.jsx(F,{onHide:()=>{M(!1),v("")},visible:w,errorMessage:m})]})};export{ee as O,te as P,X as a,q as i};
//# sourceMappingURL=PurposeOfLoan-867db4ec.js.map
