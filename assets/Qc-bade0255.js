import{q as Y,x as F,r as t,aG as D,dl as A,j as e,T as G,N as H,l as g,i as b,a6 as J,J as z,K as W,M as Z,dA as X,Q as ee,V as se,dB as te,dC as ae,f as oe,cZ as y,b as E,dD as le,e as ie}from"./index-e8217573.js";import{u as ne}from"./LoanDetailActions-c6533c8e.js";import{c as re,M as ce,C as de}from"./MainMessageBody-e15b4437.js";import{B as me}from"./ButtonBox-9e46519a.js";import{D as xe}from"./Dialog-adadaf64.js";import{E as ge}from"./ErrorDialog-d5eef4d7.js";import{S as ue}from"./SimpleOverlayPanel-f23b2f6a.js";import{T as fe}from"./TextButton-41b4a67e.js";import{T as pe}from"./Toast-ae99ea5b.js";import{A as he}from"./ACLService-e19daf7c.js";import{Q as Ne}from"./QcService-39051cda.js";import{L as je}from"./LoanService-d10912e0.js";import"./Skeleton-7e12d019.js";import"./InputBox-b9e88f52.js";import"./withAuth-6de36ebf.js";import"./StageService-c1c03c89.js";import"./kebab-menu-8835ad2e.js";import"./loader-5f2cfb31.js";import"./TransitionGroup-c8afe0ce.js";const Te=[{id:1,name:"Checklist",path:te},{id:3,name:"Asset & Document Check",path:ae}],Be=()=>{const i=Y(),L=F(),c=t.useRef(null),[C,u]=t.useState(!1),[I,f]=t.useState(""),[_]=t.useState("bottom-right"),[d,M]=t.useState(""),[p,O]=t.useState(D.PRIMARY),[h,P]=t.useState(!1),[R,m]=t.useState(!1),n=t.useRef(null),[x,U]=t.useState({assignedTo:"",delegateTo:"",initiation:""}),[r,N]=t.useState(!1),[$,k]=t.useState(!1);t.useEffect(()=>{B()},[]),t.useEffect(()=>{console.log(r,"message ");const s=async()=>{try{const o=await de.checkNewMessageAvailability((i==null?void 0:i.stageUid)??"");k(o==null?void 0:o.data)}catch(o){console.log(o)}};s();const a=setInterval(s,5e3);return()=>{clearInterval(a)}},[]),t.useEffect(()=>{var s;n!=null&&n.current&&d!==""&&((s=n==null?void 0:n.current)==null||s.showFunction())},[d,p,h]);const B=()=>{const a=`&uid=${i.loanUid}`;je.getAll(0,1,a).then(o=>{const l=o.data.results[0];L(ne(l)),(l==null?void 0:l.qcStatus)===A.COMPLETED||(l==null?void 0:l.qcStatus)===A.CANCELLED?m(!0):m(!1)}).catch(o=>{console.log(o)})},V=()=>e.jsxs("div",{className:"flex flex-col gap-4 p-5 ",children:[e.jsxs("div",{className:"flex flex-row justify-between items-center",children:[e.jsx("div",{className:"text-sm text-secondary-stext-900",children:"Assigned to :"}),e.jsx("div",{className:"text-sm text-secondary-stext-900  font-bold ml-2",children:x.assignedTo})]}),e.jsxs("div",{className:"flex flex-row justify-between items-center",children:[e.jsx("div",{className:"text-sm text-secondary-stext-900",children:"Delegated to :"}),e.jsx("div",{className:"text-sm text-secondary-stext-900  font-bold ml-2",children:x.delegateTo})]}),e.jsxs("div",{className:"flex flex-row justify-between items-center",children:[e.jsx("div",{className:"text-sm text-secondary-stext-900",children:"Date of Initiation :"}),e.jsx("div",{className:"text-sm text-secondary-stext-900  font-bold ml-2",children:oe(x.initiation)})]})]}),Q=s=>{var o,l,T,S,v,w;const a=localStorage.getItem("stageDetail");U({assignedTo:((l=(o=JSON.parse(a))==null?void 0:o.assignee)==null?void 0:l.name)??"NA",delegateTo:((S=(T=JSON.parse(a))==null?void 0:T.delegate)==null?void 0:S.name)??"NA",initiation:((v=JSON.parse(a))==null?void 0:v.createdAtSystemDate)??"NA"}),c.current&&((w=c.current)==null||w.toggle(s))},K=async()=>{try{const s=await Ne.stageComplete(i.loanUid??"");if(M("Stage completed successfully"),O(D.PRIMARY),P(!h),m(!0),he.isRouteHasAccess(y)){const a=`${E}${g}${b}${y}/${i.loanUid}/`;window.location.href=a}}catch(s){u(!0),f(le(s))}},j=s=>{N(!r)},q=({isActive:s})=>(console.log("get class menu",s),`tab text-sm px-2.5 py-1 min-w-fit ${s?"bg-secondary-steelBlue-900 rounded-sm text-white font-medium shadow-activeBtn ":"text-primary-500"}`);return e.jsx("div",{children:e.jsxs("div",{className:"flex flex-col gap-5 ",children:[e.jsxs("div",{className:"flex items-center justify-between gap-5 w-full",children:[e.jsxs("div",{className:"flex items-center gap-5 w-11/12",children:[e.jsxs("div",{className:"border-r flex gap-3 items-center border-secondary-stext-600 px-5 py-2 w-1/5 ",children:[e.jsx(G,{className:"text-primary-ptext-1000 font-bold",label:"QC"}),e.jsx(fe,{className:"underline text-xs  !text-black  ",label:"View Details",onClick:Q}),e.jsxs("button",{onClick:j,className:" relative",children:[e.jsx("img",{src:re,alt:"ChatIcon",className:""})," ",$?e.jsx("div",{className:"absolute top-0 right-0 w-2 h-2 bg-red-500 rounded-full"}):e.jsx(e.Fragment,{})]})]}),e.jsx("div",{className:"w-4/5",children:Te.map(s=>e.jsx(H,{className:q,to:`${g}${b}${J}/${i.loanUid}/${i.stageUid}${s.path}`,children:s.name},s.path))})]}),e.jsx("div",{className:"w-1/12",children:e.jsx(me,{buttonType:z.STAGE_COMPLETE,onClickWithLoader:K,disabled:R,size:"LOAN_DATA"})})]}),e.jsxs("div",{className:"qc-layout-body-content",children:[e.jsx(t.Suspense,{fallback:e.jsx(W,{}),children:e.jsx(Z,{children:X.map((s,a)=>e.jsx(ee,{path:s.path,element:e.jsx(s.component,{})},a))})}),e.jsx(se,{})]}),e.jsx(ge,{onHide:()=>{u(!1),f("")},visible:C,errorMessage:I}),e.jsx(ue,{className:"rounded-lg shadow-lg !w-80 p-1.5 ",ref:c,content:V()}),r?e.jsx(xe,{visible:r,closable:!1,model:"false",onHide:()=>N(!1),className:"rounded-lg shadow-lg !w-240 bg-blend-darken !p-0 !h-162 ",children:e.jsx(ce,{params:i,handleCloseOverLay:j})}):null,e.jsx(pe,{position:_,ref:n,toastText:d,variant:p,onRemove:()=>{const s=E+g+ie;window.location.href=s}})]})})};export{Be as default};
//# sourceMappingURL=Qc-bade0255.js.map
