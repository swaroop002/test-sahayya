{"version":3,"file":"ReadOnlyTable-86accb69.js","sources":["../../src/components/ReadOnlyTable/ReadOnlyTable.tsx"],"sourcesContent":["import noData from \"assets/img/common/No_data.svg\";\nimport SimpleDropDown from \"components/SimpleDropDown\";\nimport Text from \"components/Text/Text\";\nimport { DataTable } from \"primereact/datatable\";\nimport { forwardRef, useEffect, useImperativeHandle, useState } from \"react\";\nimport { parseStandardAPIErrorMessage } from \"utils/CommonUtil\";\n\nexport interface IReadonlyTableRef {\n  search: () => void;\n  getCurrentRecords: () => any[];\n}\n\nconst ReadOnlyTable = forwardRef<IReadonlyTableRef, any>((props, ref) => {\n  const { standardDataFormatPromise, search, showAll, routeParams, ...primeReactProps } = props;\n  const [dataTable, setDataTable] = useState({\n    limit: props.tableObj?.limit ?? 10,\n    loading: props.tableObj?.loading ?? false,\n    totalRecords: props.tableObj?.totalRecords ?? 0,\n    start: props.tableObj?.start ?? 0,\n    records: [] as any[],\n    search: props.tableObj?.search ?? \"\",\n    page: props.tableObj?.page ?? 0,\n  });\n  const [startOffset] = useState(0);\n  const [errorMessage, setErrorMessage] = useState(\"\");\n\n  useEffect(() => {\n    if (standardDataFormatPromise) {\n      prepareSearchCallAPI();\n    }\n  }, []);\n\n  useImperativeHandle(ref, () => ({\n    search: prepareSearchCallAPI,\n    getCurrentRecords,\n  }));\n\n  const prepareSearchCallAPI = (e?: any) => {\n    if (!standardDataFormatPromise) {\n      return;\n    }\n    setDataTable({\n      ...dataTable,\n      loading: true,\n    });\n    function getStart() {\n      if (props.avoidStartOffset) {\n        return dataTable.start;\n      }\n      return dataTable.start === 0 ? startOffset : dataTable.start;\n    }\n\n    const searchParams = {\n      start: getStart(),\n      limit: props.rows ? props.rows : dataTable.limit,\n      search: \"\",\n    };\n\n    if (e) {\n      const page = e.page ? e.page : 0;\n      const rows = e.rows ? e.rows : 0;\n      let first = page * rows;\n      first = props.avoidStartOffset ? first : first + startOffset;\n      searchParams.start = first;\n    }\n    if (search) {\n      searchParams.search = search;\n    }\n\n    const searchFn =\n      search && props.standardDataFormatSearchPromise\n        ? props.standardDataFormatSearchPromise\n        : standardDataFormatPromise;\n    if (showAll) {\n      return searchFn(routeParams)\n        .then((res: any) => {\n          console.log(res);\n          if (res.data) {\n            setDataTable({\n              ...dataTable,\n              loading: false,\n              records: res.data.results ?? res.data,\n              totalRecords: res.data.totalRecords,\n              start: searchParams.start,\n              search: searchParams.search,\n            });\n            if (props.onUpdateCallback) {\n              props.onUpdateCallback();\n            }\n            if (props.scrollToTopOnUpdate) {\n              const firstRow = document.querySelector(\".p-datatable-scrollable-body tr\");\n              firstRow?.scrollIntoView({ behavior: \"smooth\" });\n            }\n          }\n        })\n        .catch((err: any) => {\n          setDataTable({\n            ...dataTable,\n            loading: false,\n            records: [],\n            start: 0,\n            totalRecords: 0,\n          });\n          setErrorMessage(parseStandardAPIErrorMessage(err));\n        });\n    }\n    return searchFn(searchParams.start, searchParams.limit, searchParams.search)\n      .then((res: any) => {\n        console.log(res);\n        if (res.data) {\n          setDataTable({\n            ...dataTable,\n            loading: false,\n            records: res.data.results ?? res.data,\n            totalRecords: res.data.totalRecords,\n            start: searchParams.start,\n            search: searchParams.search,\n          });\n          if (props.onUpdateCallback) {\n            props.onUpdateCallback();\n          }\n          if (props.scrollToTopOnUpdate) {\n            const firstRow = document.querySelector(\".p-datatable-scrollable-body tr\");\n            firstRow?.scrollIntoView({ behavior: \"smooth\" });\n          }\n        }\n      })\n      .catch((err: any) => {\n        setDataTable({\n          ...dataTable,\n          loading: false,\n          records: [],\n          start: 0,\n          totalRecords: 0,\n        });\n        setErrorMessage(parseStandardAPIErrorMessage(err));\n      });\n  };\n\n  const getCurrentRecords = () => {\n    return dataTable.records;\n  };\n\n  const onChange = (e: any) => {\n    setDataTable({\n      ...dataTable,\n      limit: e.value,\n    });\n  };\n\n  const rowClass = (data: any) => {\n    return data?.uid ? { \"row-highlight\": data.uid % 2 } : \"\";\n  };\n\n  const emptyMessageRender = () => {\n    return (\n      <div className=\"flex flex-col w-full h-16 justify-center items-center\">\n        <div className=\"text-sm text-inputBorderColour pt-3 font-medium\">\n          {props.showLoader ? (\n            <div>Loading...</div>\n          ) : (\n            props.emptymessage ?? (\n              <>\n                <div className=\"flex justify-center items-center\">\n                  <img src={noData} alt=\"search-icon\" className=\" w-120 mt-84\" />\n                </div>\n\n                <div className=\"flex justify-center mt-7 ml-4\">\n                  <Text\n                    label={errorMessage || \"No Data Found\"}\n                    className=\"text-primary-primaryTextColor text-h1 font-Roboto font-bold\"\n                  />\n                </div>\n              </>\n            )\n          )}\n        </div>\n      </div>\n    );\n  };\n\n  const RowsPerPageDropdown = (options: any) => {\n    const dropdownOptions = [\n      { label: 10, value: 10 },\n      { label: 20, value: 20 },\n      { label: 50, value: 50 },\n      { label: \"All\", value: options.totalRecords },\n    ];\n\n    return (\n      <div className=\"flex ml-auto\">\n        <div className=\"flex\">\n          <Text\n            label=\"Rows Per Page\"\n            className=\"text-secondary-gray-500 text-xs ml-4 flex items-center\"\n          />\n        </div>\n        <SimpleDropDown\n          value={options.value}\n          options={dropdownOptions}\n          onChange={onChange}\n          className=\"border-none !w-20 !text-primary-gray-700 !text-xss !font-Roboto\"\n        />\n      </div>\n    );\n  };\n\n  const template1 = {\n    layout: \"FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink RowsPerPageDropdown \",\n    RowsPerPageDropdown,\n  };\n\n  return (\n    <DataTable\n      headerClassName={props.headerClassName}\n      emptyMessage={emptyMessageRender}\n      search={\"\"}\n      dataLoaderFunction={prepareSearchCallAPI}\n      value={dataTable.records}\n      first={dataTable.start}\n      rows={dataTable.limit}\n      totalRecords={dataTable.totalRecords}\n      onPage={prepareSearchCallAPI}\n      loading={dataTable.loading}\n      selection={props.selection}\n      onRowSelect={(e) => (props.onRowSelect ? props.selectThisRow(e) : \"\")}\n      selectionMode={props.selectionMode}\n      dataKey={props.dataKey}\n      resizableColumns={false}\n      paginator={showAll ? false : dataTable.totalRecords > 0 && !props.hidePaginator}\n      paginatorTemplate={template1}\n      onsort={props.sortFunction}\n      paginatorLeft={\n        <Text\n          label={`${dataTable.start + 1}-${\n            dataTable.start + dataTable.limit > dataTable.totalRecords\n              ? dataTable.totalRecords\n              : dataTable.start + dataTable.limit\n          } of ${dataTable.totalRecords}`}\n          className=\"text-secondary-gray-500 text-xs ml-4\"\n        />\n      }\n      lazy={true}\n      rowClassName={rowClass}\n      responsiveLayout=\"scroll\"\n      breakpoint=\"768px\"\n      variant=\"tertiary\"\n      {...primeReactProps}\n      className={`border border-secondary-concrete px-0  rounded-lg read-only-table ${\n        props.className ? props.className : \"\"\n      }`}\n    >\n      {props.children}\n    </DataTable>\n  );\n});\n\nexport default ReadOnlyTable;\n"],"names":["ReadOnlyTable","forwardRef","props","ref","standardDataFormatPromise","search","showAll","routeParams","primeReactProps","dataTable","setDataTable","useState","_a","_b","_c","_d","_e","_f","startOffset","errorMessage","setErrorMessage","useEffect","prepareSearchCallAPI","useImperativeHandle","getCurrentRecords","e","getStart","searchParams","page","rows","first","searchFn","res","firstRow","err","parseStandardAPIErrorMessage","onChange","rowClass","data","emptyMessageRender","jsx","jsxs","Fragment","noData","Text","template1","options","dropdownOptions","SimpleDropDown","DataTable"],"mappings":"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"}