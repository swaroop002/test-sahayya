import{R as Ne,a7 as pe,r,j as s,av as Z,aG as D,ad as K,ae as W,af as G,dQ as x,ao as X,o as j,T,dS as F,J as je,c9 as Te,aH as Ce}from"./index-e8217573.js";import{A as Se}from"./AutoComplete-0bca608a.js";import{a as ve,B as Ie}from"./ButtonBox-9e46519a.js";import{D as ke}from"./Dialog-adadaf64.js";import{C}from"./EditableTableV2-6afcb42b.js";import{E as Ae}from"./ErrorDialog-d5eef4d7.js";import{I as z}from"./InputBox-b9e88f52.js";import{L as Be}from"./LinkButton-92540c18.js";import{R as Ee}from"./ReadOnlyTable-86accb69.js";import{S as Pe}from"./SimpleDropDown-061a3470.js";import{l as J}from"./link-0172a3d4.js";import{D as Le}from"./DepositAccountService-fb3e0018.js";import{F as Re}from"./FeeService-43f7dd78.js";import{T as Me}from"./Toast-ae99ea5b.js";const Fe="/assets/copy-disabled-3c87a906.svg",He="/assets/copy-effafcc4.svg",Ue="/assets/mail-disabled-dc9e79b7.svg",Ye="/assets/mail-353eaca7.svg",_e="/assets/sms-disabled-e6a1944f.svg",$e="/assets/sms-2ea8359a.svg",Qe=o=>{const S={COPY:{label:(o==null?void 0:o.buttonLabel)??"Copy",icon:He,disabledIcon:Fe},MAIL:{label:(o==null?void 0:o.buttonLabel)??"Mail",icon:Ye,disabledIcon:Ue},SMS:{label:(o==null?void 0:o.buttonLabel)??"SMS",icon:$e,disabledIcon:_e},LINK:{label:(o==null?void 0:o.buttonLabel)??"Link",icon:J,disabledIcon:J,iconPos:(o==null?void 0:o.iconPos)??"right"}},v=s.jsx("img",{src:Z,className:"animate-spin absolute right-4"}),{t:I}=pe(),{buttonType:R,onClickWithLoader:f,...k}=o,{label:Y,onClick:n,disabled:u,loadingIcon:b}=k,[A,y]=r.useState(!1),l=S==null?void 0:S[R],g=I((l==null?void 0:l.label)??""),N=()=>`flex-row-reverse text-xs ${u?" text-secondary-steelBlue-400":" text-primary-ptext-1000  hover:text-primary-buttonPrimaryHoverColor "}  ${o==null?void 0:o.className}`,B=E=>{if(n)n(E);else if(f){const p=f();Promise.resolve(p)===p&&(y(!0),p.then(M=>{y(!1)}).catch(()=>{y(!1)}))}};return s.jsx("div",{className:"relative text-xs ",children:s.jsx(ve,{...k,className:N(),label:g,loadingIcon:b??v,iconPos:(l==null?void 0:l.iconPos)??"right",icon:s.jsx("img",{src:u?l==null?void 0:l.disabledIcon:l==null?void 0:l.icon,className:" ml-0.5 "}),onClick:B,loading:A,disabled:A||u})})},H=Ne.memo(Qe),U={instrumentType:"",sahayyaBankAccount:{name:"",uid:"",branch:"",accountNo:"",holderName:"",ifscCode:""},upi:{qr:"",link:""}},as=r.forwardRef((o,S)=>{var q;const{onHide:v,visible:I,instrumentTypeOptions:R,emailService:f}=o,[k,Y]=r.useState([]),[n,u]=r.useState({...U}),[,b]=r.useState(void 0),[A,y]=r.useState(!1),[l,g]=r.useState(""),[N,B]=r.useState(""),[E,p]=r.useState(D.PRIMARY),[M,w]=r.useState(!1),c=r.useRef(new K({validators:{...W()},...G(),autoForceUpdate:{forceUpdate:()=>b(e=>!e)}})),[_,$]=r.useState(!1),V=r.useRef(null),h=r.useRef(null);r.useEffect(()=>{re()},[I]),r.useEffect(()=>{n.sahayyaBankAccount.upiHandle&&n.instrumentType===x.UPI&&ee()},[n.sahayyaBankAccount.upiHandle]),r.useEffect(()=>{l&&y(!0)},[l]),r.useEffect(()=>{var e;h!=null&&h.current&&N!==""&&((e=h==null?void 0:h.current)==null||e.showFunction(),B(""))},[N,E,M]),r.useEffect(()=>{var e;c.current.visibleFields=[],(e=c==null?void 0:c.current)==null||e.purgeFields()},[n==null?void 0:n.instrumentType]);const ee=async()=>{var e;try{const t=await Re.getDdeUpiQrAndLink(((e=n==null?void 0:n.sahayyaBankAccount)==null?void 0:e.upiHandle)??"");u(a=>({...a,upi:{...a.upi,qr:t.data.upiQr,link:t.data.upiLink}}))}catch(t){console.error(t),g(X(t))}},se=e=>{const{name:t,value:a}=e.target;u(typeof a=="object"?i=>({...i,[t]:{name:a==null?void 0:a.name,uid:a==null?void 0:a.uid,branch:a==null?void 0:a.branch,accountNo:a==null?void 0:a.accountNo,holderName:a==null?void 0:a.holderName,ifscCode:a==null?void 0:a.ifscCode,upiHandle:a==null?void 0:a.upiHandle}}):i=>({...i,[t]:{name:a,uid:"",branch:"",accountNo:"",holderName:"",ifscCode:"",upiHandle:""},upi:{...i.upi,link:"",qr:""}}))},ae=e=>{u(t=>({...t,...U,[e.target.name]:e.target.value}))},te=()=>{u(e=>({...e,...U})),v()},P=e=>{var t,a;(a=c==null?void 0:c.current)==null||a.showMessageFor((t=e==null?void 0:e.target)==null?void 0:t.name)},ne=()=>{var t,a;let e=!1;return e=((t=c==null?void 0:c.current)==null?void 0:t.allValid())??!1,e||(b(i=>!i),(a=c==null?void 0:c.current)==null||a.showMessages(),b(i=>!i),!1)},ce=()=>{if($(!0),setTimeout(()=>{$(!1)},2e3),n){const{holderName:e,name:t,branch:a,accountNo:i,ifscCode:L}=n.sahayyaBankAccount,m=` Payment Details 

 	• Pay to : ${e} 
 	• Bank Name : ${t} 
 	• Branch : ${a} 
 	• Bank Account no : ${i} 
 	• IFSC Code : ${L}`;console.log(m),Te(m)}},oe=async()=>{var e;if(ne())try{await(f==null?void 0:f((e=n==null?void 0:n.sahayyaBankAccount)==null?void 0:e.uid)),p(D.PRIMARY),B(Ce.SAVED),w(!M)}catch(t){console.log(t),g(X(t))}},re=()=>{var e;c.current=new K({validators:{...W()},...G(),autoForceUpdate:{forceUpdate:()=>b(t=>!t)}}),(e=c==null?void 0:c.current)==null||e.hideMessages()},le=async e=>{let t=[];try{await Le.getBankAccount(0,50,e.query).then(a=>{var L;const i=(L=a.data.results)==null?void 0:L.map(m=>{var O;return{name:m.bank.name,accountNo:m.accountNumber,branch:m.ifsc.branch,uid:m.uid,holderName:m.holderName,ifscCode:(O=m.ifsc)==null?void 0:O.ifscCode,upiHandle:m.upiHandle}});a.status===200&&(t=[...i??[]])})}catch(a){console.log(a)}t.length===0&&t.push({name:"",uid:"",accountNo:"",branch:""}),Y(t)},ie=e=>s.jsx("span",{children:e==null?void 0:e.holderName}),de=e=>s.jsx("span",{children:e!=null&&e.uid?e==null?void 0:e.name:""}),me=e=>s.jsx("span",{children:e==null?void 0:e.branch}),ue=e=>s.jsx("span",{children:e==null?void 0:e.accountNo}),xe=e=>s.jsx("span",{children:e==null?void 0:e.ifscCode}),he=()=>{const{sahayyaBankAccount:e}=n;return s.jsxs("div",{className:"px-6 pb-6",children:[s.jsx("div",{className:"mb-1.5",children:s.jsx(T,{label:"label.dde.bankAccountDetails",className:"text-base  text-primary-sideBarBgColor font-medium"})}),s.jsxs(Ee,{value:[{uid:e.uid??"",holderName:e.holderName??"",name:e.name??"",branch:e.branch??"",accountNo:e.accountNo??"",ifscCode:e.ifscCode??""}],className:" share-payment-details-table",ref:V,dataKey:"uid",children:[s.jsx(C,{className:"text-primary-ptext-1000 text-left text-xs  p-1 h-12 pl-6",header:"Pay To",body:ie}),s.jsx(C,{className:"text-primary-ptext-1000 text-left text-xs  p-1 h-12 pl-6",header:"Bank Name",body:de,style:{minWidth:"300px"}}),s.jsx(C,{className:"text-primary-ptext-1000 text-left text-xs  p-1 h-12 pl-6",header:"Branch",body:me}),s.jsx(C,{className:"text-primary-ptext-1000 text-left text-xs  p-1 h-12 pl-6",header:"Bank Account No",body:ue}),s.jsx(C,{className:"text-primary-ptext-1000 text-left text-xs  p-1 h-12 pl-6",header:"IFSC Code",body:xe})]})]})},Q=()=>{var t;const{sahayyaBankAccount:e}=n;return s.jsxs(s.Fragment,{children:[" ",s.jsx("div",{children:s.jsx(Se,{label:"label.dde.sahayyaBankAccount",name:"sahayyaBankAccount",value:e==null?void 0:e.name,variant:j.PRIMARY,suggestions:k,completeMethod:le,onChange:se,itemTemplate:be,onBlur:P,validation:(t=c==null?void 0:c.current)==null?void 0:t.message("sahayyaBankAccount",e==null?void 0:e.uid,"mandatory")})}),s.jsx("div",{children:s.jsx(z,{label:"label.loanListing.branch",name:"branch",variant:j.SECONDARY,onBlur:P,value:e==null?void 0:e.branch,disabled:!0})}),s.jsx("div",{children:s.jsx(z,{label:"label.dde.accountNo",name:"accountNo",variant:j.SECONDARY,onBlur:P,value:e==null?void 0:e.accountNo,className:"text-right",disabled:!0})})]})},fe=()=>{const{instrumentType:e}=n;return e===x.CHEQUE?s.jsx(s.Fragment,{children:Q()}):e===x.UPI?s.jsx(s.Fragment,{children:Q()}):s.jsx(s.Fragment,{})},be=e=>ye(e,`${e==null?void 0:e.name}`),ye=(e,t,a)=>(e==null?void 0:e.name)===void 0?s.jsxs("div",{className:"flex flex-col items-center justify-center h-39",children:[s.jsx("img",{src:Z,alt:"search-icon",className:" h-7 w-7"}),s.jsx(T,{className:"text-primary-labelColor mt-2",label:"Loading..."})]}):s.jsxs("div",{className:"flex flex-col",children:[s.jsx(T,{className:"text-primary-labelColor",label:t}),a?s.jsx(T,{className:"text-secondary-gray-500 text-xxs",label:a}):null]}),ge=()=>s.jsx(s.Fragment,{children:s.jsxs("div",{className:"flex items-end px-6 pb-6",children:[s.jsx("div",{className:"w-23 h-23",children:s.jsx("img",{src:n.upi.qr})}),s.jsx("div",{className:" ml-6",children:s.jsx(Be,{path:n.upi.link,label:n.upi.link,target:n.upi.link})})]})}),{instrumentType:d}=n;return s.jsxs(s.Fragment,{children:[s.jsxs(ke,{onHide:v,visible:I,modal:!0,closable:!1,variant:j.SECONDARY,className:" w-[842px] !p-0",children:[s.jsxs("div",{className:"flex justify-between items-center px-6 pt-3 pb-3 border-b border-primary-gray-600",children:[s.jsx(T,{className:"text-primary-primaryTextColor text-base font-bold ",label:"label.dde.sharePaymentDetails"}),s.jsxs("div",{className:"flex items-center",children:[s.jsx("div",{className:"mr-6",children:s.jsx(H,{buttonType:F.COPY,onClick:ce,buttonLabel:_?"Copied!":"Copy",disabled:d===""||d===x.CASH||_})}),s.jsx("div",{className:"mr-6",children:s.jsx(H,{buttonType:F.MAIL,onClick:oe,disabled:d===""})}),s.jsx("div",{className:"mr-12",children:s.jsx(H,{buttonType:F.SMS,disabled:d===""})}),s.jsx("div",{className:"flex",children:s.jsx("div",{className:"mr-6",children:s.jsx(Ie,{buttonType:je.CANCEL_OUTLINE,onClick:te,className:"w-8 h-8"})})})]})]}),s.jsxs("div",{className:`${d===""||d===x.CASH?"h-[12.5rem]":"h-[26.25rem]"}   overflow-y-auto `,children:[s.jsxs("div",{className:"mt-7 grid grid-cols-3 gap-3 px-6 mb-5 ",children:[s.jsx("div",{children:s.jsx(Pe,{label:"label.dde.instrumentType",name:"instrumentType",placeholder:"placeholder.dde.instrumentType",value:d,variant:j.PRIMARY,options:R,optionLabel:"name",optionValue:"value",onChange:ae,onBlur:P,validation:(q=c==null?void 0:c.current)==null?void 0:q.message("instrumentType",d,"mandatory")})}),s.jsx("div",{}),s.jsx("div",{}),fe()]}),d===x.UPI||d===x.CHEQUE?he():null,d===x.UPI?ge():null]})]}),s.jsx(Me,{position:"bottom-right",ref:h,toastText:N,variant:E}),s.jsx(Ae,{onHide:()=>{y(!1),g("")},visible:A,errorMessage:l})]})});export{as as S};
//# sourceMappingURL=SharePaymentDetails-7d6fd6f2.js.map
